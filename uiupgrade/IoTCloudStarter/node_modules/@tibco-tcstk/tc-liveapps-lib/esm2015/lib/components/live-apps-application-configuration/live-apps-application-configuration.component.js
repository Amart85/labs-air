/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
*     Case Type icons are stored in an orgFolder specified in liveAppsConfig.json (pushed to shared state)
*     Icon Name will be appId.filename.svg
*     Icon svg should contain <DYNAMICFILL> this will be set according to the color selected in this component
*
*     eg: 1742.ic-created.svg for Partner Portal Live Apps App (appId: 1742) 'Created' state
*
*     <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14">
*        <path fill="<DYNAMICFILL>" class="svg-content" fill-rule="evenodd" d="M7 14A7 7 0 1 1 7 0a7 7 0 0 1 0 14zm3.474-6.472a.527.527 0 0 0 0-1.053H7.526V3.527a.525.525 0 1 0-1.052 0v2.948H3.526a.527.527 0 0 0 0 1.053h2.948v2.948a.525.525 0 0 0 .898.373.525.525 0 0 0 .154-.373V7.528h2.948z"/>
*      </svg>
*
*
 */
import { Component, EventEmitter, Inject, Input, Output, QueryList, ViewChildren } from '@angular/core';
import { LiveAppsService } from '../../services/live-apps.service';
import { CaseTypeState, IconMap } from '../../models/liveappsdata';
import { take, takeUntil } from 'rxjs/operators';
import { HttpClient } from '@angular/common/http';
import { DomSanitizer } from '@angular/platform-browser';
import { LiveAppsCaseSummaryComponent } from '../live-apps-case-summary/live-apps-case-summary.component';
import { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material';
import { Location } from '@angular/common';
import { LiveAppsComponent } from '../live-apps-component/live-apps-component.component';
import { DEFAULT_COLORS, DEFAULT_STATE_COLOR, DEFAULT_TYPE_COLOR, TcCaseCardConfigService } from '../../services/tc-case-card-config.service';
import { TcDocumentService } from '../../services/tc-document.service';
/**
 * Manages summary card configuration
 *
 * \@example <tcla-live-apps-application-configuration></tcla-live-apps-application-configuration>
 */
export class LiveAppsApplicationConfigurationComponent extends LiveAppsComponent {
    /**
     * @param {?} http
     * @param {?} sanitizer
     * @param {?} liveapps
     * @param {?} caseCardConfigService
     * @param {?} documentsService
     * @param {?} dialog
     * @param {?} location
     */
    constructor(http, sanitizer, liveapps, caseCardConfigService, documentsService, dialog, location) {
        super();
        this.http = http;
        this.sanitizer = sanitizer;
        this.liveapps = liveapps;
        this.caseCardConfigService = caseCardConfigService;
        this.documentsService = documentsService;
        this.dialog = dialog;
        this.location = location;
        /**
         * ~event configChanged : Configuration values changed
         * ~payload CaseCardConfig : CaseCardConfig object when configuration is changed (so called can do a save with data)
         */
        this.configChanged = new EventEmitter();
        // prepareExternalUrl will add the base href
        this.DEFAULT_CASE_TYPE_ICON = 'assets/icons/ic-generic-casetype.svg';
        this.DEFAULT_CASE_TYPE_COLOR = DEFAULT_TYPE_COLOR;
        this.DEFAULT_CASE_STATE_ICON = 'assets/icons/ic-generic-state.svg';
        this.DEFAULT_CASE_STATE_COLOR = DEFAULT_STATE_COLOR;
        this.DEFAULT_COLOR_PALETTE = DEFAULT_COLORS;
        this.getConfigForState = (/**
         * @param {?} state
         * @return {?}
         */
        (state) => {
            /** @type {?} */
            let reqIconMap;
            if (this.caseCardConfig.cardConfig && this.caseCardConfig.cardConfig.stateMap) {
                this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                (stateMap) => {
                    if (stateMap.state === state.value) {
                        reqIconMap = stateMap;
                    }
                }));
            }
            return reqIconMap ? reqIconMap : new IconMap(false, state.value, this.DEFAULT_CASE_STATE_COLOR, this.DEFAULT_CASE_STATE_ICON);
        });
        this.getConfigForCaseType = (/**
         * @param {?} caseTypeId
         * @return {?}
         */
        (caseTypeId) => {
            /** @type {?} */
            let reqIconMap;
            if (this.caseCardConfig.cardConfig && this.caseCardConfig.cardConfig.stateMap) {
                this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                (stateMap) => {
                    if (stateMap.isCaseType) {
                        reqIconMap = stateMap;
                    }
                }));
            }
            return reqIconMap ? reqIconMap : new IconMap(true, caseTypeId, this.DEFAULT_CASE_TYPE_COLOR, this.DEFAULT_CASE_TYPE_ICON);
        });
        this.updateIconMap = (/**
         * @param {?} stateConfig
         * @return {?}
         */
        (stateConfig) => {
            /** @type {?} */
            let foundMap;
            /** @type {?} */
            let updatedMap;
            if (this.caseCardConfig.cardConfig && this.caseCardConfig.cardConfig.stateMap) {
                this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    if (stateMap.state === stateConfig.state) {
                        foundMap = stateConfig;
                        stateMap.state = stateConfig.state;
                        stateMap.icon = stateConfig.icon;
                        stateMap.fill = stateConfig.fill;
                    }
                }));
                if (foundMap) {
                    foundMap = stateConfig;
                }
                else {
                    this.caseCardConfig.cardConfig.stateMap.push(stateConfig);
                }
            }
            else {
                this.caseCardConfig.cardConfig.stateMap = [];
                this.caseCardConfig.cardConfig.stateMap.push(stateConfig);
            }
            this.configChanged.emit(this.caseCardConfig);
        });
        this.handleCaseTypeColorToggleChange = (/**
         * @param {?} changes
         * @return {?}
         */
        (changes) => {
            this.caseCardConfig.cardConfig.useCaseTypeColor = changes.checked ? changes.checked : false;
            if (changes.checked) {
                this.caseSummaryComponent.forEach((/**
                 * @param {?} comp
                 * @return {?}
                 */
                (comp) => {
                    comp.restylePreview(this.selectedStateConfig.icon, this.caseTypeColor);
                }));
            }
            this.configChanged.emit(this.caseCardConfig);
        });
        this.setFill = (/**
         * @param {?} fill
         * @param {?} stateConfig
         * @return {?}
         */
        (fill, stateConfig) => {
            this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                comp.restylePreview(stateConfig.icon, fill);
            }));
            this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return comp.id === stateConfig.state;
            })).refillSVG(fill);
            this.configChanged.emit(this.caseCardConfig);
        });
        this.setCaseTypeFill = (/**
         * @param {?} fill
         * @param {?} stateConfig
         * @return {?}
         */
        (fill, stateConfig) => {
            this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                comp.restylePreviewCaseType(stateConfig.icon, fill);
            }));
            this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return (comp.id === stateConfig.state && stateConfig.isCaseType);
            })).refillSVG(fill);
            this.configChanged.emit(this.caseCardConfig);
        });
        this.selectState = (/**
         * @param {?} state
         * @return {?}
         */
        (state) => {
            this.selectedStateConfig = this.getConfigForState(state);
            if (!this.caseCardConfig.cardConfig.useCaseTypeColor) {
                this.caseSummaryComponent.forEach((/**
                 * @param {?} comp
                 * @return {?}
                 */
                (comp) => {
                    comp.restylePreview(this.selectedStateConfig.icon, this.selectedStateConfig.fill);
                }));
            }
        });
        this.setNewStateIcon = (/**
         * @param {?} url
         * @return {?}
         */
        (url) => {
            this.selectedStateConfig.icon = url;
            this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                return (comp.id === this.selectedStateConfig.state);
            })).refresh(this.selectedStateConfig.icon, this.selectedStateConfig.fill);
            this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                comp.restylePreview(this.selectedStateConfig.icon, this.selectedStateConfig.fill);
            }));
            this.updateIconMap(this.selectedStateConfig);
        });
        this.setNewCaseTypeIcon = (/**
         * @param {?} url
         * @return {?}
         */
        (url) => {
            this.caseTypeIcon = url;
            this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                return (comp.id === this.appTypeLabel);
            })).refresh(this.caseTypeIcon, this.caseTypeColor);
            this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                comp.restylePreviewCaseType(this.caseTypeIcon, this.caseTypeColor);
            }));
            this.updateIconMap(new IconMap(true, this.appTypeLabel, this.caseTypeColor, this.caseTypeIcon));
        });
        this.refresh = (/**
         * @return {?}
         */
        () => {
            // need states & cardConfig
            this.selectedCaseTypeConfig = null;
            this.caseCardConfigService.getCaseCardConfig(this.sandboxId, this.appId, this.uiAppId, this.appTypeLabel, this.DEFAULT_CASE_TYPE_COLOR, this.DEFAULT_CASE_TYPE_ICON, this.DEFAULT_CASE_STATE_COLOR, this.DEFAULT_CASE_STATE_ICON).pipe(take(1), takeUntil(this._destroyed$)).subscribe((/**
             * @param {?} caseCardConfig
             * @return {?}
             */
            caseCardConfig => {
                this.caseCardConfig = caseCardConfig;
                // set default selected to first state for this case type (0 is case type)
                this.selectedStateConfig = this.caseCardConfig.cardConfig.stateMap[1];
                /** @type {?} */
                const caseTypeRec = this.caseCardConfig.cardConfig.stateMap.find((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    return stateMap.isCaseType;
                }));
                this.caseTypeIcon = caseTypeRec.icon;
                this.caseTypeColor = caseTypeRec.fill;
                this.selectedCaseTypeConfig = this.getConfigForCaseType(this.appTypeLabel);
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => { this.errorMessage = 'Error retrieving case card config: ' + error.error.errorMsg; }));
        });
    }
    /*public saveConfig = () => {
        this.caseCardConfigService.updateCaseCardConfig(this.sandboxId, this.appId, this.uiAppId, this.caseCardConfig)
          .pipe(
            take(1),
            takeUntil(this._destroyed$),
            map(caseCardConfig => {
              this.caseCardConfig = caseCardConfig;
            })
          ).subscribe(null, error => { console.log('Unable to update case card config: ' + error.errorMsg); }
        );
      }*/
    /**
     * @param {?} state
     * @param {?} isCaseType
     * @return {?}
     */
    openDialog(state, isCaseType) {
        if (!isCaseType) {
            this.selectState(state);
        }
        else {
            state = new CaseTypeState().deserialize({ value: this.appTypeLabel });
        }
        /** @type {?} */
        const dialogRef = this.dialog.open(LiveAppsStateIconUploadDialogComponent, {
            width: '500px',
            data: { state: state, isCaseType: isCaseType }
        });
        dialogRef.componentInstance.fileevent.subscribe((/**
         * @param {?} $e
         * @return {?}
         */
        ($e) => {
            this.uploadFile($e.file, $e.state, $e.isCaseType);
        }));
        dialogRef.afterClosed().subscribe((/**
         * @param {?} result
         * @return {?}
         */
        result => {
        }));
    }
    /**
     * @param {?} file
     * @param {?} state
     * @param {?} isStateIcon
     * @return {?}
     */
    uploadFile(file, state, isStateIcon) {
        if (file) {
            /** @type {?} */
            const url = 'webresource/v1/orgFolders/' + this.folderId + '/' + this.appId + '.' + file.name;
            /** @type {?} */
            const dlUrl = 'webresource/orgFolders/' + this.folderId + '/' + this.appId + '.' + file.name;
            this.liveapps.clearFromIconSVGTextCache(url);
            this.documentsService.uploadDocument('orgFolders', this.folderId, this.sandboxId, file, (this.appId + '.' + file.name), '')
                .subscribe((/**
             * @param {?} val
             * @return {?}
             */
            val => {
                if (!isStateIcon) {
                    this.setNewStateIcon(dlUrl);
                }
                else {
                    this.setNewCaseTypeIcon(dlUrl);
                }
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => { console.log('error'); this.errorMessage = 'Error uploading state icon: ' + error.errorMsg; }));
        }
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.appId && (changes.appId.currentValue !== changes.appId.previousValue)) {
            this.refresh();
        }
    }
}
LiveAppsApplicationConfigurationComponent.decorators = [
    { type: Component, args: [{
                selector: 'tcla-live-apps-application-configuration',
                template: "<div *ngIf=\"appId\" class=\"tcs-case-card-customization\" fxLayout=\"column\">\n    <div fxLayout=\"row\" fxLayoutAlign=\"space-around stretch\" fxFlex>\n      <div fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n        <div fxLayout=\"column\" fxLayoutAlign=\"start center\">\n          <div class=\"tcs-case-card-customization-section-text\">Preview</div>\n        </div>\n        <div class=\"tcs-case-card-customization-preview\" fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n          <div *ngIf=\"selectedStateConfig && caseTypeColor && caseTypeIcon\" style=\"border-radius: 3px; margin: 5px;\" fxLayout=\"column\" fxLayoutAlign=\"space-around center\">\n            <tcla-live-apps-case-summary style=\"margin: 5px;\" [displayType]=\"'card'\" [typeBar]=\"true\" [configMode]=\"true\" [configModeColor]=\"caseCardConfig.cardConfig.useCaseTypeColor ? caseTypeColor : selectedStateConfig.fill\" [configModeIcon]=\"selectedStateConfig.icon\" [configModeCaseTypeColor]=\"caseTypeColor\" [configModeCaseTypeIcon]=\"caseTypeIcon\" [configModeAppTypeLabel]=\"appTypeLabel\"></tcla-live-apps-case-summary>\n            <tcla-live-apps-case-summary style=\"margin: 5px;\" [displayType]=\"'miniCard'\" [typeBar]=\"true\" [configMode]=\"true\" [configModeColor]=\"caseCardConfig.cardConfig.useCaseTypeColor ? caseTypeColor : selectedStateConfig.fill\" [configModeIcon]=\"selectedStateConfig.icon\" [configModeCaseTypeColor]=\"caseTypeColor\" [configModeCaseTypeIcon]=\"caseTypeIcon\" [configModeAppTypeLabel]=\"appTypeLabel\"></tcla-live-apps-case-summary>\n          </div>\n        </div>\n      </div>\n      <div class=\"tcs-case-card-customization-divider\"></div>\n      <div fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n        <div fxLayout=\"column\" fxLayoutAlign=\"start center\">\n          <div class=\"tcs-case-card-customization-section-text\">Configure Icons</div>\n        </div>\n        <div fxFlex>\n          <div fxFlex class=\"tcs-case-states-list\" *ngIf=\"caseCardConfig && caseCardConfig.cardConfig && caseCardConfig.states\" fxLayout=\"column\" fxLayoutAlign=\"start center\">\n            <div class=\"tcs-case-states-list-inner\">\n              <div class=\"case-type-color-toggle\">\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                  <mat-slide-toggle\n                  class=\"use-case-type-color\"\n                  [labelPosition]=\"'before'\"\n                  [checked]=\"caseCardConfig.cardConfig.useCaseTypeColor\"\n                  (change)=\"handleCaseTypeColorToggleChange($event)\">\n                  Use Case Type Color for color bar\n                  </mat-slide-toggle>\n                </div>\n              </div>\n              <div class=\"tcs-case-states-list-row\">\n                  <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <div fxLayoutAlign=\"start center\" style=\"min-width: 170px;\">Case Type Icon</div>\n                    <tcla-live-apps-state-icon style=\"margin-left: 10px; margin-right: 10px; min-width: 14px;\" #iconcomp [id]=\"appTypeLabel\" [iconPath]=\"selectedCaseTypeConfig.icon\" [color]=\"selectedCaseTypeConfig.fill\"\n                                               [appId]=\"appId\" [(colorPicker)]=\"selectedCaseTypeConfig.fill\" (colorPickerChange)=\"setCaseTypeFill($event, selectedCaseTypeConfig)\" [cpPresetColors]=\"DEFAULT_COLOR_PALETTE\" [cpPositionOffset]=\"'-40%'\"\n                                              matTooltip=\"Click to change color\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </tcla-live-apps-state-icon>\n                    <mat-icon (click)=\"openDialog(null, true)\" class=\"tcs-icon tcs-icon-active tcs-config-button tcs-document-upload-button\" svgIcon=\"tcs-document-upload\"\n                              matTooltip=\"Click to upload new icon\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </mat-icon>\n                    <mat-icon class=\"tcs-icon tcs-icon-active tcs-config-button-placeholder\"></mat-icon>\n                  </div>\n              </div>\n              <div class=\"tcs-case-states-icon-divider\"></div>\n              <!-- case state icons -->\n              <div *ngFor=\"let state of caseCardConfig.states\" class=\"tcs-case-states-list-row\" (click)=\"selectState(state)\">\n                <div *ngIf=\"getConfigForState(state); let stateConfig;\">\n                  <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <div fxLayoutAlign=\"start center\" style=\"min-width: 170px;\">{{state.label | ellipsis: 25}}</div>\n                    <tcla-live-apps-state-icon style=\"margin-left: 10px; margin-right: 10px; min-width: 14px;\" #iconcomp [id]=\"state.value\" [iconPath]=\"stateConfig.icon\" [color]=\"stateConfig.fill\"\n                                               [appId]=\"appId\" [(colorPicker)]=\"stateConfig.fill\" (colorPickerChange)=\"setFill($event, stateConfig)\" [cpPresetColors]=\"DEFAULT_COLOR_PALETTE\" [cpPositionOffset]=\"'-40%'\"\n                                              matTooltip=\"Click to change color\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </tcla-live-apps-state-icon>\n                    <mat-icon (click)=\"openDialog(state, false)\" class=\"tcs-icon tcs-icon-active tcs-config-button tcs-document-upload-button\" svgIcon=\"tcs-document-upload\"\n                              matTooltip=\"Click to upload new icon\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </mat-icon>\n                    <mat-icon class=\"tcs-icon tcs-icon-active tcs-config-button-placeholder\"></mat-icon>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  <!--div class=\"tcs-case-card-customization-footer\" fxLayout=\"column\" fxLayoutAlign=\"end stretch\">\n    <div class=\"tcs-case-card-customization-action-buttons\" fxLayout=\"row\" fxLayoutAlign=\"center center\">\n      <button class=\"tcs-save-app-config-button\" mat-button (click)=\"saveConfig()\" type=\"submit\">Save Configuration</button>\n    </div>\n  </div-->\n</div>\n",
                styles: [".tcs-case-card-customization{min-width:775px;min-height:370px;background-color:#fff}.tcs-case-card-customization *{font-family:Source Sans Pro;font-size:12px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;text-align:center;color:#000}.case-type-color-toggle{margin-bottom:10px;margin-top:10px}.tcs-case-card-customization-header{height:40px;border-radius:3px 3px 0 0;box-shadow:0 1px 2px 0 #dedede;padding-left:20px;padding-right:20px}.tcs-case-card-customization .tcs-case-card-customization-header-text{font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:1.5;letter-spacing:.3px;text-align:left;color:#000;margin-left:10px}.tcs-case-card-customization-action-buttons{margin-top:10px;margin-bottom:10px}.tcs-case-card-customization-divider{padding:0;margin:4px 5px 0;border-left:1.1px solid #f4f4f4}.tcs-case-card-customization .tcs-case-card-customization-section-text{font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;color:#000}.tcs-case-states-list{margin:5px}.tcs-case-card-customization-preview app-live-apps-case-summary,.tcs-case-states-list-inner{overflow-y:auto}.tcs-case-states-list-row{border-radius:3px;padding:3px;margin-left:15px;margin-right:15px}.tcs-case-states-list-row:hover{-webkit-transition:background-color .5s;transition:background-color .5s;background-color:#eef0f7}.tcs-icon-active.tcs-config-button{display:none}.tcs-icon-active.tcs-config-button-placeholder{display:inline-block;width:24px}.tcs-case-states-list-row:hover .tcs-icon-active.tcs-config-button{display:inline-block}.tcs-case-states-list-row:hover .tcs-icon-active.tcs-config-button-placeholder{display:none}.tcs-case-states-icon-divider{padding:0;margin:2px 15px 4px 10px;border-bottom:1.1px solid #f4f4f4}.tcs-save-app-config-button{height:35px}"]
            }] }
];
/** @nocollapse */
LiveAppsApplicationConfigurationComponent.ctorParameters = () => [
    { type: HttpClient },
    { type: DomSanitizer },
    { type: LiveAppsService },
    { type: TcCaseCardConfigService },
    { type: TcDocumentService },
    { type: MatDialog },
    { type: Location }
];
LiveAppsApplicationConfigurationComponent.propDecorators = {
    stateIconComponents: [{ type: ViewChildren, args: ['iconcomp',] }],
    caseSummaryComponent: [{ type: ViewChildren, args: [LiveAppsCaseSummaryComponent,] }],
    appId: [{ type: Input }],
    appTypeLabel: [{ type: Input }],
    sandboxId: [{ type: Input }],
    uiAppId: [{ type: Input }],
    folderId: [{ type: Input }],
    configChanged: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.stateIconComponents;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseSummaryComponent;
    /**
     * The LA Application Id
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.appId;
    /**
     * The label shown above the case type in the configuration widget
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.appTypeLabel;
    /**
     * sandboxId - this comes from claims resolver
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.sandboxId;
    /**
     * The Application ID of the UI (should ideally be unique as it is shared state key)
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.uiAppId;
    /**
     * The organisation folder to store/retrieve documents
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.folderId;
    /**
     * ~event configChanged : Configuration values changed
     * ~payload CaseCardConfig : CaseCardConfig object when configuration is changed (so called can do a save with data)
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.configChanged;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.errorMessage;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseCardConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectedStateConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectedCaseTypeConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseTypeIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseTypeColor;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_TYPE_ICON;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_TYPE_COLOR;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_STATE_ICON;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_STATE_COLOR;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_COLOR_PALETTE;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.getConfigForState;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.getConfigForCaseType;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.updateIconMap;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.handleCaseTypeColorToggleChange;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setFill;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setCaseTypeFill;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectState;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setNewStateIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setNewCaseTypeIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.refresh;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsApplicationConfigurationComponent.prototype.http;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsApplicationConfigurationComponent.prototype.sanitizer;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsApplicationConfigurationComponent.prototype.liveapps;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseCardConfigService;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsApplicationConfigurationComponent.prototype.documentsService;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.dialog;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsApplicationConfigurationComponent.prototype.location;
}
export class LiveAppsStateIconUploadDialogComponent {
    /**
     * @param {?} dialogRef
     * @param {?} data
     */
    constructor(dialogRef, data) {
        this.dialogRef = dialogRef;
        this.data = data;
        this.fileevent = new EventEmitter();
        this.fileToUpload = undefined;
        this.description = undefined;
        this.uploadFile = (/**
         * @return {?}
         */
        () => {
            if (this.fileToUpload) {
                this.fileevent.emit({ file: this.fileToUpload, state: this.data.state, isCaseType: this.data.isCaseType });
                this.dialogRef.close();
            }
        });
    }
    /**
     * @param {?} description
     * @return {?}
     */
    setFileDescription(description) {
        this.description = description;
    }
    /**
     * @param {?} files
     * @return {?}
     */
    attachFile(files) {
        this.fileToUpload = files.item(0);
        /*const myReader: FileReader = new FileReader();
        myReader.readAsText(this.fileToUpload);
        this.fileText = myReader.result.toString();*/
    }
    /**
     * @return {?}
     */
    onNoClick() {
        this.dialogRef.close();
    }
}
LiveAppsStateIconUploadDialogComponent.decorators = [
    { type: Component, args: [{
                selector: 'tcla-live-apps-state-icon-upload-dialog',
                template: "  <h1 mat-dialog-title>Upload New Icon (svg) for '{{data.state.value}}'</h1>\n  <div mat-dialog-content class=\"tcs-state-icon-upload-dialog\">\n    <form #fileUploadForm=\"ngForm\" fxFlex fxLayout=\"column\">\n      <div fxLayout=\"row\" fxLayoutAlign=\"start space-between\">\n        <button type=\"button\" mat-raised-button (click)=\"fileInput.click()\">Choose File To Upload</button>\n        <div *ngIf=\"fileToUpload\">{{fileToUpload.name}}</div>\n        <!-- below input is hidden and enabled by above button -->\n        <input class=\"tcs-hidden-input\" (change)=\"attachFile($event.target.files)\" accept=\"image/svg+xml\" #fileInput type=\"file\" id=\"file\">\n      </div>\n    </form>\n  </div>\n  <div mat-dialog-actions>\n    <button mat-button (click)=\"uploadFile()\" type=\"submit\" [disabled]=\"!fileToUpload\">Upload</button>\n    <button mat-button (click)=\"onNoClick()\">Cancel</button>\n  </div>\n",
                styles: [".tcs-hidden-input{display:none}"]
            }] }
];
/** @nocollapse */
LiveAppsStateIconUploadDialogComponent.ctorParameters = () => [
    { type: MatDialogRef },
    { type: undefined, decorators: [{ type: Inject, args: [MAT_DIALOG_DATA,] }] }
];
LiveAppsStateIconUploadDialogComponent.propDecorators = {
    fileevent: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileevent;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileToUpload;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.description;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileText;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.uploadFile;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.dialogRef;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.data;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHRpYmNvLXRjc3RrL3RjLWxpdmVhcHBzLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2xpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uL2xpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQWNBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsWUFBWSxFQUNaLE1BQU0sRUFDTixLQUFLLEVBSUwsTUFBTSxFQUNOLFNBQVMsRUFFVCxZQUFZLEVBQ2IsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFDLGVBQWUsRUFBQyxNQUFNLGtDQUFrQyxDQUFDO0FBQ2pFLE9BQU8sRUFBYSxhQUFhLEVBQUUsT0FBTyxFQUFDLE1BQU0sMkJBQTJCLENBQUM7QUFDN0UsT0FBTyxFQUFNLElBQUksRUFBRSxTQUFTLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUNwRCxPQUFPLEVBQUMsVUFBVSxFQUFjLE1BQU0sc0JBQXNCLENBQUM7QUFDN0QsT0FBTyxFQUFDLFlBQVksRUFBVyxNQUFNLDJCQUEyQixDQUFDO0FBR2pFLE9BQU8sRUFBQyw0QkFBNEIsRUFBQyxNQUFNLDREQUE0RCxDQUFDO0FBQ3hHLE9BQU8sRUFBQyxlQUFlLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBQyxNQUFNLG1CQUFtQixDQUFDO0FBRTNFLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUMzQyxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSxzREFBc0QsQ0FBQztBQUV2RixPQUFPLEVBQUMsY0FBYyxFQUFFLG1CQUFtQixFQUFFLGtCQUFrQixFQUFFLHVCQUF1QixFQUFDLE1BQU0sNENBQTRDLENBQUM7QUFDNUksT0FBTyxFQUFD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QUksQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLENBQUM7YUFDeEI7UUFDSCxDQUFDLEVBQUE7SUFQcUgsQ0FBQzs7Ozs7SUFTdkgsa0JBQWtCLENBQUMsV0FBbUI7UUFDcEMsSUFBSSxDQUFDLFdBQVcsR0FBRyxXQUFXLENBQUM7SUFDakMsQ0FBQzs7Ozs7SUFFRCxVQUFVLENBQUMsS0FBZTtRQUN4QixJQUFJLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEM7O3FEQUU2QztJQUMvQyxDQUFDOzs7O0lBRUQsU0FBUztRQUNQLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDekIsQ0FBQzs7O1lBbENGLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUseUNBQXlDO2dCQUNuRCx3NkJBQTZFOzthQUU5RTs7OztZQTlRbUMsWUFBWTs0Q0FzUjZCLE1BQU0sU0FBQyxlQUFlOzs7d0JBTmhHLE1BQU07Ozs7SUFBUCwyREFBOEM7O0lBQzlDLDhEQUFzQzs7SUFDdEMsNkRBQXVDOztJQUN2QywwREFBd0I7O0lBS3hCLDREQUtDOztJQVBDLDJEQUFzRTs7SUFBRSxzREFBeUMiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8qXG4qICAgICBDYXNlIFR5cGUgaWNvbnMgYXJlIHN0b3JlZCBpbiBhbiBvcmdGb2xkZXIgc3BlY2lmaWVkIGluIGxpdmVBcHBzQ29uZmlnLmpzb24gKHB1c2hlZCB0byBzaGFyZWQgc3RhdGUpXG4qICAgICBJY29uIE5hbWUgd2lsbCBiZSBhcHBJZC5maWxlbmFtZS5zdmdcbiogICAgIEljb24gc3ZnIHNob3VsZCBjb250YWluIDxEWU5BTUlDRklMTD4gdGhpcyB3aWxsIGJlIHNldCBhY2NvcmRpbmcgdG8gdGhlIGNvbG9yIHNlbGVjdGVkIGluIHRoaXMgY29tcG9uZW50XG4qXG4qICAgICBlZzogMTc0Mi5pYy1jcmVhdGVkLnN2ZyBmb3IgUGFydG5lciBQb3J0YWwgTGl2ZSBBcHBzIEFwcCAoYXBwSWQ6IDE3NDIpICdDcmVhdGVkJyBzdGF0ZVxuKlxuKiAgICAgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxNFwiIGhlaWdodD1cIjE0XCIgdmlld0JveD1cIjAgMCAxNCAxNFwiPlxuKiAgICAgICAgPHBhdGggZmlsbD1cIjxEWU5BTUlDRklMTD5cIiBjbGFzcz1cInN2Zy1jb250ZW50XCIgZmlsbC1ydWxlPVwiZXZlbm9kZFwiIGQ9XCJNNyAxNEE3IDcgMCAxIDEgNyAwYTcgNyAwIDAgMSAwIDE0em0zLjQ3NC02LjQ3MmEuNTI3LjUyNyAwIDAgMCAwLTEuMDUzSDcuNTI2VjMuNTI3YS41MjUuNTI1IDAgMSAwLTEuMDUyIDB2Mi45NDhIMy41MjZhLjUyNy41MjcgMCAwIDAgMCAxLjA1M2gyLjk0OHYyLjk0OGEuNTI1LjUyNSAwIDAgMCAuODk4LjM3My41MjUuNTI1IDAgMCAwIC4xNTQtLjM3M1Y3LjUyOGgyLjk0OHpcIi8+XG4qICAgICAgPC9zdmc+XG4qXG4qXG4gKi9cbmltcG9ydCB7XG4gIENvbXBvbmVudCxcbiAgRXZlbnRFbWl0dGVyLFxuICBJbmplY3QsXG4gIElucHV0LFxuICBPbkNoYW5nZXMsXG4gIE9uRGVzdHJveSxcbiAgT25Jbml0LFxuICBPdXRwdXQsXG4gIFF1ZXJ5TGlzdCwgU2ltcGxlQ2hhbmdlcyxcbiAgVmlld0NoaWxkLFxuICBWaWV3Q2hpbGRyZW5cbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge09ic2VydmFibGUsIG9mLCBTdWJqZWN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7TGl2ZUFwcHNTZXJ2aWNlfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9saXZlLWFwcHMuc2VydmljZSc7XG5pbXBvcnQge0NhcmRDb25maWcsIENhc2VUeXBlU3RhdGUsIEljb25NYXB9IGZyb20gJy4uLy4uL21vZGVscy9saXZlYXBwc2RhdGEnO1xuaW1wb3J0IHttYXAsIHRha2UsIHRha2VVbnRpbH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHtIdHRwQ2xpZW50LCBIdHRwSGVhZGVyc30gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHtEb21TYW5pdGl6ZXIsIFNhZmVIdG1sfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcbmltcG9ydCB7TGl2ZUFwcHNDYXNlRGF0YUNvbXBvbmVudH0gZnJvbSAnLi4vbGl2ZS1hcHBzLWNhc2UtZGF0YS9saXZlLWFwcHMtY2FzZS1kYXRhLmNvbXBvbmVudCc7XG5pbXBvcnQge0xpdmVBcHBzU3RhdGVJY29uQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtc3RhdGUtaWNvbi9saXZlLWFwcHMtc3RhdGUtaWNvbi5jb21wb25lbnQnO1xuaW1wb3J0IHtMaXZlQXBwc0Nhc2VTdW1tYXJ5Q29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtY2FzZS1zdW1tYXJ5L2xpdmUtYXBwcy1jYXNlLXN1bW1hcnkuY29tcG9uZW50JztcbmltcG9ydCB7TUFUX0RJQUxPR19EQVRBLCBNYXREaWFsb2csIE1hdERpYWxvZ1JlZn0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwnO1xuaW1wb3J0IHtMaXZlQXBwc0RvY3VtZW50VXBsb2FkRGlhbG9nQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtZG9jdW1lbnRzL2xpdmUtYXBwcy1kb2N1bWVudHMuY29tcG9uZW50JztcbmltcG9ydCB7IExvY2F0aW9uIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7TGl2ZUFwcHNDb21wb25lbnR9IGZyb20gJy4uL2xpdmUtYXBwcy1jb21wb25lbnQvbGl2ZS1hcHBzLWNvbXBvbmVudC5jb21wb25lbnQnO1xuaW1wb3J0IHtDYXNlQ2FyZENvbmZpZ30gZnJvbSAnLi4vLi4vbW9kZWxzL3RjLWNhc2UtY2FyZC1jb25maWcnO1xuaW1wb3J0IHtERUZBVUxUX0NPTE9SUywgREVGQVVMVF9TVEFURV9DT0xPUiwgREVGQVVMVF9UWVBFX0NPTE9SLCBUY0Nhc2VDYXJkQ29uZmlnU2VydmljZX0gZnJvbSAnLi4vLi4vc2VydmljZXMvdGMtY2FzZS1jYXJkLWNvbmZpZy5zZXJ2aWNlJztcbmltcG9ydCB7VGNEb2N1bWVudFNlcnZpY2V9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3RjLWRvY3VtZW50LnNlcnZpY2UnO1xuXG5cblxuLyoqXG4gKiBNYW5hZ2VzIHN1bW1hcnkgY2FyZCBjb25maWd1cmF0aW9uXG4gKlxuICpAZXhhbXBsZSA8dGNsYS1saXZlLWFwcHMtYXBwbGljYXRpb24tY29uZmlndXJhdGlvbj48L3RjbGEtbGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24+XG4gKi9cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGNsYS1saXZlLWFwcHMtYXBwbGljYXRpb24tY29uZmlndXJhdGlvbicsXG4gIHRlbXBsYXRlVXJsOiAnLi9saXZlLWFwcHMtYXBwbGljYXRpb24tY29uZmlndXJhdGlvbi5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2xpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uLmNvbXBvbmVudC5jc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBMaXZlQXBwc0FwcGxpY2F0aW9uQ29uZmlndXJhdGlvbkNvbXBvbmVudCBleHRlbmRzIExpdmVBcHBzQ29tcG9uZW50IGltcGxlbWVudHMgT25DaGFuZ2VzIHtcbiAgLy8gVGhlIFZpZXdDaGlsZCBkZWNsYXJhdGlvbnMgZ2l2ZSBhY2Nlc3MgdG8gY29tcG9uZW50cyBtYXJrZWQgb24gdGhlIHRlbXBsYXRlIHNvIHRoYXQgSSBjYW4gY2FsbCBwdWJsaWMgZnVuY3Rpb25zIGxpa2UgcmVmcmVzaFxuICBAVmlld0NoaWxkcmVuKCdpY29uY29tcCcpIHN0YXRlSWNvbkNvbXBvbmVudHM6IFF1ZXJ5TGlzdDxMaXZlQXBwc1N0YXRlSWNvbkNvbXBvbmVudD47XG4gIEBWaWV3Q2hpbGRyZW4oTGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudCkgY2FzZVN1bW1hcnlDb21wb25lbnQ6IFF1ZXJ5TGlzdDxMaXZlQXBwc0Nhc2VTdW1tYXJ5Q29tcG9uZW50PjtcblxuICAvKipcbiAgICogVGhlIExBIEFwcGxpY2F0aW9uIElkXG4gICAqL1xuICBASW5wdXQoKSBhcHBJZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgbGFiZWwgc2hvd24gYWJvdmUgdGhlIGNhc2UgdHlwZSBpbiB0aGUgY29uZmlndXJhdGlvbiB3aWRnZXRcbiAgICovXG4gIEBJbnB1dCgpIGFwcFR5cGVMYWJlbDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBzYW5kYm94SWQgLSB0aGlzIGNvbWVzIGZyb20gY2xhaW1zIHJlc29sdmVyXG4gICAqL1xuICBASW5wdXQoKSBzYW5kYm94SWQ6IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIEFwcGxpY2F0aW9uIElEIG9mIHRoZSBVSSAoc2hvdWxkIGlkZWFsbHkgYmUgdW5pcXVlIGFzIGl0IGlzIHNoYXJlZCBzdGF0ZSBrZXkpXG4gICAqL1xuICBASW5wdXQoKSB1aUFwcElkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBvcmdhbmlzYXRpb24gZm9sZGVyIHRvIHN0b3JlL3JldHJpZXZlIGRvY3VtZW50c1xuICAgKi9cbiAgQElucHV0KCkgZm9sZGVySWQ6IHN0cmluZztcblxuICAvKipcbiAgICogfmV2ZW50IGNvbmZpZ0NoYW5nZWQgOiBDb25maWd1cmF0aW9uIHZhbHVlcyBjaGFuZ2VkXG4gICAqIH5wYXlsb2FkIENhc2VDYXJkQ29uZmlnIDogQ2FzZUNhcmRDb25maWcgb2JqZWN0IHdoZW4gY29uZmlndXJhdGlvbiBpcyBjaGFuZ2VkIChzbyBjYWxsZWQgY2FuIGRvIGEgc2F2ZSB3aXRoIGRhdGEpXG4gICAqL1xuICBAT3V0cHV0KCkgY29uZmlnQ2hhbmdlZDogRXZlbnRFbWl0dGVyPENhc2VDYXJkQ29uZmlnPiA9IG5ldyBFdmVudEVtaXR0ZXI8Q2FzZUNhcmRDb25maWc+KCk7XG5cbiAgcHVibGljIGVycm9yTWVzc2FnZTogc3RyaW5nO1xuICBwdWJsaWMgY2FzZUNhcmRDb25maWc6IENhc2VDYXJkQ29uZmlnO1xuICBwdWJsaWMgc2VsZWN0ZWRTdGF0ZUNvbmZpZzogSWNvbk1hcDtcbiAgcHVibGljIHNlbGVjdGVkQ2FzZVR5cGVDb25maWc6IEljb25NYXA7XG4gIHB1YmxpYyBjYXNlVHlwZUljb246IHN0cmluZztcbiAgcHVibGljIGNhc2VUeXBlQ29sb3I6IHN0cmluZztcblxuICAvLyBwcmVwYXJlRXh0ZXJuYWxVcmwgd2lsbCBhZGQgdGhlIGJhc2UgaHJlZlxuICBwdWJsaWMgREVGQVVMVF9DQVNFX1RZUEVfSUNPTiA9ICdhc3NldHMvaWNvbnMvaWMtZ2VuZXJpYy1jYXNldHlwZS5zdmcnO1xuICBwdWJsaWMgREVGQVVMVF9DQVNFX1RZUEVfQ09MT1IgPSBERUZBVUxUX1RZUEVfQ09MT1I7XG4gIHB1YmxpYyBERUZBVUxUX0NBU0VfU1RBVEVfSUNPTiA9ICdhc3NldHMvaWNvbnMvaWMtZ2VuZXJpYy1zdGF0ZS5zdmcnO1xuICBwdWJsaWMgREVGQVVMVF9DQVNFX1NUQVRFX0NPTE9SID0gREVGQVVMVF9TVEFURV9DT0xPUjtcbiAgcHVibGljIERFRkFVTFRfQ09MT1JfUEFMRVRURSA9IERFRkFVTFRfQ09MT1JTO1xuXG4gIHB1YmxpYyBnZXRDb25maWdGb3JTdGF0ZSA9IChzdGF0ZTogQ2FzZVR5cGVTdGF0ZSk6IEljb25NYXAgPT4ge1xuICAgIGxldCByZXFJY29uTWFwOiBJY29uTWFwO1xuICAgIGlmICh0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcgJiYgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwKSB7XG4gICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXAuZm9yRWFjaCgoc3RhdGVNYXApID0+IHtcbiAgICAgICAgaWYgKHN0YXRlTWFwLnN0YXRlID09PSBzdGF0ZS52YWx1ZSkge1xuICAgICAgICAgIHJlcUljb25NYXAgPSBzdGF0ZU1hcDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiByZXFJY29uTWFwID8gcmVxSWNvbk1hcCA6IG5ldyBJY29uTWFwKGZhbHNlLCBzdGF0ZS52YWx1ZSwgdGhpcy5ERUZBVUxUX0NBU0VfU1RBVEVfQ09MT1IsIHRoaXMuREVGQVVMVF9DQVNFX1NUQVRFX0lDT04pO1xuICB9XG5cbiAgcHVibGljIGdldENvbmZpZ0ZvckNhc2VUeXBlID0gKGNhc2VUeXBlSWQ6IHN0cmluZyk6IEljb25NYXAgPT4ge1xuICAgIGxldCByZXFJY29uTWFwOiBJY29uTWFwO1xuICAgIGlmICh0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcgJiYgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwKSB7XG4gICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXAuZm9yRWFjaCgoc3RhdGVNYXApID0+IHtcbiAgICAgICAgaWYgKHN0YXRlTWFwLmlzQ2FzZVR5cGUpIHtcbiAgICAgICAgICByZXFJY29uTWFwID0gc3RhdGVNYXA7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVxSWNvbk1hcCA/IHJlcUljb25NYXAgOiBuZXcgSWNvbk1hcCh0cnVlLCBjYXNlVHlwZUlkLCB0aGlzLkRFRkFVTFRfQ0FTRV9UWVBFX0NPTE9SLCB0aGlzLkRFRkFVTFRfQ0FTRV9UWVBFX0lDT04pO1xuICB9XG5cbiAgcHVibGljIHVwZGF0ZUljb25NYXAgPSAoc3RhdGVDb25maWc6IEljb25NYXApID0+IHtcbiAgICBsZXQgZm91bmRNYXA6IEljb25NYXA7XG4gICAgbGV0IHVwZGF0ZWRNYXA6IEljb25NYXA7XG4gICAgaWYgKHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZyAmJiB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXApIHtcbiAgICAgIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcC5mb3JFYWNoKGZ1bmN0aW9uKHN0YXRlTWFwKSB7XG4gICAgICAgIGlmIChzdGF0ZU1hcC5zdGF0ZSA9PT0gc3RhdGVDb25maWcuc3RhdGUpIHtcbiAgICAgICAgICBmb3VuZE1hcCA9IHN0YXRlQ29uZmlnO1xuICAgICAgICAgIHN0YXRlTWFwLnN0YXRlID0gc3RhdGVDb25maWcuc3RhdGU7XG4gICAgICAgICAgc3RhdGVNYXAuaWNvbiA9IHN0YXRlQ29uZmlnLmljb247XG4gICAgICAgICAgc3RhdGVNYXAuZmlsbCA9IHN0YXRlQ29uZmlnLmZpbGw7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYgKGZvdW5kTWFwKSB7XG4gICAgICAgIGZvdW5kTWFwID0gc3RhdGVDb25maWc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXAucHVzaChzdGF0ZUNvbmZpZyk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcCA9IFtdO1xuICAgICAgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwLnB1c2goc3RhdGVDb25maWcpO1xuICAgIH1cbiAgICB0aGlzLmNvbmZpZ0NoYW5nZWQuZW1pdCh0aGlzLmNhc2VDYXJkQ29uZmlnKTtcbiAgfVxuXG4gIHB1YmxpYyBoYW5kbGVDYXNlVHlwZUNvbG9yVG9nZ2xlQ2hhbmdlID0gKGNoYW5nZXMpID0+IHtcbiAgICB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcudXNlQ2FzZVR5cGVDb2xvciA9IGNoYW5nZXMuY2hlY2tlZCA/IGNoYW5nZXMuY2hlY2tlZCA6IGZhbHNlO1xuICAgIGlmIChjaGFuZ2VzLmNoZWNrZWQpIHtcbiAgICAgIHRoaXMuY2FzZVN1bW1hcnlDb21wb25lbnQuZm9yRWFjaCgoY29tcDogTGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudCkgPT4ge1xuICAgICAgICBjb21wLnJlc3R5bGVQcmV2aWV3KHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5pY29uLCB0aGlzLmNhc2VUeXBlQ29sb3IpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIHRoaXMuY29uZmlnQ2hhbmdlZC5lbWl0KHRoaXMuY2FzZUNhcmRDb25maWcpO1xuICB9XG5cbiAgcHVibGljIHNldEZpbGwgPSAoZmlsbCwgc3RhdGVDb25maWc6IEljb25NYXApID0+IHtcbiAgICB0aGlzLmNhc2VTdW1tYXJ5Q29tcG9uZW50LmZvckVhY2goKGNvbXA6IExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQpID0+IHtcbiAgICAgIGNvbXAucmVzdHlsZVByZXZpZXcoc3RhdGVDb25maWcuaWNvbiwgZmlsbCk7XG4gICAgfSk7XG4gICAgdGhpcy5zdGF0ZUljb25Db21wb25lbnRzLmZpbmQoZnVuY3Rpb24oY29tcCkge1xuICAgICAgcmV0dXJuIGNvbXAuaWQgPT09IHN0YXRlQ29uZmlnLnN0YXRlO1xuICAgIH0pLnJlZmlsbFNWRyhmaWxsKTtcbiAgICB0aGlzLmNvbmZpZ0NoYW5nZWQuZW1pdCh0aGlzLmNhc2VDYXJkQ29uZmlnKTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRDYXNlVHlwZUZpbGwgPSAoZmlsbCwgc3RhdGVDb25maWc6IEljb25NYXApID0+IHtcbiAgICB0aGlzLmNhc2VTdW1tYXJ5Q29tcG9uZW50LmZvckVhY2goKGNvbXA6IExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQpID0+IHtcbiAgICAgIGNvbXAucmVzdHlsZVByZXZpZXdDYXNlVHlwZShzdGF0ZUNvbmZpZy5pY29uLCBmaWxsKTtcbiAgICB9KTtcbiAgICB0aGlzLnN0YXRlSWNvbkNvbXBvbmVudHMuZmluZChmdW5jdGlvbihjb21wKSB7XG4gICAgICByZXR1cm4gKGNvbXAuaWQgPT09IHN0YXRlQ29uZmlnLnN0YXRlICYmIHN0YXRlQ29uZmlnLmlzQ2FzZVR5cGUpO1xuICAgIH0pLnJlZmlsbFNWRyhmaWxsKTtcbiAgICB0aGlzLmNvbmZpZ0NoYW5nZWQuZW1pdCh0aGlzLmNhc2VDYXJkQ29uZmlnKTtcbiAgfVxuXG4gIHB1YmxpYyBzZWxlY3RTdGF0ZSA9IChzdGF0ZTogQ2FzZVR5cGVTdGF0ZSkgPT4ge1xuICAgIHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZyA9IHRoaXMuZ2V0Q29uZmlnRm9yU3RhdGUoc3RhdGUpO1xuICAgIGlmICghdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnVzZUNhc2VUeXBlQ29sb3IpIHtcbiAgICAgIHRoaXMuY2FzZVN1bW1hcnlDb21wb25lbnQuZm9yRWFjaCgoY29tcDogTGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudCkgPT4ge1xuICAgICAgICBjb21wLnJlc3R5bGVQcmV2aWV3KHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5pY29uLCB0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuZmlsbCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICAvKnB1YmxpYyBzYXZlQ29uZmlnID0gKCkgPT4ge1xuICAgIHRoaXMuY2FzZUNhcmRDb25maWdTZXJ2aWNlLnVwZGF0ZUNhc2VDYXJkQ29uZmlnKHRoaXMuc2FuZGJveElkLCB0aGlzLmFwcElkLCB0aGlzLnVpQXBwSWQsIHRoaXMuY2FzZUNhcmRDb25maWcpXG4gICAgICAucGlwZShcbiAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3llZCQpLFxuICAgICAgICBtYXAoY2FzZUNhcmRDb25maWcgPT4ge1xuICAgICAgICAgIHRoaXMuY2FzZUNhcmRDb25maWcgPSBjYXNlQ2FyZENvbmZpZztcbiAgICAgICAgfSlcbiAgICAgICkuc3Vic2NyaWJlKG51bGwsIGVycm9yID0+IHsgY29uc29sZS5sb2coJ1VuYWJsZSB0byB1cGRhdGUgY2FzZSBjYXJkIGNvbmZpZzogJyArIGVycm9yLmVycm9yTXNnKTsgfVxuICAgICk7XG4gIH0qL1xuXG4gIHB1YmxpYyBvcGVuRGlhbG9nKHN0YXRlOiBDYXNlVHlwZVN0YXRlLCBpc0Nhc2VUeXBlOiBib29sZWFuKTogdm9pZCB7XG5cbiAgICBpZiAoIWlzQ2FzZVR5cGUpIHtcbiAgICAgIHRoaXMuc2VsZWN0U3RhdGUoc3RhdGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzdGF0ZSA9IG5ldyBDYXNlVHlwZVN0YXRlKCkuZGVzZXJpYWxpemUoeyB2YWx1ZTogdGhpcy5hcHBUeXBlTGFiZWwgfSk7XG4gICAgfVxuICAgIGNvbnN0IGRpYWxvZ1JlZiA9IHRoaXMuZGlhbG9nLm9wZW4oTGl2ZUFwcHNTdGF0ZUljb25VcGxvYWREaWFsb2dDb21wb25lbnQsIHtcbiAgICAgIHdpZHRoOiAnNTAwcHgnLFxuICAgICAgZGF0YTogeyBzdGF0ZTogc3RhdGUsIGlzQ2FzZVR5cGU6IGlzQ2FzZVR5cGUgfVxuICAgIH0pO1xuXG4gICAgZGlhbG9nUmVmLmNvbXBvbmVudEluc3RhbmNlLmZpbGVldmVudC5zdWJzY3JpYmUoKCRlKSA9PiB7XG4gICAgICB0aGlzLnVwbG9hZEZpbGUoJGUuZmlsZSwgJGUuc3RhdGUsICRlLmlzQ2FzZVR5cGUpO1xuICAgIH0pXG5cbiAgICBkaWFsb2dSZWYuYWZ0ZXJDbG9zZWQoKS5zdWJzY3JpYmUocmVzdWx0ID0+IHtcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBzZXROZXdTdGF0ZUljb24gPSAodXJsKSA9PiB7XG4gICAgdGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLmljb24gPSB1cmw7XG4gICAgdGhpcy5zdGF0ZUljb25Db21wb25lbnRzLmZpbmQoKGNvbXA6IExpdmVBcHBzU3RhdGVJY29uQ29tcG9uZW50KSA9PiB7XG4gICAgICByZXR1cm4gKGNvbXAuaWQgPT09IHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5zdGF0ZSk7XG4gICAgfSkucmVmcmVzaCh0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuaWNvbiwgdGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLmZpbGwpO1xuICAgIHRoaXMuY2FzZVN1bW1hcnlDb21wb25lbnQuZm9yRWFjaCgoY29tcDogTGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudCkgPT4ge1xuICAgICAgY29tcC5yZXN0eWxlUHJldmlldyh0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuaWNvbiwgdGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLmZpbGwpO1xuICAgIH0pO1xuICAgIHRoaXMudXBkYXRlSWNvbk1hcCh0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcpO1xuICB9XG5cbiAgcHVibGljIHNldE5ld0Nhc2VUeXBlSWNvbiA9ICh1cmwpID0+IHtcbiAgICB0aGlzLmNhc2VUeXBlSWNvbiA9IHVybDtcbiAgICB0aGlzLnN0YXRlSWNvbkNvbXBvbmVudHMuZmluZCgoY29tcDogTGl2ZUFwcHNTdGF0ZUljb25Db21wb25lbnQpID0+IHtcbiAgICAgIHJldHVybiAoY29tcC5pZCA9PT0gdGhpcy5hcHBUeXBlTGFiZWwpO1xuICAgIH0pLnJlZnJlc2godGhpcy5jYXNlVHlwZUljb24sIHRoaXMuY2FzZVR5cGVDb2xvcik7XG4gICAgdGhpcy5jYXNlU3VtbWFyeUNvbXBvbmVudC5mb3JFYWNoKChjb21wOiBMaXZlQXBwc0Nhc2VTdW1tYXJ5Q29tcG9uZW50KSA9PiB7XG4gICAgICBjb21wLnJlc3R5bGVQcmV2aWV3Q2FzZVR5cGUodGhpcy5jYXNlVHlwZUljb24sIHRoaXMuY2FzZVR5cGVDb2xvcik7XG4gICAgfSk7XG4gICAgdGhpcy51cGRhdGVJY29uTWFwKG5ldyBJY29uTWFwKHRydWUsIHRoaXMuYXBwVHlwZUxhYmVsLCB0aGlzLmNhc2VUeXBlQ29sb3IsIHRoaXMuY2FzZVR5cGVJY29uKSk7XG4gIH1cblxuICBwdWJsaWMgdXBsb2FkRmlsZShmaWxlOiBGaWxlLCBzdGF0ZTogQ2FzZVR5cGVTdGF0ZSwgaXNTdGF0ZUljb246IGJvb2xlYW4pIHtcbiAgICBpZiAoZmlsZSkge1xuICAgICAgY29uc3QgdXJsID0gJ3dlYnJlc291cmNlL3YxL29yZ0ZvbGRlcnMvJyArIHRoaXMuZm9sZGVySWQgKyAnLycgKyB0aGlzLmFwcElkICsgJy4nICsgZmlsZS5uYW1lO1xuICAgICAgY29uc3QgZGxVcmwgPSAnd2VicmVzb3VyY2Uvb3JnRm9sZGVycy8nICsgdGhpcy5mb2xkZXJJZCArICcvJyArIHRoaXMuYXBwSWQgKyAnLicgKyBmaWxlLm5hbWU7XG4gICAgICB0aGlzLmxpdmVhcHBzLmNsZWFyRnJvbUljb25TVkdUZXh0Q2FjaGUodXJsKTtcbiAgICAgIHRoaXMuZG9jdW1lbnRzU2VydmljZS51cGxvYWREb2N1bWVudCgnb3JnRm9sZGVycycsIHRoaXMuZm9sZGVySWQsIHRoaXMuc2FuZGJveElkLFxuICAgICAgICBmaWxlLCAodGhpcy5hcHBJZCArICcuJyArIGZpbGUubmFtZSksICcnKVxuICAgICAgICAuc3Vic2NyaWJlKFxuICAgICAgICAgIHZhbCA9PiB7XG4gICAgICAgICAgICBpZiAoIWlzU3RhdGVJY29uKSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0TmV3U3RhdGVJY29uKGRsVXJsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0TmV3Q2FzZVR5cGVJY29uKGRsVXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yID0+IHsgY29uc29sZS5sb2coJ2Vycm9yJyk7IHRoaXMuZXJyb3JNZXNzYWdlID0gJ0Vycm9yIHVwbG9hZGluZyBzdGF0ZSBpY29uOiAnICsgZXJyb3IuZXJyb3JNc2c7IH0pO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyByZWZyZXNoID0gKCkgPT4ge1xuICAgIC8vIG5lZWQgc3RhdGVzICYgY2FyZENvbmZpZ1xuICAgIHRoaXMuc2VsZWN0ZWRDYXNlVHlwZUNvbmZpZyA9IG51bGw7XG4gICAgdGhpcy5jYXNlQ2FyZENvbmZpZ1NlcnZpY2UuZ2V0Q2FzZUNhcmRDb25maWcodGhpcy5zYW5kYm94SWQsIHRoaXMuYXBwSWQsIHRoaXMudWlBcHBJZCwgdGhpcy5hcHBUeXBlTGFiZWwsIHRoaXMuREVGQVVMVF9DQVNFX1RZUEVfQ09MT1IsIHRoaXMuREVGQVVMVF9DQVNFX1RZUEVfSUNPTiwgdGhpcy5ERUZBVUxUX0NBU0VfU1RBVEVfQ09MT1IsIHRoaXMuREVGQVVMVF9DQVNFX1NUQVRFX0lDT04pLnBpcGUoXG4gICAgICB0YWtlKDEpLFxuICAgICAgdGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3llZCQpXG4gICAgKS5zdWJzY3JpYmUoXG4gICAgICBjYXNlQ2FyZENvbmZpZyA9PiB7XG4gICAgICAgIHRoaXMuY2FzZUNhcmRDb25maWcgPSBjYXNlQ2FyZENvbmZpZztcbiAgICAgICAgLy8gc2V0IGRlZmF1bHQgc2VsZWN0ZWQgdG8gZmlyc3Qgc3RhdGUgZm9yIHRoaXMgY2FzZSB0eXBlICgwIGlzIGNhc2UgdHlwZSlcbiAgICAgICAgdGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnID0gdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwWzFdO1xuICAgICAgICBjb25zdCBjYXNlVHlwZVJlYyA9IHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcC5maW5kKGZ1bmN0aW9uKHN0YXRlTWFwKSB7XG4gICAgICAgICAgcmV0dXJuIHN0YXRlTWFwLmlzQ2FzZVR5cGU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuY2FzZVR5cGVJY29uID0gY2FzZVR5cGVSZWMuaWNvbjtcbiAgICAgICAgdGhpcy5jYXNlVHlwZUNvbG9yID0gY2FzZVR5cGVSZWMuZmlsbDtcbiAgICAgICAgdGhpcy5zZWxlY3RlZENhc2VUeXBlQ29uZmlnID0gdGhpcy5nZXRDb25maWdGb3JDYXNlVHlwZSh0aGlzLmFwcFR5cGVMYWJlbClcbiAgICAgIH0sIGVycm9yID0+IHsgdGhpcy5lcnJvck1lc3NhZ2UgPSAnRXJyb3IgcmV0cmlldmluZyBjYXNlIGNhcmQgY29uZmlnOiAnICsgZXJyb3IuZXJyb3IuZXJyb3JNc2c7IH0pO1xuICB9XG5cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIGh0dHA6IEh0dHBDbGllbnQsIHByb3RlY3RlZCBzYW5pdGl6ZXI6IERvbVNhbml0aXplcixcbiAgICAgICAgICAgICAgcHJvdGVjdGVkIGxpdmVhcHBzOiBMaXZlQXBwc1NlcnZpY2UsIHB1YmxpYyBjYXNlQ2FyZENvbmZpZ1NlcnZpY2U6IFRjQ2FzZUNhcmRDb25maWdTZXJ2aWNlLCBwcm90ZWN0ZWQgZG9jdW1lbnRzU2VydmljZTogVGNEb2N1bWVudFNlcnZpY2UsIHB1YmxpYyBkaWFsb2c6IE1hdERpYWxvZywgcHJvdGVjdGVkIGxvY2F0aW9uOiBMb2NhdGlvbikge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgaWYgKGNoYW5nZXMuYXBwSWQgJiYgKGNoYW5nZXMuYXBwSWQuY3VycmVudFZhbHVlICE9PSBjaGFuZ2VzLmFwcElkLnByZXZpb3VzVmFsdWUpKSB7XG4gICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICB9XG4gIH1cblxuXG59XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3RjbGEtbGl2ZS1hcHBzLXN0YXRlLWljb24tdXBsb2FkLWRpYWxvZycsXG4gIHRlbXBsYXRlVXJsOiAndXBsb2FkLWZpbGUtZGlhbG9nL2FwcC1saXZlLWFwcHMtc3RhdGUtaWNvbi11cGxvYWQtZGlhbG9nLmh0bWwnLFxuICBzdHlsZVVybHM6IFsgJ3VwbG9hZC1maWxlLWRpYWxvZy9hcHAtbGl2ZS1hcHBzLXN0YXRlLWljb24tdXBsb2FkLWRpYWxvZy5jc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBMaXZlQXBwc1N0YXRlSWNvblVwbG9hZERpYWxvZ0NvbXBvbmVudCB7XG4gIEBPdXRwdXQoKSBmaWxlZXZlbnQgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgcHVibGljIGZpbGVUb1VwbG9hZDogRmlsZSA9IHVuZGVmaW5lZDtcbiAgcHVibGljIGRlc2NyaXB0aW9uOiBzdHJpbmcgPSB1bmRlZmluZWQ7XG4gIHB1YmxpYyBmaWxlVGV4dDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHB1YmxpYyBkaWFsb2dSZWY6IE1hdERpYWxvZ1JlZjxMaXZlQXBwc1N0YXRlSWNvblVwbG9hZERpYWxvZ0NvbXBvbmVudD4sIEBJbmplY3QoTUFUX0RJQUxPR19EQVRBKSBwdWJsaWMgZGF0YTogYW55KSB7fVxuXG4gIHB1YmxpYyB1cGxvYWRGaWxlID0gKCkgPT4ge1xuICAgIGlmICh0aGlzLmZpbGVUb1VwbG9hZCkge1xuICAgICAgdGhpcy5maWxlZXZlbnQuZW1pdCh7IGZpbGU6IHRoaXMuZmlsZVRvVXBsb2FkLCBzdGF0ZTogdGhpcy5kYXRhLnN0YXRlLCBpc0Nhc2VUeXBlOiB0aGlzLmRhdGEuaXNDYXNlVHlwZSB9ICk7XG4gICAgICB0aGlzLmRpYWxvZ1JlZi5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIHNldEZpbGVEZXNjcmlwdGlvbihkZXNjcmlwdGlvbjogc3RyaW5nKSB7XG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICB9XG5cbiAgYXR0YWNoRmlsZShmaWxlczogRmlsZUxpc3QpIHtcbiAgICB0aGlzLmZpbGVUb1VwbG9hZCA9IGZpbGVzLml0ZW0oMCk7XG4gICAgLypjb25zdCBteVJlYWRlcjogRmlsZVJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgbXlSZWFkZXIucmVhZEFzVGV4dCh0aGlzLmZpbGVUb1VwbG9hZCk7XG4gICAgdGhpcy5maWxlVGV4dCA9IG15UmVhZGVyLnJlc3VsdC50b1N0cmluZygpOyovXG4gIH1cblxuICBvbk5vQ2xpY2soKTogdm9pZCB7XG4gICAgdGhpcy5kaWFsb2dSZWYuY2xvc2UoKTtcbiAgfVxuXG59XG5cbiJdfQ==