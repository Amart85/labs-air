/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, ElementRef, EventEmitter, Input, Output, ViewChild, ViewChildren } from '@angular/core';
import { CaseType } from '../../models/liveappsdata';
import { LiveAppsComponent } from '../live-apps-component/live-apps-component.component';
import { LiveAppsCaseSearchComponent } from '../live-apps-case-search/live-apps-case-search.component';
import { LiveAppsService } from '../../services/live-apps.service';
/**
 * High Level search widget component (wraps others)
 * This Component allows to search for existing Cases and list Case Cards.
 *
 * ![alt-text](../live-apps-search-widget.png "")
 *
 * \@example <tcla-live-apps-search-widget></tcla-live-apps-search-widget>
 */
export class LiveAppsSearchWidgetComponent extends LiveAppsComponent {
    /**
     * @param {?} liveapps
     */
    constructor(liveapps) {
        super();
        this.liveapps = liveapps;
        /**
         * The fixed height of the case list results pane
         */
        this.resultsHeight = this.resultsHeight ? this.resultsHeight : '400px';
        /**
         * ~event caseSelected : Case Clicked
         * ~payload string : emits case reference when a case is clicked (so parent can navigate to case)
         */
        this.caseSelected = new EventEmitter();
        // case search
        this.matchedRefs = [];
        // handle case search results
        this.handleSearchResults = (/**
         * @param {?} data
         * @return {?}
         */
        (data) => {
            this.message = undefined;
            this.matchedRefs = data.caserefs;
            this.searchString = data.searchString;
        });
        this.handleClearMatches = (/**
         * @return {?}
         */
        () => {
            this.caseSearchComponent.clearResults();
            this.matchedRefs = [];
            this.message = undefined;
        });
        // case clicked
        this.clickCaseAction = (/**
         * @param {?} caseReference
         * @return {?}
         */
        (caseReference) => {
            this.caseSelected.emit(caseReference);
        });
        this.refresh = (/**
         * @return {?}
         */
        () => {
            if (this.caseSearchComponent) {
                this.caseSearchComponent.refresh();
            }
        });
        this.searchCasesByState = (/**
         * @param {?} stateId
         * @param {?} stateLabel
         * @param {?} appId
         * @param {?} typeId
         * @param {?} message
         * @return {?}
         */
        (stateId, stateLabel, appId, typeId, message) => {
            this.caseSearchComponent.setCaseType(new CaseType().deserialize({ applicationId: appId, id: typeId }));
            this.caseSearchComponent.setSelectedStateId(stateId, stateLabel);
            this.message = message;
            this.liveapps.caseSearchEntries('', this.sandboxId, appId, typeId, true, 0, 1000, stateId).subscribe((/**
             * @param {?} results
             * @return {?}
             */
            results => {
                this.matchedRefs = results.caserefs;
            }));
        });
    }
    /**
     * @return {?}
     */
    ngAfterViewInit() {
        super.ngAfterViewInit();
        this.containerChanges$.subscribe();
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        super.ngOnInit();
    }
}
LiveAppsSearchWidgetComponent.decorators = [
    { type: Component, args: [{
                selector: 'tcla-live-apps-search-widget',
                template: "<div fxFill fxLayout=\"column\" #componentDiv>\n  <div fxLayout=\"row\" style=\"margin-top: 10px; margin-bottom: 10px;\">\n    <tcla-live-apps-case-search fxFlex fxLayoutAlign=\"center center\" [sandboxId]=\"sandboxId\" [appIds]=\"appIds\" (foundRefs)=\"handleSearchResults($event)\"></tcla-live-apps-case-search>\n  </div>\n  <div *ngIf=\"matchedRefs.length>0\" fxLayout=\"row\" fxLayoutAlign=\"space-around start\" [ngStyle]=\"{'min-height' : resultsHeight}\" style=\"margin-left: 50px; margin-right: 50px; margin-top: 20px; margin-bottom: 20px; height: 100%;\">\n    <tcla-live-apps-case-list #componentChildDiv fxFlex style=\"height: 100%\" [sandboxId]=\"sandboxId\" [uiAppId]=\"uiAppId\" [caseRefs]=\"matchedRefs\" [displayType]=\"widget.gtXs ? 'list' : 'miniCard'\" [headerText]=\"'Matching Cases'\" [headerMessage]=\"message\" [highlight]=\"searchString\" (clickCase)=\"clickCaseAction($event)\" (clearMatches)=\"handleClearMatches()\"></tcla-live-apps-case-list>\n    <!--tcla-live-apps-case-list #componentChildDiv fxFlex style=\"height: 100%\" [sandboxId]=\"sandboxId\" [uiAppId]=\"uiAppId\" [caseRefs]=\"matchedRefs\" [displayType]=\"'list'\" [headerText]=\"'Matching Cases'\" [headerMessage]=\"message\" [highlight]=\"searchString\" (clickCase)=\"clickCaseAction($event)\" (clearMatches)=\"handleClearMatches()\"></tcla-live-apps-case-list-->\n  </div>\n</div>\n\n",
                styles: [""]
            }] }
];
/** @nocollapse */
LiveAppsSearchWidgetComponent.ctorParameters = () => [
    { type: LiveAppsService }
];
LiveAppsSearchWidgetComponent.propDecorators = {
    sandboxId: [{ type: Input }],
    uiAppId: [{ type: Input }],
    appIds: [{ type: Input }],
    resultsHeight: [{ type: Input }],
    caseSelected: [{ type: Output }],
    caseSearchComponent: [{ type: ViewChild, args: [LiveAppsCaseSearchComponent, { static: false },] }],
    componentDiv: [{ type: ViewChild, args: ['componentDiv', { static: false },] }],
    componentDivs: [{ type: ViewChildren, args: ['componentDiv',] }]
};
if (false) {
    /**
     * sandboxId - this comes from claims resolver
     * @type {?}
     */
    LiveAppsSearchWidgetComponent.prototype.sandboxId;
    /**
     * The Application ID of the UI (should ideally be unique as it is shared state key)
     * @type {?}
     */
    LiveAppsSearchWidgetComponent.prototype.uiAppId;
    /**
     * The list of LA Application IDs you want to handle
     * @type {?}
     */
    LiveAppsSearchWidgetComponent.prototype.appIds;
    /**
     * The fixed height of the case list results pane
     * @type {?}
     */
    LiveAppsSearchWidgetComponent.prototype.resultsHeight;
    /**
     * ~event caseSelected : Case Clicked
     * ~payload string : emits case reference when a case is clicked (so parent can navigate to case)
     * @type {?}
     */
    LiveAppsSearchWidgetComponent.prototype.caseSelected;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.caseSearchComponent;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.componentDiv;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.componentDivs;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.widget;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.matchedRefs;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.searchString;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.message;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.handleSearchResults;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.handleClearMatches;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.clickCaseAction;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.refresh;
    /** @type {?} */
    LiveAppsSearchWidgetComponent.prototype.searchCasesByState;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsSearchWidgetComponent.prototype.liveapps;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLXNlYXJjaC13aWRnZXQuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHRpYmNvLXRjc3RrL3RjLWxpdmVhcHBzLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2xpdmUtYXBwcy1zZWFyY2gtd2lkZ2V0L2xpdmUtYXBwcy1zZWFyY2gtd2lkZ2V0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUdMLFNBQVMsRUFDVCxVQUFVLEVBQ1YsWUFBWSxFQUNaLEtBQUssRUFFTCxNQUFNLEVBQ04sU0FBUyxFQUNULFlBQVksRUFDYixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQW9CLFFBQVEsRUFBQyxNQUFNLDJCQUEyQixDQUFDO0FBQ3RFLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLHNEQUFzRCxDQUFDO0FBQ3ZGLE9BQU8sRUFBQywyQkFBMkIsRUFBQyxNQUFNLDBEQUEwRCxDQUFDO0FBQ3JHLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxrQ0FBa0MsQ0FBQzs7Ozs7Ozs7O0FBa0JqRSxNQUFNLE9BQU8sNkJBQThCLFNBQVEsaUJBQWlCOzs7O0lBc0NsRSxZQUFzQixRQUF5QjtRQUM3QyxLQUFLLEVBQUUsQ0FBQztRQURZLGFBQVEsR0FBUixRQUFRLENBQWlCOzs7O1FBbkJ0QyxrQkFBYSxHQUFXLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFFLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQzs7Ozs7UUFNMUUsaUJBQVksR0FBeUIsSUFBSSxZQUFZLEVBQVUsQ0FBQzs7UUFTMUUsZ0JBQVcsR0FBYSxFQUFFLENBQUM7O1FBU3BCLHdCQUFtQjs7OztRQUFHLENBQUMsSUFBdUIsRUFBRSxFQUFFO1lBQ3ZELElBQUksQ0FBQyxPQUFPLEdBQUcsU0FBUyxDQUFDO1lBQ3pCLElBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQztZQUNqQyxJQUFJLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQyxZQUFZLENBQUM7UUFDeEMsQ0FBQyxFQUFBO1FBRU0sdUJBQWtCOzs7UUFBRyxHQUFHLEVBQUU7WUFDL0IsSUFBSSxDQUFDLG1CQUFtQixDQUFDLFlBQVksRUFBRSxDQUFDO1lBQ3hDLElBQUksQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1lBQ3RCLElBQUksQ0FBQyxPQUFPLEdBQUcsU0FBUyxDQUFDO1FBQzNCLENBQUMsRUFBQTs7UUFHTSxvQkFBZTs7OztRQUFHLENBQUMsYUFBYSxFQUFFLEVBQUU7WUFDekMsSUFBSSxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUM7UUFDeEMsQ0FBQyxFQUFBO1FBRU0sWUFBTzs7O1FBQUcsR0FBRyxFQUFFO1lBQ3BCLElBQUksSUFBSSxDQUFDLG1CQUFtQixFQUFFO2dCQUM1QixJQUFJLENBQUMsbUJBQW1CLENBQUMsT0FBTyxFQUFFLENBQUM7YUFDcEM7UUFDSCxDQUFDLEVBQUE7UUFFTSx1QkFBa0I7Ozs7Ozs7O1FBQUcsQ0FBQyxPQUFlLEVBQUUsVUFBa0IsRUFBRSxLQUFhLEVBQUUsTUFBYyxFQUFFLE9BQWUsRUFBRSxFQUFFO1lBQ2xILElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxXQUFXLENBQUMsSUFBSSxRQUFRLEVBQUUsQ0FBQyxXQUFXLENBQUUsRUFBRSxhQUFhLEVBQUcsS0FBSyxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDekcsSUFBSSxDQUFDLG1CQUFtQixDQUFDLGtCQUFrQixDQUFDLE9BQU8sRUFBRSxVQUFVLENBQUMsQ0FBQztZQUNqRSxJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztZQUN2QixJQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsU0FBUyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxDQUFDLENBQUMsU0FBUzs7OztZQUNsRyxPQUFPLENBQUMsRUFBRTtnQkFDUixJQUFJLENBQUMsV0FBVyxHQUFHLE9BQU8sQ0FBQyxRQUFRLENBQUM7WUFDdEMsQ0FBQyxFQUNGLENBQUM7UUFDSixDQUFDLEVBQUE7SUFuQ0QsQ0FBQzs7OztJQXFDRCxlQUFlO1FBQ2IsS0FBSyxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3hCLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLEVBQUUsQ0FBQztJQUNyQyxDQUFDOzs7O0lBRUQsUUFBUTtRQUNOLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNuQixDQUFDOzs7WUF6RkYsU0FBUyxTQUFDO2dCQUNULFFBQVEsRUFBRSw4QkFBOEI7Z0JBQ3hDLDQyQ0FBdUQ7O2FBRXhEOzs7O1lBakJPLGVBQWU7Ozt3QkFzQnBCLEtBQUs7c0JBS0wsS0FBSztxQkFLTCxLQUFLOzRCQUtMLEtBQUs7MkJBTUwsTUFBTTtrQ0FHTixTQUFTLFNBQUMsMkJBQTJCLEVBQUUsRUFBQyxNQUFNLEVBQUUsS0FBSyxFQUFDOzJCQUN0RCxTQUFTLFNBQUMsY0FBYyxFQUFFLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRTs0QkFDM0MsWUFBWSxTQUFFLGNBQWM7Ozs7Ozs7SUExQjdCLGtEQUEyQjs7Ozs7SUFLM0IsZ0RBQXlCOzs7OztJQUt6QiwrQ0FBMEI7Ozs7O0lBSzFCLHNEQUFvRjs7Ozs7O0lBTXBGLHFEQUEwRTs7SUFHMUUsNERBQTBHOztJQUMxRyxxREFBdUU7O0lBQ3ZFLHNEQUFrRTs7SUFFbEUsK0NBQW9COztJQUVwQixvREFBMkI7O0lBQzNCLHFEQUFxQjs7SUFDckIsZ0RBQWdCOztJQU9oQiw0REFJQzs7SUFFRCwyREFJQzs7SUFHRCx3REFFQzs7SUFFRCxnREFJQzs7SUFFRCwyREFTQzs7Ozs7SUFyQ1csaURBQW1DIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWZ0ZXJWaWV3Q2hlY2tlZCxcbiAgQWZ0ZXJWaWV3SW5pdCxcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIElucHV0LFxuICBPbkluaXQsXG4gIE91dHB1dCxcbiAgVmlld0NoaWxkLFxuICBWaWV3Q2hpbGRyZW5cbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0Nhc2VTZWFyY2hSZXN1bHRzLCBDYXNlVHlwZX0gZnJvbSAnLi4vLi4vbW9kZWxzL2xpdmVhcHBzZGF0YSc7XG5pbXBvcnQge0xpdmVBcHBzQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtY29tcG9uZW50L2xpdmUtYXBwcy1jb21wb25lbnQuY29tcG9uZW50JztcbmltcG9ydCB7TGl2ZUFwcHNDYXNlU2VhcmNoQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtY2FzZS1zZWFyY2gvbGl2ZS1hcHBzLWNhc2Utc2VhcmNoLmNvbXBvbmVudCc7XG5pbXBvcnQge0xpdmVBcHBzU2VydmljZX0gZnJvbSAnLi4vLi4vc2VydmljZXMvbGl2ZS1hcHBzLnNlcnZpY2UnO1xuaW1wb3J0IHtTdWJqZWN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7VGNDb21wb25lbnQsIFRjQ29yZUNvbW1vbkZ1bmN0aW9uc30gZnJvbSAnQHRpYmNvLXRjc3RrL3RjLWNvcmUtbGliJztcblxuLyoqXG4gKiBIaWdoIExldmVsIHNlYXJjaCB3aWRnZXQgY29tcG9uZW50ICh3cmFwcyBvdGhlcnMpXG4gKiBUaGlzIENvbXBvbmVudCBhbGxvd3MgdG8gc2VhcmNoIGZvciBleGlzdGluZyBDYXNlcyBhbmQgbGlzdCBDYXNlIENhcmRzLlxuICpcbiAqICFbYWx0LXRleHRdKC4uL2xpdmUtYXBwcy1zZWFyY2gtd2lkZ2V0LnBuZyBcIlwiKVxuICpcbiAqQGV4YW1wbGUgPHRjbGEtbGl2ZS1hcHBzLXNlYXJjaC13aWRnZXQ+PC90Y2xhLWxpdmUtYXBwcy1zZWFyY2gtd2lkZ2V0PlxuICovXG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3RjbGEtbGl2ZS1hcHBzLXNlYXJjaC13aWRnZXQnLFxuICB0ZW1wbGF0ZVVybDogJy4vbGl2ZS1hcHBzLXNlYXJjaC13aWRnZXQuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9saXZlLWFwcHMtc2VhcmNoLXdpZGdldC5jb21wb25lbnQuY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgTGl2ZUFwcHNTZWFyY2hXaWRnZXRDb21wb25lbnQgZXh0ZW5kcyBMaXZlQXBwc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XG4gIC8qKlxuICAgKiBzYW5kYm94SWQgLSB0aGlzIGNvbWVzIGZyb20gY2xhaW1zIHJlc29sdmVyXG4gICAqL1xuICBASW5wdXQoKSBzYW5kYm94SWQ6IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIEFwcGxpY2F0aW9uIElEIG9mIHRoZSBVSSAoc2hvdWxkIGlkZWFsbHkgYmUgdW5pcXVlIGFzIGl0IGlzIHNoYXJlZCBzdGF0ZSBrZXkpXG4gICAqL1xuICBASW5wdXQoKSB1aUFwcElkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBsaXN0IG9mIExBIEFwcGxpY2F0aW9uIElEcyB5b3Ugd2FudCB0byBoYW5kbGVcbiAgICovXG4gIEBJbnB1dCgpIGFwcElkczogc3RyaW5nW107XG5cbiAgLyoqXG4gICAqIFRoZSBmaXhlZCBoZWlnaHQgb2YgdGhlIGNhc2UgbGlzdCByZXN1bHRzIHBhbmVcbiAgICovXG4gIEBJbnB1dCgpIHJlc3VsdHNIZWlnaHQ6IHN0cmluZyA9IHRoaXMucmVzdWx0c0hlaWdodCA/ICB0aGlzLnJlc3VsdHNIZWlnaHQgOiAnNDAwcHgnO1xuXG4gIC8qKlxuICAgKiB+ZXZlbnQgY2FzZVNlbGVjdGVkIDogQ2FzZSBDbGlja2VkXG4gICAqIH5wYXlsb2FkIHN0cmluZyA6IGVtaXRzIGNhc2UgcmVmZXJlbmNlIHdoZW4gYSBjYXNlIGlzIGNsaWNrZWQgKHNvIHBhcmVudCBjYW4gbmF2aWdhdGUgdG8gY2FzZSlcbiAgICovXG4gIEBPdXRwdXQoKSBjYXNlU2VsZWN0ZWQ6IEV2ZW50RW1pdHRlcjxzdHJpbmc+ID0gbmV3IEV2ZW50RW1pdHRlcjxzdHJpbmc+KCk7XG5cblxuICBAVmlld0NoaWxkKExpdmVBcHBzQ2FzZVNlYXJjaENvbXBvbmVudCwge3N0YXRpYzogZmFsc2V9KSBjYXNlU2VhcmNoQ29tcG9uZW50OiBMaXZlQXBwc0Nhc2VTZWFyY2hDb21wb25lbnQ7XG4gIEBWaWV3Q2hpbGQoJ2NvbXBvbmVudERpdicsIHsgc3RhdGljOiBmYWxzZSB9KSBjb21wb25lbnREaXY6IEVsZW1lbnRSZWY7XG4gIEBWaWV3Q2hpbGRyZW4gKCdjb21wb25lbnREaXYnKSBjb21wb25lbnREaXZzOiBMaXZlQXBwc0NvbXBvbmVudFtdO1xuXG4gIHdpZGdldDogVGNDb21wb25lbnQ7XG4gIC8vIGNhc2Ugc2VhcmNoXG4gIG1hdGNoZWRSZWZzOiBzdHJpbmdbXSA9IFtdO1xuICBzZWFyY2hTdHJpbmc6IHN0cmluZztcbiAgbWVzc2FnZTogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBsaXZlYXBwczogTGl2ZUFwcHNTZXJ2aWNlKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIC8vIGhhbmRsZSBjYXNlIHNlYXJjaCByZXN1bHRzXG4gIHB1YmxpYyBoYW5kbGVTZWFyY2hSZXN1bHRzID0gKGRhdGE6IENhc2VTZWFyY2hSZXN1bHRzKSA9PiB7XG4gICAgdGhpcy5tZXNzYWdlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMubWF0Y2hlZFJlZnMgPSBkYXRhLmNhc2VyZWZzO1xuICAgIHRoaXMuc2VhcmNoU3RyaW5nID0gZGF0YS5zZWFyY2hTdHJpbmc7XG4gIH1cblxuICBwdWJsaWMgaGFuZGxlQ2xlYXJNYXRjaGVzID0gKCkgPT4ge1xuICAgIHRoaXMuY2FzZVNlYXJjaENvbXBvbmVudC5jbGVhclJlc3VsdHMoKTtcbiAgICB0aGlzLm1hdGNoZWRSZWZzID0gW107XG4gICAgdGhpcy5tZXNzYWdlID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgLy8gY2FzZSBjbGlja2VkXG4gIHB1YmxpYyBjbGlja0Nhc2VBY3Rpb24gPSAoY2FzZVJlZmVyZW5jZSkgPT4ge1xuICAgIHRoaXMuY2FzZVNlbGVjdGVkLmVtaXQoY2FzZVJlZmVyZW5jZSk7XG4gIH1cblxuICBwdWJsaWMgcmVmcmVzaCA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5jYXNlU2VhcmNoQ29tcG9uZW50KSB7XG4gICAgICB0aGlzLmNhc2VTZWFyY2hDb21wb25lbnQucmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBzZWFyY2hDYXNlc0J5U3RhdGUgPSAoc3RhdGVJZDogbnVtYmVyLCBzdGF0ZUxhYmVsOiBzdHJpbmcsIGFwcElkOiBzdHJpbmcsIHR5cGVJZDogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcpID0+IHtcbiAgICB0aGlzLmNhc2VTZWFyY2hDb21wb25lbnQuc2V0Q2FzZVR5cGUobmV3IENhc2VUeXBlKCkuZGVzZXJpYWxpemUoIHsgYXBwbGljYXRpb25JZCA6IGFwcElkLCBpZDogdHlwZUlkIH0pKTtcbiAgICB0aGlzLmNhc2VTZWFyY2hDb21wb25lbnQuc2V0U2VsZWN0ZWRTdGF0ZUlkKHN0YXRlSWQsIHN0YXRlTGFiZWwpO1xuICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG4gICAgdGhpcy5saXZlYXBwcy5jYXNlU2VhcmNoRW50cmllcygnJywgdGhpcy5zYW5kYm94SWQsIGFwcElkLCB0eXBlSWQsIHRydWUsIDAsIDEwMDAsIHN0YXRlSWQpLnN1YnNjcmliZShcbiAgICAgIHJlc3VsdHMgPT4ge1xuICAgICAgICB0aGlzLm1hdGNoZWRSZWZzID0gcmVzdWx0cy5jYXNlcmVmcztcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHN1cGVyLm5nQWZ0ZXJWaWV3SW5pdCgpO1xuICAgIHRoaXMuY29udGFpbmVyQ2hhbmdlcyQuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBzdXBlci5uZ09uSW5pdCgpO1xuICB9XG5cbn1cbiJdfQ==