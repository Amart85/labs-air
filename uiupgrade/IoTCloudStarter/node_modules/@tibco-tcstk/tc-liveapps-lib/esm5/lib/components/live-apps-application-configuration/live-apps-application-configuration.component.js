/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*
*     Case Type icons are stored in an orgFolder specified in liveAppsConfig.json (pushed to shared state)
*     Icon Name will be appId.filename.svg
*     Icon svg should contain <DYNAMICFILL> this will be set according to the color selected in this component
*
*     eg: 1742.ic-created.svg for Partner Portal Live Apps App (appId: 1742) 'Created' state
*
*     <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14">
*        <path fill="<DYNAMICFILL>" class="svg-content" fill-rule="evenodd" d="M7 14A7 7 0 1 1 7 0a7 7 0 0 1 0 14zm3.474-6.472a.527.527 0 0 0 0-1.053H7.526V3.527a.525.525 0 1 0-1.052 0v2.948H3.526a.527.527 0 0 0 0 1.053h2.948v2.948a.525.525 0 0 0 .898.373.525.525 0 0 0 .154-.373V7.528h2.948z"/>
*      </svg>
*
*
 */
import { Component, EventEmitter, Inject, Input, Output, QueryList, ViewChildren } from '@angular/core';
import { LiveAppsService } from '../../services/live-apps.service';
import { CaseTypeState, IconMap } from '../../models/liveappsdata';
import { take, takeUntil } from 'rxjs/operators';
import { HttpClient } from '@angular/common/http';
import { DomSanitizer } from '@angular/platform-browser';
import { LiveAppsCaseSummaryComponent } from '../live-apps-case-summary/live-apps-case-summary.component';
import { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material';
import { Location } from '@angular/common';
import { LiveAppsComponent } from '../live-apps-component/live-apps-component.component';
import { DEFAULT_COLORS, DEFAULT_STATE_COLOR, DEFAULT_TYPE_COLOR, TcCaseCardConfigService } from '../../services/tc-case-card-config.service';
import { TcDocumentService } from '../../services/tc-document.service';
/**
 * Manages summary card configuration
 *
 * \@example <tcla-live-apps-application-configuration></tcla-live-apps-application-configuration>
 */
var LiveAppsApplicationConfigurationComponent = /** @class */ (function (_super) {
    tslib_1.__extends(LiveAppsApplicationConfigurationComponent, _super);
    function LiveAppsApplicationConfigurationComponent(http, sanitizer, liveapps, caseCardConfigService, documentsService, dialog, location) {
        var _this = _super.call(this) || this;
        _this.http = http;
        _this.sanitizer = sanitizer;
        _this.liveapps = liveapps;
        _this.caseCardConfigService = caseCardConfigService;
        _this.documentsService = documentsService;
        _this.dialog = dialog;
        _this.location = location;
        /**
         * ~event configChanged : Configuration values changed
         * ~payload CaseCardConfig : CaseCardConfig object when configuration is changed (so called can do a save with data)
         */
        _this.configChanged = new EventEmitter();
        // prepareExternalUrl will add the base href
        _this.DEFAULT_CASE_TYPE_ICON = 'assets/icons/ic-generic-casetype.svg';
        _this.DEFAULT_CASE_TYPE_COLOR = DEFAULT_TYPE_COLOR;
        _this.DEFAULT_CASE_STATE_ICON = 'assets/icons/ic-generic-state.svg';
        _this.DEFAULT_CASE_STATE_COLOR = DEFAULT_STATE_COLOR;
        _this.DEFAULT_COLOR_PALETTE = DEFAULT_COLORS;
        _this.getConfigForState = (/**
         * @param {?} state
         * @return {?}
         */
        function (state) {
            /** @type {?} */
            var reqIconMap;
            if (_this.caseCardConfig.cardConfig && _this.caseCardConfig.cardConfig.stateMap) {
                _this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    if (stateMap.state === state.value) {
                        reqIconMap = stateMap;
                    }
                }));
            }
            return reqIconMap ? reqIconMap : new IconMap(false, state.value, _this.DEFAULT_CASE_STATE_COLOR, _this.DEFAULT_CASE_STATE_ICON);
        });
        _this.getConfigForCaseType = (/**
         * @param {?} caseTypeId
         * @return {?}
         */
        function (caseTypeId) {
            /** @type {?} */
            var reqIconMap;
            if (_this.caseCardConfig.cardConfig && _this.caseCardConfig.cardConfig.stateMap) {
                _this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    if (stateMap.isCaseType) {
                        reqIconMap = stateMap;
                    }
                }));
            }
            return reqIconMap ? reqIconMap : new IconMap(true, caseTypeId, _this.DEFAULT_CASE_TYPE_COLOR, _this.DEFAULT_CASE_TYPE_ICON);
        });
        _this.updateIconMap = (/**
         * @param {?} stateConfig
         * @return {?}
         */
        function (stateConfig) {
            /** @type {?} */
            var foundMap;
            /** @type {?} */
            var updatedMap;
            if (_this.caseCardConfig.cardConfig && _this.caseCardConfig.cardConfig.stateMap) {
                _this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    if (stateMap.state === stateConfig.state) {
                        foundMap = stateConfig;
                        stateMap.state = stateConfig.state;
                        stateMap.icon = stateConfig.icon;
                        stateMap.fill = stateConfig.fill;
                    }
                }));
                if (foundMap) {
                    foundMap = stateConfig;
                }
                else {
                    _this.caseCardConfig.cardConfig.stateMap.push(stateConfig);
                }
            }
            else {
                _this.caseCardConfig.cardConfig.stateMap = [];
                _this.caseCardConfig.cardConfig.stateMap.push(stateConfig);
            }
            _this.configChanged.emit(_this.caseCardConfig);
        });
        _this.handleCaseTypeColorToggleChange = (/**
         * @param {?} changes
         * @return {?}
         */
        function (changes) {
            _this.caseCardConfig.cardConfig.useCaseTypeColor = changes.checked ? changes.checked : false;
            if (changes.checked) {
                _this.caseSummaryComponent.forEach((/**
                 * @param {?} comp
                 * @return {?}
                 */
                function (comp) {
                    comp.restylePreview(_this.selectedStateConfig.icon, _this.caseTypeColor);
                }));
            }
            _this.configChanged.emit(_this.caseCardConfig);
        });
        _this.setFill = (/**
         * @param {?} fill
         * @param {?} stateConfig
         * @return {?}
         */
        function (fill, stateConfig) {
            _this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                comp.restylePreview(stateConfig.icon, fill);
            }));
            _this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return comp.id === stateConfig.state;
            })).refillSVG(fill);
            _this.configChanged.emit(_this.caseCardConfig);
        });
        _this.setCaseTypeFill = (/**
         * @param {?} fill
         * @param {?} stateConfig
         * @return {?}
         */
        function (fill, stateConfig) {
            _this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                comp.restylePreviewCaseType(stateConfig.icon, fill);
            }));
            _this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return (comp.id === stateConfig.state && stateConfig.isCaseType);
            })).refillSVG(fill);
            _this.configChanged.emit(_this.caseCardConfig);
        });
        _this.selectState = (/**
         * @param {?} state
         * @return {?}
         */
        function (state) {
            _this.selectedStateConfig = _this.getConfigForState(state);
            if (!_this.caseCardConfig.cardConfig.useCaseTypeColor) {
                _this.caseSummaryComponent.forEach((/**
                 * @param {?} comp
                 * @return {?}
                 */
                function (comp) {
                    comp.restylePreview(_this.selectedStateConfig.icon, _this.selectedStateConfig.fill);
                }));
            }
        });
        _this.setNewStateIcon = (/**
         * @param {?} url
         * @return {?}
         */
        function (url) {
            _this.selectedStateConfig.icon = url;
            _this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return (comp.id === _this.selectedStateConfig.state);
            })).refresh(_this.selectedStateConfig.icon, _this.selectedStateConfig.fill);
            _this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                comp.restylePreview(_this.selectedStateConfig.icon, _this.selectedStateConfig.fill);
            }));
            _this.updateIconMap(_this.selectedStateConfig);
        });
        _this.setNewCaseTypeIcon = (/**
         * @param {?} url
         * @return {?}
         */
        function (url) {
            _this.caseTypeIcon = url;
            _this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return (comp.id === _this.appTypeLabel);
            })).refresh(_this.caseTypeIcon, _this.caseTypeColor);
            _this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                comp.restylePreviewCaseType(_this.caseTypeIcon, _this.caseTypeColor);
            }));
            _this.updateIconMap(new IconMap(true, _this.appTypeLabel, _this.caseTypeColor, _this.caseTypeIcon));
        });
        _this.refresh = (/**
         * @return {?}
         */
        function () {
            // need states & cardConfig
            _this.selectedCaseTypeConfig = null;
            _this.caseCardConfigService.getCaseCardConfig(_this.sandboxId, _this.appId, _this.uiAppId, _this.appTypeLabel, _this.DEFAULT_CASE_TYPE_COLOR, _this.DEFAULT_CASE_TYPE_ICON, _this.DEFAULT_CASE_STATE_COLOR, _this.DEFAULT_CASE_STATE_ICON).pipe(take(1), takeUntil(_this._destroyed$)).subscribe((/**
             * @param {?} caseCardConfig
             * @return {?}
             */
            function (caseCardConfig) {
                _this.caseCardConfig = caseCardConfig;
                // set default selected to first state for this case type (0 is case type)
                _this.selectedStateConfig = _this.caseCardConfig.cardConfig.stateMap[1];
                /** @type {?} */
                var caseTypeRec = _this.caseCardConfig.cardConfig.stateMap.find((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    return stateMap.isCaseType;
                }));
                _this.caseTypeIcon = caseTypeRec.icon;
                _this.caseTypeColor = caseTypeRec.fill;
                _this.selectedCaseTypeConfig = _this.getConfigForCaseType(_this.appTypeLabel);
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) { _this.errorMessage = 'Error retrieving case card config: ' + error.error.errorMsg; }));
        });
        return _this;
    }
    /*public saveConfig = () => {
      this.caseCardConfigService.updateCaseCardConfig(this.sandboxId, this.appId, this.uiAppId, this.caseCardConfig)
        .pipe(
          take(1),
          takeUntil(this._destroyed$),
          map(caseCardConfig => {
            this.caseCardConfig = caseCardConfig;
          })
        ).subscribe(null, error => { console.log('Unable to update case card config: ' + error.errorMsg); }
      );
    }*/
    /*public saveConfig = () => {
        this.caseCardConfigService.updateCaseCardConfig(this.sandboxId, this.appId, this.uiAppId, this.caseCardConfig)
          .pipe(
            take(1),
            takeUntil(this._destroyed$),
            map(caseCardConfig => {
              this.caseCardConfig = caseCardConfig;
            })
          ).subscribe(null, error => { console.log('Unable to update case card config: ' + error.errorMsg); }
        );
      }*/
    /**
     * @param {?} state
     * @param {?} isCaseType
     * @return {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.openDialog = /*public saveConfig = () => {
        this.caseCardConfigService.updateCaseCardConfig(this.sandboxId, this.appId, this.uiAppId, this.caseCardConfig)
          .pipe(
            take(1),
            takeUntil(this._destroyed$),
            map(caseCardConfig => {
              this.caseCardConfig = caseCardConfig;
            })
          ).subscribe(null, error => { console.log('Unable to update case card config: ' + error.errorMsg); }
        );
      }*/
    /**
     * @param {?} state
     * @param {?} isCaseType
     * @return {?}
     */
    function (state, isCaseType) {
        var _this = this;
        if (!isCaseType) {
            this.selectState(state);
        }
        else {
            state = new CaseTypeState().deserialize({ value: this.appTypeLabel });
        }
        /** @type {?} */
        var dialogRef = this.dialog.open(LiveAppsStateIconUploadDialogComponent, {
            width: '500px',
            data: { state: state, isCaseType: isCaseType }
        });
        dialogRef.componentInstance.fileevent.subscribe((/**
         * @param {?} $e
         * @return {?}
         */
        function ($e) {
            _this.uploadFile($e.file, $e.state, $e.isCaseType);
        }));
        dialogRef.afterClosed().subscribe((/**
         * @param {?} result
         * @return {?}
         */
        function (result) {
        }));
    };
    /**
     * @param {?} file
     * @param {?} state
     * @param {?} isStateIcon
     * @return {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.uploadFile = /**
     * @param {?} file
     * @param {?} state
     * @param {?} isStateIcon
     * @return {?}
     */
    function (file, state, isStateIcon) {
        var _this = this;
        if (file) {
            /** @type {?} */
            var url = 'webresource/v1/orgFolders/' + this.folderId + '/' + this.appId + '.' + file.name;
            /** @type {?} */
            var dlUrl_1 = 'webresource/orgFolders/' + this.folderId + '/' + this.appId + '.' + file.name;
            this.liveapps.clearFromIconSVGTextCache(url);
            this.documentsService.uploadDocument('orgFolders', this.folderId, this.sandboxId, file, (this.appId + '.' + file.name), '')
                .subscribe((/**
             * @param {?} val
             * @return {?}
             */
            function (val) {
                if (!isStateIcon) {
                    _this.setNewStateIcon(dlUrl_1);
                }
                else {
                    _this.setNewCaseTypeIcon(dlUrl_1);
                }
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) { console.log('error'); _this.errorMessage = 'Error uploading state icon: ' + error.errorMsg; }));
        }
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.appId && (changes.appId.currentValue !== changes.appId.previousValue)) {
            this.refresh();
        }
    };
    LiveAppsApplicationConfigurationComponent.decorators = [
        { type: Component, args: [{
                    selector: 'tcla-live-apps-application-configuration',
                    template: "<div *ngIf=\"appId\" class=\"tcs-case-card-customization\" fxLayout=\"column\">\n    <div fxLayout=\"row\" fxLayoutAlign=\"space-around stretch\" fxFlex>\n      <div fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n        <div fxLayout=\"column\" fxLayoutAlign=\"start center\">\n          <div class=\"tcs-case-card-customization-section-text\">Preview</div>\n        </div>\n        <div class=\"tcs-case-card-customization-preview\" fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n          <div *ngIf=\"selectedStateConfig && caseTypeColor && caseTypeIcon\" style=\"border-radius: 3px; margin: 5px;\" fxLayout=\"column\" fxLayoutAlign=\"space-around center\">\n            <tcla-live-apps-case-summary style=\"margin: 5px;\" [displayType]=\"'card'\" [typeBar]=\"true\" [configMode]=\"true\" [configModeColor]=\"caseCardConfig.cardConfig.useCaseTypeColor ? caseTypeColor : selectedStateConfig.fill\" [configModeIcon]=\"selectedStateConfig.icon\" [configModeCaseTypeColor]=\"caseTypeColor\" [configModeCaseTypeIcon]=\"caseTypeIcon\" [configModeAppTypeLabel]=\"appTypeLabel\"></tcla-live-apps-case-summary>\n            <tcla-live-apps-case-summary style=\"margin: 5px;\" [displayType]=\"'miniCard'\" [typeBar]=\"true\" [configMode]=\"true\" [configModeColor]=\"caseCardConfig.cardConfig.useCaseTypeColor ? caseTypeColor : selectedStateConfig.fill\" [configModeIcon]=\"selectedStateConfig.icon\" [configModeCaseTypeColor]=\"caseTypeColor\" [configModeCaseTypeIcon]=\"caseTypeIcon\" [configModeAppTypeLabel]=\"appTypeLabel\"></tcla-live-apps-case-summary>\n          </div>\n        </div>\n      </div>\n      <div class=\"tcs-case-card-customization-divider\"></div>\n      <div fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n        <div fxLayout=\"column\" fxLayoutAlign=\"start center\">\n          <div class=\"tcs-case-card-customization-section-text\">Configure Icons</div>\n        </div>\n        <div fxFlex>\n          <div fxFlex class=\"tcs-case-states-list\" *ngIf=\"caseCardConfig && caseCardConfig.cardConfig && caseCardConfig.states\" fxLayout=\"column\" fxLayoutAlign=\"start center\">\n            <div class=\"tcs-case-states-list-inner\">\n              <div class=\"case-type-color-toggle\">\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                  <mat-slide-toggle\n                  class=\"use-case-type-color\"\n                  [labelPosition]=\"'before'\"\n                  [checked]=\"caseCardConfig.cardConfig.useCaseTypeColor\"\n                  (change)=\"handleCaseTypeColorToggleChange($event)\">\n                  Use Case Type Color for color bar\n                  </mat-slide-toggle>\n                </div>\n              </div>\n              <div class=\"tcs-case-states-list-row\">\n                  <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <div fxLayoutAlign=\"start center\" style=\"min-width: 170px;\">Case Type Icon</div>\n                    <tcla-live-apps-state-icon style=\"margin-left: 10px; margin-right: 10px; min-width: 14px;\" #iconcomp [id]=\"appTypeLabel\" [iconPath]=\"selectedCaseTypeConfig.icon\" [color]=\"selectedCaseTypeConfig.fill\"\n                                               [appId]=\"appId\" [(colorPicker)]=\"selectedCaseTypeConfig.fill\" (colorPickerChange)=\"setCaseTypeFill($event, selectedCaseTypeConfig)\" [cpPresetColors]=\"DEFAULT_COLOR_PALETTE\" [cpPositionOffset]=\"'-40%'\"\n                                              matTooltip=\"Click to change color\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </tcla-live-apps-state-icon>\n                    <mat-icon (click)=\"openDialog(null, true)\" class=\"tcs-icon tcs-icon-active tcs-config-button tcs-document-upload-button\" svgIcon=\"tcs-document-upload\"\n                              matTooltip=\"Click to upload new icon\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </mat-icon>\n                    <mat-icon class=\"tcs-icon tcs-icon-active tcs-config-button-placeholder\"></mat-icon>\n                  </div>\n              </div>\n              <div class=\"tcs-case-states-icon-divider\"></div>\n              <!-- case state icons -->\n              <div *ngFor=\"let state of caseCardConfig.states\" class=\"tcs-case-states-list-row\" (click)=\"selectState(state)\">\n                <div *ngIf=\"getConfigForState(state); let stateConfig;\">\n                  <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <div fxLayoutAlign=\"start center\" style=\"min-width: 170px;\">{{state.label | ellipsis: 25}}</div>\n                    <tcla-live-apps-state-icon style=\"margin-left: 10px; margin-right: 10px; min-width: 14px;\" #iconcomp [id]=\"state.value\" [iconPath]=\"stateConfig.icon\" [color]=\"stateConfig.fill\"\n                                               [appId]=\"appId\" [(colorPicker)]=\"stateConfig.fill\" (colorPickerChange)=\"setFill($event, stateConfig)\" [cpPresetColors]=\"DEFAULT_COLOR_PALETTE\" [cpPositionOffset]=\"'-40%'\"\n                                              matTooltip=\"Click to change color\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </tcla-live-apps-state-icon>\n                    <mat-icon (click)=\"openDialog(state, false)\" class=\"tcs-icon tcs-icon-active tcs-config-button tcs-document-upload-button\" svgIcon=\"tcs-document-upload\"\n                              matTooltip=\"Click to upload new icon\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </mat-icon>\n                    <mat-icon class=\"tcs-icon tcs-icon-active tcs-config-button-placeholder\"></mat-icon>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  <!--div class=\"tcs-case-card-customization-footer\" fxLayout=\"column\" fxLayoutAlign=\"end stretch\">\n    <div class=\"tcs-case-card-customization-action-buttons\" fxLayout=\"row\" fxLayoutAlign=\"center center\">\n      <button class=\"tcs-save-app-config-button\" mat-button (click)=\"saveConfig()\" type=\"submit\">Save Configuration</button>\n    </div>\n  </div-->\n</div>\n",
                    styles: [".tcs-case-card-customization{min-width:775px;min-height:370px;background-color:#fff}.tcs-case-card-customization *{font-family:Source Sans Pro;font-size:12px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;text-align:center;color:#000}.case-type-color-toggle{margin-bottom:10px;margin-top:10px}.tcs-case-card-customization-header{height:40px;border-radius:3px 3px 0 0;box-shadow:0 1px 2px 0 #dedede;padding-left:20px;padding-right:20px}.tcs-case-card-customization .tcs-case-card-customization-header-text{font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:1.5;letter-spacing:.3px;text-align:left;color:#000;margin-left:10px}.tcs-case-card-customization-action-buttons{margin-top:10px;margin-bottom:10px}.tcs-case-card-customization-divider{padding:0;margin:4px 5px 0;border-left:1.1px solid #f4f4f4}.tcs-case-card-customization .tcs-case-card-customization-section-text{font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;color:#000}.tcs-case-states-list{margin:5px}.tcs-case-card-customization-preview app-live-apps-case-summary,.tcs-case-states-list-inner{overflow-y:auto}.tcs-case-states-list-row{border-radius:3px;padding:3px;margin-left:15px;margin-right:15px}.tcs-case-states-list-row:hover{-webkit-transition:background-color .5s;transition:background-color .5s;background-color:#eef0f7}.tcs-icon-active.tcs-config-button{display:none}.tcs-icon-active.tcs-config-button-placeholder{display:inline-block;width:24px}.tcs-case-states-list-row:hover .tcs-icon-active.tcs-config-button{display:inline-block}.tcs-case-states-list-row:hover .tcs-icon-active.tcs-config-button-placeholder{display:none}.tcs-case-states-icon-divider{padding:0;margin:2px 15px 4px 10px;border-bottom:1.1px solid #f4f4f4}.tcs-save-app-config-button{height:35px}"]
                }] }
    ];
    /** @nocollapse */
    LiveAppsApplicationConfigurationComponent.ctorParameters = function () { return [
        { type: HttpClient },
        { type: DomSanitizer },
        { type: LiveAppsService },
        { type: TcCaseCardConfigService },
        { type: TcDocumentService },
        { type: MatDialog },
        { type: Location }
    ]; };
    LiveAppsApplicationConfigurationComponent.propDecorators = {
        stateIconComponents: [{ type: ViewChildren, args: ['iconcomp',] }],
        caseSummaryComponent: [{ type: ViewChildren, args: [LiveAppsCaseSummaryComponent,] }],
        appId: [{ type: Input }],
        appTypeLabel: [{ type: Input }],
        sandboxId: [{ type: Input }],
        uiAppId: [{ type: Input }],
        folderId: [{ type: Input }],
        configChanged: [{ type: Output }]
    };
    return LiveAppsApplicationConfigurationComponent;
}(LiveAppsComponent));
export { LiveAppsApplicationConfigurationComponent };
if (false) {
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.stateIconComponents;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseSummaryComponent;
    /**
     * The LA Application Id
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.appId;
    /**
     * The label shown above the case type in the configuration widget
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.appTypeLabel;
    /**
     * sandboxId - this comes from claims resolver
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.sandboxId;
    /**
     * The Application ID of the UI (should ideally be unique as it is shared state key)
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.uiAppId;
    /**
     * The organisation folder to store/retrieve documents
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.folderId;
    /**
     * ~event configChanged : Configuration values changed
     * ~payload CaseCardConfig : CaseCardConfig object when configuration is changed (so called can do a save with data)
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.configChanged;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.errorMessage;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseCardConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectedStateConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectedCaseTypeConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseTypeIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseTypeColor;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_TYPE_ICON;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_TYPE_COLOR;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_STATE_ICON;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_STATE_COLOR;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_COLOR_PALETTE;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.getConfigForState;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.getConfigForCaseType;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.updateIconMap;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.handleCaseTypeColorToggleChange;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setFill;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setCaseTypeFill;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectState;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setNewStateIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setNewCaseTypeIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.refresh;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsApplicationConfigurationComponent.prototype.http;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsApplicationConfigurationComponent.prototype.sanitizer;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsApplicationConfigurationComponent.prototype.liveapps;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseCardConfigService;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsApplicationConfigurationComponent.prototype.documentsService;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.dialog;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsApplicationConfigurationComponent.prototype.location;
}
var LiveAppsStateIconUploadDialogComponent = /** @class */ (function () {
    function LiveAppsStateIconUploadDialogComponent(dialogRef, data) {
        var _this = this;
        this.dialogRef = dialogRef;
        this.data = data;
        this.fileevent = new EventEmitter();
        this.fileToUpload = undefined;
        this.description = undefined;
        this.uploadFile = (/**
         * @return {?}
         */
        function () {
            if (_this.fileToUpload) {
                _this.fileevent.emit({ file: _this.fileToUpload, state: _this.data.state, isCaseType: _this.data.isCaseType });
                _this.dialogRef.close();
            }
        });
    }
    /**
     * @param {?} description
     * @return {?}
     */
    LiveAppsStateIconUploadDialogComponent.prototype.setFileDescription = /**
     * @param {?} description
     * @return {?}
     */
    function (description) {
        this.description = description;
    };
    /**
     * @param {?} files
     * @return {?}
     */
    LiveAppsStateIconUploadDialogComponent.prototype.attachFile = /**
     * @param {?} files
     * @return {?}
     */
    function (files) {
        this.fileToUpload = files.item(0);
        /*const myReader: FileReader = new FileReader();
        myReader.readAsText(this.fileToUpload);
        this.fileText = myReader.result.toString();*/
    };
    /**
     * @return {?}
     */
    LiveAppsStateIconUploadDialogComponent.prototype.onNoClick = /**
     * @return {?}
     */
    function () {
        this.dialogRef.close();
    };
    LiveAppsStateIconUploadDialogComponent.decorators = [
        { type: Component, args: [{
                    selector: 'tcla-live-apps-state-icon-upload-dialog',
                    template: "  <h1 mat-dialog-title>Upload New Icon (svg) for '{{data.state.value}}'</h1>\n  <div mat-dialog-content class=\"tcs-state-icon-upload-dialog\">\n    <form #fileUploadForm=\"ngForm\" fxFlex fxLayout=\"column\">\n      <div fxLayout=\"row\" fxLayoutAlign=\"start space-between\">\n        <button type=\"button\" mat-raised-button (click)=\"fileInput.click()\">Choose File To Upload</button>\n        <div *ngIf=\"fileToUpload\">{{fileToUpload.name}}</div>\n        <!-- below input is hidden and enabled by above button -->\n        <input class=\"tcs-hidden-input\" (change)=\"attachFile($event.target.files)\" accept=\"image/svg+xml\" #fileInput type=\"file\" id=\"file\">\n      </div>\n    </form>\n  </div>\n  <div mat-dialog-actions>\n    <button mat-button (click)=\"uploadFile()\" type=\"submit\" [disabled]=\"!fileToUpload\">Upload</button>\n    <button mat-button (click)=\"onNoClick()\">Cancel</button>\n  </div>\n",
                    styles: [".tcs-hidden-input{display:none}"]
                }] }
    ];
    /** @nocollapse */
    LiveAppsStateIconUploadDialogComponent.ctorParameters = function () { return [
        { type: MatDialogRef },
        { type: undefined, decorators: [{ type: Inject, args: [MAT_DIALOG_DATA,] }] }
    ]; };
    LiveAppsStateIconUploadDialogComponent.propDecorators = {
        fileevent: [{ type: Output }]
    };
    return LiveAppsStateIconUploadDialogComponent;
}());
export { LiveAppsStateIconUploadDialogComponent };
if (false) {
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileevent;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileToUpload;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.description;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileText;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.uploadFile;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.dialogRef;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.data;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHRpYmNvLXRjc3RrL3RjLWxpdmVhcHBzLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2xpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uL2xpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFjQSxPQUFPLEVBQ0wsU0FBUyxFQUNULFlBQVksRUFDWixNQUFNLEVBQ04sS0FBSyxFQUlMLE1BQU0sRUFDTixTQUFTLEVBRVQsWUFBWSxFQUNiLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxrQ0FBa0MsQ0FBQztBQUNqRSxPQUFPLEVBQWEsYUFBYSxFQUFFLE9BQU8sRUFBQyxNQUFNLDJCQUEyQixDQUFDO0FBQzdFLE9BQU8sRUFBTSxJQUFJLEVBQUUsU0FBUyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDcEQsT0FBTyxFQUFDLFVBQVUsRUFBYyxNQUFNLHNCQUFzQixDQUFDO0FBQzdELE9BQU8sRUFBQyxZQUFZLEVBQVcsTUFBTSwyQkFBMkIsQ0FBQztBQUdqRSxPQUFPLEVBQUMsNEJBQTRCLEVBQUMsTUFBTSw0REFBNEQsQ0FBQztBQUN4RyxPQUFPLEVBQUMsZUFBZSxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUUzRSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDM0MsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sc0RBQXNELENBQUM7QUFFdkYsT0FBTyxFQUFDLGNBQWMsRUFBRSxtQkFBbUIsRUFBRSxrQkFBa0IsRUFBRSx1QkFBdUIsRUFBQyxNQUFNLDRDQUE0QyxDQUFDO0FBQzVJLE9BQU8sRUFB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QVcsR0FBRyxXQUFXLENBQUM7SUFDakMsQ0FBQzs7Ozs7SUFFRCwyREFBVTs7OztJQUFWLFVBQVcsS0FBZTtRQUN4QixJQUFJLENBQUMsWUFBWSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEM7O3FEQUU2QztJQUMvQyxDQUFDOzs7O0lBRUQsMERBQVM7OztJQUFUO1FBQ0UsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUN6QixDQUFDOztnQkFsQ0YsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSx5Q0FBeUM7b0JBQ25ELHc2QkFBNkU7O2lCQUU5RTs7OztnQkE5UW1DLFlBQVk7Z0RBc1I2QixNQUFNLFNBQUMsZUFBZTs7OzRCQU5oRyxNQUFNOztJQThCVCw2Q0FBQztDQUFBLEFBcENELElBb0NDO1NBL0JZLHNDQUFzQzs7O0lBQ2pELDJEQUE4Qzs7SUFDOUMsOERBQXNDOztJQUN0Qyw2REFBdUM7O0lBQ3ZDLDBEQUF3Qjs7SUFLeEIsNERBS0M7O0lBUEMsMkRBQXNFOztJQUFFLHNEQUF5QyIsInNvdXJjZXNDb250ZW50IjpbIlxuLypcbiogICAgIENhc2UgVHlwZSBpY29ucyBhcmUgc3RvcmVkIGluIGFuIG9yZ0ZvbGRlciBzcGVjaWZpZWQgaW4gbGl2ZUFwcHNDb25maWcuanNvbiAocHVzaGVkIHRvIHNoYXJlZCBzdGF0ZSlcbiogICAgIEljb24gTmFtZSB3aWxsIGJlIGFwcElkLmZpbGVuYW1lLnN2Z1xuKiAgICAgSWNvbiBzdmcgc2hvdWxkIGNvbnRhaW4gPERZTkFNSUNGSUxMPiB0aGlzIHdpbGwgYmUgc2V0IGFjY29yZGluZyB0byB0aGUgY29sb3Igc2VsZWN0ZWQgaW4gdGhpcyBjb21wb25lbnRcbipcbiogICAgIGVnOiAxNzQyLmljLWNyZWF0ZWQuc3ZnIGZvciBQYXJ0bmVyIFBvcnRhbCBMaXZlIEFwcHMgQXBwIChhcHBJZDogMTc0MikgJ0NyZWF0ZWQnIHN0YXRlXG4qXG4qICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE0XCIgaGVpZ2h0PVwiMTRcIiB2aWV3Qm94PVwiMCAwIDE0IDE0XCI+XG4qICAgICAgICA8cGF0aCBmaWxsPVwiPERZTkFNSUNGSUxMPlwiIGNsYXNzPVwic3ZnLWNvbnRlbnRcIiBmaWxsLXJ1bGU9XCJldmVub2RkXCIgZD1cIk03IDE0QTcgNyAwIDEgMSA3IDBhNyA3IDAgMCAxIDAgMTR6bTMuNDc0LTYuNDcyYS41MjcuNTI3IDAgMCAwIDAtMS4wNTNINy41MjZWMy41MjdhLjUyNS41MjUgMCAxIDAtMS4wNTIgMHYyLjk0OEgzLjUyNmEuNTI3LjUyNyAwIDAgMCAwIDEuMDUzaDIuOTQ4djIuOTQ4YS41MjUuNTI1IDAgMCAwIC44OTguMzczLjUyNS41MjUgMCAwIDAgLjE1NC0uMzczVjcuNTI4aDIuOTQ4elwiLz5cbiogICAgICA8L3N2Zz5cbipcbipcbiAqL1xuaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBFdmVudEVtaXR0ZXIsXG4gIEluamVjdCxcbiAgSW5wdXQsXG4gIE9uQ2hhbmdlcyxcbiAgT25EZXN0cm95LFxuICBPbkluaXQsXG4gIE91dHB1dCxcbiAgUXVlcnlMaXN0LCBTaW1wbGVDaGFuZ2VzLFxuICBWaWV3Q2hpbGQsXG4gIFZpZXdDaGlsZHJlblxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7T2JzZXJ2YWJsZSwgb2YsIFN1YmplY3R9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtMaXZlQXBwc1NlcnZpY2V9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2xpdmUtYXBwcy5zZXJ2aWNlJztcbmltcG9ydCB7Q2FyZENvbmZpZywgQ2FzZVR5cGVTdGF0ZSwgSWNvbk1hcH0gZnJvbSAnLi4vLi4vbW9kZWxzL2xpdmVhcHBzZGF0YSc7XG5pbXBvcnQge21hcCwgdGFrZSwgdGFrZVVudGlsfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQge0h0dHBDbGllbnQsIEh0dHBIZWFkZXJzfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQge0RvbVNhbml0aXplciwgU2FmZUh0bWx9IGZyb20gJ0Bhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXInO1xuaW1wb3J0IHtMaXZlQXBwc0Nhc2VEYXRhQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtY2FzZS1kYXRhL2xpdmUtYXBwcy1jYXNlLWRhdGEuY29tcG9uZW50JztcbmltcG9ydCB7TGl2ZUFwcHNTdGF0ZUljb25Db21wb25lbnR9IGZyb20gJy4uL2xpdmUtYXBwcy1zdGF0ZS1pY29uL2xpdmUtYXBwcy1zdGF0ZS1pY29uLmNvbXBvbmVudCc7XG5pbXBvcnQge0xpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnR9IGZyb20gJy4uL2xpdmUtYXBwcy1jYXNlLXN1bW1hcnkvbGl2ZS1hcHBzLWNhc2Utc3VtbWFyeS5jb21wb25lbnQnO1xuaW1wb3J0IHtNQVRfRElBTE9HX0RBVEEsIE1hdERpYWxvZywgTWF0RGlhbG9nUmVmfSBmcm9tICdAYW5ndWxhci9tYXRlcmlhbCc7XG5pbXBvcnQge0xpdmVBcHBzRG9jdW1lbnRVcGxvYWREaWFsb2dDb21wb25lbnR9IGZyb20gJy4uL2xpdmUtYXBwcy1kb2N1bWVudHMvbGl2ZS1hcHBzLWRvY3VtZW50cy5jb21wb25lbnQnO1xuaW1wb3J0IHsgTG9jYXRpb24gfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHtMaXZlQXBwc0NvbXBvbmVudH0gZnJvbSAnLi4vbGl2ZS1hcHBzLWNvbXBvbmVudC9saXZlLWFwcHMtY29tcG9uZW50LmNvbXBvbmVudCc7XG5pbXBvcnQge0Nhc2VDYXJkQ29uZmlnfSBmcm9tICcuLi8uLi9tb2RlbHMvdGMtY2FzZS1jYXJkLWNvbmZpZyc7XG5pbXBvcnQge0RFRkFVTFRfQ09MT1JTLCBERUZBVUxUX1NUQVRFX0NPTE9SLCBERUZBVUxUX1RZUEVfQ09MT1IsIFRjQ2FzZUNhcmRDb25maWdTZXJ2aWNlfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy90Yy1jYXNlLWNhcmQtY29uZmlnLnNlcnZpY2UnO1xuaW1wb3J0IHtUY0RvY3VtZW50U2VydmljZX0gZnJvbSAnLi4vLi4vc2VydmljZXMvdGMtZG9jdW1lbnQuc2VydmljZSc7XG5cblxuXG4vKipcbiAqIE1hbmFnZXMgc3VtbWFyeSBjYXJkIGNvbmZpZ3VyYXRpb25cbiAqXG4gKkBleGFtcGxlIDx0Y2xhLWxpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uPjwvdGNsYS1saXZlLWFwcHMtYXBwbGljYXRpb24tY29uZmlndXJhdGlvbj5cbiAqL1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd0Y2xhLWxpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2xpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vbGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24uY29tcG9uZW50LmNzcyddXG59KVxuZXhwb3J0IGNsYXNzIExpdmVBcHBzQXBwbGljYXRpb25Db25maWd1cmF0aW9uQ29tcG9uZW50IGV4dGVuZHMgTGl2ZUFwcHNDb21wb25lbnQgaW1wbGVtZW50cyBPbkNoYW5nZXMge1xuICAvLyBUaGUgVmlld0NoaWxkIGRlY2xhcmF0aW9ucyBnaXZlIGFjY2VzcyB0byBjb21wb25lbnRzIG1hcmtlZCBvbiB0aGUgdGVtcGxhdGUgc28gdGhhdCBJIGNhbiBjYWxsIHB1YmxpYyBmdW5jdGlvbnMgbGlrZSByZWZyZXNoXG4gIEBWaWV3Q2hpbGRyZW4oJ2ljb25jb21wJykgc3RhdGVJY29uQ29tcG9uZW50czogUXVlcnlMaXN0PExpdmVBcHBzU3RhdGVJY29uQ29tcG9uZW50PjtcbiAgQFZpZXdDaGlsZHJlbihMaXZlQXBwc0Nhc2VTdW1tYXJ5Q29tcG9uZW50KSBjYXNlU3VtbWFyeUNvbXBvbmVudDogUXVlcnlMaXN0PExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQ+O1xuXG4gIC8qKlxuICAgKiBUaGUgTEEgQXBwbGljYXRpb24gSWRcbiAgICovXG4gIEBJbnB1dCgpIGFwcElkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBsYWJlbCBzaG93biBhYm92ZSB0aGUgY2FzZSB0eXBlIGluIHRoZSBjb25maWd1cmF0aW9uIHdpZGdldFxuICAgKi9cbiAgQElucHV0KCkgYXBwVHlwZUxhYmVsOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIHNhbmRib3hJZCAtIHRoaXMgY29tZXMgZnJvbSBjbGFpbXMgcmVzb2x2ZXJcbiAgICovXG4gIEBJbnB1dCgpIHNhbmRib3hJZDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgQXBwbGljYXRpb24gSUQgb2YgdGhlIFVJIChzaG91bGQgaWRlYWxseSBiZSB1bmlxdWUgYXMgaXQgaXMgc2hhcmVkIHN0YXRlIGtleSlcbiAgICovXG4gIEBJbnB1dCgpIHVpQXBwSWQ6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIG9yZ2FuaXNhdGlvbiBmb2xkZXIgdG8gc3RvcmUvcmV0cmlldmUgZG9jdW1lbnRzXG4gICAqL1xuICBASW5wdXQoKSBmb2xkZXJJZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiB+ZXZlbnQgY29uZmlnQ2hhbmdlZCA6IENvbmZpZ3VyYXRpb24gdmFsdWVzIGNoYW5nZWRcbiAgICogfnBheWxvYWQgQ2FzZUNhcmRDb25maWcgOiBDYXNlQ2FyZENvbmZpZyBvYmplY3Qgd2hlbiBjb25maWd1cmF0aW9uIGlzIGNoYW5nZWQgKHNvIGNhbGxlZCBjYW4gZG8gYSBzYXZlIHdpdGggZGF0YSlcbiAgICovXG4gIEBPdXRwdXQoKSBjb25maWdDaGFuZ2VkOiBFdmVudEVtaXR0ZXI8Q2FzZUNhcmRDb25maWc+ID0gbmV3IEV2ZW50RW1pdHRlcjxDYXNlQ2FyZENvbmZpZz4oKTtcblxuICBwdWJsaWMgZXJyb3JNZXNzYWdlOiBzdHJpbmc7XG4gIHB1YmxpYyBjYXNlQ2FyZENvbmZpZzogQ2FzZUNhcmRDb25maWc7XG4gIHB1YmxpYyBzZWxlY3RlZFN0YXRlQ29uZmlnOiBJY29uTWFwO1xuICBwdWJsaWMgc2VsZWN0ZWRDYXNlVHlwZUNvbmZpZzogSWNvbk1hcDtcbiAgcHVibGljIGNhc2VUeXBlSWNvbjogc3RyaW5nO1xuICBwdWJsaWMgY2FzZVR5cGVDb2xvcjogc3RyaW5nO1xuXG4gIC8vIHByZXBhcmVFeHRlcm5hbFVybCB3aWxsIGFkZCB0aGUgYmFzZSBocmVmXG4gIHB1YmxpYyBERUZBVUxUX0NBU0VfVFlQRV9JQ09OID0gJ2Fzc2V0cy9pY29ucy9pYy1nZW5lcmljLWNhc2V0eXBlLnN2Zyc7XG4gIHB1YmxpYyBERUZBVUxUX0NBU0VfVFlQRV9DT0xPUiA9IERFRkFVTFRfVFlQRV9DT0xPUjtcbiAgcHVibGljIERFRkFVTFRfQ0FTRV9TVEFURV9JQ09OID0gJ2Fzc2V0cy9pY29ucy9pYy1nZW5lcmljLXN0YXRlLnN2Zyc7XG4gIHB1YmxpYyBERUZBVUxUX0NBU0VfU1RBVEVfQ09MT1IgPSBERUZBVUxUX1NUQVRFX0NPTE9SO1xuICBwdWJsaWMgREVGQVVMVF9DT0xPUl9QQUxFVFRFID0gREVGQVVMVF9DT0xPUlM7XG5cbiAgcHVibGljIGdldENvbmZpZ0ZvclN0YXRlID0gKHN0YXRlOiBDYXNlVHlwZVN0YXRlKTogSWNvbk1hcCA9PiB7XG4gICAgbGV0IHJlcUljb25NYXA6IEljb25NYXA7XG4gICAgaWYgKHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZyAmJiB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXApIHtcbiAgICAgIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcC5mb3JFYWNoKChzdGF0ZU1hcCkgPT4ge1xuICAgICAgICBpZiAoc3RhdGVNYXAuc3RhdGUgPT09IHN0YXRlLnZhbHVlKSB7XG4gICAgICAgICAgcmVxSWNvbk1hcCA9IHN0YXRlTWFwO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcUljb25NYXAgPyByZXFJY29uTWFwIDogbmV3IEljb25NYXAoZmFsc2UsIHN0YXRlLnZhbHVlLCB0aGlzLkRFRkFVTFRfQ0FTRV9TVEFURV9DT0xPUiwgdGhpcy5ERUZBVUxUX0NBU0VfU1RBVEVfSUNPTik7XG4gIH1cblxuICBwdWJsaWMgZ2V0Q29uZmlnRm9yQ2FzZVR5cGUgPSAoY2FzZVR5cGVJZDogc3RyaW5nKTogSWNvbk1hcCA9PiB7XG4gICAgbGV0IHJlcUljb25NYXA6IEljb25NYXA7XG4gICAgaWYgKHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZyAmJiB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXApIHtcbiAgICAgIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcC5mb3JFYWNoKChzdGF0ZU1hcCkgPT4ge1xuICAgICAgICBpZiAoc3RhdGVNYXAuaXNDYXNlVHlwZSkge1xuICAgICAgICAgIHJlcUljb25NYXAgPSBzdGF0ZU1hcDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiByZXFJY29uTWFwID8gcmVxSWNvbk1hcCA6IG5ldyBJY29uTWFwKHRydWUsIGNhc2VUeXBlSWQsIHRoaXMuREVGQVVMVF9DQVNFX1RZUEVfQ09MT1IsIHRoaXMuREVGQVVMVF9DQVNFX1RZUEVfSUNPTik7XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlSWNvbk1hcCA9IChzdGF0ZUNvbmZpZzogSWNvbk1hcCkgPT4ge1xuICAgIGxldCBmb3VuZE1hcDogSWNvbk1hcDtcbiAgICBsZXQgdXBkYXRlZE1hcDogSWNvbk1hcDtcbiAgICBpZiAodGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnICYmIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcCkge1xuICAgICAgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwLmZvckVhY2goZnVuY3Rpb24oc3RhdGVNYXApIHtcbiAgICAgICAgaWYgKHN0YXRlTWFwLnN0YXRlID09PSBzdGF0ZUNvbmZpZy5zdGF0ZSkge1xuICAgICAgICAgIGZvdW5kTWFwID0gc3RhdGVDb25maWc7XG4gICAgICAgICAgc3RhdGVNYXAuc3RhdGUgPSBzdGF0ZUNvbmZpZy5zdGF0ZTtcbiAgICAgICAgICBzdGF0ZU1hcC5pY29uID0gc3RhdGVDb25maWcuaWNvbjtcbiAgICAgICAgICBzdGF0ZU1hcC5maWxsID0gc3RhdGVDb25maWcuZmlsbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoZm91bmRNYXApIHtcbiAgICAgICAgZm91bmRNYXAgPSBzdGF0ZUNvbmZpZztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcC5wdXNoKHN0YXRlQ29uZmlnKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwID0gW107XG4gICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXAucHVzaChzdGF0ZUNvbmZpZyk7XG4gICAgfVxuICAgIHRoaXMuY29uZmlnQ2hhbmdlZC5lbWl0KHRoaXMuY2FzZUNhcmRDb25maWcpO1xuICB9XG5cbiAgcHVibGljIGhhbmRsZUNhc2VUeXBlQ29sb3JUb2dnbGVDaGFuZ2UgPSAoY2hhbmdlcykgPT4ge1xuICAgIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy51c2VDYXNlVHlwZUNvbG9yID0gY2hhbmdlcy5jaGVja2VkID8gY2hhbmdlcy5jaGVja2VkIDogZmFsc2U7XG4gICAgaWYgKGNoYW5nZXMuY2hlY2tlZCkge1xuICAgICAgdGhpcy5jYXNlU3VtbWFyeUNvbXBvbmVudC5mb3JFYWNoKChjb21wOiBMaXZlQXBwc0Nhc2VTdW1tYXJ5Q29tcG9uZW50KSA9PiB7XG4gICAgICAgIGNvbXAucmVzdHlsZVByZXZpZXcodGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLmljb24sIHRoaXMuY2FzZVR5cGVDb2xvcik7XG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhpcy5jb25maWdDaGFuZ2VkLmVtaXQodGhpcy5jYXNlQ2FyZENvbmZpZyk7XG4gIH1cblxuICBwdWJsaWMgc2V0RmlsbCA9IChmaWxsLCBzdGF0ZUNvbmZpZzogSWNvbk1hcCkgPT4ge1xuICAgIHRoaXMuY2FzZVN1bW1hcnlDb21wb25lbnQuZm9yRWFjaCgoY29tcDogTGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudCkgPT4ge1xuICAgICAgY29tcC5yZXN0eWxlUHJldmlldyhzdGF0ZUNvbmZpZy5pY29uLCBmaWxsKTtcbiAgICB9KTtcbiAgICB0aGlzLnN0YXRlSWNvbkNvbXBvbmVudHMuZmluZChmdW5jdGlvbihjb21wKSB7XG4gICAgICByZXR1cm4gY29tcC5pZCA9PT0gc3RhdGVDb25maWcuc3RhdGU7XG4gICAgfSkucmVmaWxsU1ZHKGZpbGwpO1xuICAgIHRoaXMuY29uZmlnQ2hhbmdlZC5lbWl0KHRoaXMuY2FzZUNhcmRDb25maWcpO1xuICB9XG5cbiAgcHVibGljIHNldENhc2VUeXBlRmlsbCA9IChmaWxsLCBzdGF0ZUNvbmZpZzogSWNvbk1hcCkgPT4ge1xuICAgIHRoaXMuY2FzZVN1bW1hcnlDb21wb25lbnQuZm9yRWFjaCgoY29tcDogTGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudCkgPT4ge1xuICAgICAgY29tcC5yZXN0eWxlUHJldmlld0Nhc2VUeXBlKHN0YXRlQ29uZmlnLmljb24sIGZpbGwpO1xuICAgIH0pO1xuICAgIHRoaXMuc3RhdGVJY29uQ29tcG9uZW50cy5maW5kKGZ1bmN0aW9uKGNvbXApIHtcbiAgICAgIHJldHVybiAoY29tcC5pZCA9PT0gc3RhdGVDb25maWcuc3RhdGUgJiYgc3RhdGVDb25maWcuaXNDYXNlVHlwZSk7XG4gICAgfSkucmVmaWxsU1ZHKGZpbGwpO1xuICAgIHRoaXMuY29uZmlnQ2hhbmdlZC5lbWl0KHRoaXMuY2FzZUNhcmRDb25maWcpO1xuICB9XG5cbiAgcHVibGljIHNlbGVjdFN0YXRlID0gKHN0YXRlOiBDYXNlVHlwZVN0YXRlKSA9PiB7XG4gICAgdGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnID0gdGhpcy5nZXRDb25maWdGb3JTdGF0ZShzdGF0ZSk7XG4gICAgaWYgKCF0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcudXNlQ2FzZVR5cGVDb2xvcikge1xuICAgICAgdGhpcy5jYXNlU3VtbWFyeUNvbXBvbmVudC5mb3JFYWNoKChjb21wOiBMaXZlQXBwc0Nhc2VTdW1tYXJ5Q29tcG9uZW50KSA9PiB7XG4gICAgICAgIGNvbXAucmVzdHlsZVByZXZpZXcodGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLmljb24sIHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5maWxsKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIC8qcHVibGljIHNhdmVDb25maWcgPSAoKSA9PiB7XG4gICAgdGhpcy5jYXNlQ2FyZENvbmZpZ1NlcnZpY2UudXBkYXRlQ2FzZUNhcmRDb25maWcodGhpcy5zYW5kYm94SWQsIHRoaXMuYXBwSWQsIHRoaXMudWlBcHBJZCwgdGhpcy5jYXNlQ2FyZENvbmZpZylcbiAgICAgIC5waXBlKFxuICAgICAgICB0YWtlKDEpLFxuICAgICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveWVkJCksXG4gICAgICAgIG1hcChjYXNlQ2FyZENvbmZpZyA9PiB7XG4gICAgICAgICAgdGhpcy5jYXNlQ2FyZENvbmZpZyA9IGNhc2VDYXJkQ29uZmlnO1xuICAgICAgICB9KVxuICAgICAgKS5zdWJzY3JpYmUobnVsbCwgZXJyb3IgPT4geyBjb25zb2xlLmxvZygnVW5hYmxlIHRvIHVwZGF0ZSBjYXNlIGNhcmQgY29uZmlnOiAnICsgZXJyb3IuZXJyb3JNc2cpOyB9XG4gICAgKTtcbiAgfSovXG5cbiAgcHVibGljIG9wZW5EaWFsb2coc3RhdGU6IENhc2VUeXBlU3RhdGUsIGlzQ2FzZVR5cGU6IGJvb2xlYW4pOiB2b2lkIHtcblxuICAgIGlmICghaXNDYXNlVHlwZSkge1xuICAgICAgdGhpcy5zZWxlY3RTdGF0ZShzdGF0ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0YXRlID0gbmV3IENhc2VUeXBlU3RhdGUoKS5kZXNlcmlhbGl6ZSh7IHZhbHVlOiB0aGlzLmFwcFR5cGVMYWJlbCB9KTtcbiAgICB9XG4gICAgY29uc3QgZGlhbG9nUmVmID0gdGhpcy5kaWFsb2cub3BlbihMaXZlQXBwc1N0YXRlSWNvblVwbG9hZERpYWxvZ0NvbXBvbmVudCwge1xuICAgICAgd2lkdGg6ICc1MDBweCcsXG4gICAgICBkYXRhOiB7IHN0YXRlOiBzdGF0ZSwgaXNDYXNlVHlwZTogaXNDYXNlVHlwZSB9XG4gICAgfSk7XG5cbiAgICBkaWFsb2dSZWYuY29tcG9uZW50SW5zdGFuY2UuZmlsZWV2ZW50LnN1YnNjcmliZSgoJGUpID0+IHtcbiAgICAgIHRoaXMudXBsb2FkRmlsZSgkZS5maWxlLCAkZS5zdGF0ZSwgJGUuaXNDYXNlVHlwZSk7XG4gICAgfSlcblxuICAgIGRpYWxvZ1JlZi5hZnRlckNsb3NlZCgpLnN1YnNjcmliZShyZXN1bHQgPT4ge1xuICAgIH0pO1xuICB9XG5cbiAgcHVibGljIHNldE5ld1N0YXRlSWNvbiA9ICh1cmwpID0+IHtcbiAgICB0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuaWNvbiA9IHVybDtcbiAgICB0aGlzLnN0YXRlSWNvbkNvbXBvbmVudHMuZmluZCgoY29tcDogTGl2ZUFwcHNTdGF0ZUljb25Db21wb25lbnQpID0+IHtcbiAgICAgIHJldHVybiAoY29tcC5pZCA9PT0gdGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLnN0YXRlKTtcbiAgICB9KS5yZWZyZXNoKHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5pY29uLCB0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuZmlsbCk7XG4gICAgdGhpcy5jYXNlU3VtbWFyeUNvbXBvbmVudC5mb3JFYWNoKChjb21wOiBMaXZlQXBwc0Nhc2VTdW1tYXJ5Q29tcG9uZW50KSA9PiB7XG4gICAgICBjb21wLnJlc3R5bGVQcmV2aWV3KHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5pY29uLCB0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuZmlsbCk7XG4gICAgfSk7XG4gICAgdGhpcy51cGRhdGVJY29uTWFwKHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZyk7XG4gIH1cblxuICBwdWJsaWMgc2V0TmV3Q2FzZVR5cGVJY29uID0gKHVybCkgPT4ge1xuICAgIHRoaXMuY2FzZVR5cGVJY29uID0gdXJsO1xuICAgIHRoaXMuc3RhdGVJY29uQ29tcG9uZW50cy5maW5kKChjb21wOiBMaXZlQXBwc1N0YXRlSWNvbkNvbXBvbmVudCkgPT4ge1xuICAgICAgcmV0dXJuIChjb21wLmlkID09PSB0aGlzLmFwcFR5cGVMYWJlbCk7XG4gICAgfSkucmVmcmVzaCh0aGlzLmNhc2VUeXBlSWNvbiwgdGhpcy5jYXNlVHlwZUNvbG9yKTtcbiAgICB0aGlzLmNhc2VTdW1tYXJ5Q29tcG9uZW50LmZvckVhY2goKGNvbXA6IExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQpID0+IHtcbiAgICAgIGNvbXAucmVzdHlsZVByZXZpZXdDYXNlVHlwZSh0aGlzLmNhc2VUeXBlSWNvbiwgdGhpcy5jYXNlVHlwZUNvbG9yKTtcbiAgICB9KTtcbiAgICB0aGlzLnVwZGF0ZUljb25NYXAobmV3IEljb25NYXAodHJ1ZSwgdGhpcy5hcHBUeXBlTGFiZWwsIHRoaXMuY2FzZVR5cGVDb2xvciwgdGhpcy5jYXNlVHlwZUljb24pKTtcbiAgfVxuXG4gIHB1YmxpYyB1cGxvYWRGaWxlKGZpbGU6IEZpbGUsIHN0YXRlOiBDYXNlVHlwZVN0YXRlLCBpc1N0YXRlSWNvbjogYm9vbGVhbikge1xuICAgIGlmIChmaWxlKSB7XG4gICAgICBjb25zdCB1cmwgPSAnd2VicmVzb3VyY2UvdjEvb3JnRm9sZGVycy8nICsgdGhpcy5mb2xkZXJJZCArICcvJyArIHRoaXMuYXBwSWQgKyAnLicgKyBmaWxlLm5hbWU7XG4gICAgICBjb25zdCBkbFVybCA9ICd3ZWJyZXNvdXJjZS9vcmdGb2xkZXJzLycgKyB0aGlzLmZvbGRlcklkICsgJy8nICsgdGhpcy5hcHBJZCArICcuJyArIGZpbGUubmFtZTtcbiAgICAgIHRoaXMubGl2ZWFwcHMuY2xlYXJGcm9tSWNvblNWR1RleHRDYWNoZSh1cmwpO1xuICAgICAgdGhpcy5kb2N1bWVudHNTZXJ2aWNlLnVwbG9hZERvY3VtZW50KCdvcmdGb2xkZXJzJywgdGhpcy5mb2xkZXJJZCwgdGhpcy5zYW5kYm94SWQsXG4gICAgICAgIGZpbGUsICh0aGlzLmFwcElkICsgJy4nICsgZmlsZS5uYW1lKSwgJycpXG4gICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgdmFsID0+IHtcbiAgICAgICAgICAgIGlmICghaXNTdGF0ZUljb24pIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXROZXdTdGF0ZUljb24oZGxVcmwpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdGhpcy5zZXROZXdDYXNlVHlwZUljb24oZGxVcmwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXJyb3IgPT4geyBjb25zb2xlLmxvZygnZXJyb3InKTsgdGhpcy5lcnJvck1lc3NhZ2UgPSAnRXJyb3IgdXBsb2FkaW5nIHN0YXRlIGljb246ICcgKyBlcnJvci5lcnJvck1zZzsgfSk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHJlZnJlc2ggPSAoKSA9PiB7XG4gICAgLy8gbmVlZCBzdGF0ZXMgJiBjYXJkQ29uZmlnXG4gICAgdGhpcy5zZWxlY3RlZENhc2VUeXBlQ29uZmlnID0gbnVsbDtcbiAgICB0aGlzLmNhc2VDYXJkQ29uZmlnU2VydmljZS5nZXRDYXNlQ2FyZENvbmZpZyh0aGlzLnNhbmRib3hJZCwgdGhpcy5hcHBJZCwgdGhpcy51aUFwcElkLCB0aGlzLmFwcFR5cGVMYWJlbCwgdGhpcy5ERUZBVUxUX0NBU0VfVFlQRV9DT0xPUiwgdGhpcy5ERUZBVUxUX0NBU0VfVFlQRV9JQ09OLCB0aGlzLkRFRkFVTFRfQ0FTRV9TVEFURV9DT0xPUiwgdGhpcy5ERUZBVUxUX0NBU0VfU1RBVEVfSUNPTikucGlwZShcbiAgICAgIHRha2UoMSksXG4gICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveWVkJClcbiAgICApLnN1YnNjcmliZShcbiAgICAgIGNhc2VDYXJkQ29uZmlnID0+IHtcbiAgICAgICAgdGhpcy5jYXNlQ2FyZENvbmZpZyA9IGNhc2VDYXJkQ29uZmlnO1xuICAgICAgICAvLyBzZXQgZGVmYXVsdCBzZWxlY3RlZCB0byBmaXJzdCBzdGF0ZSBmb3IgdGhpcyBjYXNlIHR5cGUgKDAgaXMgY2FzZSB0eXBlKVxuICAgICAgICB0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcgPSB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXBbMV07XG4gICAgICAgIGNvbnN0IGNhc2VUeXBlUmVjID0gdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwLmZpbmQoZnVuY3Rpb24oc3RhdGVNYXApIHtcbiAgICAgICAgICByZXR1cm4gc3RhdGVNYXAuaXNDYXNlVHlwZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5jYXNlVHlwZUljb24gPSBjYXNlVHlwZVJlYy5pY29uO1xuICAgICAgICB0aGlzLmNhc2VUeXBlQ29sb3IgPSBjYXNlVHlwZVJlYy5maWxsO1xuICAgICAgICB0aGlzLnNlbGVjdGVkQ2FzZVR5cGVDb25maWcgPSB0aGlzLmdldENvbmZpZ0ZvckNhc2VUeXBlKHRoaXMuYXBwVHlwZUxhYmVsKVxuICAgICAgfSwgZXJyb3IgPT4geyB0aGlzLmVycm9yTWVzc2FnZSA9ICdFcnJvciByZXRyaWV2aW5nIGNhc2UgY2FyZCBjb25maWc6ICcgKyBlcnJvci5lcnJvci5lcnJvck1zZzsgfSk7XG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgaHR0cDogSHR0cENsaWVudCwgcHJvdGVjdGVkIHNhbml0aXplcjogRG9tU2FuaXRpemVyLFxuICAgICAgICAgICAgICBwcm90ZWN0ZWQgbGl2ZWFwcHM6IExpdmVBcHBzU2VydmljZSwgcHVibGljIGNhc2VDYXJkQ29uZmlnU2VydmljZTogVGNDYXNlQ2FyZENvbmZpZ1NlcnZpY2UsIHByb3RlY3RlZCBkb2N1bWVudHNTZXJ2aWNlOiBUY0RvY3VtZW50U2VydmljZSwgcHVibGljIGRpYWxvZzogTWF0RGlhbG9nLCBwcm90ZWN0ZWQgbG9jYXRpb246IExvY2F0aW9uKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICBpZiAoY2hhbmdlcy5hcHBJZCAmJiAoY2hhbmdlcy5hcHBJZC5jdXJyZW50VmFsdWUgIT09IGNoYW5nZXMuYXBwSWQucHJldmlvdXNWYWx1ZSkpIHtcbiAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG5cbn1cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGNsYS1saXZlLWFwcHMtc3RhdGUtaWNvbi11cGxvYWQtZGlhbG9nJyxcbiAgdGVtcGxhdGVVcmw6ICd1cGxvYWQtZmlsZS1kaWFsb2cvYXBwLWxpdmUtYXBwcy1zdGF0ZS1pY29uLXVwbG9hZC1kaWFsb2cuaHRtbCcsXG4gIHN0eWxlVXJsczogWyAndXBsb2FkLWZpbGUtZGlhbG9nL2FwcC1saXZlLWFwcHMtc3RhdGUtaWNvbi11cGxvYWQtZGlhbG9nLmNzcyddXG59KVxuZXhwb3J0IGNsYXNzIExpdmVBcHBzU3RhdGVJY29uVXBsb2FkRGlhbG9nQ29tcG9uZW50IHtcbiAgQE91dHB1dCgpIGZpbGVldmVudCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICBwdWJsaWMgZmlsZVRvVXBsb2FkOiBGaWxlID0gdW5kZWZpbmVkO1xuICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyA9IHVuZGVmaW5lZDtcbiAgcHVibGljIGZpbGVUZXh0OiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIGRpYWxvZ1JlZjogTWF0RGlhbG9nUmVmPExpdmVBcHBzU3RhdGVJY29uVXBsb2FkRGlhbG9nQ29tcG9uZW50PiwgQEluamVjdChNQVRfRElBTE9HX0RBVEEpIHB1YmxpYyBkYXRhOiBhbnkpIHt9XG5cbiAgcHVibGljIHVwbG9hZEZpbGUgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuZmlsZVRvVXBsb2FkKSB7XG4gICAgICB0aGlzLmZpbGVldmVudC5lbWl0KHsgZmlsZTogdGhpcy5maWxlVG9VcGxvYWQsIHN0YXRlOiB0aGlzLmRhdGEuc3RhdGUsIGlzQ2FzZVR5cGU6IHRoaXMuZGF0YS5pc0Nhc2VUeXBlIH0gKTtcbiAgICAgIHRoaXMuZGlhbG9nUmVmLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RmlsZURlc2NyaXB0aW9uKGRlc2NyaXB0aW9uOiBzdHJpbmcpIHtcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gIH1cblxuICBhdHRhY2hGaWxlKGZpbGVzOiBGaWxlTGlzdCkge1xuICAgIHRoaXMuZmlsZVRvVXBsb2FkID0gZmlsZXMuaXRlbSgwKTtcbiAgICAvKmNvbnN0IG15UmVhZGVyOiBGaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICBteVJlYWRlci5yZWFkQXNUZXh0KHRoaXMuZmlsZVRvVXBsb2FkKTtcbiAgICB0aGlzLmZpbGVUZXh0ID0gbXlSZWFkZXIucmVzdWx0LnRvU3RyaW5nKCk7Ki9cbiAgfVxuXG4gIG9uTm9DbGljaygpOiB2b2lkIHtcbiAgICB0aGlzLmRpYWxvZ1JlZi5jbG9zZSgpO1xuICB9XG5cbn1cblxuIl19