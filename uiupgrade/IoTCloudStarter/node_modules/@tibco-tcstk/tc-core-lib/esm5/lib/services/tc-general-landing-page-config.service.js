/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { map } from 'rxjs/operators';
import { TcSharedStateService } from './tc-shared-state.service';
import { GeneralLandingPageConfig } from '../models/tc-general-landing-page-config';
import { SharedStateContent, SharedStateEntry, SharedStateList } from '../models/tc-shared-state';
import { TcCoreCommonFunctions } from '../common/tc-core-common-functions';
import * as i0 from "@angular/core";
import * as i1 from "./tc-shared-state.service";
var TcGeneralLandingPageConfigService = /** @class */ (function () {
    function TcGeneralLandingPageConfigService(sharedStateService) {
        this.sharedStateService = sharedStateService;
    }
    /**
     * @param {?} sandboxId
     * @param {?} uiAppId
     * @param {?} generalLandingPageConfig
     * @return {?}
     */
    TcGeneralLandingPageConfigService.prototype.createGeneralLandingPageConfig = /**
     * @param {?} sandboxId
     * @param {?} uiAppId
     * @param {?} generalLandingPageConfig
     * @return {?}
     */
    function (sandboxId, uiAppId, generalLandingPageConfig) {
        /** @type {?} */
        var ssName = uiAppId + '.general.landing.page.config.tibcolabs.client.context.PUBLIC';
        /** @type {?} */
        var content = new SharedStateContent();
        content.json = TcCoreCommonFunctions.escapeString(JSON.stringify(generalLandingPageConfig));
        return this.sharedStateService.createSharedState(ssName, 'PUBLIC', '', sandboxId, undefined, undefined, undefined, content)
            .pipe(map((/**
         * @param {?} value
         * @return {?}
         */
        function (value) { return value; })));
    };
    /**
     * @param {?} uiAppId
     * @param {?} useCache
     * @param {?} flushCache
     * @return {?}
     */
    TcGeneralLandingPageConfigService.prototype.getGeneralLandingPageConfig = /**
     * @param {?} uiAppId
     * @param {?} useCache
     * @param {?} flushCache
     * @return {?}
     */
    function (uiAppId, useCache, flushCache) {
        // if useCache is false this will trigger the service to update the cached version with latest
        /** @type {?} */
        var ssName = uiAppId + '.general.landing.page.config.tibcolabs.client.context.PUBLIC';
        return this.sharedStateService.getSharedState(ssName, 'PUBLIC', useCache, flushCache)
            .pipe(map((/**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            if (value.sharedStateEntries.length > 0) {
                /** @type {?} */
                var ssresult = new GeneralLandingPageConfig().deserialize(JSON.parse(value.sharedStateEntries[0].content.json));
                ssresult.id = value.sharedStateEntries[0].id;
                return ssresult;
            }
            else {
                return undefined;
            }
        })));
    };
    /**
     * @param {?} sandboxId
     * @param {?} uiAppId
     * @param {?} generalLandingPageConfig
     * @param {?} id
     * @return {?}
     */
    TcGeneralLandingPageConfigService.prototype.updateGeneralLandingPageConfig = /**
     * @param {?} sandboxId
     * @param {?} uiAppId
     * @param {?} generalLandingPageConfig
     * @param {?} id
     * @return {?}
     */
    function (sandboxId, uiAppId, generalLandingPageConfig, id) {
        var _this = this;
        /** @type {?} */
        var ssName = uiAppId + '.general.landing.page.config.tibcolabs.client.context.PUBLIC';
        /** @type {?} */
        var content = new SharedStateContent();
        content.json = TcCoreCommonFunctions.escapeString(JSON.stringify(generalLandingPageConfig));
        /** @type {?} */
        var entry = new SharedStateEntry();
        entry.content = content;
        entry.sandboxId = sandboxId;
        entry.name = ssName;
        entry.type = 'PUBLIC';
        entry.id = id;
        /** @type {?} */
        var ssList = new SharedStateList();
        ssList.sharedStateEntries = [];
        ssList.sharedStateEntries.push(entry);
        return this.sharedStateService.updateSharedState(ssList.sharedStateEntries)
            .pipe(map((/**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            // flush the cache
            _this.getGeneralLandingPageConfig(uiAppId, true, true).subscribe();
            return new GeneralLandingPageConfig().deserialize((JSON.parse(value.sharedStateEntries[0].content.json)));
        })));
    };
    TcGeneralLandingPageConfigService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    TcGeneralLandingPageConfigService.ctorParameters = function () { return [
        { type: TcSharedStateService }
    ]; };
    /** @nocollapse */ TcGeneralLandingPageConfigService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function TcGeneralLandingPageConfigService_Factory() { return new TcGeneralLandingPageConfigService(i0.ɵɵinject(i1.TcSharedStateService)); }, token: TcGeneralLandingPageConfigService, providedIn: "root" });
    return TcGeneralLandingPageConfigService;
}());
export { TcGeneralLandingPageConfigService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    TcGeneralLandingPageConfigService.prototype.sharedStateService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGMtZ2VuZXJhbC1sYW5kaW5nLXBhZ2UtY29uZmlnLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AdGliY28tdGNzdGsvdGMtY29yZS1saWIvIiwic291cmNlcyI6WyJsaWIvc2VydmljZXMvdGMtZ2VuZXJhbC1sYW5kaW5nLXBhZ2UtY29uZmlnLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFM0MsT0FBTyxFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQ3JDLE9BQU8sRUFBRSxvQkFBb0IsRUFBRSxNQUFNLDJCQUEyQixDQUFDO0FBQ2pFLE9BQU8sRUFBRSx3QkFBd0IsRUFBcUIsTUFBTSwwQ0FBMEMsQ0FBQztBQUN2RyxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsZ0JBQWdCLEVBQUUsZUFBZSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDbEcsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sb0NBQW9DLENBQUM7OztBQUUzRTtJQU1JLDJDQUNZLGtCQUF3QztRQUF4Qyx1QkFBa0IsR0FBbEIsa0JBQWtCLENBQXNCO0lBRXBELENBQUM7Ozs7Ozs7SUFFTSwwRUFBOEI7Ozs7OztJQUFyQyxVQUFzQyxTQUFpQixFQUFFLE9BQWUsRUFBRSx3QkFBa0Q7O1lBQ2xILE1BQU0sR0FBRyxPQUFPLEdBQUcsOERBQThEOztZQUNqRixPQUFPLEdBQXVCLElBQUksa0JBQWtCLEVBQUU7UUFDNUQsT0FBTyxDQUFDLElBQUksR0FBRyxxQkFBcUIsQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDLENBQUM7UUFFNUYsT0FBTyxJQUFJLENBQUMsa0JBQWtCLENBQUMsaUJBQWlCLENBQUMsTUFBTSxFQUFFLFFBQVEsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLE9B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dWxhci9jb3JlJztcbmltcG9ydCB7IE9ic2VydmFibGUsIG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBUY1NoYXJlZFN0YXRlU2VydmljZSB9IGZyb20gJy4vdGMtc2hhcmVkLXN0YXRlLnNlcnZpY2UnO1xuaW1wb3J0IHsgR2VuZXJhbExhbmRpbmdQYWdlQ29uZmlnLCBMYW5kaW5nUGFnZUNvbmZpZyB9IGZyb20gJy4uL21vZGVscy90Yy1nZW5lcmFsLWxhbmRpbmctcGFnZS1jb25maWcnO1xuaW1wb3J0IHsgU2hhcmVkU3RhdGVDb250ZW50LCBTaGFyZWRTdGF0ZUVudHJ5LCBTaGFyZWRTdGF0ZUxpc3QgfSBmcm9tICcuLi9tb2RlbHMvdGMtc2hhcmVkLXN0YXRlJztcbmltcG9ydCB7IFRjQ29yZUNvbW1vbkZ1bmN0aW9ucyB9IGZyb20gJy4uL2NvbW1vbi90Yy1jb3JlLWNvbW1vbi1mdW5jdGlvbnMnO1xuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46ICdyb290J1xufSlcblxuZXhwb3J0IGNsYXNzIFRjR2VuZXJhbExhbmRpbmdQYWdlQ29uZmlnU2VydmljZSB7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBzaGFyZWRTdGF0ZVNlcnZpY2U6IFRjU2hhcmVkU3RhdGVTZXJ2aWNlXG4gICAgKSB7XG4gICAgfVxuXG4gICAgcHVibGljIGNyZWF0ZUdlbmVyYWxMYW5kaW5nUGFnZUNvbmZpZyhzYW5kYm94SWQ6IG51bWJlciwgdWlBcHBJZDogc3RyaW5nLCBnZW5lcmFsTGFuZGluZ1BhZ2VDb25maWc6IEdlbmVyYWxMYW5kaW5nUGFnZUNvbmZpZykge1xuICAgICAgICBjb25zdCBzc05hbWUgPSB1aUFwcElkICsgJy5nZW5lcmFsLmxhbmRpbmcucGFnZS5jb25maWcudGliY29sYWJzLmNsaWVudC5jb250ZXh0LlBVQkxJQyc7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQ6IFNoYXJlZFN0YXRlQ29udGVudCA9IG5ldyBTaGFyZWRTdGF0ZUNvbnRlbnQoKTtcbiAgICAgICAgY29udGVudC5qc29uID0gVGNDb3JlQ29tbW9uRnVuY3Rpb25zLmVzY2FwZVN0cmluZyhKU09OLnN0cmluZ2lmeShnZW5lcmFsTGFuZGluZ1BhZ2VDb25maWcpKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5zaGFyZWRTdGF0ZVNlcnZpY2UuY3JlYXRlU2hhcmVkU3RhdGUoc3NOYW1lLCAnUFVCTElDJywgJycsIHNhbmRib3hJZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY29udGVudClcbiAgICAgICAgICAgIC5waXBlKFxuICAgICAgICAgICAgICAgIG1hcCh2YWx1ZSA9PiB2YWx1ZSlcbiAgICAgICAgICAgICk7XG4gICAgfVxuXG4gICAgcHVibGljIGdldEdlbmVyYWxMYW5kaW5nUGFnZUNvbmZpZyh1aUFwcElkOiBzdHJpbmcsIHVzZUNhY2hlOiBib29sZWFuLCBmbHVzaENhY2hlOiBib29sZWFuKTogT2JzZXJ2YWJsZTxHZW5lcmFsTGFuZGluZ1BhZ2VDb25maWc+IHtcbiAgICAgICAgLy8gaWYgdXNlQ2FjaGUgaXMgZmFsc2UgdGhpcyB3aWxsIHRyaWdnZXIgdGhlIHNlcnZpY2UgdG8gdXBkYXRlIHRoZSBjYWNoZWQgdmVyc2lvbiB3aXRoIGxhdGVzdFxuICAgICAgICBjb25zdCBzc05hbWUgPSB1aUFwcElkICsgJy5nZW5lcmFsLmxhbmRpbmcucGFnZS5jb25maWcudGliY29sYWJzLmNsaWVudC5jb250ZXh0LlBVQkxJQyc7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuc2hhcmVkU3RhdGVTZXJ2aWNlLmdldFNoYXJlZFN0YXRlKHNzTmFtZSwgJ1BVQkxJQycsIHVzZUNhY2hlLCBmbHVzaENhY2hlKVxuICAgICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICAgICAgbWFwKHZhbHVlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLnNoYXJlZFN0YXRlRW50cmllcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzc3Jlc3VsdCA9IG5ldyBHZW5lcmFsTGFuZGluZ1BhZ2VDb25maWcoKS5kZXNlcmlhbGl6ZShKU09OLnBhcnNlKHZhbHVlLnNoYXJlZFN0YXRlRW50cmllc1swXS5jb250ZW50Lmpzb24pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNzcmVzdWx0LmlkID0gdmFsdWUuc2hhcmVkU3RhdGVFbnRyaWVzWzBdLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNzcmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApO1xuICAgIH1cblxuICAgIHB1YmxpYyB1cGRhdGVHZW5lcmFsTGFuZGluZ1BhZ2VDb25maWcoc2FuZGJveElkOiBudW1iZXIsIHVpQXBwSWQ6IHN0cmluZywgZ2VuZXJhbExhbmRpbmdQYWdlQ29uZmlnOiBHZW5lcmFsTGFuZGluZ1BhZ2VDb25maWcsIGlkOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3Qgc3NOYW1lID0gdWlBcHBJZCArICcuZ2VuZXJhbC5sYW5kaW5nLnBhZ2UuY29uZmlnLnRpYmNvbGFicy5jbGllbnQuY29udGV4dC5QVUJMSUMnO1xuICAgICAgICBjb25zdCBjb250ZW50OiBTaGFyZWRTdGF0ZUNvbnRlbnQgPSBuZXcgU2hhcmVkU3RhdGVDb250ZW50KCk7XG4gICAgICAgIGNvbnRlbnQuanNvbiA9IFRjQ29yZUNvbW1vbkZ1bmN0aW9ucy5lc2NhcGVTdHJpbmcoSlNPTi5zdHJpbmdpZnkoZ2VuZXJhbExhbmRpbmdQYWdlQ29uZmlnKSk7XG4gICAgICAgIGNvbnN0IGVudHJ5OiBTaGFyZWRTdGF0ZUVudHJ5ID0gbmV3IFNoYXJlZFN0YXRlRW50cnkoKTtcbiAgICAgICAgZW50cnkuY29udGVudCA9IGNvbnRlbnQ7XG4gICAgICAgIGVudHJ5LnNhbmRib3hJZCA9IHNhbmRib3hJZDtcbiAgICAgICAgZW50cnkubmFtZSA9IHNzTmFtZTtcbiAgICAgICAgZW50cnkudHlwZSA9ICdQVUJMSUMnO1xuICAgICAgICBlbnRyeS5pZCA9IGlkO1xuICAgICAgICBjb25zdCBzc0xpc3Q6IFNoYXJlZFN0YXRlTGlzdCA9IG5ldyBTaGFyZWRTdGF0ZUxpc3QoKTtcbiAgICAgICAgc3NMaXN0LnNoYXJlZFN0YXRlRW50cmllcyA9IFtdO1xuICAgICAgICBzc0xpc3Quc2hhcmVkU3RhdGVFbnRyaWVzLnB1c2goZW50cnkpO1xuXG4gICAgICAgIHJldHVybiB0aGlzLnNoYXJlZFN0YXRlU2VydmljZS51cGRhdGVTaGFyZWRTdGF0ZShzc0xpc3Quc2hhcmVkU3RhdGVFbnRyaWVzKVxuICAgICAgICAgICAgLnBpcGUoXG4gICAgICAgICAgICAgICAgbWFwKHZhbHVlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gZmx1c2ggdGhlIGNhY2hlXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0R2VuZXJhbExhbmRpbmdQYWdlQ29uZmlnKHVpQXBwSWQsIHRydWUsIHRydWUpLnN1YnNjcmliZSgpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEdlbmVyYWxMYW5kaW5nUGFnZUNvbmZpZygpLmRlc2VyaWFsaXplKChKU09OLnBhcnNlKHZhbHVlLnNoYXJlZFN0YXRlRW50cmllc1swXS5jb250ZW50Lmpzb24pKSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgfVxufVxuXG4iXX0=