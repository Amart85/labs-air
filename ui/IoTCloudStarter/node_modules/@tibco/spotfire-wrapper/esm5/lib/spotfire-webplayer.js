/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
// Copyright (c) 2018-2018. TIBCO Software Inc. All Rights Reserved. Confidential & Proprietary.
import { Observable, forkJoin, of as observableOf, zip, BehaviorSubject, throwError, TimeoutError } from 'rxjs';
import { mergeMap, tap, pluck, map, filter, timeout, catchError } from 'rxjs/operators';
/** @type {?} */
export var CUSTLABELS = {
    showAbout: 'Show the about menu item',
    showAnalysisInformationTool: 'Show the analysis information tool menu item',
    showAuthor: 'Show the button for enabling authoring',
    showClose: 'Show the analysis close menu item',
    showCustomizableHeader: 'Show the customizable header',
    showDodPanel: 'Show the details on demand panel in the visualization.',
    showExportFile: 'Show the export file menu item',
    showFilterPanel: 'Show the filter panel.',
    showHelp: 'Show the help menu item',
    showLogout: 'Show the logout menu item',
    showPageNavigation: 'Show the page navigation controls in the analysis',
    showStatusBar: 'Show status bar in the Web Player',
    showToolBar: 'Show the analysis toolbar and menu',
    showUndoRedo: 'Show the undo/redo menu item'
};
/**
 * @param {...?} args
 * @return {?}
 */
function doConsole() {
    var args = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        args[_i] = arguments[_i];
    }
    // console.log('[SPOTFIRE-WEBPLAYER]', ...args);
}
var PageState = /** @class */ (function () {
    function PageState() {
    }
    return PageState;
}());
if (false) {
    /** @type {?} */
    PageState.prototype.index;
    /** @type {?} */
    PageState.prototype.pageTitle;
}
var DataTable = /** @class */ (function () {
    function DataTable() {
    }
    return DataTable;
}());
if (false) {
    /** @type {?} */
    DataTable.prototype.dataTableName;
}
var DataColumn = /** @class */ (function () {
    function DataColumn() {
    }
    return DataColumn;
}());
if (false) {
    /** @type {?} */
    DataColumn.prototype.dataColumnName;
    /** @type {?} */
    DataColumn.prototype.dataTableName;
    /** @type {?} */
    DataColumn.prototype.dataType;
    /** @type {?} */
    DataColumn.prototype.values;
}
var DistinctValues = /** @class */ (function () {
    function DistinctValues() {
    }
    return DistinctValues;
}());
if (false) {
    /** @type {?} */
    DistinctValues.prototype.count;
    /** @type {?} */
    DistinctValues.prototype.values;
}
var Marking = /** @class */ (function () {
    function Marking(_marking) {
        var _this = this;
        this._marking = _marking;
        this.getMarkingNames$ = (/**
         * @return {?}
         */
        function () { return doCall(_this._marking, 'getMarkingNames'); });
        this.onChanged$ = (/**
         * @param {?} m
         * @param {?} t
         * @param {?} c
         * @param {?} n
         * @return {?}
         */
        function (m, t, c, n) { return doCall(_this._marking, 'onChanged', m, t, c, n); });
    }
    return Marking;
}());
export { Marking };
if (false) {
    /** @type {?} */
    Marking.prototype.getMarkingNames$;
    /** @type {?} */
    Marking.prototype.onChanged$;
    /** @type {?} */
    Marking.prototype._marking;
}
var Filtering = /** @class */ (function () {
    function Filtering(_filtering) {
        var _this = this;
        this._filtering = _filtering;
        this.set = (/**
         * @param {?} flts
         * @return {?}
         */
        function (flts) { return _this._filtering.setFilters(flts, spotfire.webPlayer.filteringOperation.REPLACE); });
        this.resetAllFilters = (/**
         * @return {?}
         */
        function () { return _this._filtering.resetAllFilters(); });
        this.getAllModifiedFilterColumns = (/**
         * @return {?}
         */
        function () { return doCall(_this._filtering, 'getAllModifiedFilterColumns', spotfire.webPlayer.includedFilterSettings.ALL_WITH_CHECKED_HIERARCHY_NODES); });
    }
    return Filtering;
}());
if (false) {
    /** @type {?} */
    Filtering.prototype.set;
    /** @type {?} */
    Filtering.prototype.resetAllFilters;
    /** @type {?} */
    Filtering.prototype.getAllModifiedFilterColumns;
    /** @type {?} */
    Filtering.prototype._filtering;
}
var SpotfireParameters = /** @class */ (function () {
    function SpotfireParameters(vars) {
        var _this = this;
        this.version = '7.14';
        this.debug = false;
        this.reloadAnalysisInstance = false;
        console.log('CONSTR SpotfireParameters', vars, this);
        if (vars) {
            Object.keys(vars).forEach((/**
             * @param {?} key
             * @return {?}
             */
            function (key) { return _this[key] = vars[key]; }));
        }
        // Create a Unique ID for this Spotfire dashboard
        //
        this.domid = this.domid ? this.domid : this.sid ? "" + this.sid : "" + new Date().getTime();
    }
    return SpotfireParameters;
}());
export { SpotfireParameters };
if (false) {
    /** @type {?} */
    SpotfireParameters.prototype.url;
    /** @type {?} */
    SpotfireParameters.prototype.path;
    /** @type {?} */
    SpotfireParameters.prototype.page;
    /** @type {?} */
    SpotfireParameters.prototype.domid;
    /** @type {?} */
    SpotfireParameters.prototype.sid;
    /** @type {?} */
    SpotfireParameters.prototype.customization;
    /** @type {?} */
    SpotfireParameters.prototype.version;
    /** @type {?} */
    SpotfireParameters.prototype.debug;
    /** @type {?} */
    SpotfireParameters.prototype.reloadAnalysisInstance;
    /** @type {?} */
    SpotfireParameters.prototype.document;
    /** @type {?} */
    SpotfireParameters.prototype.app;
    /** @type {?} */
    SpotfireParameters.prototype._parameters;
}
var Data = /** @class */ (function () {
    function Data(_data) {
        var _this = this;
        this._data = _data;
        this.allTables = {};
        // A Spotfire analysis contains one or more data tables, retrieved by the getDataTable,
        // getActiveDataTable and getDataTables methods.
        this.getDataTables$ = (/**
         * @return {?}
         */
        function () { return doCall(_this._data, 'getDataTables'); });
        this.getDataTableColNames$ = (/**
         * @param {?} t
         * @return {?}
         */
        function (t) { return doCall(_this._data, 'getDataTable', t)
            .pipe(mergeMap((/**
         * @param {?} f
         * @return {?}
         */
        function (f) { return _this.getDataColumns$(f); })), map((/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            var _a;
            return (_a = {}, _a[t] = d, _a);
        }))); });
        this.getDataTable$ = (/**
         * @param {?} t
         * @return {?}
         */
        function (t) { return doCall(_this._data, 'getDataTable', t)
            .pipe(mergeMap((/**
         * @param {?} f
         * @return {?}
         */
        function (f) { return _this.getDataColumns$(f); }))); });
        // Each data table contains one or more data columns, retrieved by the getDataColumn,
        // getDataColumns and searchDataColumns.
        this.getDataColumns$ = (/**
         * @param {?} t
         * @return {?}
         */
        function (t) { return doCall(t, 'getDataColumns').pipe(mergeMap((/**
         * @param {?} columns
         * @return {?}
         */
        function (columns) {
            /** @type {?} */
            var obs = [];
            columns.forEach((/**
             * @param {?} col
             * @return {?}
             */
            function (col) { return obs.push(zip.apply(void 0, tslib_1.__spread([observableOf(col)], [(/**
                 * @param {?} a
                 * @param {?} b
                 * @return {?}
                 */
                function (a, b) { return a.dataColumnName; })]))); }));
            return forkJoin(obs);
        }))); });
        // From the DataColumn class it is possible to retrieve metadata, such as column name and data type.
        // It is also possible to get a list of the unique values in the data column with the getDistinctValues method.
        this.getDistinctValues$ = (/**
         * @param {?} t
         * @return {?}
         */
        function (t) { return doCall(t, 'getDistinctValues', 0, 20).pipe(tap((/**
         * @param {?} g
         * @return {?}
         */
        function (g) { return doConsole('Data.DistinctValues$', t, g, g.count > 0 && g.count < 25); })), 
        // filter(g => g.count > 0 && g.count < 25),
        //  tap(g => doConsole('[OBS]', 'DistinctValues filtres', g)),
        pluck('values')); });
        this.getTables$ = (/**
         * @return {?}
         */
        function () { return _this.getDataTables$().pipe(mergeMap((/**
         * @param {?} tables
         * @return {?}
         */
        function (tables) {
            /** @type {?} */
            var obs = [];
            tables.forEach((/**
             * @param {?} table
             * @return {?}
             */
            function (table) { return obs.push(_this.getDataTableColNames$(table.dataTableName)); }));
            return forkJoin(obs);
        })), map((/**
         * @param {?} k
         * @return {?}
         */
        function (k) {
            /** @type {?} */
            var z = {};
            k.forEach((/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return z = tslib_1.__assign({}, z, p); }));
            return z;
        }))); });
        this.getAllTables$ = (/**
         * @return {?}
         */
        function () { return _this.getDataTables$().pipe(mergeMap((/**
         * @param {?} tables
         * @return {?}
         */
        function (tables) {
            /** @type {?} */
            var obs = [];
            tables.forEach((/**
             * @param {?} table
             * @return {?}
             */
            function (table) { return obs.push(_this.getDataTable$(table.dataTableName)); }));
            return forkJoin(obs);
        })), map((/**
         * @param {?} tables
         * @return {?}
         */
        function (tables) {
            /** @type {?} */
            var dataTables = [];
            ((/** @type {?} */ (tables[0]))).forEach((/**
             * @param {?} columns
             * @return {?}
             */
            function (columns) {
                /** @type {?} */
                var tname = columns['tabName'];
                if (!dataTables[tname]) {
                    dataTables[tname] = {};
                }
                dataTables[tname][columns['colName']] = columns['vals'];
            }));
            return dataTables;
        }))); });
    }
    return Data;
}());
export { Data };
if (false) {
    /** @type {?} */
    Data.prototype.allTables;
    /**
     * @type {?}
     * @private
     */
    Data.prototype.getDataTables$;
    /**
     * @type {?}
     * @private
     */
    Data.prototype.getDataTableColNames$;
    /**
     * @type {?}
     * @private
     */
    Data.prototype.getDataTable$;
    /**
     * @type {?}
     * @private
     */
    Data.prototype.getDataColumns$;
    /**
     * @type {?}
     * @private
     */
    Data.prototype.getDistinctValues$;
    /** @type {?} */
    Data.prototype.getTables$;
    /** @type {?} */
    Data.prototype.getAllTables$;
    /**
     * @type {?}
     * @private
     */
    Data.prototype._data;
}
var DocMetadata = /** @class */ (function () {
    function DocMetadata(p) {
        this.sizeUnit = 'B';
        if (p) {
            this.contentSize = parseInt(p['contentSize'], 10);
            if (this.contentSize > (1024 * 1024)) {
                this.size = this.contentSize / (1024 * 1024);
                this.sizeUnit = 'MB';
            }
            else if (this.contentSize > 1024) {
                this.size = this.contentSize / 1024;
                this.sizeUnit = 'KB';
            }
            this.created = new Date(p.created);
            this.lastModified = new Date(p.lastModified);
            this.description = p.description;
            this.path = p.path;
            this.title = p.title;
        }
    }
    return DocMetadata;
}());
export { DocMetadata };
if (false) {
    /** @type {?} */
    DocMetadata.prototype.size;
    /** @type {?} */
    DocMetadata.prototype.sizeUnit;
    /** @type {?} */
    DocMetadata.prototype.contentSize;
    /** @type {?} */
    DocMetadata.prototype.created;
    /** @type {?} */
    DocMetadata.prototype.description;
    /** @type {?} */
    DocMetadata.prototype.lastModified;
    /** @type {?} */
    DocMetadata.prototype.path;
    /** @type {?} */
    DocMetadata.prototype.title;
}
var Document = /** @class */ (function () {
    function Document(app, id, page, custo) {
        var _this = this;
        this.onActivePageChangedCallback = (/**
         * @param {?} pageState
         * @return {?}
         */
        function (pageState) { return console.log('onActivePageChangedCallback', pageState); });
        this.do = (/**
         * @template T
         * @param {?} m
         * @return {?}
         */
        function (m) { return doCall(_this._doc, m); });
        this.getDocumentMetadata$ = (/**
         * @return {?}
         */
        function () { return _this.do('getDocumentMetadata').pipe(map((/**
         * @param {?} g
         * @return {?}
         */
        function (g) { return new DocMetadata(g); }))); });
        this.getPages$ = (/**
         * @return {?}
         */
        function () { return _this.do('getPages').pipe(map((/**
         * @param {?} m
         * @return {?}
         */
        function (m) { return Object.keys(m).map((/**
         * @param {?} f
         * @return {?}
         */
        function (f) { return m[f].pageTitle; })); }))); });
        // getDocumentProperties$ = () => this.do('getDocumentProperties');
        // getBookmarks$ = () => this.do('getBookmarks');
        // getBookmarkNames$ = () => this.do('getBookmarkNames');
        // getReports$ = () => this.do('getReports');
        this.getActivePage$ = (/**
         * @return {?}
         */
        function () { return _this.do('getActivePage'); });
        this.setActivePage = (/**
         * @param {?} p
         * @return {?}
         */
        function (p) { return _this._doc.setActivePage(p); });
        this.getData = (/**
         * @return {?}
         */
        function () { return _this.data; });
        this.getMarking = (/**
         * @return {?}
         */
        function () { return _this.marking; });
        this.getFiltering = (/**
         * @return {?}
         */
        function () { return _this.filtering; });
        this.onDocumentReady$ = (/**
         * @return {?}
         */
        function () { return doCall(_this._doc, 'onDocumentReady'); });
        this.close = (/**
         * @return {?}
         */
        function () { return _this._doc ? _this._doc.close() : null; });
        this.onActivePageChanged$ = (/**
         * @return {?}
         */
        function () { return doCall(_this._doc, 'onActivePageChanged'); });
        this._doc = app.openDocument(id, page, custo);
        app.onOpened$().subscribe((/**
         * @param {?} doc
         * @return {?}
         */
        function (doc) {
            doConsole("Document.onOpened$: page is now opened:", doc);
            _this._doc = doc;
            // Register event handler for page change events.
            _this.onActivePageChanged$().subscribe(_this.onActivePageChangedCallback);
            _this.marking = new Marking(_this._doc.marking);
            _this.filtering = new Filtering(_this._doc.filtering);
            _this.data = new Data(_this._doc.data);
        }));
    }
    return Document;
}());
export { Document };
if (false) {
    /**
     * @type {?}
     * @private
     */
    Document.prototype._doc;
    /**
     * @type {?}
     * @private
     */
    Document.prototype.marking;
    /**
     * @type {?}
     * @private
     */
    Document.prototype.filtering;
    /**
     * @type {?}
     * @private
     */
    Document.prototype.data;
    /**
     * @type {?}
     * @private
     */
    Document.prototype.onActivePageChangedCallback;
    /**
     * @type {?}
     * @private
     */
    Document.prototype.do;
    /** @type {?} */
    Document.prototype.getDocumentMetadata$;
    /** @type {?} */
    Document.prototype.getPages$;
    /** @type {?} */
    Document.prototype.getActivePage$;
    /** @type {?} */
    Document.prototype.setActivePage;
    /** @type {?} */
    Document.prototype.getData;
    /** @type {?} */
    Document.prototype.getMarking;
    /** @type {?} */
    Document.prototype.getFiltering;
    /** @type {?} */
    Document.prototype.onDocumentReady$;
    /** @type {?} */
    Document.prototype.close;
    /**
     * @type {?}
     * @private
     */
    Document.prototype.onActivePageChanged$;
}
/**
 * \@description
 * Turn async calls into Observables.
 *
 * For methods which name starts with 'on', the observable continues providing data it's received.
 * Otherwise the observable stops sending data at first buffer received.
 * An error is raised when the 50min timeout expires.
 *
 * @template T
 * @param {?} obj the object against we call method
 * @param {?} m the name of method
 * @param {...?} a
 * @return {?} Observable<T> an observable that corresponds to the original callback
 *
 */
function doCall(obj, m) {
    var a = [];
    for (var _i = 2; _i < arguments.length; _i++) {
        a[_i - 2] = arguments[_i];
    }
    return new Observable((/**
     * @param {?} observer
     * @return {?}
     */
    function (observer) {
        /** @type {?} */
        var oneShot = ['onDocumentReady'];
        // doConsole('[OBS]', 'doCall obj=', obj, ', m=', m, ', arg=', args, typeof obj);
        if (typeof obj[m] !== 'function' || !obj) {
            console.error('[OBS]', "function '" + m + "' does not exist on ", obj);
            observer.error("function '" + m + "' does not exist on objet " + JSON.stringify(obj));
        }
        try {
            // doConsole('[OBS]', `Call ${m}(${a.join(',')})`, a.length);
            /** @type {?} */
            var q = (/**
             * @param {?} g
             * @return {?}
             */
            function (g) { return observer.next(g); });
            /** @type {?} */
            var p = (/**
             * @param {?} g
             * @return {?}
             */
            function (g) { observer.next(g); observer.complete(); });
            return m.startsWith('on') && oneShot.indexOf(m) === -1 ? obj[m].apply(obj, tslib_1.__spread(a, [q])) : obj[m].apply(obj, tslib_1.__spread(a, [p]));
        }
        catch (err) {
            console.warn('[OBS]', 'doCall erreur: ', err);
            observer.error(err);
        }
    })).pipe(timeout(3001000), catchError((/**
     * @param {?} e
     * @return {?}
     */
    function (e) {
        if (e instanceof TimeoutError) {
            console.error("[SPOTFIRE-WEBPLAYER] The call " + m + "(" + a.join(',') + ") does not answer after 3001sec on " + JSON.stringify(obj));
        }
        else {
            console.error('[SPOTFIRE-WEBPLAYER] ERROR on doCall', e);
        }
        return throwError(e);
    })));
}
var Application = /** @class */ (function () {
    function Application(url, customization, path, parameters, reloadAnalysisInstance, version, onCreateLoginElement) {
        var _this = this;
        this.url = url;
        this.customization = customization;
        this.path = path;
        this.parameters = parameters;
        this.reloadAnalysisInstance = reloadAnalysisInstance;
        this.version = version;
        this.onCreateLoginElement = onCreateLoginElement;
        this.readySubject = new BehaviorSubject(false);
        this.onApplicationReady$ = this.readySubject.asObservable().pipe(filter((/**
         * @param {?} d
         * @return {?}
         */
        function (d) { return d; })));
        this.onReadyCallback = (/**
         * @param {?} response
         * @param {?} newApp
         * @return {?}
         */
        function (response, newApp) {
            doConsole('Application.onReadyCallback', response, newApp);
            _this._app = newApp;
            // Register an error handler to catch errors.
            _this._app.onError(_this.onErrorCallback);
            if (response.status === 'OK') {
                // The application is ready, meaning that the api is loaded and that the analysis path
                // is validated for the current session(anonymous or logg ed in user)
                _this.readySubject.next(true);
                _this.readySubject.complete();
            }
            else {
                /** @type {?} */
                var errMsg = "Status not OK. " + response.status + ": " + response.message;
                console.error('[SPOTFIRE-WEBPLAYER] Application.onReadyCallback', errMsg, response);
                _this.readySubject.error(errMsg);
            }
        });
        // Displays an error message if something goes wrong in the Web Player.
        this.onErrorCallback = (/**
         * @param {?} errCode
         * @param {?} desc
         * @return {?}
         */
        function (errCode, desc) { return console.error("[SPOTFIRE-WEBPLAYER] " + errCode + ": " + desc); });
        this.onOpened$ = (/**
         * @return {?}
         */
        function () { return doCall(_this._app, 'onOpened'); });
        this.getDocument = (/**
         * @param {?} id
         * @param {?} page
         * @param {?=} custo
         * @return {?}
         */
        function (id, page, custo) {
            return new Document(_this, id, page, custo ? custo : _this.customization);
        });
        this.openDocument = (/**
         * @param {?} id
         * @param {?} page
         * @param {?} custo
         * @return {?}
         */
        function (id, page, custo) { return _this._app.openDocument(id, page, custo); });
        this._app = new spotfire.webPlayer.createApplication(this.url, this.customization, this.path, this.parameters, this.reloadAnalysisInstance, this.version, this.onReadyCallback, this.onCreateLoginElement);
    }
    return Application;
}());
export { Application };
if (false) {
    /**
     * @type {?}
     * @private
     */
    Application.prototype._app;
    /**
     * @type {?}
     * @private
     */
    Application.prototype.readySubject;
    /** @type {?} */
    Application.prototype.onApplicationReady$;
    /**
     * @type {?}
     * @private
     */
    Application.prototype.onReadyCallback;
    /**
     * @type {?}
     * @private
     */
    Application.prototype.onErrorCallback;
    /** @type {?} */
    Application.prototype.onOpened$;
    /** @type {?} */
    Application.prototype.getDocument;
    /** @type {?} */
    Application.prototype.openDocument;
    /** @type {?} */
    Application.prototype.url;
    /** @type {?} */
    Application.prototype.customization;
    /** @type {?} */
    Application.prototype.path;
    /** @type {?} */
    Application.prototype.parameters;
    /** @type {?} */
    Application.prototype.reloadAnalysisInstance;
    /** @type {?} */
    Application.prototype.version;
    /** @type {?} */
    Application.prototype.onCreateLoginElement;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BvdGZpcmUtd2VicGxheWVyLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHRpYmNvL3Nwb3RmaXJlLXdyYXBwZXIvIiwic291cmNlcyI6WyJsaWIvc3BvdGZpcmUtd2VicGxheWVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUVBLE9BQU8sRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLEVBQUUsSUFBSSxZQUFZLEVBQUUsR0FBRyxFQUFFLGVBQWUsRUFBTSxVQUFVLEVBQUUsWUFBWSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBRXBILE9BQU8sRUFBRSxRQUFRLEVBQUUsR0FBRyxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7QUFJeEYsTUFBTSxLQUFPLFVBQVUsR0FBRztJQUN4QixTQUFTLEVBQUUsMEJBQTBCO0lBQ3JDLDJCQUEyQixFQUFFLDhDQUE4QztJQUMzRSxVQUFVLEVBQUUsd0NBQXdDO0lBQ3BELFNBQVMsRUFBRSxtQ0FBbUM7SUFDOUMsc0JBQXNCLEVBQUUsOEJBQThCO0lBQ3RELFlBQVksRUFBRSx3REFBd0Q7SUFDdEUsY0FBYyxFQUFFLGdDQUFnQztJQUNoRCxlQUFlLEVBQUUsd0JBQXdCO0lBQ3pDLFFBQVEsRUFBRSx5QkFBeUI7SUFDbkMsVUFBVSxFQUFFLDJCQUEyQjtJQUN2QyxrQkFBa0IsRUFBRSxtREFBbUQ7SUFDdkUsYUFBYSxFQUFFLG1DQUFtQztJQUNsRCxXQUFXLEVBQUUsb0NBQW9DO0lBQ2pELFlBQVksRUFBRSw4QkFBOEI7Q0FDN0M7Ozs7O0FBRUQsU0FBUyxTQUFTO0lBQUMsY0FBYztTQUFkLFVBQWMsRUFBZCxxQkFBYyxFQUFkLElBQWM7UUFBZCx5QkFBYzs7SUFDL0IsZ0RBQWdEO0FBQ2xELENBQUM7QUFDRDtJQUFBO0lBQW9ELENBQUM7SUFBRCxnQkFBQztBQUFELENBQUMsQUFBckQsSUFBcUQ7OztJQUFuQywwQkFBYzs7SUFB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QyxJQUFJLEdBQUcsSUFBSSxRQUFRLENBQUMsU0FBUyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxHQUFHLEVBQzNELElBQUksQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxzQkFBc0IsRUFDM0UsSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0lBQ25FLENBQUM7SUF3Qkgsa0JBQUM7QUFBRCxDQUFDLEFBeENELElBd0NDOzs7Ozs7O0lBdkNDLDJCQUFrQjs7Ozs7SUFDbEIsbUNBQTJEOztJQUMzRCwwQ0FBbUY7Ozs7O0lBZW5GLHNDQWVDOzs7OztJQUVELHNDQUF1SDs7SUFDdkgsZ0NBQWdEOztJQUNoRCxrQ0FDa0U7O0lBQ2xFLG1DQUFvSDs7SUFqQ2xILDBCQUFrQjs7SUFDbEIsb0NBQW1DOztJQUNuQywyQkFBbUI7O0lBQ25CLGlDQUF5Qjs7SUFDekIsNkNBQXNDOztJQUN0Qyw4QkFBc0I7O0lBQ3RCLDJDQUEyQiIsInNvdXJjZXNDb250ZW50IjpbIlxuLy8gQ29weXJpZ2h0IChjKSAyMDE4LTIwMTguIFRJQkNPIFNvZnR3YXJlIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4gQ29uZmlkZW50aWFsICYgUHJvcHJpZXRhcnkuXG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBmb3JrSm9pbiwgb2YgYXMgb2JzZXJ2YWJsZU9mLCB6aXAsIEJlaGF2aW9yU3ViamVjdCwgb2YsIHRocm93RXJyb3IsIFRpbWVvdXRFcnJvciB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgU3BvdGZpcmVDdXN0b21pemF0aW9uIGFzIEN1c3RvbWl6YXRpb24sIFNwb3RmaXJlRmlsdGVyIH0gZnJvbSAnLi9zcG90ZmlyZS1jdXN0b21pemF0aW9uJztcbmltcG9ydCB7IG1lcmdlTWFwLCB0YXAsIHBsdWNrLCBtYXAsIGZpbHRlciwgdGltZW91dCwgY2F0Y2hFcnJvciB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcblxuZGVjbGFyZSBsZXQgc3BvdGZpcmU6IGFueTtcblxuZXhwb3J0IGNvbnN0IENVU1RMQUJFTFMgPSB7XG4gIHNob3dBYm91dDogJ1Nob3cgdGhlIGFib3V0IG1lbnUgaXRlbScsXG4gIHNob3dBbmFseXNpc0luZm9ybWF0aW9uVG9vbDogJ1Nob3cgdGhlIGFuYWx5c2lzIGluZm9ybWF0aW9uIHRvb2wgbWVudSBpdGVtJyxcbiAgc2hvd0F1dGhvcjogJ1Nob3cgdGhlIGJ1dHRvbiBmb3IgZW5hYmxpbmcgYXV0aG9yaW5nJyxcbiAgc2hvd0Nsb3NlOiAnU2hvdyB0aGUgYW5hbHlzaXMgY2xvc2UgbWVudSBpdGVtJyxcbiAgc2hvd0N1c3RvbWl6YWJsZUhlYWRlcjogJ1Nob3cgdGhlIGN1c3RvbWl6YWJsZSBoZWFkZXInLFxuICBzaG93RG9kUGFuZWw6ICdTaG93IHRoZSBkZXRhaWxzIG9uIGRlbWFuZCBwYW5lbCBpbiB0aGUgdmlzdWFsaXphdGlvbi4nLFxuICBzaG93RXhwb3J0RmlsZTogJ1Nob3cgdGhlIGV4cG9ydCBmaWxlIG1lbnUgaXRlbScsXG4gIHNob3dGaWx0ZXJQYW5lbDogJ1Nob3cgdGhlIGZpbHRlciBwYW5lbC4nLFxuICBzaG93SGVscDogJ1Nob3cgdGhlIGhlbHAgbWVudSBpdGVtJyxcbiAgc2hvd0xvZ291dDogJ1Nob3cgdGhlIGxvZ291dCBtZW51IGl0ZW0nLFxuICBzaG93UGFnZU5hdmlnYXRpb246ICdTaG93IHRoZSBwYWdlIG5hdmlnYXRpb24gY29udHJvbHMgaW4gdGhlIGFuYWx5c2lzJyxcbiAgc2hvd1N0YXR1c0JhcjogJ1Nob3cgc3RhdHVzIGJhciBpbiB0aGUgV2ViIFBsYXllcicsXG4gIHNob3dUb29sQmFyOiAnU2hvdyB0aGUgYW5hbHlzaXMgdG9vbGJhciBhbmQgbWVudScsXG4gIHNob3dVbmRvUmVkbzogJ1Nob3cgdGhlIHVuZG8vcmVkbyBtZW51IGl0ZW0nXG59O1xuXG5mdW5jdGlvbiBkb0NvbnNvbGUoLi4uYXJnczogYW55W10pIHtcbiAgLy8gY29uc29sZS5sb2coJ1tTUE9URklSRS1XRUJQTEFZRVJdJywgLi4uYXJncyk7XG59XG5jbGFzcyBQYWdlU3RhdGUgeyBpbmRleDogbnVtYmVyOyBwYWdlVGl0bGU6IHN0cmluZzsgfVxuY2xhc3MgRGF0YVRhYmxlIHsgZGF0YVRhYmxlTmFtZTogc3RyaW5nOyB9XG5jbGFzcyBEYXRhQ29sdW1uIHsgZGF0YUNvbHVtbk5hbWU6IHN0cmluZzsgZGF0YVRhYmxlTmFtZTogc3RyaW5nOyBkYXRhVHlwZTogc3RyaW5nOyB2YWx1ZXM6IHt9OyB9XG5jbGFzcyBEaXN0aW5jdFZhbHVlcyB7IGNvdW50OiBudW1iZXI7IHZhbHVlczogQXJyYXk8c3RyaW5nPjsgfVxuXG5cbmV4cG9ydCBjbGFzcyBNYXJraW5nIHtcbiAgY29uc3RydWN0b3IocHVibGljIF9tYXJraW5nKSB7IH1cbiAgZ2V0TWFya2luZ05hbWVzJCA9ICgpID0+IGRvQ2FsbDxzdHJpbmdbXT4odGhpcy5fbWFya2luZywgJ2dldE1hcmtpbmdOYW1lcycpO1xuICBvbkNoYW5nZWQkID0gKG0sIHQsIGMsIG4pID0+IGRvQ2FsbCh0aGlzLl9tYXJraW5nLCAnb25DaGFuZ2VkJywgbSwgdCwgYywgbik7XG59XG5cbmNsYXNzIEZpbHRlcmluZyB7XG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBfZmlsdGVyaW5nKSB7IH1cbiAgc2V0ID0gKGZsdHMpID0+IHRoaXMuX2ZpbHRlcmluZy5zZXRGaWx0ZXJzKGZsdHMsIHNwb3RmaXJlLndlYlBsYXllci5maWx0ZXJpbmdPcGVyYXRpb24uUkVQTEFDRSk7XG4gIHJlc2V0QWxsRmlsdGVycyA9ICgpID0+IHRoaXMuX2ZpbHRlcmluZy5yZXNldEFsbEZpbHRlcnMoKTtcbiAgZ2V0QWxsTW9kaWZpZWRGaWx0ZXJDb2x1bW5zID0gKCkgPT4gZG9DYWxsPFNwb3RmaXJlRmlsdGVyW10+KFxuICAgIHRoaXMuX2ZpbHRlcmluZywgJ2dldEFsbE1vZGlmaWVkRmlsdGVyQ29sdW1ucycsXG4gICAgc3BvdGZpcmUud2ViUGxheWVyLmluY2x1ZGVkRmlsdGVyU2V0dGluZ3MuQUxMX1dJVEhfQ0hFQ0tFRF9ISUVSQVJDSFlfTk9ERVNcbiAgKVxufVxuXG5leHBvcnQgY2xhc3MgU3BvdGZpcmVQYXJhbWV0ZXJzIHtcbiAgdXJsOiBzdHJpbmc7XG4gIHBhdGg6IHN0cmluZztcbiAgcGFnZTogc3RyaW5nIHwgbnVtYmVyO1xuICBkb21pZDogc3RyaW5nO1xuICBzaWQ6IHN0cmluZztcbiAgY3VzdG9taXphdGlvbjogQ3VzdG9taXphdGlvbjtcbiAgdmVyc2lvbiA9ICc3LjE0JztcbiAgZGVidWcgPSBmYWxzZTtcbiAgcmVsb2FkQW5hbHlzaXNJbnN0YW5jZSA9IGZhbHNlO1xuICBkb2N1bWVudDogYW55O1xuICBhcHA6IGFueTtcbiAgX3BhcmFtZXRlcnM6IHN0cmluZztcbiAgY29uc3RydWN0b3IodmFycz86IHt9KSB7XG4gICAgY29uc29sZS5sb2coJ0NPTlNUUiBTcG90ZmlyZVBhcmFtZXRlcnMnLCB2YXJzLCB0aGlzKTtcbiAgICBpZiAodmFycykge1xuICAgICAgT2JqZWN0LmtleXModmFycykuZm9yRWFjaChrZXkgPT4gdGhpc1trZXldID0gdmFyc1trZXldKTtcbiAgICB9XG4gICAgLy8gQ3JlYXRlIGEgVW5pcXVlIElEIGZvciB0aGlzIFNwb3RmaXJlIGRhc2hib2FyZFxuICAgIC8vXG4gICAgdGhpcy5kb21pZCA9IHRoaXMuZG9taWQgPyB0aGlzLmRvbWlkIDogdGhpcy5zaWQgPyBgJHt0aGlzLnNpZH1gIDogYCR7bmV3IERhdGUoKS5nZXRUaW1lKCl9YDtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgRGF0YSB7XG4gIGFsbFRhYmxlcyA9IHt9O1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIF9kYXRhKSB7IH1cblxuICAvLyBBIFNwb3RmaXJlIGFuYWx5c2lzIGNvbnRhaW5zIG9uZSBvciBtb3JlIGRhdGEgdGFibGVzLCByZXRyaWV2ZWQgYnkgdGhlIGdldERhdGFUYWJsZSxcbiAgLy8gZ2V0QWN0aXZlRGF0YVRhYmxlIGFuZCBnZXREYXRhVGFibGVzIG1ldGhvZHMuXG4gIHByaXZhdGUgZ2V0RGF0YVRhYmxlcyQgPSAoKSA9PiBkb0NhbGw8RGF0YVRhYmxlW10+KHRoaXMuX2RhdGEsICdnZXREYXRhVGFibGVzJyk7XG5cbiAgcHJpdmF0ZSBnZXREYXRhVGFibGVDb2xOYW1lcyQgPSAodCkgPT4gZG9DYWxsPERhdGFUYWJsZT4odGhpcy5fZGF0YSwgJ2dldERhdGFUYWJsZScsIHQpXG4gICAgLnBpcGUobWVyZ2VNYXAoZiA9PiB0aGlzLmdldERhdGFDb2x1bW5zJChmKSksIG1hcChkID0+ICh7IFt0XTogZCB9KSkpXG5cbiAgcHJpdmF0ZSBnZXREYXRhVGFibGUkID0gKHQpID0+IGRvQ2FsbDxEYXRhVGFibGU+KHRoaXMuX2RhdGEsICdnZXREYXRhVGFibGUnLCB0KVxuICAgIC5waXBlKG1lcmdlTWFwKGYgPT4gdGhpcy5nZXREYXRhQ29sdW1ucyQoZikpKVxuXG4gIC8vIEVhY2ggZGF0YSB0YWJsZSBjb250YWlucyBvbmUgb3IgbW9yZSBkYXRhIGNvbHVtbnMsIHJldHJpZXZlZCBieSB0aGUgZ2V0RGF0YUNvbHVtbixcbiAgLy8gZ2V0RGF0YUNvbHVtbnMgYW5kIHNlYXJjaERhdGFDb2x1bW5zLlxuICBwcml2YXRlIGdldERhdGFDb2x1bW5zJCA9ICh0KSA9PiBkb0NhbGw8RGF0YUNvbHVtbltdPih0LCAnZ2V0RGF0YUNvbHVtbnMnKS5waXBlKFxuICAgIG1lcmdlTWFwKGNvbHVtbnMgPT4ge1xuICAgICAgY29uc3Qgb2JzID0gW107XG4gICAgICBjb2x1bW5zLmZvckVhY2goKGNvbDogRGF0YUNvbHVtbikgPT4gb2JzLnB1c2goemlwKC4uLltvYnNlcnZhYmxlT2YoY29sKV0sIChhOiBEYXRhQ29sdW1uLCBiKSA9PiBhLmRhdGFDb2x1bW5OYW1lKSkpO1xuICAgICAgcmV0dXJuIGZvcmtKb2luKG9icyk7XG4gICAgfSlcbiAgKVxuXG5cbiAgLy8gRnJvbSB0aGUgRGF0YUNvbHVtbiBjbGFzcyBpdCBpcyBwb3NzaWJsZSB0byByZXRyaWV2ZSBtZXRhZGF0YSwgc3VjaCBhcyBjb2x1bW4gbmFtZSBhbmQgZGF0YSB0eXBlLlxuICAvLyBJdCBpcyBhbHNvIHBvc3NpYmxlIHRvIGdldCBhIGxpc3Qgb2YgdGhlIHVuaXF1ZSB2YWx1ZXMgaW4gdGhlIGRhdGEgY29sdW1uIHdpdGggdGhlIGdldERpc3RpbmN0VmFsdWVzIG1ldGhvZC5cbiAgcHJpdmF0ZSBnZXREaXN0aW5jdFZhbHVlcyQgPSAodDogRGF0YUNvbHVtbikgPT4gZG9DYWxsPERpc3RpbmN0VmFsdWVzPih0LCAnZ2V0RGlzdGluY3RWYWx1ZXMnLCAwLCAyMCkucGlwZShcbiAgICB0YXAoZyA9PiBkb0NvbnNvbGUoJ0RhdGEuRGlzdGluY3RWYWx1ZXMkJywgdCwgZywgZy5jb3VudCA+IDAgJiYgZy5jb3VudCA8IDI1KSksXG4gICAgLy8gZmlsdGVyKGcgPT4gZy5jb3VudCA+IDAgJiYgZy5jb3VudCA8IDI1KSxcbiAgICAvLyAgdGFwKGcgPT4gZG9Db25zb2xlKCdbT0JTXScsICdEaXN0aW5jdFZhbHVlcyBmaWx0cmVzJywgZykpLFxuICAgIHBsdWNrKCd2YWx1ZXMnKSlcblxuICBnZXRUYWJsZXMkID0gKCkgPT4gdGhpcy5nZXREYXRhVGFibGVzJCgpLnBpcGUoXG4gICAgbWVyZ2VNYXAodGFibGVzID0+IHtcbiAgICAgIGNvbnN0IG9icyA9IFtdO1xuICAgICAgdGFibGVzLmZvckVhY2godGFibGUgPT4gb2JzLnB1c2godGhpcy5nZXREYXRhVGFibGVDb2xOYW1lcyQodGFibGUuZGF0YVRhYmxlTmFtZSkpKTtcbiAgICAgIHJldHVybiBmb3JrSm9pbihvYnMpO1xuICAgIH0pLFxuICAgIG1hcChrID0+IHtcbiAgICAgIGxldCB6ID0ge307XG4gICAgICBrLmZvckVhY2gocCA9PiB6ID0geyAuLi56LCAuLi5wIH0pO1xuICAgICAgcmV0dXJuIHo7XG4gICAgfSlcbiAgKVxuICBnZXRBbGxUYWJsZXMkID0gKCkgPT4gdGhpcy5nZXREYXRhVGFibGVzJCgpLnBpcGUoXG4gICAgbWVyZ2VNYXAodGFibGVzID0+IHtcbiAgICAgIGNvbnN0IG9icyA9IFtdO1xuICAgICAgdGFibGVzLmZvckVhY2godGFibGUgPT4gb2JzLnB1c2godGhpcy5nZXREYXRhVGFibGUkKHRhYmxlLmRhdGFUYWJsZU5hbWUpKSk7XG4gICAgICByZXR1cm4gZm9ya0pvaW4ob2JzKTtcbiAgICB9KSwgbWFwKHRhYmxlcyA9PiB7XG4gICAgICBjb25zdCBkYXRhVGFibGVzID0gW107XG4gICAgICAodGFibGVzWzBdIGFzIFtdKS5mb3JFYWNoKGNvbHVtbnMgPT4ge1xuICAgICAgICBjb25zdCB0bmFtZSA9IGNvbHVtbnNbJ3RhYk5hbWUnXTtcbiAgICAgICAgaWYgKCFkYXRhVGFibGVzW3RuYW1lXSkgeyBkYXRhVGFibGVzW3RuYW1lXSA9IHt9OyB9XG4gICAgICAgIGRhdGFUYWJsZXNbdG5hbWVdW2NvbHVtbnNbJ2NvbE5hbWUnXV0gPSBjb2x1bW5zWyd2YWxzJ107XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkYXRhVGFibGVzO1xuICAgIH0pKVxufVxuXG5leHBvcnQgY2xhc3MgRG9jTWV0YWRhdGEge1xuICBzaXplOiBudW1iZXI7XG4gIHNpemVVbml0ID0gJ0InO1xuICBjb250ZW50U2l6ZTogbnVtYmVyO1xuICBjcmVhdGVkOiBEYXRlO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBsYXN0TW9kaWZpZWQ6IERhdGU7XG4gIHBhdGg6IHN0cmluZztcbiAgdGl0bGU6IHN0cmluZztcblxuICBjb25zdHJ1Y3RvcihwPykge1xuICAgIGlmIChwKSB7XG4gICAgICB0aGlzLmNvbnRlbnRTaXplID0gcGFyc2VJbnQocFsnY29udGVudFNpemUnXSwgMTApO1xuICAgICAgaWYgKHRoaXMuY29udGVudFNpemUgPiAoMTAyNCAqIDEwMjQpKSB7XG4gICAgICAgIHRoaXMuc2l6ZSA9IHRoaXMuY29udGVudFNpemUgLyAoMTAyNCAqIDEwMjQpO1xuICAgICAgICB0aGlzLnNpemVVbml0ID0gJ01CJztcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5jb250ZW50U2l6ZSA+IDEwMjQpIHtcbiAgICAgICAgdGhpcy5zaXplID0gdGhpcy5jb250ZW50U2l6ZSAvIDEwMjQ7XG4gICAgICAgIHRoaXMuc2l6ZVVuaXQgPSAnS0InO1xuICAgICAgfVxuICAgICAgdGhpcy5jcmVhdGVkID0gbmV3IERhdGUocC5jcmVhdGVkKTtcbiAgICAgIHRoaXMubGFzdE1vZGlmaWVkID0gbmV3IERhdGUocC5sYXN0TW9kaWZpZWQpO1xuICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IHAuZGVzY3JpcHRpb247XG4gICAgICB0aGlzLnBhdGggPSBwLnBhdGg7XG4gICAgICB0aGlzLnRpdGxlID0gcC50aXRsZTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIERvY3VtZW50IHtcbiAgcHJpdmF0ZSBfZG9jO1xuICBwcml2YXRlIG1hcmtpbmc6IE1hcmtpbmc7XG4gIHByaXZhdGUgZmlsdGVyaW5nOiBGaWx0ZXJpbmc7XG4gIHByaXZhdGUgZGF0YTogRGF0YTtcbiAgY29uc3RydWN0b3IoYXBwLCBpZCwgcGFnZSwgY3VzdG8pIHtcbiAgICB0aGlzLl9kb2MgPSBhcHAub3BlbkRvY3VtZW50KGlkLCBwYWdlLCBjdXN0byk7XG4gICAgYXBwLm9uT3BlbmVkJCgpLnN1YnNjcmliZShkb2MgPT4ge1xuICAgICAgZG9Db25zb2xlKGBEb2N1bWVudC5vbk9wZW5lZCQ6IHBhZ2UgaXMgbm93IG9wZW5lZDpgLCBkb2MpO1xuICAgICAgdGhpcy5fZG9jID0gZG9jO1xuICAgICAgLy8gUmVnaXN0ZXIgZXZlbnQgaGFuZGxlciBmb3IgcGFnZSBjaGFuZ2UgZXZlbnRzLlxuICAgICAgdGhpcy5vbkFjdGl2ZVBhZ2VDaGFuZ2VkJCgpLnN1YnNjcmliZSh0aGlzLm9uQWN0aXZlUGFnZUNoYW5nZWRDYWxsYmFjayk7XG4gICAgICB0aGlzLm1hcmtpbmcgPSBuZXcgTWFya2luZyh0aGlzLl9kb2MubWFya2luZyk7XG4gICAgICB0aGlzLmZpbHRlcmluZyA9IG5ldyBGaWx0ZXJpbmcodGhpcy5fZG9jLmZpbHRlcmluZyk7XG4gICAgICB0aGlzLmRhdGEgPSBuZXcgRGF0YSh0aGlzLl9kb2MuZGF0YSk7XG4gICAgfSk7XG4gIH1cbiAgcHJpdmF0ZSBvbkFjdGl2ZVBhZ2VDaGFuZ2VkQ2FsbGJhY2sgPSAocGFnZVN0YXRlKSA9PiBjb25zb2xlLmxvZygnb25BY3RpdmVQYWdlQ2hhbmdlZENhbGxiYWNrJywgcGFnZVN0YXRlKTtcbiAgcHJpdmF0ZSBkbyA9IDxUPihtOiBzdHJpbmcpID0+IGRvQ2FsbDxUPih0aGlzLl9kb2MsIG0pO1xuICBnZXREb2N1bWVudE1ldGFkYXRhJCA9ICgpOiBPYnNlcnZhYmxlPERvY01ldGFkYXRhPiA9PiB0aGlzLmRvPERvY01ldGFkYXRhPignZ2V0RG9jdW1lbnRNZXRhZGF0YScpLnBpcGUoXG4gICAgbWFwKGcgPT4gbmV3IERvY01ldGFkYXRhKGcpKSlcbiAgZ2V0UGFnZXMkID0gKCkgPT4gdGhpcy5kbygnZ2V0UGFnZXMnKS5waXBlKG1hcChtID0+IE9iamVjdC5rZXlzKG0pLm1hcChmID0+IG1bZl0ucGFnZVRpdGxlKSkpO1xuICAvLyBnZXREb2N1bWVudFByb3BlcnRpZXMkID0gKCkgPT4gdGhpcy5kbygnZ2V0RG9jdW1lbnRQcm9wZXJ0aWVzJyk7XG4gIC8vIGdldEJvb2ttYXJrcyQgPSAoKSA9PiB0aGlzLmRvKCdnZXRCb29rbWFya3MnKTtcbiAgLy8gZ2V0Qm9va21hcmtOYW1lcyQgPSAoKSA9PiB0aGlzLmRvKCdnZXRCb29rbWFya05hbWVzJyk7XG4gIC8vIGdldFJlcG9ydHMkID0gKCkgPT4gdGhpcy5kbygnZ2V0UmVwb3J0cycpO1xuICBnZXRBY3RpdmVQYWdlJCA9ICgpID0+IHRoaXMuZG88UGFnZVN0YXRlPignZ2V0QWN0aXZlUGFnZScpO1xuICBzZXRBY3RpdmVQYWdlID0gKHA6IHN0cmluZyB8IG51bWJlcikgPT4gdGhpcy5fZG9jLnNldEFjdGl2ZVBhZ2UocCk7XG4gIGdldERhdGEgPSAoKSA9PiB0aGlzLmRhdGE7XG4gIGdldE1hcmtpbmcgPSAoKSA9PiB0aGlzLm1hcmtpbmc7XG4gIGdldEZpbHRlcmluZyA9ICgpID0+IHRoaXMuZmlsdGVyaW5nO1xuICBwdWJsaWMgb25Eb2N1bWVudFJlYWR5JCA9ICgpID0+IGRvQ2FsbCh0aGlzLl9kb2MsICdvbkRvY3VtZW50UmVhZHknKTtcbiAgcHVibGljIGNsb3NlID0gKCkgPT4gdGhpcy5fZG9jID8gdGhpcy5fZG9jLmNsb3NlKCkgOiBudWxsO1xuICBwcml2YXRlIG9uQWN0aXZlUGFnZUNoYW5nZWQkID0gKCkgPT4gZG9DYWxsKHRoaXMuX2RvYywgJ29uQWN0aXZlUGFnZUNoYW5nZWQnKTtcbn1cblxuLyoqXG4gKiBAZGVzY3JpcHRpb25cbiAqIFR1cm4gYXN5bmMgY2FsbHMgaW50byBPYnNlcnZhYmxlcy5cbiAqXG4gKiBGb3IgbWV0aG9kcyB3aGljaCBuYW1lIHN0YXJ0cyB3aXRoICdvbicsIHRoZSBvYnNlcnZhYmxlIGNvbnRpbnVlcyBwcm92aWRpbmcgZGF0YSBpdCdzIHJlY2VpdmVkLlxuICogT3RoZXJ3aXNlIHRoZSBvYnNlcnZhYmxlIHN0b3BzIHNlbmRpbmcgZGF0YSBhdCBmaXJzdCBidWZmZXIgcmVjZWl2ZWQuXG4gKiBBbiBlcnJvciBpcyByYWlzZWQgd2hlbiB0aGUgNTBtaW4gdGltZW91dCBleHBpcmVzLlxuICpcbiAqIEBwYXJhbSBvYmogdGhlIG9iamVjdCBhZ2FpbnN0IHdlIGNhbGwgbWV0aG9kXG4gKiBAcGFyYW0gbSB0aGUgbmFtZSBvZiBtZXRob2RcbiAqIEBwYXJhbSAuLi5hIGxpc3Qgb2YgYXJndW1lbnRzIHRvIGJlIHNlbnQgYWxvbmcgd2l0aCB0aGUgbWV0aG9kXG4gKlxuICogQHJldHVybiBPYnNlcnZhYmxlPFQ+IGFuIG9ic2VydmFibGUgdGhhdCBjb3JyZXNwb25kcyB0byB0aGUgb3JpZ2luYWwgY2FsbGJhY2tcbiAqXG4gKi9cbmZ1bmN0aW9uIGRvQ2FsbDxUPihvYmosIG06IHN0cmluZywgLi4uYTogYW55W10pOiBPYnNlcnZhYmxlPFQ+IHtcbiAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlPFQ+KG9ic2VydmVyID0+IHtcbiAgICBjb25zdCBvbmVTaG90ID0gWydvbkRvY3VtZW50UmVhZHknXTtcbiAgICAvLyBkb0NvbnNvbGUoJ1tPQlNdJywgJ2RvQ2FsbCBvYmo9Jywgb2JqLCAnLCBtPScsIG0sICcsIGFyZz0nLCBhcmdzLCB0eXBlb2Ygb2JqKTtcbiAgICBpZiAodHlwZW9mIG9ialttXSAhPT0gJ2Z1bmN0aW9uJyB8fCAhb2JqKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbT0JTXScsIGBmdW5jdGlvbiAnJHttfScgZG9lcyBub3QgZXhpc3Qgb24gYCwgb2JqKTtcbiAgICAgIG9ic2VydmVyLmVycm9yKGBmdW5jdGlvbiAnJHttfScgZG9lcyBub3QgZXhpc3Qgb24gb2JqZXQgJHtKU09OLnN0cmluZ2lmeShvYmopfWApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgLy8gZG9Db25zb2xlKCdbT0JTXScsIGBDYWxsICR7bX0oJHthLmpvaW4oJywnKX0pYCwgYS5sZW5ndGgpO1xuICAgICAgY29uc3QgcSA9IChnOiBUKSA9PiBvYnNlcnZlci5uZXh0KGcpO1xuICAgICAgY29uc3QgcCA9IChnOiBUKSA9PiB7IG9ic2VydmVyLm5leHQoZyk7IG9ic2VydmVyLmNvbXBsZXRlKCk7IH07XG4gICAgICByZXR1cm4gbS5zdGFydHNXaXRoKCdvbicpICYmIG9uZVNob3QuaW5kZXhPZihtKSA9PT0gLTEgPyBvYmpbbV0oLi4uYSwgcSkgOiBvYmpbbV0oLi4uYSwgcCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1tPQlNdJywgJ2RvQ2FsbCBlcnJldXI6ICcsIGVycik7XG4gICAgICBvYnNlcnZlci5lcnJvcihlcnIpO1xuICAgIH1cbiAgfSkucGlwZShcbiAgICB0aW1lb3V0KDMwMDEwMDApLFxuICAgIGNhdGNoRXJyb3IoZSA9PiB7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIFRpbWVvdXRFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBbU1BPVEZJUkUtV0VCUExBWUVSXSBUaGUgY2FsbCAke219KCR7YS5qb2luKCcsJyl9KSBkb2VzIG5vdCBhbnN3ZXIgYWZ0ZXIgMzAwMXNlYyBvbiAke0pTT04uc3RyaW5naWZ5KG9iail9YCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdbU1BPVEZJUkUtV0VCUExBWUVSXSBFUlJPUiBvbiBkb0NhbGwnLCBlKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aHJvd0Vycm9yKGUpO1xuICAgIH0pKTtcbn1cblxuZXhwb3J0IGNsYXNzIEFwcGxpY2F0aW9uIHtcbiAgcHJpdmF0ZSBfYXBwOiBhbnk7XG4gIHByaXZhdGUgcmVhZHlTdWJqZWN0ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxib29sZWFuPihmYWxzZSk7XG4gIHB1YmxpYyBvbkFwcGxpY2F0aW9uUmVhZHkkID0gdGhpcy5yZWFkeVN1YmplY3QuYXNPYnNlcnZhYmxlKCkucGlwZShmaWx0ZXIoZCA9PiBkKSk7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIHVybDogc3RyaW5nLFxuICAgIHB1YmxpYyBjdXN0b21pemF0aW9uOiBDdXN0b21pemF0aW9uLFxuICAgIHB1YmxpYyBwYXRoOiBzdHJpbmcsXG4gICAgcHVibGljIHBhcmFtZXRlcnM6IHN0cmluZyxcbiAgICBwdWJsaWMgcmVsb2FkQW5hbHlzaXNJbnN0YW5jZTogYm9vbGVhbixcbiAgICBwdWJsaWMgdmVyc2lvbjogc3RyaW5nLFxuICAgIHB1YmxpYyBvbkNyZWF0ZUxvZ2luRWxlbWVudCkge1xuICAgIHRoaXMuX2FwcCA9IG5ldyBzcG90ZmlyZS53ZWJQbGF5ZXIuY3JlYXRlQXBwbGljYXRpb24odGhpcy51cmwsXG4gICAgICB0aGlzLmN1c3RvbWl6YXRpb24sIHRoaXMucGF0aCwgdGhpcy5wYXJhbWV0ZXJzLCB0aGlzLnJlbG9hZEFuYWx5c2lzSW5zdGFuY2UsXG4gICAgICB0aGlzLnZlcnNpb24sIHRoaXMub25SZWFkeUNhbGxiYWNrLCB0aGlzLm9uQ3JlYXRlTG9naW5FbGVtZW50KTtcbiAgfVxuXG4gIHByaXZhdGUgb25SZWFkeUNhbGxiYWNrID0gKHJlc3BvbnNlLCBuZXdBcHA6IEFwcGxpY2F0aW9uKSA9PiB7XG4gICAgZG9Db25zb2xlKCdBcHBsaWNhdGlvbi5vblJlYWR5Q2FsbGJhY2snLCByZXNwb25zZSwgbmV3QXBwKTtcbiAgICB0aGlzLl9hcHAgPSBuZXdBcHA7XG4gICAgLy8gUmVnaXN0ZXIgYW4gZXJyb3IgaGFuZGxlciB0byBjYXRjaCBlcnJvcnMuXG4gICAgdGhpcy5fYXBwLm9uRXJyb3IodGhpcy5vbkVycm9yQ2FsbGJhY2spO1xuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09ICdPSycpIHtcbiAgICAgIC8vIFRoZSBhcHBsaWNhdGlvbiBpcyByZWFkeSwgbWVhbmluZyB0aGF0IHRoZSBhcGkgaXMgbG9hZGVkIGFuZCB0aGF0IHRoZSBhbmFseXNpcyBwYXRoXG4gICAgICAvLyBpcyB2YWxpZGF0ZWQgZm9yIHRoZSBjdXJyZW50IHNlc3Npb24oYW5vbnltb3VzIG9yIGxvZ2cgZWQgaW4gdXNlcilcbiAgICAgIHRoaXMucmVhZHlTdWJqZWN0Lm5leHQodHJ1ZSk7XG4gICAgICB0aGlzLnJlYWR5U3ViamVjdC5jb21wbGV0ZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBlcnJNc2cgPSBgU3RhdHVzIG5vdCBPSy4gJHtyZXNwb25zZS5zdGF0dXN9OiAke3Jlc3BvbnNlLm1lc3NhZ2V9YDtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tTUE9URklSRS1XRUJQTEFZRVJdIEFwcGxpY2F0aW9uLm9uUmVhZHlDYWxsYmFjaycsIGVyck1zZywgcmVzcG9uc2UpO1xuICAgICAgdGhpcy5yZWFkeVN1YmplY3QuZXJyb3IoZXJyTXNnKTtcbiAgICB9XG4gIH1cbiAgLy8gRGlzcGxheXMgYW4gZXJyb3IgbWVzc2FnZSBpZiBzb21ldGhpbmcgZ29lcyB3cm9uZyBpbiB0aGUgV2ViIFBsYXllci5cbiAgcHJpdmF0ZSBvbkVycm9yQ2FsbGJhY2sgPSAoZXJyQ29kZTogc3RyaW5nLCBkZXNjOiBzdHJpbmcpID0+IGNvbnNvbGUuZXJyb3IoYFtTUE9URklSRS1XRUJQTEFZRVJdICR7ZXJyQ29kZX06ICR7ZGVzY31gKTtcbiAgb25PcGVuZWQkID0gKCkgPT4gZG9DYWxsKHRoaXMuX2FwcCwgJ29uT3BlbmVkJyk7XG4gIGdldERvY3VtZW50ID0gKGlkOiBzdHJpbmcsIHBhZ2U6IHN0cmluZyB8IG51bWJlciwgY3VzdG8/OiBDdXN0b21pemF0aW9uKTogRG9jdW1lbnQgPT5cbiAgICBuZXcgRG9jdW1lbnQodGhpcywgaWQsIHBhZ2UsIGN1c3RvID8gY3VzdG8gOiB0aGlzLmN1c3RvbWl6YXRpb24pXG4gIG9wZW5Eb2N1bWVudCA9IChpZDogc3RyaW5nLCBwYWdlOiBzdHJpbmcgfCBudW1iZXIsIGN1c3RvOiBDdXN0b21pemF0aW9uKSA9PiB0aGlzLl9hcHAub3BlbkRvY3VtZW50KGlkLCBwYWdlLCBjdXN0byk7XG59XG4iXX0=