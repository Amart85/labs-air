/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
// Copyright (c) 2018-2018. TIBCO Software Inc. All Rights Reserved. Confidential & Proprietary.
import { Component, Input, EventEmitter, ViewChild, ElementRef, Output, ViewEncapsulation } from '@angular/core';
import { BehaviorSubject } from 'rxjs';
import { tap } from 'rxjs/operators';
import { SpotfireCustomization, SpotfireFilter } from '../spotfire-customization';
import { DocMetadata, SpotfireParameters } from '../spotfire-webplayer';
import { DocumentService } from '../document.service';
var SpotfireViewerComponent = /** @class */ (function () {
    function SpotfireViewerComponent(docSvc) {
        var _this = this;
        this.docSvc = docSvc;
        /**
         * \@description
         * print debug logs to JS console. Default to false
         */
        this.debug = false;
        this.maxRows = 10;
        this.spotParams = new SpotfireParameters();
        this.errorMessages = [];
        this.edit = false;
        /* Filtering observables, emitter and subject*/
        this.filterSubject = new BehaviorSubject([]);
        this.filter$ = this.filterSubject.asObservable();
        /**
         * \@description
         * Optional. emit filters set by user in dashboard
         */
        this.filteringEvent = new EventEmitter(false);
        /* Marking observables, emitter and subject*/
        this.markerSubject = new BehaviorSubject({});
        this.marker$ = this.markerSubject.asObservable();
        /**
         * \@description
         * Optional. emit marking set by user in dashboard
         */
        this.markingEvent = new EventEmitter(false);
        this.markedRows = {};
        this.longTime = false;
        this.doConsole = (/**
         * @param {...?} args
         * @return {?}
         */
        function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            return _this.debug && console.log.apply(console, tslib_1.__spread(['[SPOTFIRE-VIEWER]'], args));
        });
        this.ngOnChanges = (/**
         * @param {?} changes
         * @return {?}
         */
        function (changes) {
            if (!!changes) {
                _this.display(changes);
            }
        });
        this.stopPropagation = (/**
         * @param {?} e
         * @return {?}
         */
        function (e) { return e.stopPropagation(); });
        this.isMarkingWiredUp = (/**
         * @return {?}
         */
        function () { return _this.markingEvent.observers.length > 0; });
        this.isFiltingWiredUp = (/**
         * @return {?}
         */
        function () { return _this.filteringEvent.observers.length > 0; });
        this.displayErrorMessage = (/**
         * @param {?} message
         * @return {?}
         */
        function (message) {
            console.error('ERROR:', message);
            _this.errorMessages.push(message);
            if (!_this.spotParams.document) {
                // Do not display the info Message when document is running
                _this.spot.nativeElement.style.fontFamily = 'monospace';
                _this.spot.nativeElement.style.color = '#e82127';
                _this.spot.nativeElement.style.textAlign = 'center';
                _this.spot.nativeElement.style.padding = '30px';
                _this.spot.nativeElement.textContent = _this.errorMessages.join('<br>');
            }
        });
        this.displayInfoMessage = (/**
         * @param {?} message
         * @return {?}
         */
        function (message) {
            console.log(message);
            if (!_this.spotParams.document && _this.debug) {
                // Do not display the info Message when document is running
                _this.spot.nativeElement.style.fontFamily = 'monospace';
                _this.spot.nativeElement.style.color = 'black';
                _this.spot.nativeElement.style.textAlign = 'center';
                _this.spot.nativeElement.textContent = message;
            }
        });
        this.afterDisplay = (/**
         * @param {?} doc
         * @return {?}
         */
        function (doc) {
            _this.doConsole("SpotfireViewerComponent openPage(" + _this.spotParams.page + ") returns", doc);
            _this.document = doc;
            if (_this.filters && _this.document.getFiltering()) {
                /** @type {?} */
                var flt = _this.document.getFiltering();
                flt.resetAllFilters();
                /*
                this.doConsole(`SpotfireViewerComponent set Filter(avant)`, this.filters);
                (this.filters as Array<SpotfireFilter>).forEach(t => t.setFilterType(spotfire));
                this.doConsole(`SpotfireViewerComponent set Filter(apres)`, this.filters);
              */
                flt.set(_this.filters);
                _this.loadFilters();
                _this.doConsole('FILTER', _this.filters);
            }
            _this.doForm(_this.document);
            if (_this.markingOn) {
                // Clear marking
                _this.markerSubject.next({});
                _this.document.getData().getTables$()
                    .pipe(tap((/**
                 * @param {?} allTableNames
                 * @return {?}
                 */
                function (allTableNames) { return _this.doConsole("All tables and column names:", allTableNames); })))
                    .subscribe((/**
                 * @param {?} allTableNames
                 * @return {?}
                 */
                function (allTableNames) { return _this.document.getMarking().getMarkingNames$()
                    .pipe(tap((/**
                 * @param {?} markingNames
                 * @return {?}
                 */
                function (markingNames) { return _this.doConsole("All marking names:", markingNames); })))
                    .subscribe((/**
                 * @param {?} markingNames
                 * @return {?}
                 */
                function (markingNames) { return markingNames.forEach((/**
                 * @param {?} markingName
                 * @return {?}
                 */
                function (markingName) {
                    /** @type {?} */
                    var tableNames = _this.markingOn === '*' ? allTableNames : _this.markingOn;
                    Object.keys(tableNames).forEach((/**
                     * @param {?} tName
                     * @return {?}
                     */
                    function (tName) {
                        /** @type {?} */
                        var columnNames = _this.markingOn === '*' ? allTableNames[tName] : tableNames[tName];
                        if (columnNames.length === 1 && columnNames[0] === '*') {
                            columnNames = allTableNames[tName];
                        }
                        _this.doConsole("marking.onChanged(" + markingName + ", " + tName + ", " + JSON.stringify(columnNames) + ", " + _this.maxRows + ")");
                        _this.document.getMarking().onChanged$(markingName, tName, columnNames, _this.maxRows)
                            .subscribe((/**
                         * @param {?} f
                         * @return {?}
                         */
                        function (f) { return _this.updateMarking(tName, markingName, f); }));
                    }));
                })); })); }));
            }
            if (_this.isFiltingWiredUp()) {
                _this.doConsole('we have observers for filtering');
                // Subscribe to filteringEvent and emit the result to the Output if filter panel is displayed
                //
                _this.filter$.pipe(tap((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return _this.doConsole('Emit filter', f); })))
                    .subscribe((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return _this.filteringEvent.emit(f); }));
            }
            if (_this.isMarkingWiredUp()) {
                _this.doConsole('we have observers for marking');
                // Subscribe to markingEvent and emit the result to the Output
                //
                _this.marker$.pipe(tap((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return _this.doConsole('Emit marking', f); })))
                    .subscribe((/**
                 * @param {?} f
                 * @return {?}
                 */
                function (f) { return _this.markingEvent.emit(f); }));
            }
            // console.log('YES loadFilters');
            // setInterval(() => this.loadFilters(), 3000);
        });
        /**
         * \@description
         * Callback method played when marking changes are detected.
         *
         * Will gather all marking and emit an event back to caller.
         *
         * @param tName Table name
         * @param mName Maring name
         * @param res marked rows returned by Spotfire
         */
        this.updateMarking = (/**
         * @param {?} tName
         * @param {?} mName
         * @param {?} res
         * @return {?}
         */
        function (tName, mName, res) {
            if (Object.keys(res).length > 0) {
                _this.doConsole("We have marked rows on marking '" + mName + "' for table '" + tName + "':", res);
                // update the marked row if partial selection
                //
                if (!_this.markedRows[mName]) {
                    _this.markedRows[mName] = {};
                }
                if (!_this.markedRows[mName][tName]) {
                    _this.markedRows[mName][tName] = res;
                }
                else {
                    _this.markedRows[mName][tName] = Object.assign(_this.markedRows[mName][tName], res);
                }
                //   this.doConsole('[MARKING] on publie', this.markedRows);
                _this.markerSubject.next(_this.markedRows);
            }
            else if (_this.markedRows[mName] && _this.markedRows[mName][tName]) {
                // remove the marked row if no marking
                //
                delete _this.markedRows[mName][tName];
                if (Object.keys(_this.markedRows[mName]).length === 0) {
                    delete _this.markedRows[mName];
                }
                _this.markerSubject.next(_this.markedRows);
            }
            else {
                //  this.doConsole(`No rows are marked on marking '${mName}' for table '${tName}'`);
            }
            _this.loadFilters();
        });
        console.log('SPOTFIRE WRAPPER - 10 juillet - Angular 8');
        this.doConsole('Welcome !');
        setTimeout((/**
         * @return {?}
         */
        function () { return _this.longTime = true; }), 6000);
    }
    Object.defineProperty(SpotfireViewerComponent.prototype, "parameters", {
        /**
          * @description
          * Optional. Load parameters for the analysis.
          */
        set: /**
         * \@description
         * Optional. Load parameters for the analysis.
         * @param {?} value
         * @return {?}
         */
        function (value) {
            this._parameters = value;
            this.spotParams._parameters = value;
            if (this.app) {
                this.openPath(this.path);
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @return {?}
     */
    SpotfireViewerComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.doConsole('OnInit', this.url, this.path);
        this.display();
    };
    /**
     * @description
     * Redraw the dashboard.
     * Depending on nature of change (url/path/page) the dashboard is fully refreshed or adjusted accordingly
     * @param changes The list of changes to apply
     */
    /**
     * \@description
     * Redraw the dashboard.
     * Depending on nature of change (url/path/page) the dashboard is fully refreshed or adjusted accordingly
     * @param {?=} changes The list of changes to apply
     * @return {?}
     */
    SpotfireViewerComponent.prototype.display = /**
     * \@description
     * Redraw the dashboard.
     * Depending on nature of change (url/path/page) the dashboard is fully refreshed or adjusted accordingly
     * @param {?=} changes The list of changes to apply
     * @return {?}
     */
    function (changes) {
        this.doConsole('Display', changes);
        if (typeof this.customization === 'string') {
            this.customization = new SpotfireCustomization(JSON.parse(this.customization));
        }
        else {
            this.customization = new SpotfireCustomization(this.customization);
        }
        if (typeof this.filters === 'string') {
            /** @type {?} */
            var allFilters_1 = [];
            JSON.parse(this.filters).forEach((/**
             * @param {?} m
             * @return {?}
             */
            function (m) { return allFilters_1.push(new SpotfireFilter(m)); }));
            this.filters = allFilters_1;
        }
        if (typeof this.markingOn === 'string' && this.markingOn !== '*') {
            this.markingOn = JSON.parse(this.markingOn);
        }
        this.doConsole('display', changes, this.url, this.path, 'PAGE=', this.page, this.customization, this.maxRows, this.app, this.markingOn);
        if (!changes || changes.url) {
            this.openWebPlayer(this.url, this.path, this.customization);
        }
        else if (this.app && changes.page) {
            this.openPage(this.page);
        }
        else {
            this.doConsole("The Url attribute is not provided, flip the dashboard and display form!");
            this.edit = true;
            this.metadata = new DocMetadata();
        }
    };
    /**
     * @description
     * Get Spotfire JavaScript API (webPlayer) from url
     *
     * When a componenet is initiated or url is updated, it lazy loads the library
     * Once loaded it opens the path.
     *
     * @param url the webPlayer server url
     * @param path the path to the page
     * @param custo the initial customization info
     */
    /**
     * \@description
     * Get Spotfire JavaScript API (webPlayer) from url
     *
     * When a componenet is initiated or url is updated, it lazy loads the library
     * Once loaded it opens the path.
     *
     * @protected
     * @param {?} url the webPlayer server url
     * @param {?} path the path to the page
     * @param {?} customization
     * @return {?}
     */
    SpotfireViewerComponent.prototype.openWebPlayer = /**
     * \@description
     * Get Spotfire JavaScript API (webPlayer) from url
     *
     * When a componenet is initiated or url is updated, it lazy loads the library
     * Once loaded it opens the path.
     *
     * @protected
     * @param {?} url the webPlayer server url
     * @param {?} path the path to the page
     * @param {?} customization
     * @return {?}
     */
    function (url, path, customization) {
        var _this = this;
        this.edit = false;
        this.url = url;
        this.path = path;
        this.customization = customization;
        this.doConsole("SpotfireViewerComponent openWebPlayer(" + url + ")");
        this.displayInfoMessage(this.url + "...");
        // Create a Unique ID for this Spotfire dashboard
        //
        this.spot.nativeElement.id = this.sid ? this.sid : new Date().getTime();
        this.spotParams = tslib_1.__assign({}, this.spotParams, { path: path, url: url, customization: customization, domid: this.spot.nativeElement.id, page: this.page });
        this.docSvc.openWebPlayer$(this.spotParams).subscribe((/**
         * @param {?} doc
         * @return {?}
         */
        function (doc) { return _this.afterDisplay(doc); }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) { return _this.displayErrorMessage(err); }));
    };
    /**
     * @description
     * Open the path using JavaScript API (spotfire.webPlayer.createApplication)
     *
     * @param path the absolute analysis path
     */
    /**
     * \@description
     * Open the path using JavaScript API (spotfire.webPlayer.createApplication)
     *
     * @protected
     * @param {?} path the absolute analysis path
     * @return {?}
     */
    SpotfireViewerComponent.prototype.openPath = /**
     * \@description
     * Open the path using JavaScript API (spotfire.webPlayer.createApplication)
     *
     * @protected
     * @param {?} path the absolute analysis path
     * @return {?}
     */
    function (path) {
        var _this = this;
        this.path = path;
        this.displayInfoMessage(this.url + "/" + path + "...");
        this.doConsole("SpotfireViewerComponent openPath(" + path + ")", this.sid);
        this.spotParams = tslib_1.__assign({}, this.spotParams, { path: path, domid: this.spot.nativeElement.id });
        this.docSvc.openPath$(this.spotParams).subscribe((/**
         * @param {?} doc
         * @return {?}
         */
        function (doc) { return _this.afterDisplay(doc); }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) { return _this.displayErrorMessage(err); }));
    };
    /**
     * @protected
     * @param {?} doc
     * @return {?}
     */
    SpotfireViewerComponent.prototype.doForm = /**
     * @protected
     * @param {?} doc
     * @return {?}
     */
    function (doc) { };
    /**
     * @description
     * Open the Document page
     *
     * @param page the document page that will be displayed
     */
    /**
     * \@description
     * Open the Document page
     *
     * @param {?} page the document page that will be displayed
     * @return {?}
     */
    SpotfireViewerComponent.prototype.openPage = /**
     * \@description
     * Open the Document page
     *
     * @param {?} page the document page that will be displayed
     * @return {?}
     */
    function (page) {
        var _this = this;
        this.displayInfoMessage(this.url + "/" + this.path + "/" + (page ? page : '') + "...");
        this.doConsole("SpotfireViewerComponent openPage(" + page + ")");
        this.page = page;
        this.spotParams = tslib_1.__assign({}, this.spotParams, { page: page });
        /** @type {?} */
        var p = this.spotParams;
        this.docSvc.openPage$(p).subscribe((/**
         * @param {?} doc
         * @return {?}
         */
        function (doc) { return _this.afterDisplay(doc); }));
    };
    /**
     * @description
     * Emit to caller the filters
     */
    /**
     * \@description
     * Emit to caller the filters
     * @private
     * @return {?}
     */
    SpotfireViewerComponent.prototype.loadFilters = /**
     * \@description
     * Emit to caller the filters
     * @private
     * @return {?}
     */
    function () {
        var _this = this;
        //  console.log('AA Nicolas loadFilters BLOUP ! (19 juin 2019)');
        if (this.isFiltingWiredUp()) {
            this.document.getFiltering().getAllModifiedFilterColumns()
                .subscribe((/**
             * @param {?} fs
             * @return {?}
             */
            function (fs) { return _this.filterSubject.next(fs); }));
        }
        //    this.document.getFiltering().getAllModifiedFilterColumns()
        //      .subscribe(fs => console.log('les FILTERS:', fs));
    };
    SpotfireViewerComponent.decorators = [
        { type: Component, args: [{
                    selector: 'spotfire-viewer',
                    exportAs: 'spotfireViewer',
                    template: "<div style='height:100%; border:2px dashed green; border-radius:8px' #spot></div>",
                    encapsulation: ViewEncapsulation.None
                }] }
    ];
    /** @nocollapse */
    SpotfireViewerComponent.ctorParameters = function () { return [
        { type: DocumentService }
    ]; };
    SpotfireViewerComponent.propDecorators = {
        debug: [{ type: Input }],
        url: [{ type: Input }],
        path: [{ type: Input }],
        page: [{ type: Input }],
        sid: [{ type: Input }],
        customization: [{ type: Input }],
        filters: [{ type: Input }],
        markingOn: [{ type: Input }],
        maxRows: [{ type: Input }],
        parameters: [{ type: Input }],
        spot: [{ type: ViewChild, args: ['spot', { static: true, read: ElementRef },] }],
        filteringEvent: [{ type: Output }],
        markingEvent: [{ type: Output }]
    };
    return SpotfireViewerComponent;
}());
export { SpotfireViewerComponent };
if (false) {
    /**
     * \@description
     * print debug logs to JS console. Default to false
     * @type {?}
     */
    SpotfireViewerComponent.prototype.debug;
    /**
     * \@description
     * The URL to the Web Player server
     * @type {?}
     */
    SpotfireViewerComponent.prototype.url;
    /**
     * \@description
     * The path in the library to the analysis to open.
     * @type {?}
     */
    SpotfireViewerComponent.prototype.path;
    /**
     * \@description
     * Optional initial page. The page can either be expressed
     * as an integer (0-based page index) or as a string (page name).
     * @type {?}
     */
    SpotfireViewerComponent.prototype.page;
    /**
     * \@description
     * Optional unique id to read/write settings from local storage
     * @type {?}
     */
    SpotfireViewerComponent.prototype.sid;
    /**
     * \@description
     * Optional instance of a Customization instance.
     * If set, this will override the customizationInfo instance held by the application.
     * @type {?}
     */
    SpotfireViewerComponent.prototype.customization;
    /**
     * \@description
     * Optional. Array of filters that will be applied once page is loaded.
     * @type {?}
     */
    SpotfireViewerComponent.prototype.filters;
    /** @type {?} */
    SpotfireViewerComponent.prototype.markingOn;
    /** @type {?} */
    SpotfireViewerComponent.prototype.maxRows;
    /**
     * @type {?}
     * @protected
     */
    SpotfireViewerComponent.prototype.spotParams;
    /**
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype._parameters;
    /** @type {?} */
    SpotfireViewerComponent.prototype.spot;
    /** @type {?} */
    SpotfireViewerComponent.prototype.errorMessages;
    /** @type {?} */
    SpotfireViewerComponent.prototype.metadata;
    /** @type {?} */
    SpotfireViewerComponent.prototype.edit;
    /**
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype.document;
    /**
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype.app;
    /**
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype.filterSubject;
    /** @type {?} */
    SpotfireViewerComponent.prototype.filter$;
    /**
     * \@description
     * Optional. emit filters set by user in dashboard
     * @type {?}
     */
    SpotfireViewerComponent.prototype.filteringEvent;
    /**
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype.markerSubject;
    /** @type {?} */
    SpotfireViewerComponent.prototype.marker$;
    /**
     * \@description
     * Optional. emit marking set by user in dashboard
     * @type {?}
     */
    SpotfireViewerComponent.prototype.markingEvent;
    /**
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype.markedRows;
    /** @type {?} */
    SpotfireViewerComponent.prototype.view;
    /** @type {?} */
    SpotfireViewerComponent.prototype.longTime;
    /** @type {?} */
    SpotfireViewerComponent.prototype.doConsole;
    /** @type {?} */
    SpotfireViewerComponent.prototype.ngOnChanges;
    /** @type {?} */
    SpotfireViewerComponent.prototype.stopPropagation;
    /**
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype.isMarkingWiredUp;
    /**
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype.isFiltingWiredUp;
    /**
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype.displayErrorMessage;
    /**
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype.displayInfoMessage;
    /**
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype.afterDisplay;
    /**
     * \@description
     * Callback method played when marking changes are detected.
     *
     * Will gather all marking and emit an event back to caller.
     *
     * \@param tName Table name
     * \@param mName Maring name
     * \@param res marked rows returned by Spotfire
     * @type {?}
     * @private
     */
    SpotfireViewerComponent.prototype.updateMarking;
    /** @type {?} */
    SpotfireViewerComponent.prototype.docSvc;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BvdGZpcmUtdmlld2VyLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0aWJjby9zcG90ZmlyZS13cmFwcGVyLyIsInNvdXJjZXMiOlsibGliL3ZpZXdlci9zcG90ZmlyZS12aWV3ZXIuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUNBLE9BQU8sRUFDTCxTQUFTLEVBQUUsS0FBSyxFQUFFLFlBQVksRUFBRSxTQUFTLEVBQ3pDLFVBQVUsRUFBRSxNQUFNLEVBQTRCLGlCQUFpQixFQUNoRSxNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLEVBQWMsZUFBZSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQ25ELE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUNyQyxPQUFPLEVBQUUscUJBQXFCLEVBQUUsY0FBYyxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDbEYsT0FBTyxFQUFFLFdBQVcsRUFBeUIsa0JBQWtCLEVBQUUsTUFBTSx1QkFBdUIsQ0FBQztBQUMvRixPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFPdEQ7SUFtR0UsaUNBQW1CLE1BQXVCO1FBQTFDLGlCQUlDO1FBSmtCLFdBQU0sR0FBTixNQUFNLENBQWlCOzs7OztRQXZGakMsVUFBSyxHQUFHLEtBQUssQ0FBQztRQXdDZCxZQUFPLEdBQUcsRUFBRSxDQUFDO1FBRVosZUFBVSxHQUF1QixJQUFJLGtCQUFrQixFQUFFLENBQUM7UUFlcEUsa0JBQWEsR0FBRyxFQUFFLENBQUM7UUFJbkIsU0FBSSxHQUFHLEtBQUssQ0FBQzs7UUFJTCxrQkFBYSxHQUFHLElBQUksZUFBZSxDQUFZLEVBQUUsQ0FBQyxDQUFDO1FBQ3BELFlBQU8sR0FBMEIsSUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZLEVBQUUsQ0FBQzs7Ozs7UUFNaEUsbUJBQWMsR0FBc0IsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUM7O1FBRzlELGtCQUFhLEdB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SUE1T1cseUNBQThCIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSAyMDE4LTIwMTguIFRJQkNPIFNvZnR3YXJlIEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4gQ29uZmlkZW50aWFsICYgUHJvcHJpZXRhcnkuXG5pbXBvcnQge1xuICBDb21wb25lbnQsIElucHV0LCBFdmVudEVtaXR0ZXIsIFZpZXdDaGlsZCxcbiAgRWxlbWVudFJlZiwgT3V0cHV0LCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMsIFZpZXdFbmNhcHN1bGF0aW9uLCBPbkluaXRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IE9ic2VydmFibGUsIEJlaGF2aW9yU3ViamVjdCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgU3BvdGZpcmVDdXN0b21pemF0aW9uLCBTcG90ZmlyZUZpbHRlciB9IGZyb20gJy4uL3Nwb3RmaXJlLWN1c3RvbWl6YXRpb24nO1xuaW1wb3J0IHsgRG9jTWV0YWRhdGEsIEFwcGxpY2F0aW9uLCBEb2N1bWVudCwgU3BvdGZpcmVQYXJhbWV0ZXJzIH0gZnJvbSAnLi4vc3BvdGZpcmUtd2VicGxheWVyJztcbmltcG9ydCB7IERvY3VtZW50U2VydmljZSB9IGZyb20gJy4uL2RvY3VtZW50LnNlcnZpY2UnO1xuXG4vLyBodHRwczovL2NvbW11bml0eS50aWJjby5jb20vd2lraS90aWJjby1zcG90ZmlyZS1qYXZhc2NyaXB0LWFwaS1vdmVydmlld1xuLy8gaHR0cHM6Ly9jb21tdW5pdHkudGliY28uY29tL3dpa2kvbWFzaHVwLWV4YW1wbGUtbXVsdGlwbGUtdmlld3MtdXNpbmctdGliY28tc3BvdGZpcmUtamF2YXNjcmlwdC1hcGlcblxuZGVjbGFyZSBsZXQgc3BvdGZpcmU6IGFueTtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnc3BvdGZpcmUtdmlld2VyJyxcbiAgZXhwb3J0QXM6ICdzcG90ZmlyZVZpZXdlcicsXG4gIHRlbXBsYXRlVXJsOiAnc3BvdGZpcmUtdmlld2VyLmNvbXBvbmVudC5odG1sJyxcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZVxufSlcblxuZXhwb3J0IGNsYXNzIFNwb3RmaXJlVmlld2VyQ29tcG9uZW50IGltcGxlbWVudHMgT25DaGFuZ2VzLCBPbkluaXQge1xuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIHByaW50IGRlYnVnIGxvZ3MgdG8gSlMgY29uc29sZS4gRGVmYXVsdCB0byBmYWxzZVxuICAgKi9cbiAgQElucHV0KCkgZGVidWcgPSBmYWxzZTtcblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFRoZSBVUkwgdG8gdGhlIFdlYiBQbGF5ZXIgc2VydmVyXG4gICAqL1xuICBASW5wdXQoKSB1cmw6IHN0cmluZztcblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFRoZSBwYXRoIGluIHRoZSBsaWJyYXJ5IHRvIHRoZSBhbmFseXNpcyB0byBvcGVuLlxuICAgKi9cbiAgQElucHV0KCkgcGF0aDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogT3B0aW9uYWwgaW5pdGlhbCBwYWdlLiBUaGUgcGFnZSBjYW4gZWl0aGVyIGJlIGV4cHJlc3NlZFxuICAgKiBhcyBhbiBpbnRlZ2VyICgwLWJhc2VkIHBhZ2UgaW5kZXgpIG9yIGFzIGEgc3RyaW5nIChwYWdlIG5hbWUpLlxuICAgKi9cbiAgQElucHV0KCkgcGFnZTogc3RyaW5nO1xuXG4gIC8qKlxuICAqIEBkZXNjcmlwdGlvblxuICAqIE9wdGlvbmFsIHVuaXF1ZSBpZCB0byByZWFkL3dyaXRlIHNldHRpbmdzIGZyb20gbG9jYWwgc3RvcmFnZVxuICAqL1xuICBASW5wdXQoKSBzaWQ6IHN0cmluZztcblxuICAvKipcbiAgKiBAZGVzY3JpcHRpb25cbiAgKiBPcHRpb25hbCBpbnN0YW5jZSBvZiBhIEN1c3RvbWl6YXRpb24gaW5zdGFuY2UuIFxuICAqIElmIHNldCwgdGhpcyB3aWxsIG92ZXJyaWRlIHRoZSBjdXN0b21pemF0aW9uSW5mbyBpbnN0YW5jZSBoZWxkIGJ5IHRoZSBhcHBsaWNhdGlvbi5cbiAgKi9cbiAgQElucHV0KCkgY3VzdG9taXphdGlvbjogU3BvdGZpcmVDdXN0b21pemF0aW9uIHwgc3RyaW5nO1xuXG4gIC8qKlxuICAgICogQGRlc2NyaXB0aW9uXG4gICAgKiBPcHRpb25hbC4gQXJyYXkgb2YgZmlsdGVycyB0aGF0IHdpbGwgYmUgYXBwbGllZCBvbmNlIHBhZ2UgaXMgbG9hZGVkLlxuICAgICovXG4gIEBJbnB1dCgpIGZpbHRlcnM6IEFycmF5PFNwb3RmaXJlRmlsdGVyPiB8IHN0cmluZztcbiAgQElucHV0KCkgbWFya2luZ09uOiB7fSB8IHN0cmluZztcbiAgQElucHV0KCkgbWF4Um93cyA9IDEwO1xuXG4gIHByb3RlY3RlZCBzcG90UGFyYW1zOiBTcG90ZmlyZVBhcmFtZXRlcnMgPSBuZXcgU3BvdGZpcmVQYXJhbWV0ZXJzKCk7XG4gIC8qKlxuICAgICogQGRlc2NyaXB0aW9uXG4gICAgKiBPcHRpb25hbC4gTG9hZCBwYXJhbWV0ZXJzIGZvciB0aGUgYW5hbHlzaXMuXG4gICAgKi9cbiAgQElucHV0KCkgc2V0IHBhcmFtZXRlcnModmFsdWU6IHN0cmluZykge1xuICAgIHRoaXMuX3BhcmFtZXRlcnMgPSB2YWx1ZTtcbiAgICB0aGlzLnNwb3RQYXJhbXMuX3BhcmFtZXRlcnMgPSB2YWx1ZTtcbiAgICBpZiAodGhpcy5hcHApIHtcbiAgICAgIHRoaXMub3BlblBhdGgodGhpcy5wYXRoKTtcbiAgICB9XG4gIH1cbiAgcHJpdmF0ZSBfcGFyYW1ldGVyczogc3RyaW5nO1xuXG4gIEBWaWV3Q2hpbGQoJ3Nwb3QnLCB7IHN0YXRpYzogdHJ1ZSwgcmVhZDogRWxlbWVudFJlZiB9KSBzcG90OiBFbGVtZW50UmVmO1xuICBlcnJvck1lc3NhZ2VzID0gW107XG5cbiAgLyogbWV0YWRhdGEgY29udGFpbnMgSW5mb3JtYXRpb24gYWJvdXQgdGhlIFNwb3RmaXJlIGFuYWx5c2lzICovXG4gIG1ldGFkYXRhOiBEb2NNZXRhZGF0YTtcbiAgZWRpdCA9IGZhbHNlO1xuICBwcml2YXRlIGRvY3VtZW50OiBEb2N1bWVudDtcbiAgcHJpdmF0ZSBhcHA6IEFwcGxpY2F0aW9uO1xuICAvKiBGaWx0ZXJpbmcgb2JzZXJ2YWJsZXMsIGVtaXR0ZXIgYW5kIHN1YmplY3QqL1xuICBwcml2YXRlIGZpbHRlclN1YmplY3QgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PEFycmF5PHt9Pj4oW10pO1xuICBwdWJsaWMgZmlsdGVyJDogT2JzZXJ2YWJsZTxBcnJheTx7fT4+ID0gdGhpcy5maWx0ZXJTdWJqZWN0LmFzT2JzZXJ2YWJsZSgpO1xuXG4gIC8qKlxuICAgICogQGRlc2NyaXB0aW9uXG4gICAgKiBPcHRpb25hbC4gZW1pdCBmaWx0ZXJzIHNldCBieSB1c2VyIGluIGRhc2hib2FyZFxuICAgICovXG4gIEBPdXRwdXQoKSBmaWx0ZXJpbmdFdmVudDogRXZlbnRFbWl0dGVyPGFueT4gPSBuZXcgRXZlbnRFbWl0dGVyKGZhbHNlKTtcblxuICAvKiBNYXJraW5nIG9ic2VydmFibGVzLCBlbWl0dGVyIGFuZCBzdWJqZWN0Ki9cbiAgcHJpdmF0ZSBtYXJrZXJTdWJqZWN0ID0gbmV3IEJlaGF2aW9yU3ViamVjdDx7fT4oe30pO1xuICBwdWJsaWMgbWFya2VyJDogT2JzZXJ2YWJsZTx7fT4gPSB0aGlzLm1hcmtlclN1YmplY3QuYXNPYnNlcnZhYmxlKCk7XG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogT3B0aW9uYWwuIGVtaXQgbWFya2luZyBzZXQgYnkgdXNlciBpbiBkYXNoYm9hcmRcbiAgICovXG4gIEBPdXRwdXQoKSBtYXJraW5nRXZlbnQ6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcihmYWxzZSk7XG4gIHByaXZhdGUgbWFya2VkUm93cyA9IHt9O1xuXG4gIHZpZXc6IGFueTtcbiAgbG9uZ1RpbWUgPSBmYWxzZTtcblxuICBjb25zdHJ1Y3RvcihwdWJsaWMgZG9jU3ZjOiBEb2N1bWVudFNlcnZpY2UpIHtcbiAgICBjb25zb2xlLmxvZygnU1BPVEZJUkUgV1JBUFBFUiAtIDEwIGp1aWxsZXQgLSBBbmd1bGFyIDgnKVxuICAgIHRoaXMuZG9Db25zb2xlKCdXZWxjb21lICEnKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMubG9uZ1RpbWUgPSB0cnVlLCA2MDAwKTtcbiAgfVxuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuZG9Db25zb2xlKCdPbkluaXQnLCB0aGlzLnVybCwgdGhpcy5wYXRoKTtcbiAgICB0aGlzLmRpc3BsYXkoKTtcbiAgfVxuXG4gIGRvQ29uc29sZSA9ICguLi5hcmdzOiBhbnlbXSkgPT4gdGhpcy5kZWJ1ZyAmJiBjb25zb2xlLmxvZygnW1NQT1RGSVJFLVZJRVdFUl0nLCAuLi5hcmdzKTtcblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIFJlZHJhdyB0aGUgZGFzaGJvYXJkLlxuICAgKiBEZXBlbmRpbmcgb24gbmF0dXJlIG9mIGNoYW5nZSAodXJsL3BhdGgvcGFnZSkgdGhlIGRhc2hib2FyZCBpcyBmdWxseSByZWZyZXNoZWQgb3IgYWRqdXN0ZWQgYWNjb3JkaW5nbHlcbiAgICogQHBhcmFtIGNoYW5nZXMgVGhlIGxpc3Qgb2YgY2hhbmdlcyB0byBhcHBseVxuICAgKi9cblxuICBkaXNwbGF5KGNoYW5nZXM/OiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgdGhpcy5kb0NvbnNvbGUoJ0Rpc3BsYXknLCBjaGFuZ2VzKTtcbiAgICBpZiAodHlwZW9mIHRoaXMuY3VzdG9taXphdGlvbiA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHRoaXMuY3VzdG9taXphdGlvbiA9IG5ldyBTcG90ZmlyZUN1c3RvbWl6YXRpb24oSlNPTi5wYXJzZSh0aGlzLmN1c3RvbWl6YXRpb24pKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jdXN0b21pemF0aW9uID0gbmV3IFNwb3RmaXJlQ3VzdG9taXphdGlvbih0aGlzLmN1c3RvbWl6YXRpb24pO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2YgdGhpcy5maWx0ZXJzID09PSAnc3RyaW5nJykge1xuICAgICAgY29uc3QgYWxsRmlsdGVyczogQXJyYXk8U3BvdGZpcmVGaWx0ZXI+ID0gW107XG4gICAgICBKU09OLnBhcnNlKHRoaXMuZmlsdGVycykuZm9yRWFjaCgobTogU3BvdGZpcmVGaWx0ZXIpID0+IGFsbEZpbHRlcnMucHVzaChuZXcgU3BvdGZpcmVGaWx0ZXIobSkpKTtcbiAgICAgIHRoaXMuZmlsdGVycyA9IGFsbEZpbHRlcnM7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgdGhpcy5tYXJraW5nT24gPT09ICdzdHJpbmcnICYmIHRoaXMubWFya2luZ09uICE9PSAnKicpIHtcbiAgICAgIHRoaXMubWFya2luZ09uID0gSlNPTi5wYXJzZSh0aGlzLm1hcmtpbmdPbik7XG4gICAgfVxuXG4gICAgdGhpcy5kb0NvbnNvbGUoJ2Rpc3BsYXknLCBjaGFuZ2VzLCB0aGlzLnVybCwgdGhpcy5wYXRoLCAnUEFHRT0nLCB0aGlzLnBhZ2UsIHRoaXMuY3VzdG9taXphdGlvbiwgdGhpcy5tYXhSb3dzLCB0aGlzLmFwcCwgdGhpcy5tYXJraW5nT24pO1xuICAgIGlmICghY2hhbmdlcyB8fCBjaGFuZ2VzLnVybCkge1xuICAgICAgdGhpcy5vcGVuV2ViUGxheWVyKHRoaXMudXJsLCB0aGlzLnBhdGgsIHRoaXMuY3VzdG9taXphdGlvbik7XG4gICAgfSBlbHNlIGlmICh0aGlzLmFwcCAmJiBjaGFuZ2VzLnBhZ2UpIHtcbiAgICAgIHRoaXMub3BlblBhZ2UodGhpcy5wYWdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kb0NvbnNvbGUoYFRoZSBVcmwgYXR0cmlidXRlIGlzIG5vdCBwcm92aWRlZCwgZmxpcCB0aGUgZGFzaGJvYXJkIGFuZCBkaXNwbGF5IGZvcm0hYCk7XG4gICAgICB0aGlzLmVkaXQgPSB0cnVlO1xuICAgICAgdGhpcy5tZXRhZGF0YSA9IG5ldyBEb2NNZXRhZGF0YSgpO1xuICAgIH1cbiAgfVxuICBuZ09uQ2hhbmdlcyA9IChjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSA9PiB7XG4gICAgaWYgKCEhY2hhbmdlcykge1xuICAgICAgdGhpcy5kaXNwbGF5KGNoYW5nZXMpO1xuICAgIH1cbiAgfVxuXG4gIHN0b3BQcm9wYWdhdGlvbiA9IChlOiBFdmVudCkgPT4gZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgcHJpdmF0ZSBpc01hcmtpbmdXaXJlZFVwID0gKCkgPT4gdGhpcy5tYXJraW5nRXZlbnQub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7XG4gIHByaXZhdGUgaXNGaWx0aW5nV2lyZWRVcCA9ICgpID0+IHRoaXMuZmlsdGVyaW5nRXZlbnQub2JzZXJ2ZXJzLmxlbmd0aCA+IDA7XG4gIHByaXZhdGUgZGlzcGxheUVycm9yTWVzc2FnZSA9IChtZXNzYWdlOiBzdHJpbmcpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKCdFUlJPUjonLCBtZXNzYWdlKTtcbiAgICB0aGlzLmVycm9yTWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICBpZiAoIXRoaXMuc3BvdFBhcmFtcy5kb2N1bWVudCkge1xuICAgICAgLy8gRG8gbm90IGRpc3BsYXkgdGhlIGluZm8gTWVzc2FnZSB3aGVuIGRvY3VtZW50IGlzIHJ1bm5pbmdcbiAgICAgIHRoaXMuc3BvdC5uYXRpdmVFbGVtZW50LnN0eWxlLmZvbnRGYW1pbHkgPSAnbW9ub3NwYWNlJztcbiAgICAgIHRoaXMuc3BvdC5uYXRpdmVFbGVtZW50LnN0eWxlLmNvbG9yID0gJyNlODIxMjcnO1xuICAgICAgdGhpcy5zcG90Lm5hdGl2ZUVsZW1lbnQuc3R5bGUudGV4dEFsaWduID0gJ2NlbnRlcic7XG4gICAgICB0aGlzLnNwb3QubmF0aXZlRWxlbWVudC5zdHlsZS5wYWRkaW5nID0gJzMwcHgnO1xuICAgICAgdGhpcy5zcG90Lm5hdGl2ZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLmVycm9yTWVzc2FnZXMuam9pbignPGJyPicpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZGlzcGxheUluZm9NZXNzYWdlID0gKG1lc3NhZ2U6IHN0cmluZykgPT4ge1xuICAgIGNvbnNvbGUubG9nKG1lc3NhZ2UpO1xuICAgIGlmICghdGhpcy5zcG90UGFyYW1zLmRvY3VtZW50ICYmIHRoaXMuZGVidWcpIHtcbiAgICAgIC8vIERvIG5vdCBkaXNwbGF5IHRoZSBpbmZvIE1lc3NhZ2Ugd2hlbiBkb2N1bWVudCBpcyBydW5uaW5nXG4gICAgICB0aGlzLnNwb3QubmF0aXZlRWxlbWVudC5zdHlsZS5mb250RmFtaWx5ID0gJ21vbm9zcGFjZSc7XG4gICAgICB0aGlzLnNwb3QubmF0aXZlRWxlbWVudC5zdHlsZS5jb2xvciA9ICdibGFjayc7XG4gICAgICB0aGlzLnNwb3QubmF0aXZlRWxlbWVudC5zdHlsZS50ZXh0QWxpZ24gPSAnY2VudGVyJztcbiAgICAgIHRoaXMuc3BvdC5uYXRpdmVFbGVtZW50LnRleHRDb250ZW50ID0gbWVzc2FnZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIEdldCBTcG90ZmlyZSBKYXZhU2NyaXB0IEFQSSAod2ViUGxheWVyKSBmcm9tIHVybFxuICAgKlxuICAgKiBXaGVuIGEgY29tcG9uZW5ldCBpcyBpbml0aWF0ZWQgb3IgdXJsIGlzIHVwZGF0ZWQsIGl0IGxhenkgbG9hZHMgdGhlIGxpYnJhcnlcbiAgICogT25jZSBsb2FkZWQgaXQgb3BlbnMgdGhlIHBhdGguXG4gICAqXG4gICAqIEBwYXJhbSB1cmwgdGhlIHdlYlBsYXllciBzZXJ2ZXIgdXJsXG4gICAqIEBwYXJhbSBwYXRoIHRoZSBwYXRoIHRvIHRoZSBwYWdlXG4gICAqIEBwYXJhbSBjdXN0byB0aGUgaW5pdGlhbCBjdXN0b21pemF0aW9uIGluZm9cbiAgICovXG4gIHByb3RlY3RlZCBvcGVuV2ViUGxheWVyKHVybDogc3RyaW5nLCBwYXRoOiBzdHJpbmcsIGN1c3RvbWl6YXRpb246IFNwb3RmaXJlQ3VzdG9taXphdGlvbikge1xuICAgIHRoaXMuZWRpdCA9IGZhbHNlO1xuICAgIHRoaXMudXJsID0gdXJsO1xuICAgIHRoaXMucGF0aCA9IHBhdGg7XG4gICAgdGhpcy5jdXN0b21pemF0aW9uID0gY3VzdG9taXphdGlvbjtcbiAgICB0aGlzLmRvQ29uc29sZShgU3BvdGZpcmVWaWV3ZXJDb21wb25lbnQgb3BlbldlYlBsYXllcigke3VybH0pYCk7XG5cbiAgICB0aGlzLmRpc3BsYXlJbmZvTWVzc2FnZShgJHt0aGlzLnVybH0uLi5gKTtcblxuICAgIC8vIENyZWF0ZSBhIFVuaXF1ZSBJRCBmb3IgdGhpcyBTcG90ZmlyZSBkYXNoYm9hcmRcbiAgICAvL1xuICAgIHRoaXMuc3BvdC5uYXRpdmVFbGVtZW50LmlkID0gdGhpcy5zaWQgPyB0aGlzLnNpZCA6IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgIHRoaXMuc3BvdFBhcmFtcyA9IHsgLi4udGhpcy5zcG90UGFyYW1zLCBwYXRoLCB1cmwsIGN1c3RvbWl6YXRpb24sIGRvbWlkOiB0aGlzLnNwb3QubmF0aXZlRWxlbWVudC5pZCwgcGFnZTogdGhpcy5wYWdlIH07XG5cbiAgICB0aGlzLmRvY1N2Yy5vcGVuV2ViUGxheWVyJCh0aGlzLnNwb3RQYXJhbXMpLnN1YnNjcmliZShcbiAgICAgIGRvYyA9PiB0aGlzLmFmdGVyRGlzcGxheShkb2MpLFxuICAgICAgZXJyID0+IHRoaXMuZGlzcGxheUVycm9yTWVzc2FnZShlcnIpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogT3BlbiB0aGUgcGF0aCB1c2luZyBKYXZhU2NyaXB0IEFQSSAoc3BvdGZpcmUud2ViUGxheWVyLmNyZWF0ZUFwcGxpY2F0aW9uKVxuICAgKlxuICAgKiBAcGFyYW0gcGF0aCB0aGUgYWJzb2x1dGUgYW5hbHlzaXMgcGF0aFxuICAgKi9cbiAgcHJvdGVjdGVkIG9wZW5QYXRoKHBhdGg6IHN0cmluZykge1xuICAgIHRoaXMucGF0aCA9IHBhdGg7XG4gICAgdGhpcy5kaXNwbGF5SW5mb01lc3NhZ2UoYCR7dGhpcy51cmx9LyR7cGF0aH0uLi5gKTtcbiAgICB0aGlzLmRvQ29uc29sZShgU3BvdGZpcmVWaWV3ZXJDb21wb25lbnQgb3BlblBhdGgoJHtwYXRofSlgLCB0aGlzLnNpZCk7XG4gICAgdGhpcy5zcG90UGFyYW1zID0geyAuLi50aGlzLnNwb3RQYXJhbXMsIHBhdGgsIGRvbWlkOiB0aGlzLnNwb3QubmF0aXZlRWxlbWVudC5pZCB9O1xuICAgIHRoaXMuZG9jU3ZjLm9wZW5QYXRoJCh0aGlzLnNwb3RQYXJhbXMpLnN1YnNjcmliZShcbiAgICAgIGRvYyA9PiB0aGlzLmFmdGVyRGlzcGxheShkb2MpLFxuICAgICAgZXJyID0+IHRoaXMuZGlzcGxheUVycm9yTWVzc2FnZShlcnIpKTtcbiAgfVxuXG4gIHByb3RlY3RlZCBkb0Zvcm0oZG9jOiBEb2N1bWVudCkgeyB9XG4gIC8qKlxuICAgKiBAZGVzY3JpcHRpb25cbiAgICogT3BlbiB0aGUgRG9jdW1lbnQgcGFnZVxuICAgKlxuICAgKiBAcGFyYW0gcGFnZSB0aGUgZG9jdW1lbnQgcGFnZSB0aGF0IHdpbGwgYmUgZGlzcGxheWVkXG4gICAqL1xuICBwdWJsaWMgb3BlblBhZ2UocGFnZTogc3RyaW5nKSB7XG4gICAgdGhpcy5kaXNwbGF5SW5mb01lc3NhZ2UoYCR7dGhpcy51cmx9LyR7dGhpcy5wYXRofS8ke3BhZ2UgPyBwYWdlIDogJyd9Li4uYCk7XG4gICAgdGhpcy5kb0NvbnNvbGUoYFNwb3RmaXJlVmlld2VyQ29tcG9uZW50IG9wZW5QYWdlKCR7cGFnZX0pYCk7XG4gICAgdGhpcy5wYWdlID0gcGFnZTtcbiAgICB0aGlzLnNwb3RQYXJhbXMgPSB7IC4uLnRoaXMuc3BvdFBhcmFtcywgcGFnZSB9O1xuICAgIGNvbnN0IHAgPSB0aGlzLnNwb3RQYXJhbXM7XG4gICAgdGhpcy5kb2NTdmMub3BlblBhZ2UkKHApLnN1YnNjcmliZShkb2MgPT4gdGhpcy5hZnRlckRpc3BsYXkoZG9jKSk7XG4gIH1cblxuICBwcml2YXRlIGFmdGVyRGlzcGxheSA9IChkb2M6IERvY3VtZW50KSA9PiB7XG4gICAgdGhpcy5kb0NvbnNvbGUoYFNwb3RmaXJlVmlld2VyQ29tcG9uZW50IG9wZW5QYWdlKCR7dGhpcy5zcG90UGFyYW1zLnBhZ2V9KSByZXR1cm5zYCwgZG9jKTtcbiAgICB0aGlzLmRvY3VtZW50ID0gZG9jO1xuICAgIGlmICh0aGlzLmZpbHRlcnMgJiYgdGhpcy5kb2N1bWVudC5nZXRGaWx0ZXJpbmcoKSkge1xuICAgICAgY29uc3QgZmx0ID0gdGhpcy5kb2N1bWVudC5nZXRGaWx0ZXJpbmcoKTtcbiAgICAgIGZsdC5yZXNldEFsbEZpbHRlcnMoKTtcbiAgICAgIC8qXG4gICAgICB0aGlzLmRvQ29uc29sZShgU3BvdGZpcmVWaWV3ZXJDb21wb25lbnQgc2V0IEZpbHRlcihhdmFudClgLCB0aGlzLmZpbHRlcnMpO1xuICAgICAgKHRoaXMuZmlsdGVycyBhcyBBcnJheTxTcG90ZmlyZUZpbHRlcj4pLmZvckVhY2godCA9PiB0LnNldEZpbHRlclR5cGUoc3BvdGZpcmUpKTtcbiAgICAgIHRoaXMuZG9Db25zb2xlKGBTcG90ZmlyZVZpZXdlckNvbXBvbmVudCBzZXQgRmlsdGVyKGFwcmVzKWAsIHRoaXMuZmlsdGVycyk7XG4gICAgKi9cbiAgICAgIGZsdC5zZXQodGhpcy5maWx0ZXJzKTtcbiAgICAgIHRoaXMubG9hZEZpbHRlcnMoKTtcbiAgICAgIHRoaXMuZG9Db25zb2xlKCdGSUxURVInLCB0aGlzLmZpbHRlcnMpO1xuICAgIH1cblxuICAgIHRoaXMuZG9Gb3JtKHRoaXMuZG9jdW1lbnQpO1xuICAgIGlmICh0aGlzLm1hcmtpbmdPbikge1xuICAgICAgLy8gQ2xlYXIgbWFya2luZ1xuICAgICAgdGhpcy5tYXJrZXJTdWJqZWN0Lm5leHQoe30pO1xuICAgICAgdGhpcy5kb2N1bWVudC5nZXREYXRhKCkuZ2V0VGFibGVzJCgpXG4gICAgICAgIC5waXBlKHRhcChhbGxUYWJsZU5hbWVzID0+IHRoaXMuZG9Db25zb2xlKGBBbGwgdGFibGVzIGFuZCBjb2x1bW4gbmFtZXM6YCwgYWxsVGFibGVOYW1lcykpKVxuICAgICAgICAuc3Vic2NyaWJlKGFsbFRhYmxlTmFtZXMgPT4gdGhpcy5kb2N1bWVudC5nZXRNYXJraW5nKCkuZ2V0TWFya2luZ05hbWVzJCgpXG4gICAgICAgICAgLnBpcGUodGFwKG1hcmtpbmdOYW1lcyA9PiB0aGlzLmRvQ29uc29sZShgQWxsIG1hcmtpbmcgbmFtZXM6YCwgbWFya2luZ05hbWVzKSkpXG4gICAgICAgICAgLnN1YnNjcmliZShtYXJraW5nTmFtZXMgPT4gbWFya2luZ05hbWVzLmZvckVhY2gobWFya2luZ05hbWUgPT4ge1xuICAgICAgICAgICAgY29uc3QgdGFibGVOYW1lcyA9IHRoaXMubWFya2luZ09uID09PSAnKicgPyBhbGxUYWJsZU5hbWVzIDogdGhpcy5tYXJraW5nT247XG4gICAgICAgICAgICBPYmplY3Qua2V5cyh0YWJsZU5hbWVzKS5mb3JFYWNoKHROYW1lID0+IHtcbiAgICAgICAgICAgICAgbGV0IGNvbHVtbk5hbWVzOiBBcnJheTxzdHJpbmc+ID0gdGhpcy5tYXJraW5nT24gPT09ICcqJyA/IGFsbFRhYmxlTmFtZXNbdE5hbWVdIDogdGFibGVOYW1lc1t0TmFtZV07XG4gICAgICAgICAgICAgIGlmIChjb2x1bW5OYW1lcy5sZW5ndGggPT09IDEgJiYgY29sdW1uTmFtZXNbMF0gPT09ICcqJykge1xuICAgICAgICAgICAgICAgIGNvbHVtbk5hbWVzID0gYWxsVGFibGVOYW1lc1t0TmFtZV07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgdGhpcy5kb0NvbnNvbGUoYG1hcmtpbmcub25DaGFuZ2VkKCR7bWFya2luZ05hbWV9LCAke3ROYW1lfSwgJHtKU09OLnN0cmluZ2lmeShjb2x1bW5OYW1lcyl9LCAke3RoaXMubWF4Um93c30pYCk7XG4gICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQuZ2V0TWFya2luZygpLm9uQ2hhbmdlZCQobWFya2luZ05hbWUsIHROYW1lLCBjb2x1bW5OYW1lcywgdGhpcy5tYXhSb3dzKVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoZiA9PiB0aGlzLnVwZGF0ZU1hcmtpbmcodE5hbWUsIG1hcmtpbmdOYW1lLCBmKSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KSkpO1xuICAgIH1cbiAgICBpZiAodGhpcy5pc0ZpbHRpbmdXaXJlZFVwKCkpIHtcbiAgICAgIHRoaXMuZG9Db25zb2xlKCd3ZSBoYXZlIG9ic2VydmVycyBmb3IgZmlsdGVyaW5nJyk7XG4gICAgICAvLyBTdWJzY3JpYmUgdG8gZmlsdGVyaW5nRXZlbnQgYW5kIGVtaXQgdGhlIHJlc3VsdCB0byB0aGUgT3V0cHV0IGlmIGZpbHRlciBwYW5lbCBpcyBkaXNwbGF5ZWRcbiAgICAgIC8vXG4gICAgICB0aGlzLmZpbHRlciQucGlwZSh0YXAoZiA9PiB0aGlzLmRvQ29uc29sZSgnRW1pdCBmaWx0ZXInLCBmKSkpXG4gICAgICAgIC5zdWJzY3JpYmUoZiA9PiB0aGlzLmZpbHRlcmluZ0V2ZW50LmVtaXQoZikpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzTWFya2luZ1dpcmVkVXAoKSkge1xuICAgICAgdGhpcy5kb0NvbnNvbGUoJ3dlIGhhdmUgb2JzZXJ2ZXJzIGZvciBtYXJraW5nJyk7XG4gICAgICAvLyBTdWJzY3JpYmUgdG8gbWFya2luZ0V2ZW50IGFuZCBlbWl0IHRoZSByZXN1bHQgdG8gdGhlIE91dHB1dFxuICAgICAgLy9cbiAgICAgIHRoaXMubWFya2VyJC5waXBlKHRhcChmID0+IHRoaXMuZG9Db25zb2xlKCdFbWl0IG1hcmtpbmcnLCBmKSkpXG4gICAgICAgIC5zdWJzY3JpYmUoZiA9PiB0aGlzLm1hcmtpbmdFdmVudC5lbWl0KGYpKTtcbiAgICB9XG4gICAgLy8gY29uc29sZS5sb2coJ1lFUyBsb2FkRmlsdGVycycpO1xuICAgIC8vIHNldEludGVydmFsKCgpID0+IHRoaXMubG9hZEZpbHRlcnMoKSwgMzAwMCk7XG4gIH1cblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIENhbGxiYWNrIG1ldGhvZCBwbGF5ZWQgd2hlbiBtYXJraW5nIGNoYW5nZXMgYXJlIGRldGVjdGVkLlxuICAgKlxuICAgKiBXaWxsIGdhdGhlciBhbGwgbWFya2luZyBhbmQgZW1pdCBhbiBldmVudCBiYWNrIHRvIGNhbGxlci5cbiAgICpcbiAgICogQHBhcmFtIHROYW1lIFRhYmxlIG5hbWVcbiAgICogQHBhcmFtIG1OYW1lIE1hcmluZyBuYW1lXG4gICAqIEBwYXJhbSByZXMgbWFya2VkIHJvd3MgcmV0dXJuZWQgYnkgU3BvdGZpcmVcbiAgICovXG4gIHByaXZhdGUgdXBkYXRlTWFya2luZyA9ICh0TmFtZTogc3RyaW5nLCBtTmFtZTogc3RyaW5nLCByZXM6IHt9KSA9PiB7XG4gICAgaWYgKE9iamVjdC5rZXlzKHJlcykubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5kb0NvbnNvbGUoYFdlIGhhdmUgbWFya2VkIHJvd3Mgb24gbWFya2luZyAnJHttTmFtZX0nIGZvciB0YWJsZSAnJHt0TmFtZX0nOmAsIHJlcyk7XG4gICAgICAvLyB1cGRhdGUgdGhlIG1hcmtlZCByb3cgaWYgcGFydGlhbCBzZWxlY3Rpb25cbiAgICAgIC8vXG4gICAgICBpZiAoIXRoaXMubWFya2VkUm93c1ttTmFtZV0pIHtcbiAgICAgICAgdGhpcy5tYXJrZWRSb3dzW21OYW1lXSA9IHt9O1xuICAgICAgfVxuICAgICAgaWYgKCF0aGlzLm1hcmtlZFJvd3NbbU5hbWVdW3ROYW1lXSkge1xuICAgICAgICB0aGlzLm1hcmtlZFJvd3NbbU5hbWVdW3ROYW1lXSA9IHJlcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubWFya2VkUm93c1ttTmFtZV1bdE5hbWVdID0gT2JqZWN0LmFzc2lnbih0aGlzLm1hcmtlZFJvd3NbbU5hbWVdW3ROYW1lXSwgcmVzKTtcbiAgICAgIH1cbiAgICAgIC8vICAgdGhpcy5kb0NvbnNvbGUoJ1tNQVJLSU5HXSBvbiBwdWJsaWUnLCB0aGlzLm1hcmtlZFJvd3MpO1xuICAgICAgdGhpcy5tYXJrZXJTdWJqZWN0Lm5leHQodGhpcy5tYXJrZWRSb3dzKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMubWFya2VkUm93c1ttTmFtZV0gJiYgdGhpcy5tYXJrZWRSb3dzW21OYW1lXVt0TmFtZV0pIHtcbiAgICAgIC8vIHJlbW92ZSB0aGUgbWFya2VkIHJvdyBpZiBubyBtYXJraW5nXG4gICAgICAvL1xuICAgICAgZGVsZXRlIHRoaXMubWFya2VkUm93c1ttTmFtZV1bdE5hbWVdO1xuICAgICAgaWYgKE9iamVjdC5rZXlzKHRoaXMubWFya2VkUm93c1ttTmFtZV0pLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBkZWxldGUgdGhpcy5tYXJrZWRSb3dzW21OYW1lXTtcbiAgICAgIH1cbiAgICAgIHRoaXMubWFya2VyU3ViamVjdC5uZXh0KHRoaXMubWFya2VkUm93cyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vICB0aGlzLmRvQ29uc29sZShgTm8gcm93cyBhcmUgbWFya2VkIG9uIG1hcmtpbmcgJyR7bU5hbWV9JyBmb3IgdGFibGUgJyR7dE5hbWV9J2ApO1xuICAgIH1cbiAgICB0aGlzLmxvYWRGaWx0ZXJzKCk7XG4gIH1cblxuICAvKipcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIEVtaXQgdG8gY2FsbGVyIHRoZSBmaWx0ZXJzXG4gICAqL1xuICBwcml2YXRlIGxvYWRGaWx0ZXJzKCkge1xuICAgIC8vICBjb25zb2xlLmxvZygnQUEgTmljb2xhcyBsb2FkRmlsdGVycyBCTE9VUCAhICgxOSBqdWluIDIwMTkpJyk7XG4gICAgaWYgKHRoaXMuaXNGaWx0aW5nV2lyZWRVcCgpKSB7XG4gICAgICB0aGlzLmRvY3VtZW50LmdldEZpbHRlcmluZygpLmdldEFsbE1vZGlmaWVkRmlsdGVyQ29sdW1ucygpXG4gICAgICAgIC5zdWJzY3JpYmUoZnMgPT4gdGhpcy5maWx0ZXJTdWJqZWN0Lm5leHQoZnMpKTtcbiAgICB9XG4gICAgLy8gICAgdGhpcy5kb2N1bWVudC5nZXRGaWx0ZXJpbmcoKS5nZXRBbGxNb2RpZmllZEZpbHRlckNvbHVtbnMoKVxuICAgIC8vICAgICAgLnN1YnNjcmliZShmcyA9PiBjb25zb2xlLmxvZygnbGVzIEZJTFRFUlM6JywgZnMpKTtcbiAgfVxufVxuIl19