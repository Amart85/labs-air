/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component } from '@angular/core';
import { ActivatedRoute } from '@angular/router';
import { LandingPageConfig, LandingPageItemConfig } from '../../models/tc-general-landing-page-config';
import { TcGeneralLandingPageConfigService } from '../../services/tc-general-landing-page-config.service';
import { MatSnackBar, MatDialog } from '@angular/material';
import { TibcoCloudNewElementComponent } from '../tibco-cloud-new-element/tibco-cloud-new-element.component';
/**
 * Configuration page home
 *
 * \@example <tc-tibco-cloud-setting-landing></tc-tibco-cloud-setting-landing>
 */
var TibcoCloudSettingLandingComponent = /** @class */ (function () {
    function TibcoCloudSettingLandingComponent(route, generalLandingPageConfigService, snackBar, dialog) {
        var _this = this;
        this.route = route;
        this.generalLandingPageConfigService = generalLandingPageConfigService;
        this.snackBar = snackBar;
        this.dialog = dialog;
        /**
         * New Configuration
         */
        this.runNewConfiguration = (/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var dialogRef = _this.dialog.open(TibcoCloudNewElementComponent, {
                width: '50%',
                height: '30%',
                maxWidth: '100vw',
                maxHeight: '100vh',
                panelClass: 'tcs-style-dialog',
                data: { resourceType: 'Landing Page' }
            });
            dialogRef.afterClosed().subscribe((/**
             * @param {?} result
             * @return {?}
             */
            function (result) {
                if (result) {
                    /** @type {?} */
                    var newElement = new LandingPageConfig().deserialize({
                        key: result.id,
                        description: result.name,
                        highlights: [new LandingPageItemConfig(), new LandingPageItemConfig(), new LandingPageItemConfig()]
                    });
                    _this.landingPages.push(newElement);
                    _this.selectedWelcomePage = newElement;
                }
            }));
        });
        /**
         * Helper to Compare Objects
         */
        this.compareObjects = (/**
         * @param {?} o1
         * @param {?} o2
         * @return {?}
         */
        function (o1, o2) {
            return o1 === o2;
        });
    }
    /**
    * @ignore
    */
    /**
     * @ignore
     * @return {?}
     */
    TibcoCloudSettingLandingComponent.prototype.ngOnInit = /**
     * @ignore
     * @return {?}
     */
    function () {
        this.landingPagesConfig = this.route.snapshot.data.landingPagesConfigHolder;
        this.landingPages = this.landingPagesConfig.landingPage;
        this.allRoles = this.route.snapshot.data.allRolesHolder.roles.filter((/**
         * @param {?} element
         * @return {?}
         */
        function (element) { return !element.configuration; }));
        this.sandboxId = this.route.snapshot.data.claims.primaryProductionSandbox.id;
        this.uiAppId = this.route.snapshot.data.landingPagesConfigHolder.uiAppId;
        // If there is only one landing page selects it automatically
        if (this.landingPages.length == 1) {
            this.selectedWelcomePage = this.landingPages[0];
        }
    };
    /**
     * Save Configuration
     */
    /**
     * Save Configuration
     * @return {?}
     */
    TibcoCloudSettingLandingComponent.prototype.runSaveFunction = /**
     * Save Configuration
     * @return {?}
     */
    function () {
        var _this = this;
        this.generalLandingPageConfigService.updateGeneralLandingPageConfig(this.sandboxId, this.uiAppId, this.landingPagesConfig, this.landingPagesConfig.id).subscribe((/**
         * @param {?} result
         * @return {?}
         */
        function (result) {
            _this.snackBar.open('Landing Pages configuration saved', 'OK', {
                duration: 3000
            });
        }), (/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            _this.snackBar.open('Error saving Landing Pages configuration', 'OK', {
                duration: 3000
            });
        }));
    };
    /**
     * Delete Configuration
     */
    /**
     * Delete Configuration
     * @return {?}
     */
    TibcoCloudSettingLandingComponent.prototype.runDeleteConfiguration = /**
     * Delete Configuration
     * @return {?}
     */
    function () {
        var _this = this;
        /** @type {?} */
        var pages = this.landingPages;
        pages.forEach((/**
         * @param {?} element
         * @return {?}
         */
        function (element) {
            if (element == _this.selectedWelcomePage) {
                /** @type {?} */
                var index = pages.indexOf(element, 0);
                pages.splice(index, 1);
                _this.selectedWelcomePage = undefined;
            }
        }));
    };
    TibcoCloudSettingLandingComponent.decorators = [
        { type: Component, args: [{
                    selector: 'tc-tibco-cloud-setting-landing',
                    template: "<div fxLayout=\"column\" fxFill>\n    <tc-tibco-cloud-widget-header style=\"height: 40px;\" [icon]=\"'tcs-capabilities'\"\n        [headerText]=\"'Landing Page Configuration'\"></tc-tibco-cloud-widget-header>\n    <div fxFlex style=\"padding: 20px; overflow: hidden\" fxLayout=\"column\">\n        <div style=\"overflow: auto;\">\n            <div fxLayout=\"column\" fxFlex>\n                <p>You can manage the configuration for the landing pages here.</p>\n                <br>\n                <mat-form-field>\n                    <mat-label>Welcome Page Configuration</mat-label>\n                    <mat-select [(value)]=\"selectedWelcomePage\">\n                        <mat-option *ngFor=\"let landingPage of landingPages\" [value]=\"landingPage\">\n                            {{landingPage.key}}-{{landingPage.description}}\n                        </mat-option>\n                    </mat-select>\n                </mat-form-field>\n\n                <div *ngIf=\"selectedWelcomePage\">\n                    <div fxLayoutGap=\"10px\">\n                        <mat-form-field fxFlex=\"50\">\n                            <input matInput placeholder=\"Title\" [(ngModel)]=\"selectedWelcomePage.title\">\n                        </mat-form-field>\n                        <mat-form-field fxFlex=\"50\">\n                            <input matInput placeholder=\"Subtitle\" [(ngModel)]=\"selectedWelcomePage.subtitle\">\n                        </mat-form-field>\n                    </div>\n                    <div fxLayoutGap=\"10px\">\n                        <mat-form-field fxFlex=\"50\">\n                            <input matInput placeholder=\"Background URL\" [(ngModel)]=\"selectedWelcomePage.backgroundURL\">\n                        </mat-form-field>\n                        <mat-form-field fxFlex=\"50\">\n                            <input matInput placeholder=\"Home route\" [(ngModel)]=\"selectedWelcomePage.homeRoute\">\n                        </mat-form-field>\n                    </div>\n                    <div fxLayoutGap=\"10px\">\n                        <mat-form-field fxFlex=\"80\">\n                            <mat-label>Used in roles</mat-label>\n                            <mat-select [(ngModel)]=\"selectedWelcomePage.roles\" [compareWith]=\"compareObjects\" multiple>\n                                <mat-option *ngFor=\"let role of allRoles\" [value]=\"role.id\">{{role.display}}</mat-option>\n                            </mat-select>\n                        </mat-form-field>\n                    </div>\n                    <div>Hightlights</div>\n                    <div *ngFor=\"let highlight of selectedWelcomePage.highlights\" fxLayoutGap=\"10px\">\n                        <mat-form-field fxFlex=\"15\">\n                            <input matInput placeholder=\"Icon URL\" [(ngModel)]=\"highlight.iconURL\">\n                        </mat-form-field>\n                        <mat-form-field fxFlex=\"30\">\n                            <input matInput placeholder=\"Title\" [(ngModel)]=\"highlight.title\">\n                        </mat-form-field>\n                        <mat-form-field fxFlex=\"55\">\n                            <textarea matInput placeholder=\"Subtitle\" [(ngModel)]=\"highlight.content\" cdkAutosizeMinRows=\"3\" cdkAutosizeMaxRows=\"3\"></textarea>\n                        </mat-form-field>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div fxFlex class=\"tcs-filler-panel\"></div>\n        <div fxLayout=\"row\" fxLayoutGap=\"10px\" fxLayoutAlign=\"end end\" style=\"min-height: 50px\">\n            <button mat-raised-button color=\"secundary\" (click)=\"runDeleteConfiguration()\">Delete</button>\n            <button mat-raised-button color=\"secundary\" (click)=\"runNewConfiguration()\">New</button>\n            <button mat-raised-button color=\"primary\" (click)=\"runSaveFunction()\">Save</button>\n        </div>\n    </div>\n</div>",
                    styles: [""]
                }] }
    ];
    /** @nocollapse */
    TibcoCloudSettingLandingComponent.ctorParameters = function () { return [
        { type: ActivatedRoute },
        { type: TcGeneralLandingPageConfigService },
        { type: MatSnackBar },
        { type: MatDialog }
    ]; };
    return TibcoCloudSettingLandingComponent;
}());
export { TibcoCloudSettingLandingComponent };
if (false) {
    /**
     * @type {?}
     * @private
     */
    TibcoCloudSettingLandingComponent.prototype.claims;
    /**
     * @type {?}
     * @private
     */
    TibcoCloudSettingLandingComponent.prototype.landingPagesConfig;
    /**
     * @type {?}
     * @private
     */
    TibcoCloudSettingLandingComponent.prototype.sandboxId;
    /**
     * @type {?}
     * @private
     */
    TibcoCloudSettingLandingComponent.prototype.uiAppId;
    /** @type {?} */
    TibcoCloudSettingLandingComponent.prototype.landingPages;
    /** @type {?} */
    TibcoCloudSettingLandingComponent.prototype.selectedWelcomePage;
    /** @type {?} */
    TibcoCloudSettingLandingComponent.prototype.allRoles;
    /** @type {?} */
    TibcoCloudSettingLandingComponent.prototype.selectedRole;
    /**
     * New Configuration
     * @type {?}
     */
    TibcoCloudSettingLandingComponent.prototype.runNewConfiguration;
    /**
     * Helper to Compare Objects
     * @type {?}
     */
    TibcoCloudSettingLandingComponent.prototype.compareObjects;
    /**
     * @type {?}
     * @private
     */
    TibcoCloudSettingLandingComponent.prototype.route;
    /**
     * @type {?}
     * @private
     */
    TibcoCloudSettingLandingComponent.prototype.generalLandingPageConfigService;
    /**
     * @type {?}
     * @private
     */
    TibcoCloudSettingLandingComponent.prototype.snackBar;
    /**
     * @type {?}
     * @private
     */
    TibcoCloudSettingLandingComponent.prototype.dialog;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGliY28tY2xvdWQtc2V0dGluZy1sYW5kaW5nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0aWJjby10Y3N0ay90Yy1jb3JlLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL3RpYmNvLWNsb3VkLXNldHRpbmctbGFuZGluZy90aWJjby1jbG91ZC1zZXR0aW5nLWxhbmRpbmcuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ2xELE9BQU8sRUFBRSxjQUFjLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUNqRCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUscUJBQXFCLEVBQTRCLE1BQU0sNkNBQTZDLENBQUM7QUFDakksT0FBTyxFQUFFLGlDQUFpQyxFQUFFLE1BQU0sdURBQXVELENBQUM7QUFFMUcsT0FBTyxFQUFFLFdBQVcsRUFBRSxTQUFTLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQztBQUMzRCxPQUFPLEVBQUUsNkJBQTZCLEVBQUUsTUFBTSw4REFBOEQsQ0FBQzs7Ozs7O0FBUTdHO0lBaUJJLDJDQUNZLEtBQXFCLEVBQ3JCLCtCQUFrRSxFQUNsRSxRQUFxQixFQUNyQixNQUFpQjtRQUo3QixpQkFLSztRQUpPLFVBQUssR0FBTCxLQUFLLENBQWdCO1FBQ3JCLG9DQUErQixHQUEvQiwrQkFBK0IsQ0FBbUM7UUFDbEUsYUFBUSxHQUFSLFFBQVEsQ0FBYTtRQUNyQixXQUFNLEdBQU4sTUFBTSxDQUFXOzs7O1FBdUQ3Qix3QkFBbUI7OztRQUFHOztnQkFFWixTQUFTLEdBQUcsS0FBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsNkJBQTZCLEVBQUU7Z0JBQzlELEtBQUssRUFBRSxLQUFLO2dCQUNaLE1BQU0sRUFBRSxLQUFLO2dCQUNiLFFBQVEsRUFBRSxPQUFPO2dCQUNqQixTQUFTLEVBQUUsT0FBTztnQkFDbEIsVUFBVSxFQUFFLGtCQUFrQjtn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T0FBTztZQUNqQixJQUFJLE9BQU8sSUFBSSxLQUFJLENBQUMsbUJBQW1CLEVBQUM7O29CQUM5QixLQUFLLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO2dCQUN2QyxLQUFLLENBQUMsTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDdkIsS0FBSSxDQUFDLG1CQUFtQixHQUFHLFNBQVMsQ0FBQzthQUN4QztRQUNMLENBQUMsRUFBQyxDQUFDO0lBQ1AsQ0FBQzs7Z0JBdkVKLFNBQVMsU0FBQztvQkFDVCxRQUFRLEVBQUUsZ0NBQWdDO29CQUMxQyw0NUhBQTJEOztpQkFFNUQ7Ozs7Z0JBakJRLGNBQWM7Z0JBRWQsaUNBQWlDO2dCQUVqQyxXQUFXO2dCQUFFLFNBQVM7O0lBcUgvQix3Q0FBQztDQUFBLEFBNUdELElBNEdDO1NBdkdZLGlDQUFpQzs7Ozs7O0lBRTFDLG1EQUFzQjs7Ozs7SUFDdEIsK0RBQXFEOzs7OztJQUNyRCxzREFBMEI7Ozs7O0lBQzFCLG9EQUF3Qjs7SUFFeEIseURBQXlDOztJQUN6QyxnRUFBOEM7O0lBQzlDLHFEQUFpQzs7SUFDakMseURBQXFDOzs7OztJQTZEckMsZ0VBdUJDOzs7OztJQUtELDJEQUVDOzs7OztJQXhGRyxrREFBNkI7Ozs7O0lBQzdCLDRFQUEwRTs7Ozs7SUFDMUUscURBQTZCOzs7OztJQUM3QixtREFBeUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQWN0aXZhdGVkUm91dGUgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IHsgTGFuZGluZ1BhZ2VDb25maWcsIExhbmRpbmdQYWdlSXRlbUNvbmZpZywgR2VuZXJhbExhbmRpbmdQYWdlQ29uZmlnIH0gZnJvbSAnLi4vLi4vbW9kZWxzL3RjLWdlbmVyYWwtbGFuZGluZy1wYWdlLWNvbmZpZyc7XG5pbXBvcnQgeyBUY0dlbmVyYWxMYW5kaW5nUGFnZUNvbmZpZ1NlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy90Yy1nZW5lcmFsLWxhbmRpbmctcGFnZS1jb25maWcuc2VydmljZSc7XG5pbXBvcnQgeyBDbGFpbSB9IGZyb20gJy4uLy4uL21vZGVscy90Yy1sb2dpbic7XG5pbXBvcnQgeyBNYXRTbmFja0JhciwgTWF0RGlhbG9nIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwnO1xuaW1wb3J0IHsgVGliY29DbG91ZE5ld0VsZW1lbnRDb21wb25lbnQgfSBmcm9tICcuLi90aWJjby1jbG91ZC1uZXctZWxlbWVudC90aWJjby1jbG91ZC1uZXctZWxlbWVudC5jb21wb25lbnQnO1xuaW1wb3J0IHsgUm9sZUF0dHJpYnV0ZSB9IGZyb20gJy4uLy4uL21vZGVscy90Yy1nZW5lcmFsLWNvbmZpZyc7XG5cbi8qKlxuICogQ29uZmlndXJhdGlvbiBwYWdlIGhvbWVcbiAqXG4gKkBleGFtcGxlIDx0Yy10aWJjby1jbG91ZC1zZXR0aW5nLWxhbmRpbmc+PC90Yy10aWJjby1jbG91ZC1zZXR0aW5nLWxhbmRpbmc+XG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3RjLXRpYmNvLWNsb3VkLXNldHRpbmctbGFuZGluZycsXG4gIHRlbXBsYXRlVXJsOiAnLi90aWJjby1jbG91ZC1zZXR0aW5nLWxhbmRpbmcuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi90aWJjby1jbG91ZC1zZXR0aW5nLWxhbmRpbmcuY29tcG9uZW50LmNzcyddXG59KVxuZXhwb3J0IGNsYXNzIFRpYmNvQ2xvdWRTZXR0aW5nTGFuZGluZ0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG5cbiAgICBwcml2YXRlIGNsYWltczogQ2xhaW07XG4gICAgcHJpdmF0ZSBsYW5kaW5nUGFnZXNDb25maWc6IEdlbmVyYWxMYW5kaW5nUGFnZUNvbmZpZztcbiAgICBwcml2YXRlIHNhbmRib3hJZDogbnVtYmVyO1xuICAgIHByaXZhdGUgdWlBcHBJZDogc3RyaW5nO1xuXG4gICAgcHVibGljIGxhbmRpbmdQYWdlczogTGFuZGluZ1BhZ2VDb25maWdbXTtcbiAgICBwdWJsaWMgc2VsZWN0ZWRXZWxjb21lUGFnZTogTGFuZGluZ1BhZ2VDb25maWc7XG4gICAgcHVibGljIGFsbFJvbGVzOiBSb2xlQXR0cmlidXRlW107XG4gICAgcHVibGljIHNlbGVjdGVkUm9sZTogUm9sZUF0dHJpYnV0ZVtdO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcm91dGU6IEFjdGl2YXRlZFJvdXRlLFxuICAgICAgICBwcml2YXRlIGdlbmVyYWxMYW5kaW5nUGFnZUNvbmZpZ1NlcnZpY2U6IFRjR2VuZXJhbExhbmRpbmdQYWdlQ29uZmlnU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBzbmFja0JhcjogTWF0U25hY2tCYXIsXG4gICAgICAgIHByaXZhdGUgZGlhbG9nOiBNYXREaWFsb2dcbiAgICApIHsgfVxuXG4gICAgLyoqXG4gICAgKiBAaWdub3JlXG4gICAgKi9cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5sYW5kaW5nUGFnZXNDb25maWcgPSB0aGlzLnJvdXRlLnNuYXBzaG90LmRhdGEubGFuZGluZ1BhZ2VzQ29uZmlnSG9sZGVyO1xuICAgICAgICB0aGlzLmxhbmRpbmdQYWdlcyA9IHRoaXMubGFuZGluZ1BhZ2VzQ29uZmlnLmxhbmRpbmdQYWdlO1xuICAgICAgICB0aGlzLmFsbFJvbGVzID0gdGhpcy5yb3V0ZS5zbmFwc2hvdC5kYXRhLmFsbFJvbGVzSG9sZGVyLnJvbGVzLmZpbHRlcihlbGVtZW50ID0+ICFlbGVtZW50LmNvbmZpZ3VyYXRpb24pO1xuXG4gICAgICAgIHRoaXMuc2FuZGJveElkID0gdGhpcy5yb3V0ZS5zbmFwc2hvdC5kYXRhLmNsYWltcy5wcmltYXJ5UHJvZHVjdGlvblNhbmRib3guaWQ7XG4gICAgICAgIHRoaXMudWlBcHBJZCA9IHRoaXMucm91dGUuc25hcHNob3QuZGF0YS5sYW5kaW5nUGFnZXNDb25maWdIb2xkZXIudWlBcHBJZDtcblxuICAgICAgICAvLyBJZiB0aGVyZSBpcyBvbmx5IG9uZSBsYW5kaW5nIHBhZ2Ugc2VsZWN0cyBpdCBhdXRvbWF0aWNhbGx5XG4gICAgICAgIGlmICh0aGlzLmxhbmRpbmdQYWdlcy5sZW5ndGggPT0gMSkge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFdlbGNvbWVQYWdlID0gdGhpcy5sYW5kaW5nUGFnZXNbMF07XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTYXZlIENvbmZpZ3VyYXRpb25cbiAgICAgKi9cbiAgICBydW5TYXZlRnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5nZW5lcmFsTGFuZGluZ1BhZ2VDb25maWdTZXJ2aWNlLnVwZGF0ZUdlbmVyYWxMYW5kaW5nUGFnZUNvbmZpZyh0aGlzLnNhbmRib3hJZCwgdGhpcy51aUFwcElkLCB0aGlzLmxhbmRpbmdQYWdlc0NvbmZpZywgdGhpcy5sYW5kaW5nUGFnZXNDb25maWcuaWQpLnN1YnNjcmliZShcbiAgICAgICAgICAgIHJlc3VsdCA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zbmFja0Jhci5vcGVuKCdMYW5kaW5nIFBhZ2VzIGNvbmZpZ3VyYXRpb24gc2F2ZWQnLCAnT0snLCB7XG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAzMDAwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNuYWNrQmFyLm9wZW4oJ0Vycm9yIHNhdmluZyBMYW5kaW5nIFBhZ2VzIGNvbmZpZ3VyYXRpb24nLCAnT0snLCB7XG4gICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAzMDAwXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRGVsZXRlIENvbmZpZ3VyYXRpb25cbiAgICAgKi9cbiAgICBydW5EZWxldGVDb25maWd1cmF0aW9uKCl7XG4gICAgICAgIGNvbnN0IHBhZ2VzID0gdGhpcy5sYW5kaW5nUGFnZXM7XG4gICAgICAgIHBhZ2VzLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICBpZiAoZWxlbWVudCA9PSB0aGlzLnNlbGVjdGVkV2VsY29tZVBhZ2Upe1xuICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gcGFnZXMuaW5kZXhPZihlbGVtZW50LCAwKTtcbiAgICAgICAgICAgICAgICBwYWdlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRXZWxjb21lUGFnZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogTmV3IENvbmZpZ3VyYXRpb25cbiAgICAgKi9cbiAgICBydW5OZXdDb25maWd1cmF0aW9uID0gKCk6dm9pZCA9PiB7XG5cbiAgICAgICAgY29uc3QgZGlhbG9nUmVmID0gdGhpcy5kaWFsb2cub3BlbihUaWJjb0Nsb3VkTmV3RWxlbWVudENvbXBvbmVudCwge1xuICAgICAgICAgICAgd2lkdGg6ICc1MCUnLFxuICAgICAgICAgICAgaGVpZ2h0OiAnMzAlJyxcbiAgICAgICAgICAgIG1heFdpZHRoOiAnMTAwdncnLFxuICAgICAgICAgICAgbWF4SGVpZ2h0OiAnMTAwdmgnLFxuICAgICAgICAgICAgcGFuZWxDbGFzczogJ3Rjcy1zdHlsZS1kaWFsb2cnLFxuICAgICAgICAgICAgZGF0YTogeyByZXNvdXJjZVR5cGU6ICdMYW5kaW5nIFBhZ2UnIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZGlhbG9nUmVmLmFmdGVyQ2xvc2VkKCkuc3Vic2NyaWJlKHJlc3VsdCA9PiB7XG4gICAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3RWxlbWVudCA9IG5ldyBMYW5kaW5nUGFnZUNvbmZpZygpLmRlc2VyaWFsaXplKHtcbiAgICAgICAgICAgICAgICAgICAga2V5OiByZXN1bHQuaWQsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiByZXN1bHQubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0czogW25ldyBMYW5kaW5nUGFnZUl0ZW1Db25maWcoKSwgbmV3IExhbmRpbmdQYWdlSXRlbUNvbmZpZygpLCBuZXcgTGFuZGluZ1BhZ2VJdGVtQ29uZmlnKCldXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmxhbmRpbmdQYWdlcy5wdXNoKG5ld0VsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRXZWxjb21lUGFnZSA9IG5ld0VsZW1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhlbHBlciB0byBDb21wYXJlIE9iamVjdHNcbiAgICAgKi9cbiAgICBjb21wYXJlT2JqZWN0cyA9IChvMTogc3RyaW5nLCBvMjogc3RyaW5nKTogYm9vbGVhbiA9PiB7XG4gICAgICAgIHJldHVybiBvMSA9PT0gbzI7XG4gICAgfVxuXG59XG4iXX0=