/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { forkJoin } from 'rxjs';
import { LiveAppsService } from './live-apps.service';
import { TcCaseDataService } from './tc-case-data.service';
import { map, tap } from 'rxjs/operators';
import { HttpClient } from '@angular/common/http';
import { StateTrackerData, StateTracker, TrackerState, StateAuditEventList } from '../models/tc-case-states';
import { DomSanitizer } from '@angular/platform-browser';
import { Location } from '@angular/common';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
import * as i2 from "./live-apps.service";
import * as i3 from "./tc-case-data.service";
import * as i4 from "@angular/platform-browser";
import * as i5 from "@angular/common";
/** @type {?} */
const MILESTONE_SVG = {
    END_SECTION_COMPLETED_SVG: '<svg xmlns="http://www.w3.org/2000/svg" width="94" height="36" viewBox="0 0 94 36">\n' +
        '    <path class="{{milestoneBgClass}}" fill="none" fill-rule="evenodd" d="M0 0h76c9.941 0 18 8.059 18 18s-8.059 18-18 18H0c6.095-3.675 10.172-10.361 10.172-18C10.172 10.361 6.095 3.675 0 0z"/>\n' +
        '    <text fill="#FFF" font-family="SourceSansPro-Regular, Source Sans Pro" font-size="14">\n' +
        '        <tspan x="16" y="23" class="{{milestoneLabelClass}}">{{milestoneLabel}}</tspan>\n' +
        '    </text>\n' +
        '</svg>\n',
    END_SECTION_INPROGESS_SVG: '<svg xmlns="http://www.w3.org/2000/svg" width="94" height="36" viewBox="0 0 94 36">\n' +
        '    <path class="{{milestoneBgClass}}" fill="none" fill-rule="evenodd" d="M0 0h76c9.941 0 18 8.059 18 18s-8.059 18-18 18H0c6.095-3.675 10.172-10.361 10.172-18C10.172 10.361 6.095 3.675 0 0z"/>\n' +
        '    <text fill="#FFF" font-family="SourceSansPro-Regular, Source Sans Pro" font-size="14">\n' +
        '        <tspan x="16" y="23" class="{{milestoneLabelClass}}">{{milestoneLabel}}</tspan>\n' +
        '    </text>\n' +
        '</svg>\n',
    END_SECTION_PENDING_SVG: '<svg xmlns="http://www.w3.org/2000/svg" width="94" height="36" viewBox="0 0 94 36">\n' +
        '    <path class="{{milestoneBgClass}}" fill="none" fill-rule="evenodd" d="M0 0h76c9.941 0 18 8.059 18 18s-8.059 18-18 18H0c6.095-3.675 10.172-10.361 10.172-18C10.172 10.361 6.095 3.675 0 0z"/>\n' +
        '    <text class="pending-text" fill="#FFF" font-family="SourceSansPro-Regular, Source Sans Pro" font-size="14">\n' +
        '        <tspan x="16" y="23" class="{{milestoneLabelClass}}">{{milestoneLabel}}</tspan>\n' +
        '    </text>\n' +
        '</svg>\n',
    FIRST_SECTION_COMPLETED_SVG: '<svg xmlns="http://www.w3.org/2000/svg" width="94" height="36" viewBox="0 0 94 36">\n' +
        '<path class="{{milestoneBgClass}}" fill="none" fill-rule="evenodd" d="M93.42 0C87.176 3.675 83 10.361 83 18c0 7.639 4.176 14.325 10.42 18H0c6.36-3.675 10.614-10.361 10.614-18C10.614 10.361 6.36 3.675 0 0h93.42z"/>\n' +
        '<text fill="#FFF" font-family="SourceSansPro-Regular, Source Sans Pro" font-size="14">\n' +
        '    <tspan x="16" y="23" class="{{milestoneLabelClass}}">{{milestoneLabel}}</tspan>\n' +
        '</text>\n' +
        '</svg>\n',
    FIRST_SECTION_INPROGRESS_SVG: '<svg xmlns="http://www.w3.org/2000/svg" width="94" height="36" viewBox="0 0 94 36">\n' +
        '    <path class="{{milestoneBgClass}}" fill="none" fill-rule="evenodd" d="M93.42 0C87.176 3.675 83 10.361 83 18c0 7.639 4.176 14.325 10.42 18H0c6.36-3.675 10.614-10.361 10.614-18C10.614 10.361 6.36 3.675 0 0h93.42z"/>\n' +
        '    <text fill="#FFF" font-family="SourceSansPro-Regular, Source Sans Pro" font-size="14">\n' +
        '        <tspan x="16" y="23" class="{{milestoneLabelClass}}">{{milestoneLabel}}</tspan>\n' +
        '    </text>\n' +
        '</svg>',
    FIRST_SECTION_PENDING_SVG: '<svg xmlns="http://www.w3.org/2000/svg" width="94" height="36" viewBox="0 0 94 36">\n' +
        '    <path class="{{milestoneBgClass}}" fill="none" fill-rule="evenodd" d="M93.42 0C87.176 3.675 83 10.361 83 18c0 7.639 4.176 14.325 10.42 18H0c6.36-3.675 10.614-10.361 10.614-18C10.614 10.361 6.36 3.675 0 0h93.42z"/>\n' +
        '    <text fill="#FFF" font-family="SourceSansPro-Regular, Source Sans Pro" font-size="14">\n' +
        '        <tspan x="16" y="23" class="{{milestoneLabelClass}}">{{milestoneLabel}}</tspan>\n' +
        '    </text>\n' +
        '</svg>\n',
    MIDDLE_SECTION_COMPLETED_SVG: '<svg xmlns="http://www.w3.org/2000/svg" width="164" height="36" viewBox="0 0 164 36">\n' +
        '    <path class="{{milestoneBgClass}}" fill="none" fill-rule="evenodd" d="M164 0c-6.09 3.675-10.163 10.361-10.163 18 0 7.639 4.073 14.325 10.163 18H0c6.095-3.675 10.172-10.361 10.172-18C10.172 10.361 6.095 3.675 0 0h164z"/>\n' +
        '    <text fill="#FFF" font-family="SourceSansPro-Regular, Source Sans Pro" font-size="14">\n' +
        '        <tspan x="16" y="23" class="{{milestoneLabelClass}}">{{milestoneLabel}}</tspan>\n' +
        '    </text>\n' +
        '</svg>\n',
    MIDDLE_SECTION_INPROGRESS_SVG: '<svg xmlns="http://www.w3.org/2000/svg" width="164" height="36" viewBox="0 0 164 36">\n' +
        '    <path class="{{milestoneBgClass}}" fill="none" fill-rule="evenodd" d="M164 0c-6.09 3.675-10.163 10.361-10.163 18 0 7.639 4.073 14.325 10.163 18H0c6.095-3.675 10.172-10.361 10.172-18C10.172 10.361 6.095 3.675 0 0h164z"/>\n' +
        '    <text fill="#FFF" font-family="SourceSansPro-Regular, Source Sans Pro" font-size="14">\n' +
        '        <tspan x="16" y="23" class="{{milestoneLabelClass}}">{{milestoneLabel}}</tspan>\n' +
        '    </text>\n' +
        '</svg>\n',
    MIDDLE_SECTION_PENDING_SVG: '<svg xmlns="http://www.w3.org/2000/svg" width="164" height="36" viewBox="0 0 164 36">\n' +
        '    <path class="{{milestoneBgClass}}" fill="none" fill-rule="evenodd" d="M164 0c-6.09 3.675-10.163 10.361-10.163 18 0 7.639 4.073 14.325 10.163 18H0c6.095-3.675 10.172-10.361 10.172-18C10.172 10.361 6.095 3.675 0 0h164z"/>\n' +
        '    <text class="pending-text" fill="#FFF" font-family="SourceSansPro-Regular, Source Sans Pro" font-size="14">\n' +
        '        <tspan x="16" y="23" class="{{milestoneLabelClass}}">{{milestoneLabel}}</tspan>\n' +
        '    </text>\n' +
        '</svg>\n'
};
export class TcCaseStatesService {
    /**
     * @param {?} http
     * @param {?} liveAppsService
     * @param {?} caseDataService
     * @param {?} sanitizer
     * @param {?} location
     */
    constructor(http, liveAppsService, caseDataService, sanitizer, location) {
        this.http = http;
        this.liveAppsService = liveAppsService;
        this.caseDataService = caseDataService;
        this.sanitizer = sanitizer;
        this.location = location;
        this.getTrackerData = (/**
         * @param {?} caseRef
         * @param {?} sandboxId
         * @param {?} appId
         * @return {?}
         */
        (caseRef, sandboxId, appId) => {
            // merge the result of these three API calls into one object
            /** @type {?} */
            const caseState$ = this.caseDataService.getCaseState(caseRef, sandboxId);
            /** @type {?} */
            const possibleStates$ = this.liveAppsService.getCaseTypeStates(sandboxId, appId, 100);
            /** @type {?} */
            const stateAudit$ = this.getCaseStateAudit(caseRef, sandboxId);
            return forkJoin([caseState$, possibleStates$, stateAudit$]).pipe(map((/**
             * @param {?} resultArr
             * @return {?}
             */
            resultArr => {
                return new StateTrackerData().deserialize({ possibleStates: resultArr[1], currentState: resultArr[0], caseAudit: resultArr[2].auditEvents });
            })));
        });
        this.buildTracker = (/**
         * @param {?} trackerData
         * @return {?}
         */
        (trackerData) => {
            /** @type {?} */
            const tracker = new StateTracker();
            tracker.states = [];
            if (trackerData.caseAudit.length <= 0) {
                // if no audit it has likely been deleted and we cannot create a milestone trailer
                tracker.valid = false;
            }
            else {
                // work out the status of each state
                // possible states: 'pending', 'inprogress', 'completed'
                trackerData.possibleStates.states.forEach((/**
                 * @param {?} state
                 * @return {?}
                 */
                state => {
                    /** @type {?} */
                    const stateLabel = state.label;
                    /** @type {?} */
                    const stateName = state.value;
                    /** @type {?} */
                    const trackerState = new TrackerState();
                    trackerState.phase = '';
                    trackerState.previousPhase = '';
                    // no specific name coming from API so use label.
                    trackerState.name = state.label;
                    trackerState.label = state.label;
                    trackerState.isTerminal = state.isTerminal ? state.isTerminal : false;
                    // find last event for this state
                    /** @type {?} */
                    const reversedEvents = [];
                    Object.assign(reversedEvents, trackerData.caseAudit);
                    reversedEvents.reverse();
                    /** @type {?} */
                    const idx = reversedEvents.findIndex((/**
                     * @param {?} auditEvent
                     * @return {?}
                     */
                    auditEvent => auditEvent.caseState.value === state.value));
                    /** @type {?} */
                    const origIdx = (trackerData.caseAudit.length - 1) - idx;
                    /** @type {?} */
                    let thisEvent;
                    if (idx === -1) {
                        // no audit events so we haven't reached this state yet
                        trackerState.status = 'pending';
                    }
                    else {
                        thisEvent = trackerData.caseAudit[origIdx];
                        trackerState.user = thisEvent.principalName ? thisEvent.principalName.value : 'system';
                        trackerState.changed = thisEvent.creationTime ? thisEvent.creationTime.value : '';
                        trackerState.phase = thisEvent.phaseLabel ? thisEvent.phaseLabel.value : undefined;
                        trackerState.previousPhase = thisEvent.previousPhaseLabel ? thisEvent.previousPhaseLabel.value : undefined;
                        if (state.isTerminal) {
                            // if we have audit for this state and it is terminal it must be completed
                            trackerState.status = 'completed';
                        }
                        else if ((trackerData.caseAudit.length - 1) === origIdx) {
                            // if this is the last audit entry then it is in progress
                            trackerState.status = 'inprogress';
                        }
                        else {
                            // otherwise it must be completed
                            trackerState.status = 'completed';
                        }
                    }
                    tracker.states.push(trackerState);
                    tracker.valid = true;
                }));
            }
            return tracker;
        });
        this.getTracker = (/**
         * @param {?} caseRef
         * @param {?} sandboxId
         * @param {?} appId
         * @return {?}
         */
        (caseRef, sandboxId, appId) => {
            /** @type {?} */
            const tracker$ = this.getTrackerData(caseRef, sandboxId, appId).pipe(map((/**
             * @param {?} trackerData
             * @return {?}
             */
            trackerData => {
                return this.buildTracker(trackerData);
            })));
            return tracker$;
        });
    }
    /**
     * @param {?} caseRef
     * @param {?} sandboxId
     * @param {?} appId
     * @return {?}
     */
    getCaseStateAuditWithTerminal(caseRef, sandboxId, appId) {
        /** @type {?} */
        const possibleStates$ = this.liveAppsService.getCaseTypeStates(sandboxId, appId, 100);
        /** @type {?} */
        const caseStateAudit$ = this.getCaseStateAudit(caseRef, sandboxId);
        return forkJoin([possibleStates$, caseStateAudit$]).pipe(map((/**
         * @param {?} resultArr
         * @return {?}
         */
        resultArr => {
            /** @type {?} */
            const possibleStates = resultArr[0];
            /** @type {?} */
            const caseStateAudit = resultArr[1];
            // mark if any are terminal states
            caseStateAudit.auditEvents.forEach((/**
             * @param {?} auditEvent
             * @return {?}
             */
            auditEvent => {
                /** @type {?} */
                const foundState = possibleStates.states.find((/**
                 * @param {?} state
                 * @return {?}
                 */
                state => state.value === auditEvent.caseState.value));
                auditEvent.isTerminal = foundState.isTerminal ? foundState.isTerminal : false;
            }));
            return caseStateAudit;
        })));
    }
    /**
     * @param {?} caseRef
     * @param {?} sandboxId
     * @return {?}
     */
    getCaseStateAudit(caseRef, sandboxId) {
        /** @type {?} */
        const url = '/event/v1/auditEvents?$sandbox=' + sandboxId
            + '&$filter=type eq \'casestate\''
            + ' and id eq \'' + caseRef + '\'';
        return this.http.get(url)
            .pipe(tap((/**
         * @param {?} val
         * @return {?}
         */
        val => sessionStorage.setItem('tcsTimestamp', Date.now().toString()))), map((/**
         * @param {?} caseaudit
         * @return {?}
         */
        caseaudit => new StateAuditEventList().deserialize(caseaudit))));
    }
    /**
     * @param {?} stateLabel
     * @param {?} labelClass
     * @param {?} bgClass
     * @param {?} svgFileName
     * @return {?}
     */
    getMilestoneSectionSvg(stateLabel, labelClass, bgClass, svgFileName) {
        /*return this.liveAppsService.getIconSVGText(TcCoreCommonFunctions.prepareUrlForStaticResource(this.location, 'assets/icons/milestones/' + svgFileName)).pipe(
          map(svgcontents => {
            let updatedsvg = svgcontents.replace('{{milestoneLabel}}', stateLabel);
            updatedsvg = updatedsvg.replace('{{milestoneBgClass}}', bgClass);
            updatedsvg = updatedsvg.replace('{{milestoneLabelClass}}', labelClass);
            const newval = this.sanitizer.bypassSecurityTrustHtml(updatedsvg);
            return newval;
          })
        );*/
        // convert svgFileName to the inline property name
        svgFileName = svgFileName.toUpperCase();
        /** @type {?} */
        const regEx = /-|\./gi;
        svgFileName = svgFileName.replace(regEx, '_');
        /** @type {?} */
        const svgcontents = MILESTONE_SVG[svgFileName];
        if (svgcontents) {
            /** @type {?} */
            let updatedsvg = svgcontents.replace('{{milestoneLabel}}', stateLabel);
            updatedsvg = updatedsvg.replace('{{milestoneBgClass}}', bgClass);
            updatedsvg = updatedsvg.replace('{{milestoneLabelClass}}', labelClass);
            /** @type {?} */
            const newval = this.sanitizer.bypassSecurityTrustHtml(updatedsvg);
            return newval;
        }
        else {
            return undefined;
        }
    }
}
TcCaseStatesService.decorators = [
    { type: Injectable, args: [{
                providedIn: 'root'
            },] }
];
/** @nocollapse */
TcCaseStatesService.ctorParameters = () => [
    { type: HttpClient },
    { type: LiveAppsService },
    { type: TcCaseDataService },
    { type: DomSanitizer },
    { type: Location }
];
/** @nocollapse */ TcCaseStatesService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function TcCaseStatesService_Factory() { return new TcCaseStatesService(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.LiveAppsService), i0.ɵɵinject(i3.TcCaseDataService), i0.ɵɵinject(i4.DomSanitizer), i0.ɵɵinject(i5.Location)); }, token: TcCaseStatesService, providedIn: "root" });
if (false) {
    /**
     * @type {?}
     * @private
     */
    TcCaseStatesService.prototype.getTrackerData;
    /**
     * @type {?}
     * @private
     */
    TcCaseStatesService.prototype.buildTracker;
    /** @type {?} */
    TcCaseStatesService.prototype.getTracker;
    /**
     * @type {?}
     * @private
     */
    TcCaseStatesService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    TcCaseStatesService.prototype.liveAppsService;
    /**
     * @type {?}
     * @private
     */
    TcCaseStatesService.prototype.caseDataService;
    /**
     * @type {?}
     * @private
     */
    TcCaseStatesService.prototype.sanitizer;
    /**
     * @type {?}
     * @private
     */
    TcCaseStatesService.prototype.location;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGMtY2FzZS1zdGF0ZXMuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0aWJjby10Y3N0ay90Yy1saXZlYXBwcy1saWIvIiwic291cmNlcyI6WyJsaWIvc2VydmljZXMvdGMtY2FzZS1zdGF0ZXMuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUMzQyxPQUFPLEVBQUMsUUFBUSxFQUFhLE1BQU0sTUFBTSxDQUFDO0FBQzFDLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxxQkFBcUIsQ0FBQztBQUNwRCxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSx3QkFBd0IsQ0FBQztBQUN6RCxPQUFPLEVBQUMsR0FBRyxFQUFFLEdBQUcsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ3hDLE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxzQkFBc0IsQ0FBQztBQUNoRCxPQUFPLEVBQUMsZ0JBQWdCLEVBQUUsWUFBWSxFQUFFLFlBQVksRUFBRSxtQkFBbUIsRUFBa0IsTUFBTSwwQkFBMEIsQ0FBQztBQUM1SCxPQUFPLEVBQUMsWUFBWSxFQUFXLE1BQU0sMkJBQTJCLENBQUM7QUFDakUsT0FBTyxFQUFDLFFBQVEsRUFBQyxNQUFNLGlCQUFpQixDQUFDOzs7Ozs7OztNQUduQyxhQUFhLEdBQUc7SUFDcEIseUJBQXlCLEVBQUUsdUZBQXVGO1FBQ2xILG9NQUFvTTtRQUNwTSw4RkFBOEY7UUFDOUYsMkZBQTJGO1FBQzNGLGVBQWU7UUFDZixVQUFVO0lBQ1YseUJBQXlCLEVBQUUsdUZBQXVGO1FBQ2xILG9NQUFvTTtRQUNwTSw4RkFBOEY7UUFDOUYsMkZBQTJGO1FBQzNGLGVBQWU7UUFDZixVQUFVO0lBQ1YsdUJBQXVCLEVBQUUsdUZBQXVGO1FBQ2hILG9NQUFvTTtRQUNwTSxtSEFBbUg7UUFDbkgsMkZBQTJGO1FBQzNGLGVBQWU7UUFDZixVQUFVO0lBQ1YsMkJBQTJCLEVBQUUs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QVU7WUFIVixlQUFlO1lBQ2YsaUJBQWlCO1lBSWpCLFlBQVk7WUFDWixRQUFROzs7Ozs7OztJQXVFZCw2Q0FZQzs7Ozs7SUFFRCwyQ0FtREM7O0lBRUQseUNBT0M7Ozs7O0lBaEZXLG1DQUF3Qjs7Ozs7SUFDeEIsOENBQXdDOzs7OztJQUN4Qyw4Q0FBMEM7Ozs7O0lBQzFDLHdDQUErQjs7Ozs7SUFDL0IsdUNBQTBCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtmb3JrSm9pbiwgT2JzZXJ2YWJsZX0gZnJvbSAncnhqcyc7XG5pbXBvcnQge0xpdmVBcHBzU2VydmljZX0gZnJvbSAnLi9saXZlLWFwcHMuc2VydmljZSc7XG5pbXBvcnQge1RjQ2FzZURhdGFTZXJ2aWNlfSBmcm9tICcuL3RjLWNhc2UtZGF0YS5zZXJ2aWNlJztcbmltcG9ydCB7bWFwLCB0YXB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7SHR0cENsaWVudH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHtTdGF0ZVRyYWNrZXJEYXRhLCBTdGF0ZVRyYWNrZXIsIFRyYWNrZXJTdGF0ZSwgU3RhdGVBdWRpdEV2ZW50TGlzdCwgU3RhdGVBdWRpdEV2ZW50fSBmcm9tICcuLi9tb2RlbHMvdGMtY2FzZS1zdGF0ZXMnO1xuaW1wb3J0IHtEb21TYW5pdGl6ZXIsIFNhZmVIdG1sfSBmcm9tICdAYW5ndWxhci9wbGF0Zm9ybS1icm93c2VyJztcbmltcG9ydCB7TG9jYXRpb259IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge1RjQ29yZUNvbW1vbkZ1bmN0aW9uc30gZnJvbSAnQHRpYmNvLXRjc3RrL3RjLWNvcmUtbGliJztcblxuY29uc3QgTUlMRVNUT05FX1NWRyA9IHtcbiAgRU5EX1NFQ1RJT05fQ09NUExFVEVEX1NWRzogJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiOTRcIiBoZWlnaHQ9XCIzNlwiIHZpZXdCb3g9XCIwIDAgOTQgMzZcIj5cXG4nICtcbiAgJyAgICA8cGF0aCBjbGFzcz1cInt7bWlsZXN0b25lQmdDbGFzc319XCIgZmlsbD1cIm5vbmVcIiBmaWxsLXJ1bGU9XCJldmVub2RkXCIgZD1cIk0wIDBoNzZjOS45NDEgMCAxOCA4LjA1OSAxOCAxOHMtOC4wNTkgMTgtMTggMThIMGM2LjA5NS0zLjY3NSAxMC4xNzItMTAuMzYxIDEwLjE3Mi0xOEMxMC4xNzIgMTAuMzYxIDYuMDk1IDMuNjc1IDAgMHpcIi8+XFxuJyArXG4gICcgICAgPHRleHQgZmlsbD1cIiNGRkZcIiBmb250LWZhbWlseT1cIlNvdXJjZVNhbnNQcm8tUmVndWxhciwgU291cmNlIFNhbnMgUHJvXCIgZm9udC1zaXplPVwiMTRcIj5cXG4nICtcbiAgJyAgICAgICAgPHRzcGFuIHg9XCIxNlwiIHk9XCIyM1wiIGNsYXNzPVwie3ttaWxlc3RvbmVMYWJlbENsYXNzfX1cIj57e21pbGVzdG9uZUxhYmVsfX08L3RzcGFuPlxcbicgK1xuICAnICAgIDwvdGV4dD5cXG4nICtcbiAgJzwvc3ZnPlxcbicsXG4gIEVORF9TRUNUSU9OX0lOUFJPR0VTU19TVkc6ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjk0XCIgaGVpZ2h0PVwiMzZcIiB2aWV3Qm94PVwiMCAwIDk0IDM2XCI+XFxuJyArXG4gICcgICAgPHBhdGggY2xhc3M9XCJ7e21pbGVzdG9uZUJnQ2xhc3N9fVwiIGZpbGw9XCJub25lXCIgZmlsbC1ydWxlPVwiZXZlbm9kZFwiIGQ9XCJNMCAwaDc2YzkuOTQxIDAgMTggOC4wNTkgMTggMThzLTguMDU5IDE4LTE4IDE4SDBjNi4wOTUtMy42NzUgMTAuMTcyLTEwLjM2MSAxMC4xNzItMThDMTAuMTcyIDEwLjM2MSA2LjA5NSAzLjY3NSAwIDB6XCIvPlxcbicgK1xuICAnICAgIDx0ZXh0IGZpbGw9XCIjRkZGXCIgZm9udC1mYW1pbHk9XCJTb3VyY2VTYW5zUHJvLVJlZ3VsYXIsIFNvdXJjZSBTYW5zIFByb1wiIGZvbnQtc2l6ZT1cIjE0XCI+XFxuJyArXG4gICcgICAgICAgIDx0c3BhbiB4PVwiMTZcIiB5PVwiMjNcIiBjbGFzcz1cInt7bWlsZXN0b25lTGFiZWxDbGFzc319XCI+e3ttaWxlc3RvbmVMYWJlbH19PC90c3Bhbj5cXG4nICtcbiAgJyAgICA8L3RleHQ+XFxuJyArXG4gICc8L3N2Zz5cXG4nLFxuICBFTkRfU0VDVElPTl9QRU5ESU5HX1NWRzogJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiOTRcIiBoZWlnaHQ9XCIzNlwiIHZpZXdCb3g9XCIwIDAgOTQgMzZcIj5cXG4nICtcbiAgJyAgICA8cGF0aCBjbGFzcz1cInt7bWlsZXN0b25lQmdDbGFzc319XCIgZmlsbD1cIm5vbmVcIiBmaWxsLXJ1bGU9XCJldmVub2RkXCIgZD1cIk0wIDBoNzZjOS45NDEgMCAxOCA4LjA1OSAxOCAxOHMtOC4wNTkgMTgtMTggMThIMGM2LjA5NS0zLjY3NSAxMC4xNzItMTAuMzYxIDEwLjE3Mi0xOEMxMC4xNzIgMTAuMzYxIDYuMDk1IDMuNjc1IDAgMHpcIi8+XFxuJyArXG4gICcgICAgPHRleHQgY2xhc3M9XCJwZW5kaW5nLXRleHRcIiBmaWxsPVwiI0ZGRlwiIGZvbnQtZmFtaWx5PVwiU291cmNlU2Fuc1Byby1SZWd1bGFyLCBTb3VyY2UgU2FucyBQcm9cIiBmb250LXNpemU9XCIxNFwiPlxcbicgK1xuICAnICAgICAgICA8dHNwYW4geD1cIjE2XCIgeT1cIjIzXCIgY2xhc3M9XCJ7e21pbGVzdG9uZUxhYmVsQ2xhc3N9fVwiPnt7bWlsZXN0b25lTGFiZWx9fTwvdHNwYW4+XFxuJyArXG4gICcgICAgPC90ZXh0PlxcbicgK1xuICAnPC9zdmc+XFxuJyxcbiAgRklSU1RfU0VDVElPTl9DT01QTEVURURfU1ZHOiAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCI5NFwiIGhlaWdodD1cIjM2XCIgdmlld0JveD1cIjAgMCA5NCAzNlwiPlxcbicgK1xuICAnPHBhdGggY2xhc3M9XCJ7e21pbGVzdG9uZUJnQ2xhc3N9fVwiIGZpbGw9XCJub25lXCIgZmlsbC1ydWxlPVwiZXZlbm9kZFwiIGQ9XCJNOTMuNDIgMEM4Ny4xNzYgMy42NzUgODMgMTAuMzYxIDgzIDE4YzAgNy42MzkgNC4xNzYgMTQuMzI1IDEwLjQyIDE4SDBjNi4zNi0zLjY3NSAxMC42MTQtMTAuMzYxIDEwLjYxNC0xOEMxMC42MTQgMTAuMzYxIDYuMzYgMy42NzUgMCAwaDkzLjQyelwiLz5cXG4nICtcbiAgJzx0ZXh0IGZpbGw9XCIjRkZGXCIgZm9udC1mYW1pbHk9XCJTb3VyY2VTYW5zUHJvLVJlZ3VsYXIsIFNvdXJjZSBTYW5zIFByb1wiIGZvbnQtc2l6ZT1cIjE0XCI+XFxuJyArXG4gICcgICAgPHRzcGFuIHg9XCIxNlwiIHk9XCIyM1wiIGNsYXNzPVwie3ttaWxlc3RvbmVMYWJlbENsYXNzfX1cIj57e21pbGVzdG9uZUxhYmVsfX08L3RzcGFuPlxcbicgK1xuICAnPC90ZXh0PlxcbicgK1xuICAnPC9zdmc+XFxuJyxcbiAgRklSU1RfU0VDVElPTl9JTlBST0dSRVNTX1NWRzogJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiOTRcIiBoZWlnaHQ9XCIzNlwiIHZpZXdCb3g9XCIwIDAgOTQgMzZcIj5cXG4nICtcbiAgJyAgICA8cGF0aCBjbGFzcz1cInt7bWlsZXN0b25lQmdDbGFzc319XCIgZmlsbD1cIm5vbmVcIiBmaWxsLXJ1bGU9XCJldmVub2RkXCIgZD1cIk05My40MiAwQzg3LjE3NiAzLjY3NSA4MyAxMC4zNjEgODMgMThjMCA3LjYzOSA0LjE3NiAxNC4zMjUgMTAuNDIgMThIMGM2LjM2LTMuNjc1IDEwLjYxNC0xMC4zNjEgMTAuNjE0LTE4QzEwLjYxNCAxMC4zNjEgNi4zNiAzLjY3NSAwIDBoOTMuNDJ6XCIvPlxcbicgK1xuICAnICAgIDx0ZXh0IGZpbGw9XCIjRkZGXCIgZm9udC1mYW1pbHk9XCJTb3VyY2VTYW5zUHJvLVJlZ3VsYXIsIFNvdXJjZSBTYW5zIFByb1wiIGZvbnQtc2l6ZT1cIjE0XCI+XFxuJyArXG4gICcgICAgICAgIDx0c3BhbiB4PVwiMTZcIiB5PVwiMjNcIiBjbGFzcz1cInt7bWlsZXN0b25lTGFiZWxDbGFzc319XCI+e3ttaWxlc3RvbmVMYWJlbH19PC90c3Bhbj5cXG4nICtcbiAgJyAgICA8L3RleHQ+XFxuJyArXG4gICc8L3N2Zz4nLFxuICBGSVJTVF9TRUNUSU9OX1BFTkRJTkdfU1ZHOiAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCI5NFwiIGhlaWdodD1cIjM2XCIgdmlld0JveD1cIjAgMCA5NCAzNlwiPlxcbicgK1xuICAnICAgIDxwYXRoIGNsYXNzPVwie3ttaWxlc3RvbmVCZ0NsYXNzfX1cIiBmaWxsPVwibm9uZVwiIGZpbGwtcnVsZT1cImV2ZW5vZGRcIiBkPVwiTTkzLjQyIDBDODcuMTc2IDMuNjc1IDgzIDEwLjM2MSA4MyAxOGMwIDcuNjM5IDQuMTc2IDE0LjMyNSAxMC40MiAxOEgwYzYuMzYtMy42NzUgMTAuNjE0LTEwLjM2MSAxMC42MTQtMThDMTAuNjE0IDEwLjM2MSA2LjM2IDMuNjc1IDAgMGg5My40MnpcIi8+XFxuJyArXG4gICcgICAgPHRleHQgZmlsbD1cIiNGRkZcIiBmb250LWZhbWlseT1cIlNvdXJjZVNhbnNQcm8tUmVndWxhciwgU291cmNlIFNhbnMgUHJvXCIgZm9udC1zaXplPVwiMTRcIj5cXG4nICtcbiAgJyAgICAgICAgPHRzcGFuIHg9XCIxNlwiIHk9XCIyM1wiIGNsYXNzPVwie3ttaWxlc3RvbmVMYWJlbENsYXNzfX1cIj57e21pbGVzdG9uZUxhYmVsfX08L3RzcGFuPlxcbicgK1xuICAnICAgIDwvdGV4dD5cXG4nICtcbiAgJzwvc3ZnPlxcbicsXG4gIE1JRERMRV9TRUNUSU9OX0NPTVBMRVRFRF9TVkc6ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE2NFwiIGhlaWdodD1cIjM2XCIgdmlld0JveD1cIjAgMCAxNjQgMzZcIj5cXG4nICtcbiAgJyAgICA8cGF0aCBjbGFzcz1cInt7bWlsZXN0b25lQmdDbGFzc319XCIgZmlsbD1cIm5vbmVcIiBmaWxsLXJ1bGU9XCJldmVub2RkXCIgZD1cIk0xNjQgMGMtNi4wOSAzLjY3NS0xMC4xNjMgMTAuMzYxLTEwLjE2MyAxOCAwIDcuNjM5IDQuMDczIDE0LjMyNSAxMC4xNjMgMThIMGM2LjA5NS0zLjY3NSAxMC4xNzItMTAuMzYxIDEwLjE3Mi0xOEMxMC4xNzIgMTAuMzYxIDYuMDk1IDMuNjc1IDAgMGgxNjR6XCIvPlxcbicgK1xuICAnICAgIDx0ZXh0IGZpbGw9XCIjRkZGXCIgZm9udC1mYW1pbHk9XCJTb3VyY2VTYW5zUHJvLVJlZ3VsYXIsIFNvdXJjZSBTYW5zIFByb1wiIGZvbnQtc2l6ZT1cIjE0XCI+XFxuJyArXG4gICcgICAgICAgIDx0c3BhbiB4PVwiMTZcIiB5PVwiMjNcIiBjbGFzcz1cInt7bWlsZXN0b25lTGFiZWxDbGFzc319XCI+e3ttaWxlc3RvbmVMYWJlbH19PC90c3Bhbj5cXG4nICtcbiAgJyAgICA8L3RleHQ+XFxuJyArXG4gICc8L3N2Zz5cXG4nLFxuICBNSURETEVfU0VDVElPTl9JTlBST0dSRVNTX1NWRzogJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTY0XCIgaGVpZ2h0PVwiMzZcIiB2aWV3Qm94PVwiMCAwIDE2NCAzNlwiPlxcbicgK1xuICAnICAgIDxwYXRoIGNsYXNzPVwie3ttaWxlc3RvbmVCZ0NsYXNzfX1cIiBmaWxsPVwibm9uZVwiIGZpbGwtcnVsZT1cImV2ZW5vZGRcIiBkPVwiTTE2NCAwYy02LjA5IDMuNjc1LTEwLjE2MyAxMC4zNjEtMTAuMTYzIDE4IDAgNy42MzkgNC4wNzMgMTQuMzI1IDEwLjE2MyAxOEgwYzYuMDk1LTMuNjc1IDEwLjE3Mi0xMC4zNjEgMTAuMTcyLTE4QzEwLjE3MiAxMC4zNjEgNi4wOTUgMy42NzUgMCAwaDE2NHpcIi8+XFxuJyArXG4gICcgICAgPHRleHQgZmlsbD1cIiNGRkZcIiBmb250LWZhbWlseT1cIlNvdXJjZVNhbnNQcm8tUmVndWxhciwgU291cmNlIFNhbnMgUHJvXCIgZm9udC1zaXplPVwiMTRcIj5cXG4nICtcbiAgJyAgICAgICAgPHRzcGFuIHg9XCIxNlwiIHk9XCIyM1wiIGNsYXNzPVwie3ttaWxlc3RvbmVMYWJlbENsYXNzfX1cIj57e21pbGVzdG9uZUxhYmVsfX08L3RzcGFuPlxcbicgK1xuICAnICAgIDwvdGV4dD5cXG4nICtcbiAgJzwvc3ZnPlxcbicsXG4gIE1JRERMRV9TRUNUSU9OX1BFTkRJTkdfU1ZHOiAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxNjRcIiBoZWlnaHQ9XCIzNlwiIHZpZXdCb3g9XCIwIDAgMTY0IDM2XCI+XFxuJyArXG4gICcgICAgPHBhdGggY2xhc3M9XCJ7e21pbGVzdG9uZUJnQ2xhc3N9fVwiIGZpbGw9XCJub25lXCIgZmlsbC1ydWxlPVwiZXZlbm9kZFwiIGQ9XCJNMTY0IDBjLTYuMDkgMy42NzUtMTAuMTYzIDEwLjM2MS0xMC4xNjMgMTggMCA3LjYzOSA0LjA3MyAxNC4zMjUgMTAuMTYzIDE4SDBjNi4wOTUtMy42NzUgMTAuMTcyLTEwLjM2MSAxMC4xNzItMThDMTAuMTcyIDEwLjM2MSA2LjA5NSAzLjY3NSAwIDBoMTY0elwiLz5cXG4nICtcbiAgJyAgICA8dGV4dCBjbGFzcz1cInBlbmRpbmctdGV4dFwiIGZpbGw9XCIjRkZGXCIgZm9udC1mYW1pbHk9XCJTb3VyY2VTYW5zUHJvLVJlZ3VsYXIsIFNvdXJjZSBTYW5zIFByb1wiIGZvbnQtc2l6ZT1cIjE0XCI+XFxuJyArXG4gICcgICAgICAgIDx0c3BhbiB4PVwiMTZcIiB5PVwiMjNcIiBjbGFzcz1cInt7bWlsZXN0b25lTGFiZWxDbGFzc319XCI+e3ttaWxlc3RvbmVMYWJlbH19PC90c3Bhbj5cXG4nICtcbiAgJyAgICA8L3RleHQ+XFxuJyArXG4gICc8L3N2Zz5cXG4nXG59XG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIFRjQ2FzZVN0YXRlc1NlcnZpY2Uge1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgaHR0cDogSHR0cENsaWVudCxcbiAgICAgICAgICAgICAgcHJpdmF0ZSBsaXZlQXBwc1NlcnZpY2U6IExpdmVBcHBzU2VydmljZSxcbiAgICAgICAgICAgICAgcHJpdmF0ZSBjYXNlRGF0YVNlcnZpY2U6IFRjQ2FzZURhdGFTZXJ2aWNlLFxuICAgICAgICAgICAgICBwcml2YXRlIHNhbml0aXplcjogRG9tU2FuaXRpemVyLFxuICAgICAgICAgICAgICBwcml2YXRlIGxvY2F0aW9uOiBMb2NhdGlvbikgeyB9XG5cbiAgcHJpdmF0ZSBnZXRUcmFja2VyRGF0YSA9IChjYXNlUmVmOiBzdHJpbmcsIHNhbmRib3hJZDogbnVtYmVyLCBhcHBJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxTdGF0ZVRyYWNrZXJEYXRhPiA9PiB7XG4gICAgLy8gbWVyZ2UgdGhlIHJlc3VsdCBvZiB0aGVzZSB0aHJlZSBBUEkgY2FsbHMgaW50byBvbmUgb2JqZWN0XG4gICAgY29uc3QgY2FzZVN0YXRlJCA9IHRoaXMuY2FzZURhdGFTZXJ2aWNlLmdldENhc2VTdGF0ZShjYXNlUmVmLCBzYW5kYm94SWQpO1xuICAgIGNvbnN0IHBvc3NpYmxlU3RhdGVzJCA9IHRoaXMubGl2ZUFwcHNTZXJ2aWNlLmdldENhc2VUeXBlU3RhdGVzKHNhbmRib3hJZCwgYXBwSWQsIDEwMCk7XG4gICAgY29uc3Qgc3RhdGVBdWRpdCQgPSB0aGlzLmdldENhc2VTdGF0ZUF1ZGl0KGNhc2VSZWYsIHNhbmRib3hJZCk7XG4gICAgcmV0dXJuIGZvcmtKb2luKFtjYXNlU3RhdGUkLCBwb3NzaWJsZVN0YXRlcyQsIHN0YXRlQXVkaXQkXSkucGlwZShcbiAgICAgIG1hcChyZXN1bHRBcnIgPT4ge1xuICAgICAgICByZXR1cm4gbmV3IFN0YXRlVHJhY2tlckRhdGEoKS5kZXNlcmlhbGl6ZShcbiAgICAgICAgICB7IHBvc3NpYmxlU3RhdGVzOiByZXN1bHRBcnJbMV0sIGN1cnJlbnRTdGF0ZTogcmVzdWx0QXJyWzBdLCBjYXNlQXVkaXQ6IHJlc3VsdEFyclsyXS5hdWRpdEV2ZW50cyB9XG4gICAgICAgICAgKTtcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRUcmFja2VyID0gKHRyYWNrZXJEYXRhOiBTdGF0ZVRyYWNrZXJEYXRhKTogU3RhdGVUcmFja2VyID0+IHtcbiAgICBjb25zdCB0cmFja2VyID0gbmV3IFN0YXRlVHJhY2tlcigpO1xuICAgIHRyYWNrZXIuc3RhdGVzID0gW107XG4gICAgaWYgKHRyYWNrZXJEYXRhLmNhc2VBdWRpdC5sZW5ndGggPD0gMCkge1xuICAgICAgLy8gaWYgbm8gYXVkaXQgaXQgaGFzIGxpa2VseSBiZWVuIGRlbGV0ZWQgYW5kIHdlIGNhbm5vdCBjcmVhdGUgYSBtaWxlc3RvbmUgdHJhaWxlclxuICAgICAgdHJhY2tlci52YWxpZCA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyB3b3JrIG91dCB0aGUgc3RhdHVzIG9mIGVhY2ggc3RhdGVcbiAgICAgIC8vIHBvc3NpYmxlIHN0YXRlczogJ3BlbmRpbmcnLCAnaW5wcm9ncmVzcycsICdjb21wbGV0ZWQnXG4gICAgICB0cmFja2VyRGF0YS5wb3NzaWJsZVN0YXRlcy5zdGF0ZXMuZm9yRWFjaChzdGF0ZSA9PiB7XG4gICAgICAgIGNvbnN0IHN0YXRlTGFiZWwgPSBzdGF0ZS5sYWJlbDtcbiAgICAgICAgY29uc3Qgc3RhdGVOYW1lID0gc3RhdGUudmFsdWU7XG4gICAgICAgIGNvbnN0IHRyYWNrZXJTdGF0ZSA9IG5ldyBUcmFja2VyU3RhdGUoKTtcbiAgICAgICAgdHJhY2tlclN0YXRlLnBoYXNlID0gJyc7XG4gICAgICAgIHRyYWNrZXJTdGF0ZS5wcmV2aW91c1BoYXNlID0gJyc7XG4gICAgICAgIC8vIG5vIHNwZWNpZmljIG5hbWUgY29taW5nIGZyb20gQVBJIHNvIHVzZSBsYWJlbC5cbiAgICAgICAgdHJhY2tlclN0YXRlLm5hbWUgPSBzdGF0ZS5sYWJlbDtcbiAgICAgICAgdHJhY2tlclN0YXRlLmxhYmVsID0gc3RhdGUubGFiZWw7XG4gICAgICAgIHRyYWNrZXJTdGF0ZS5pc1Rlcm1pbmFsID0gc3RhdGUuaXNUZXJtaW5hbCA/IHN0YXRlLmlzVGVybWluYWwgOiBmYWxzZTtcbiAgICAgICAgLy8gZmluZCBsYXN0IGV2ZW50IGZvciB0aGlzIHN0YXRlXG4gICAgICAgIGNvbnN0IHJldmVyc2VkRXZlbnRzID0gW107XG4gICAgICAgIE9iamVjdC5hc3NpZ24ocmV2ZXJzZWRFdmVudHMsIHRyYWNrZXJEYXRhLmNhc2VBdWRpdCk7XG4gICAgICAgIHJldmVyc2VkRXZlbnRzLnJldmVyc2UoKTtcbiAgICAgICAgY29uc3QgaWR4ID0gcmV2ZXJzZWRFdmVudHMuZmluZEluZGV4KGF1ZGl0RXZlbnQgPT4gYXVkaXRFdmVudC5jYXNlU3RhdGUudmFsdWUgPT09IHN0YXRlLnZhbHVlKTtcbiAgICAgICAgY29uc3Qgb3JpZ0lkeCA9ICh0cmFja2VyRGF0YS5jYXNlQXVkaXQubGVuZ3RoIC0gMSkgLSBpZHg7XG4gICAgICAgIGxldCB0aGlzRXZlbnQ6IFN0YXRlQXVkaXRFdmVudDtcbiAgICAgICAgaWYgKGlkeCA9PT0gLTEpIHtcbiAgICAgICAgICAvLyBubyBhdWRpdCBldmVudHMgc28gd2UgaGF2ZW4ndCByZWFjaGVkIHRoaXMgc3RhdGUgeWV0XG4gICAgICAgICAgdHJhY2tlclN0YXRlLnN0YXR1cyA9ICdwZW5kaW5nJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzRXZlbnQgPSB0cmFja2VyRGF0YS5jYXNlQXVkaXRbb3JpZ0lkeF07XG4gICAgICAgICAgdHJhY2tlclN0YXRlLnVzZXIgPSB0aGlzRXZlbnQucHJpbmNpcGFsTmFtZSA/IHRoaXNFdmVudC5wcmluY2lwYWxOYW1lLnZhbHVlIDogJ3N5c3RlbSc7XG4gICAgICAgICAgdHJhY2tlclN0YXRlLmNoYW5nZWQgPSB0aGlzRXZlbnQuY3JlYXRpb25UaW1lID8gdGhpc0V2ZW50LmNyZWF0aW9uVGltZS52YWx1ZSA6ICcnO1xuICAgICAgICAgIHRyYWNrZXJTdGF0ZS5waGFzZSA9IHRoaXNFdmVudC5waGFzZUxhYmVsID8gdGhpc0V2ZW50LnBoYXNlTGFiZWwudmFsdWUgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgdHJhY2tlclN0YXRlLnByZXZpb3VzUGhhc2UgPSB0aGlzRXZlbnQucHJldmlvdXNQaGFzZUxhYmVsID8gdGhpc0V2ZW50LnByZXZpb3VzUGhhc2VMYWJlbC52YWx1ZSA6IHVuZGVmaW5lZDtcbiAgICAgICAgICBpZiAoc3RhdGUuaXNUZXJtaW5hbCkge1xuICAgICAgICAgICAgLy8gaWYgd2UgaGF2ZSBhdWRpdCBmb3IgdGhpcyBzdGF0ZSBhbmQgaXQgaXMgdGVybWluYWwgaXQgbXVzdCBiZSBjb21wbGV0ZWRcbiAgICAgICAgICAgIHRyYWNrZXJTdGF0ZS5zdGF0dXMgPSAnY29tcGxldGVkJztcbiAgICAgICAgICB9IGVsc2UgaWYgKCh0cmFja2VyRGF0YS5jYXNlQXVkaXQubGVuZ3RoIC0gMSkgPT09IG9yaWdJZHgpIHtcbiAgICAgICAgICAgIC8vIGlmIHRoaXMgaXMgdGhlIGxhc3QgYXVkaXQgZW50cnkgdGhlbiBpdCBpcyBpbiBwcm9ncmVzc1xuICAgICAgICAgICAgdHJhY2tlclN0YXRlLnN0YXR1cyA9ICdpbnByb2dyZXNzJztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGl0IG11c3QgYmUgY29tcGxldGVkXG4gICAgICAgICAgICB0cmFja2VyU3RhdGUuc3RhdHVzID0gJ2NvbXBsZXRlZCc7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHRyYWNrZXIuc3RhdGVzLnB1c2godHJhY2tlclN0YXRlKTtcbiAgICAgICAgdHJhY2tlci52YWxpZCA9IHRydWU7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHRyYWNrZXI7XG4gIH1cblxuICBwdWJsaWMgZ2V0VHJhY2tlciA9IChjYXNlUmVmOiBzdHJpbmcsIHNhbmRib3hJZDogbnVtYmVyLCBhcHBJZDogc3RyaW5nKTogT2JzZXJ2YWJsZTxTdGF0ZVRyYWNrZXI+ID0+IHtcbiAgICBjb25zdCB0cmFja2VyJCA9IHRoaXMuZ2V0VHJhY2tlckRhdGEoY2FzZVJlZiwgc2FuZGJveElkLCBhcHBJZCkucGlwZShcbiAgICAgIG1hcCh0cmFja2VyRGF0YSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmJ1aWxkVHJhY2tlcih0cmFja2VyRGF0YSk7XG4gICAgICB9KVxuICAgICk7XG4gICAgcmV0dXJuIHRyYWNrZXIkO1xuICB9XG5cbiAgcHVibGljIGdldENhc2VTdGF0ZUF1ZGl0V2l0aFRlcm1pbmFsKGNhc2VSZWY6IHN0cmluZywgc2FuZGJveElkOiBudW1iZXIsIGFwcElkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPFN0YXRlQXVkaXRFdmVudExpc3Q+IHtcbiAgICBjb25zdCBwb3NzaWJsZVN0YXRlcyQgPSB0aGlzLmxpdmVBcHBzU2VydmljZS5nZXRDYXNlVHlwZVN0YXRlcyhzYW5kYm94SWQsIGFwcElkLCAxMDApO1xuICAgIGNvbnN0IGNhc2VTdGF0ZUF1ZGl0JCA9IHRoaXMuZ2V0Q2FzZVN0YXRlQXVkaXQoY2FzZVJlZiwgc2FuZGJveElkKTtcbiAgICByZXR1cm4gZm9ya0pvaW4oW3Bvc3NpYmxlU3RhdGVzJCwgY2FzZVN0YXRlQXVkaXQkXSkucGlwZShcbiAgICAgIG1hcChyZXN1bHRBcnIgPT4ge1xuICAgICAgICBjb25zdCBwb3NzaWJsZVN0YXRlcyA9IHJlc3VsdEFyclswXTtcbiAgICAgICAgY29uc3QgY2FzZVN0YXRlQXVkaXQgPSByZXN1bHRBcnJbMV07XG4gICAgICAgIC8vIG1hcmsgaWYgYW55IGFyZSB0ZXJtaW5hbCBzdGF0ZXNcbiAgICAgICAgY2FzZVN0YXRlQXVkaXQuYXVkaXRFdmVudHMuZm9yRWFjaChhdWRpdEV2ZW50ID0+IHtcbiAgICAgICAgICBjb25zdCBmb3VuZFN0YXRlID0gcG9zc2libGVTdGF0ZXMuc3RhdGVzLmZpbmQoc3RhdGUgPT4gc3RhdGUudmFsdWUgPT09IGF1ZGl0RXZlbnQuY2FzZVN0YXRlLnZhbHVlKTtcbiAgICAgICAgICBhdWRpdEV2ZW50LmlzVGVybWluYWwgPSBmb3VuZFN0YXRlLmlzVGVybWluYWwgPyBmb3VuZFN0YXRlLmlzVGVybWluYWwgOiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBjYXNlU3RhdGVBdWRpdDtcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRDYXNlU3RhdGVBdWRpdChjYXNlUmVmOiBzdHJpbmcsIHNhbmRib3hJZDogbnVtYmVyKTogT2JzZXJ2YWJsZTxTdGF0ZUF1ZGl0RXZlbnRMaXN0PiB7XG5cbiAgICBjb25zdCB1cmwgPSAnL2V2ZW50L3YxL2F1ZGl0RXZlbnRzPyRzYW5kYm94PScgKyBzYW5kYm94SWRcbiAgICAgICsgJyYkZmlsdGVyPXR5cGUgZXEgXFwnY2FzZXN0YXRlXFwnJ1xuICAgICAgKyAnIGFuZCBpZCBlcSBcXCcnICsgY2FzZVJlZiArICdcXCcnO1xuXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQodXJsKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRhcCggdmFsID0+IHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ3Rjc1RpbWVzdGFtcCcsIERhdGUubm93KCkudG9TdHJpbmcoKSkpLFxuICAgICAgICBtYXAoY2FzZWF1ZGl0ID0+IG5ldyBTdGF0ZUF1ZGl0RXZlbnRMaXN0KCkuZGVzZXJpYWxpemUoY2FzZWF1ZGl0KSkpO1xuICB9XG5cbiAgcHVibGljIGdldE1pbGVzdG9uZVNlY3Rpb25Tdmcoc3RhdGVMYWJlbDogc3RyaW5nLCBsYWJlbENsYXNzOiBzdHJpbmcsIGJnQ2xhc3M6IHN0cmluZywgc3ZnRmlsZU5hbWU6IHN0cmluZyk6IFNhZmVIdG1sIHtcbiAgICAvKnJldHVybiB0aGlzLmxpdmVBcHBzU2VydmljZS5nZXRJY29uU1ZHVGV4dChUY0NvcmVDb21tb25GdW5jdGlvbnMucHJlcGFyZVVybEZvclN0YXRpY1Jlc291cmNlKHRoaXMubG9jYXRpb24sICdhc3NldHMvaWNvbnMvbWlsZXN0b25lcy8nICsgc3ZnRmlsZU5hbWUpKS5waXBlKFxuICAgICAgbWFwKHN2Z2NvbnRlbnRzID0+IHtcbiAgICAgICAgbGV0IHVwZGF0ZWRzdmcgPSBzdmdjb250ZW50cy5yZXBsYWNlKCd7e21pbGVzdG9uZUxhYmVsfX0nLCBzdGF0ZUxhYmVsKTtcbiAgICAgICAgdXBkYXRlZHN2ZyA9IHVwZGF0ZWRzdmcucmVwbGFjZSgne3ttaWxlc3RvbmVCZ0NsYXNzfX0nLCBiZ0NsYXNzKTtcbiAgICAgICAgdXBkYXRlZHN2ZyA9IHVwZGF0ZWRzdmcucmVwbGFjZSgne3ttaWxlc3RvbmVMYWJlbENsYXNzfX0nLCBsYWJlbENsYXNzKTtcbiAgICAgICAgY29uc3QgbmV3dmFsID0gdGhpcy5zYW5pdGl6ZXIuYnlwYXNzU2VjdXJpdHlUcnVzdEh0bWwodXBkYXRlZHN2Zyk7XG4gICAgICAgIHJldHVybiBuZXd2YWw7XG4gICAgICB9KVxuICAgICk7Ki9cbiAgICAvLyBjb252ZXJ0IHN2Z0ZpbGVOYW1lIHRvIHRoZSBpbmxpbmUgcHJvcGVydHkgbmFtZVxuICAgIHN2Z0ZpbGVOYW1lID0gc3ZnRmlsZU5hbWUudG9VcHBlckNhc2UoKTtcbiAgICBjb25zdCByZWdFeCA9IC8tfFxcLi9naTtcbiAgICBzdmdGaWxlTmFtZSA9IHN2Z0ZpbGVOYW1lLnJlcGxhY2UocmVnRXgsICdfJyk7XG4gICAgY29uc3Qgc3ZnY29udGVudHMgPSBNSUxFU1RPTkVfU1ZHW3N2Z0ZpbGVOYW1lXTtcbiAgICBpZiAoc3ZnY29udGVudHMpIHtcbiAgICAgIGxldCB1cGRhdGVkc3ZnID0gc3ZnY29udGVudHMucmVwbGFjZSgne3ttaWxlc3RvbmVMYWJlbH19Jywgc3RhdGVMYWJlbCk7XG4gICAgICB1cGRhdGVkc3ZnID0gdXBkYXRlZHN2Zy5yZXBsYWNlKCd7e21pbGVzdG9uZUJnQ2xhc3N9fScsIGJnQ2xhc3MpO1xuICAgICAgdXBkYXRlZHN2ZyA9IHVwZGF0ZWRzdmcucmVwbGFjZSgne3ttaWxlc3RvbmVMYWJlbENsYXNzfX0nLCBsYWJlbENsYXNzKTtcbiAgICAgIGNvbnN0IG5ld3ZhbCA9IHRoaXMuc2FuaXRpemVyLmJ5cGFzc1NlY3VyaXR5VHJ1c3RIdG1sKHVwZGF0ZWRzdmcpO1xuICAgICAgcmV0dXJuIG5ld3ZhbDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gIH1cbn1cbiJdfQ==