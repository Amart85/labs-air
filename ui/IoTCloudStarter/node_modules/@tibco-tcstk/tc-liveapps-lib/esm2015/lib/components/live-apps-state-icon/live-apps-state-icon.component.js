/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input } from '@angular/core';
import { DomSanitizer } from '@angular/platform-browser';
import { HttpClient } from '@angular/common/http';
import { map, take, takeUntil } from 'rxjs/operators';
import { LiveAppsService } from '../../services/live-apps.service';
import { Location } from '@angular/common';
import { LiveAppsComponent } from '../live-apps-component/live-apps-component.component';
import { TcCoreCommonFunctions } from '@tibco-tcstk/tc-core-lib';
import { GENERIC_CASETYPE_ICON_SVG, GENERIC_STATE_ICON_SVG } from '../../services/tc-case-card-config.service';
/**
 * renders a single icon for a state
 *
 * ![alt-text](../live-apps-state-icon.png "")
 *
 * \@example <tcla-live-apps-state-icon></tcla-live-apps-state-icon>
 */
export class LiveAppsStateIconComponent extends LiveAppsComponent {
    /**
     * @param {?} sanitizer
     * @param {?} http
     * @param {?} liveapps
     * @param {?} location
     */
    constructor(sanitizer, http, liveapps, location) {
        super();
        this.sanitizer = sanitizer;
        this.http = http;
        this.liveapps = liveapps;
        this.location = location;
        this.svgcontents = undefined;
        this.refillSVG = (/**
         * @param {?} fill
         * @return {?}
         */
        function (fill) {
            /** @type {?} */
            const updatedsvg = this.svgcontents.replace('fill="<DYNAMICFILL>"', 'fill="' + fill + '"');
            /** @type {?} */
            const newval = this.sanitizer.bypassSecurityTrustHtml(updatedsvg);
            this.iconSVG = newval;
        });
        this.refresh = (/**
         * @param {?} icon
         * @param {?} fill
         * @return {?}
         */
        (icon, fill) => {
            /** @type {?} */
            let url;
            if (icon && icon !== 'assets/icons/ic-generic-casetype.svg' && icon !== 'assets/icons/ic-generic-state.svg') {
                if (icon.slice(0, 13) === 'assets/icons/') {
                    // if icon is in assets folder we need to prepare the Url
                    url = TcCoreCommonFunctions.prepareUrlForStaticResource(this.location, icon);
                }
                else {
                    url = '/' + icon;
                }
                this.liveapps.getIconSVGText(url)
                    .pipe(take(1), takeUntil(this._destroyed$), map((/**
                 * @param {?} val
                 * @return {?}
                 */
                val => {
                    this.svgcontents = val;
                    val = val.toString().replace('fill="<DYNAMICFILL>"', 'fill="' + fill + '"');
                    /** @type {?} */
                    const newval = this.sanitizer.bypassSecurityTrustHtml(val);
                    return newval;
                })))
                    .subscribe((/**
                 * @param {?} val
                 * @return {?}
                 */
                val => {
                    this.iconSVG = val;
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                error => {
                    console.log('Unable to retrieve icon: ' + error.errorMsg);
                }));
            }
            else {
                // use generic icon
                /** @type {?} */
                let svgcontents;
                if (icon === 'assets/icons/ic-generic-casetype.svg') {
                    svgcontents = GENERIC_CASETYPE_ICON_SVG;
                }
                else {
                    svgcontents = GENERIC_STATE_ICON_SVG;
                }
                this.svgcontents = svgcontents;
                svgcontents = svgcontents.replace('fill="<DYNAMICFILL>"', 'fill="' + fill + '"');
                /** @type {?} */
                const newval = this.sanitizer.bypassSecurityTrustHtml(svgcontents);
                this.iconSVG = newval;
            }
        });
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // this.refresh(this.iconPath, this.color);
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if ((changes.iconPath && (changes.iconPath.currentValue !== changes.iconPath.previousValue)) || (changes.color && (changes.color.currentValue !== changes.color.previousValue))) {
            this.refresh(this.iconPath, this.color);
        }
    }
}
LiveAppsStateIconComponent.decorators = [
    { type: Component, args: [{
                selector: 'tcla-live-apps-state-icon',
                template: "<div class=\"la-state-icon-svg\" [innerHtml]=\"iconSVG\" fxLayoutAlign=\"start center\"></div>\n",
                styles: [":host ::ng-deep .la-state-icon-svg svg{height:16px;width:16px}"]
            }] }
];
/** @nocollapse */
LiveAppsStateIconComponent.ctorParameters = () => [
    { type: DomSanitizer },
    { type: HttpClient },
    { type: LiveAppsService },
    { type: Location }
];
LiveAppsStateIconComponent.propDecorators = {
    id: [{ type: Input }],
    iconPath: [{ type: Input }],
    color: [{ type: Input }],
    iconHostURL: [{ type: Input }],
    appId: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    LiveAppsStateIconComponent.prototype.id;
    /** @type {?} */
    LiveAppsStateIconComponent.prototype.iconPath;
    /** @type {?} */
    LiveAppsStateIconComponent.prototype.color;
    /** @type {?} */
    LiveAppsStateIconComponent.prototype.iconHostURL;
    /** @type {?} */
    LiveAppsStateIconComponent.prototype.appId;
    /** @type {?} */
    LiveAppsStateIconComponent.prototype.iconSVG;
    /** @type {?} */
    LiveAppsStateIconComponent.prototype.svgcontents;
    /** @type {?} */
    LiveAppsStateIconComponent.prototype.refillSVG;
    /** @type {?} */
    LiveAppsStateIconComponent.prototype.refresh;
    /**
     * @type {?}
     * @private
     */
    LiveAppsStateIconComponent.prototype.sanitizer;
    /**
     * @type {?}
     * @private
     */
    LiveAppsStateIconComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    LiveAppsStateIconComponent.prototype.liveapps;
    /**
     * @type {?}
     * @private
     */
    LiveAppsStateIconComponent.prototype.location;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLXN0YXRlLWljb24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHRpYmNvLXRjc3RrL3RjLWxpdmVhcHBzLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2xpdmUtYXBwcy1zdGF0ZS1pY29uL2xpdmUtYXBwcy1zdGF0ZS1pY29uLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQStELE1BQU0sZUFBZSxDQUFDO0FBRTdHLE9BQU8sRUFBQyxZQUFZLEVBQVcsTUFBTSwyQkFBMkIsQ0FBQztBQUNqRSxPQUFPLEVBQUMsVUFBVSxFQUEwQixNQUFNLHNCQUFzQixDQUFDO0FBQ3pFLE9BQU8sRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ3BELE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxrQ0FBa0MsQ0FBQztBQUNqRSxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDekMsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sc0RBQXNELENBQUM7QUFDdkYsT0FBTyxFQUFDLHFCQUFxQixFQUFDLE1BQU0sMEJBQTBCLENBQUM7QUFDL0QsT0FBTyxFQUFDLHlCQUF5QixFQUFFLHNCQUFzQixFQUFDLE1BQU0sNENBQTRDLENBQUM7Ozs7Ozs7O0FBZTdHLE1BQU0sT0FBTywwQkFBMkIsU0FBUSxpQkFBaUI7Ozs7Ozs7SUFVL0QsWUFBb0IsU0FBdUIsRUFBVSxJQUFnQixFQUFVLFFBQXlCLEVBQVUsUUFBa0I7UUFDbEksS0FBSyxFQUFFLENBQUM7UUFEVSxjQUFTLEdBQVQsU0FBUyxDQUFjO1FBQVUsU0FBSSxHQUFKLElBQUksQ0FBWTtRQUFVLGFBQVEsR0FBUixRQUFRLENBQWlCO1FBQVUsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUY3SCxnQkFBVyxHQUFXLFNBQVMsQ0FBQztRQU1oQyxjQUFTOzs7O1FBQUcsVUFBUyxJQUFJOztrQkFDeEIsVUFBVSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsT0FBTyxDQUFDLHNCQUFzQixFQUFFLFFBQVEsR0FBRyxJQUFJLEdBQUcsR0FBRyxDQUFDOztrQkFDcEYsTUFBTSxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsdUJBQXVCLENBQUMsVUFBVSxDQUFDO1lBQ2pFLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO1FBQ3hCLENBQUMsRUFBQztRQUVLLFlBQU87Ozs7O1FBQUcsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUU7O2dCQUMxQixHQUFXO1lBQ2YsSUFBSSxJQUFJLElBQUksSUFBSSxLQUFLLHNDQUFzQyxJQUFJLElBQUksS0FBSyxtQ0FBbUMsRUFBRTtnQkFDM0csSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsS0FBSyxlQUFlLEVBQUU7b0JBQ3pDLHlEQUF5RDtvQkFDekQsR0FBRyxHQUFHLHFCQUFxQixDQUFDLDJCQUEyQixDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7aUJBQzlFO3FCQUFNO29CQUNMLEdBQUcsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDO2lCQUNsQjtnQkFDRCxJQUFJLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUM7cUJBQzlCLElBQUksQ0FDSCxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQ1AsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsRUFDM0IsR0FBRzs7OztnQkFBQyxHQUFHLENBQUMsRUFBRTtvQkFDTixJQUFJLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQztvQkFDdkIsR0FBRyxHQUFHLEdBQUcsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxPQUFPLENBQUMsc0JBQXNCLEVBQUUsUUFBUSxHQUFHLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBQzs7MEJBQ3RFLE1BQU0sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLHVCQUF1QixDQUFDLEdBQUcsQ0FBQztvQkFDMUQsT0FBTyxNQUFNLENBQUM7Z0JBQ2hCLENBQUMsRUFDRixDQUNGO3FCQUNBLFNBQVM7Ozs7Z0JBQUMsR0FBRyxDQUFDLEVBQUU7b0JBQ2IsSUFBSSxDQUFDLE9BQU8sR0FBRyxHQUFHLENBQUM7Z0JBQ3JCLENBQUM7Ozs7Z0JBQ0MsS0FBSyxDQUFDLEVBQUU7b0JBQ1IsT0FBTyxDQUFDLEdBQUcsQ0FBQywyQkFBMkIsR0FBRyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBQzVELENBQUMsRUFDRixDQUFDO2FBQ0w7aUJBQU07OztvQkFFRCxXQUFtQjtnQkFDdkIsSUFBSSxJQUFJLEtBQUssc0NBQXNDLEVBQUU7b0JBQ25ELFdBQVcsR0FBRyx5QkFBeUIsQ0FBQztpQkFDekM7cUJBQU07b0JBQ0wsV0FBVyxHQUFHLHNCQUFzQixDQUFDO2lCQUN0QztnQkFDRCxJQUFJLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQztnQkFDL0IsV0FBVyxHQUFHLFdBQVcsQ0FBQyxPQUFPLENBQUMsc0JBQXNCLEVBQUUsUUFBUSxHQUFHLElBQUksR0FBRyxHQUFHLENBQUMsQ0FBQzs7c0JBQzNFLE1BQU0sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLHVCQUF1QixDQUFDLFdBQVcsQ0FBQztnQkFDbEUsSUFBSSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7YUFDdkI7UUFDSCxDQUFDLEVBQUE7SUFqREQsQ0FBQzs7OztJQW9ERCxRQUFRO1FBQ04sMkNBQTJDO0lBQzdDLENBQUM7Ozs7O0lBRUQsV0FBVyxDQUFDLE9BQXNCO1FBQ2hDLElBQUksQ0FBQyxPQUFPLENBQUMsUUFBUSxJQUFJLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxZQUFZLEtBQUssT0FBTyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLEtBQUssSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxLQUFLLE9BQU8sQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUMsRUFBRTtZQUMvSyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ3pDO0lBQ0gsQ0FBQzs7O1lBN0VGLFNBQVMsU0FBQztnQkFDVCxRQUFRLEVBQUUsMkJBQTJCO2dCQUNyQyw0R0FBb0Q7O2FBRXJEOzs7O1lBckJPLFlBQVk7WUFDWixVQUFVO1lBRVYsZUFBZTtZQUNmLFFBQVE7OztpQkFtQmIsS0FBSzt1QkFDTCxLQUFLO29CQUNMLEtBQUs7MEJBQ0wsS0FBSztvQkFDTCxLQUFLOzs7O0lBSk4sd0NBQW9COztJQUNwQiw4Q0FBMEI7O0lBQzFCLDJDQUF1Qjs7SUFDdkIsaURBQTZCOztJQUM3QiwyQ0FBdUI7O0lBRXZCLDZDQUF5Qjs7SUFDekIsaURBQXVDOztJQU12QywrQ0FJRTs7SUFFRiw2Q0F5Q0M7Ozs7O0lBbkRXLCtDQUErQjs7Ozs7SUFBRSwwQ0FBd0I7Ozs7O0lBQUUsOENBQWlDOzs7OztJQUFFLDhDQUEwQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBJbnB1dCwgT25DaGFuZ2VzLCBPbkRlc3Ryb3ksIE9uSW5pdCwgU2VjdXJpdHlDb250ZXh0LCBTaW1wbGVDaGFuZ2VzfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7U3ViamVjdH0gZnJvbSAncnhqcyc7XG5pbXBvcnQge0RvbVNhbml0aXplciwgU2FmZUh0bWx9IGZyb20gJ0Bhbmd1bGFyL3BsYXRmb3JtLWJyb3dzZXInO1xuaW1wb3J0IHtIdHRwQ2xpZW50LCBIdHRwSGVhZGVycywgSHR0cFBhcmFtc30gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHttYXAsIHRha2UsIHRha2VVbnRpbH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHtMaXZlQXBwc1NlcnZpY2V9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2xpdmUtYXBwcy5zZXJ2aWNlJztcbmltcG9ydCB7TG9jYXRpb259IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge0xpdmVBcHBzQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtY29tcG9uZW50L2xpdmUtYXBwcy1jb21wb25lbnQuY29tcG9uZW50JztcbmltcG9ydCB7VGNDb3JlQ29tbW9uRnVuY3Rpb25zfSBmcm9tICdAdGliY28tdGNzdGsvdGMtY29yZS1saWInO1xuaW1wb3J0IHtHRU5FUklDX0NBU0VUWVBFX0lDT05fU1ZHLCBHRU5FUklDX1NUQVRFX0lDT05fU1ZHfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy90Yy1jYXNlLWNhcmQtY29uZmlnLnNlcnZpY2UnO1xuXG4vKipcbiAqIHJlbmRlcnMgYSBzaW5nbGUgaWNvbiBmb3IgYSBzdGF0ZVxuICpcbiAqICFbYWx0LXRleHRdKC4uL2xpdmUtYXBwcy1zdGF0ZS1pY29uLnBuZyBcIlwiKVxuICpcbiAqQGV4YW1wbGUgPHRjbGEtbGl2ZS1hcHBzLXN0YXRlLWljb24+PC90Y2xhLWxpdmUtYXBwcy1zdGF0ZS1pY29uPlxuICovXG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3RjbGEtbGl2ZS1hcHBzLXN0YXRlLWljb24nLFxuICB0ZW1wbGF0ZVVybDogJy4vbGl2ZS1hcHBzLXN0YXRlLWljb24uY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9saXZlLWFwcHMtc3RhdGUtaWNvbi5jb21wb25lbnQuY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgTGl2ZUFwcHNTdGF0ZUljb25Db21wb25lbnQgZXh0ZW5kcyBMaXZlQXBwc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcbiAgQElucHV0KCkgaWQ6IHN0cmluZztcbiAgQElucHV0KCkgaWNvblBhdGg6IHN0cmluZztcbiAgQElucHV0KCkgY29sb3I6IHN0cmluZztcbiAgQElucHV0KCkgaWNvbkhvc3RVUkw6IHN0cmluZztcbiAgQElucHV0KCkgYXBwSWQ6IHN0cmluZztcblxuICBwdWJsaWMgaWNvblNWRzogU2FmZUh0bWw7XG4gIHB1YmxpYyBzdmdjb250ZW50czogc3RyaW5nID0gdW5kZWZpbmVkO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgc2FuaXRpemVyOiBEb21TYW5pdGl6ZXIsIHByaXZhdGUgaHR0cDogSHR0cENsaWVudCwgcHJpdmF0ZSBsaXZlYXBwczogTGl2ZUFwcHNTZXJ2aWNlLCBwcml2YXRlIGxvY2F0aW9uOiBMb2NhdGlvbikge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBwdWJsaWMgcmVmaWxsU1ZHID0gZnVuY3Rpb24oZmlsbCkge1xuICAgIGNvbnN0IHVwZGF0ZWRzdmcgPSB0aGlzLnN2Z2NvbnRlbnRzLnJlcGxhY2UoJ2ZpbGw9XCI8RFlOQU1JQ0ZJTEw+XCInLCAnZmlsbD1cIicgKyBmaWxsICsgJ1wiJyk7XG4gICAgY29uc3QgbmV3dmFsID0gdGhpcy5zYW5pdGl6ZXIuYnlwYXNzU2VjdXJpdHlUcnVzdEh0bWwodXBkYXRlZHN2Zyk7XG4gICAgdGhpcy5pY29uU1ZHID0gbmV3dmFsO1xuICB9O1xuXG4gIHB1YmxpYyByZWZyZXNoID0gKGljb24sIGZpbGwpID0+IHtcbiAgICBsZXQgdXJsOiBzdHJpbmc7XG4gICAgaWYgKGljb24gJiYgaWNvbiAhPT0gJ2Fzc2V0cy9pY29ucy9pYy1nZW5lcmljLWNhc2V0eXBlLnN2ZycgJiYgaWNvbiAhPT0gJ2Fzc2V0cy9pY29ucy9pYy1nZW5lcmljLXN0YXRlLnN2ZycpIHtcbiAgICAgIGlmIChpY29uLnNsaWNlKDAsIDEzKSA9PT0gJ2Fzc2V0cy9pY29ucy8nKSB7XG4gICAgICAgIC8vIGlmIGljb24gaXMgaW4gYXNzZXRzIGZvbGRlciB3ZSBuZWVkIHRvIHByZXBhcmUgdGhlIFVybFxuICAgICAgICB1cmwgPSBUY0NvcmVDb21tb25GdW5jdGlvbnMucHJlcGFyZVVybEZvclN0YXRpY1Jlc291cmNlKHRoaXMubG9jYXRpb24sIGljb24pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXJsID0gJy8nICsgaWNvbjtcbiAgICAgIH1cbiAgICAgIHRoaXMubGl2ZWFwcHMuZ2V0SWNvblNWR1RleHQodXJsKVxuICAgICAgICAucGlwZShcbiAgICAgICAgICB0YWtlKDEpLFxuICAgICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQkKSxcbiAgICAgICAgICBtYXAodmFsID0+IHtcbiAgICAgICAgICAgICAgdGhpcy5zdmdjb250ZW50cyA9IHZhbDtcbiAgICAgICAgICAgICAgdmFsID0gdmFsLnRvU3RyaW5nKCkucmVwbGFjZSgnZmlsbD1cIjxEWU5BTUlDRklMTD5cIicsICdmaWxsPVwiJyArIGZpbGwgKyAnXCInKTtcbiAgICAgICAgICAgICAgY29uc3QgbmV3dmFsID0gdGhpcy5zYW5pdGl6ZXIuYnlwYXNzU2VjdXJpdHlUcnVzdEh0bWwodmFsKTtcbiAgICAgICAgICAgICAgcmV0dXJuIG5ld3ZhbDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgICAgLnN1YnNjcmliZSh2YWwgPT4ge1xuICAgICAgICAgICAgdGhpcy5pY29uU1ZHID0gdmFsO1xuICAgICAgICAgIH1cbiAgICAgICAgICAsIGVycm9yID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVbmFibGUgdG8gcmV0cmlldmUgaWNvbjogJyArIGVycm9yLmVycm9yTXNnKTtcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIHVzZSBnZW5lcmljIGljb25cbiAgICAgIGxldCBzdmdjb250ZW50czogc3RyaW5nO1xuICAgICAgaWYgKGljb24gPT09ICdhc3NldHMvaWNvbnMvaWMtZ2VuZXJpYy1jYXNldHlwZS5zdmcnKSB7XG4gICAgICAgIHN2Z2NvbnRlbnRzID0gR0VORVJJQ19DQVNFVFlQRV9JQ09OX1NWRztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHN2Z2NvbnRlbnRzID0gR0VORVJJQ19TVEFURV9JQ09OX1NWRztcbiAgICAgIH1cbiAgICAgIHRoaXMuc3ZnY29udGVudHMgPSBzdmdjb250ZW50cztcbiAgICAgIHN2Z2NvbnRlbnRzID0gc3ZnY29udGVudHMucmVwbGFjZSgnZmlsbD1cIjxEWU5BTUlDRklMTD5cIicsICdmaWxsPVwiJyArIGZpbGwgKyAnXCInKTtcbiAgICAgIGNvbnN0IG5ld3ZhbCA9IHRoaXMuc2FuaXRpemVyLmJ5cGFzc1NlY3VyaXR5VHJ1c3RIdG1sKHN2Z2NvbnRlbnRzKTtcbiAgICAgIHRoaXMuaWNvblNWRyA9IG5ld3ZhbDtcbiAgICB9XG4gIH1cblxuXG4gIG5nT25Jbml0KCkge1xuICAgIC8vIHRoaXMucmVmcmVzaCh0aGlzLmljb25QYXRoLCB0aGlzLmNvbG9yKTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcbiAgICBpZiAoKGNoYW5nZXMuaWNvblBhdGggJiYgKGNoYW5nZXMuaWNvblBhdGguY3VycmVudFZhbHVlICE9PSBjaGFuZ2VzLmljb25QYXRoLnByZXZpb3VzVmFsdWUpKSB8fCAoY2hhbmdlcy5jb2xvciAmJiAoY2hhbmdlcy5jb2xvci5jdXJyZW50VmFsdWUgIT09IGNoYW5nZXMuY29sb3IucHJldmlvdXNWYWx1ZSkpKSB7XG4gICAgICB0aGlzLnJlZnJlc2godGhpcy5pY29uUGF0aCwgdGhpcy5jb2xvcik7XG4gICAgfVxuICB9XG5cbn1cbiJdfQ==