/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
/*
*     Case Type icons are stored in an orgFolder specified in liveAppsConfig.json (pushed to shared state)
*     Icon Name will be appId.filename.svg
*     Icon svg should contain <DYNAMICFILL> this will be set according to the color selected in this component
*
*     eg: 1742.ic-created.svg for Partner Portal Live Apps App (appId: 1742) 'Created' state
*
*     <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14">
*        <path fill="<DYNAMICFILL>" class="svg-content" fill-rule="evenodd" d="M7 14A7 7 0 1 1 7 0a7 7 0 0 1 0 14zm3.474-6.472a.527.527 0 0 0 0-1.053H7.526V3.527a.525.525 0 1 0-1.052 0v2.948H3.526a.527.527 0 0 0 0 1.053h2.948v2.948a.525.525 0 0 0 .898.373.525.525 0 0 0 .154-.373V7.528h2.948z"/>
*      </svg>
*
*
 */
import { Component, EventEmitter, Inject, Input, Output, QueryList, ViewChildren } from '@angular/core';
import { LiveAppsService } from '../../services/live-apps.service';
import { CaseTypeState, IconMap } from '../../models/liveappsdata';
import { map, take, takeUntil } from 'rxjs/operators';
import { HttpClient } from '@angular/common/http';
import { DomSanitizer } from '@angular/platform-browser';
import { LiveAppsCaseSummaryComponent } from '../live-apps-case-summary/live-apps-case-summary.component';
import { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material';
import { Location } from '@angular/common';
import { LiveAppsComponent } from '../live-apps-component/live-apps-component.component';
import { DEFAULT_COLORS, DEFAULT_STATE_COLOR, DEFAULT_TYPE_COLOR, TcCaseCardConfigService } from '../../services/tc-case-card-config.service';
import { TcDocumentService } from '../../services/tc-document.service';
/**
 * Manages summary card configuration
 *
 * \@example <tcla-live-apps-application-configuration></tcla-live-apps-application-configuration>
 */
export class LiveAppsApplicationConfigurationComponent extends LiveAppsComponent {
    /**
     * @param {?} http
     * @param {?} sanitizer
     * @param {?} liveapps
     * @param {?} caseCardConfigService
     * @param {?} documentsService
     * @param {?} dialog
     * @param {?} location
     */
    constructor(http, sanitizer, liveapps, caseCardConfigService, documentsService, dialog, location) {
        super();
        this.http = http;
        this.sanitizer = sanitizer;
        this.liveapps = liveapps;
        this.caseCardConfigService = caseCardConfigService;
        this.documentsService = documentsService;
        this.dialog = dialog;
        this.location = location;
        /**
         * ~event configChanged : Configuration values changed
         * ~payload CaseCardConfig : CaseCardConfig object when configuration is changed (so called can do a save with data)
         */
        this.configChanged = new EventEmitter();
        // prepareExternalUrl will add the base href
        this.DEFAULT_CASE_TYPE_ICON = 'assets/icons/ic-generic-casetype.svg';
        this.DEFAULT_CASE_TYPE_COLOR = DEFAULT_TYPE_COLOR;
        this.DEFAULT_CASE_STATE_ICON = 'assets/icons/ic-generic-state.svg';
        this.DEFAULT_CASE_STATE_COLOR = DEFAULT_STATE_COLOR;
        this.DEFAULT_COLOR_PALETTE = DEFAULT_COLORS;
        this.getConfigForState = (/**
         * @param {?} state
         * @return {?}
         */
        (state) => {
            /** @type {?} */
            let reqIconMap;
            if (this.caseCardConfig.cardConfig && this.caseCardConfig.cardConfig.stateMap) {
                this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                (stateMap) => {
                    if (stateMap.state === state.value) {
                        reqIconMap = stateMap;
                    }
                }));
            }
            return reqIconMap ? reqIconMap : new IconMap(false, state.value, this.DEFAULT_CASE_STATE_COLOR, this.DEFAULT_CASE_STATE_ICON);
        });
        this.getConfigForCaseType = (/**
         * @param {?} caseTypeId
         * @return {?}
         */
        (caseTypeId) => {
            /** @type {?} */
            let reqIconMap;
            if (this.caseCardConfig.cardConfig && this.caseCardConfig.cardConfig.stateMap) {
                this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                (stateMap) => {
                    if (stateMap.isCaseType) {
                        reqIconMap = stateMap;
                    }
                }));
            }
            return reqIconMap ? reqIconMap : new IconMap(true, caseTypeId, this.DEFAULT_CASE_TYPE_COLOR, this.DEFAULT_CASE_TYPE_ICON);
        });
        this.updateIconMap = (/**
         * @param {?} stateConfig
         * @return {?}
         */
        (stateConfig) => {
            /** @type {?} */
            let foundMap;
            /** @type {?} */
            let updatedMap;
            if (this.caseCardConfig.cardConfig && this.caseCardConfig.cardConfig.stateMap) {
                this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    if (stateMap.state === stateConfig.state) {
                        foundMap = stateConfig;
                        stateMap.state = stateConfig.state;
                        stateMap.icon = stateConfig.icon;
                        stateMap.fill = stateConfig.fill;
                    }
                }));
                if (foundMap) {
                    foundMap = stateConfig;
                }
                else {
                    this.caseCardConfig.cardConfig.stateMap.push(stateConfig);
                }
            }
            else {
                this.caseCardConfig.cardConfig.stateMap = [];
                this.caseCardConfig.cardConfig.stateMap.push(stateConfig);
            }
            this.configChanged.emit(this.caseCardConfig);
        });
        this.handleCaseTypeColorToggleChange = (/**
         * @param {?} changes
         * @return {?}
         */
        (changes) => {
            this.caseCardConfig.cardConfig.useCaseTypeColor = changes.checked ? changes.checked : false;
            if (changes.checked) {
                this.caseSummaryComponent.forEach((/**
                 * @param {?} comp
                 * @return {?}
                 */
                (comp) => {
                    comp.restylePreview(this.selectedStateConfig.icon, this.caseTypeColor);
                }));
            }
            this.configChanged.emit(this.caseCardConfig);
        });
        this.setFill = (/**
         * @param {?} fill
         * @param {?} stateConfig
         * @return {?}
         */
        (fill, stateConfig) => {
            this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                comp.restylePreview(stateConfig.icon, fill);
            }));
            this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return comp.id === stateConfig.state;
            })).refillSVG(fill);
            this.configChanged.emit(this.caseCardConfig);
        });
        this.setCaseTypeFill = (/**
         * @param {?} fill
         * @param {?} stateConfig
         * @return {?}
         */
        (fill, stateConfig) => {
            this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                comp.restylePreviewCaseType(stateConfig.icon, fill);
            }));
            this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return (comp.id === stateConfig.state && stateConfig.isCaseType);
            })).refillSVG(fill);
            this.configChanged.emit(this.caseCardConfig);
        });
        this.selectState = (/**
         * @param {?} state
         * @return {?}
         */
        (state) => {
            this.selectedStateConfig = this.getConfigForState(state);
            if (!this.caseCardConfig.cardConfig.useCaseTypeColor) {
                this.caseSummaryComponent.forEach((/**
                 * @param {?} comp
                 * @return {?}
                 */
                (comp) => {
                    comp.restylePreview(this.selectedStateConfig.icon, this.selectedStateConfig.fill);
                }));
            }
        });
        this.setNewStateIcon = (/**
         * @param {?} url
         * @return {?}
         */
        (url) => {
            this.selectedStateConfig.icon = url;
            this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                return (comp.id === this.selectedStateConfig.state);
            })).refresh(this.selectedStateConfig.icon, this.selectedStateConfig.fill);
            this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                comp.restylePreview(this.selectedStateConfig.icon, this.selectedStateConfig.fill);
            }));
            this.updateIconMap(this.selectedStateConfig);
        });
        this.setNewCaseTypeIcon = (/**
         * @param {?} url
         * @return {?}
         */
        (url) => {
            this.caseTypeIcon = url;
            this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                return (comp.id === this.appTypeLabel);
            })).refresh(this.caseTypeIcon, this.caseTypeColor);
            this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            (comp) => {
                comp.restylePreviewCaseType(this.caseTypeIcon, this.caseTypeColor);
            }));
            this.updateIconMap(new IconMap(true, this.appTypeLabel, this.caseTypeColor, this.caseTypeIcon));
        });
        this.refresh = (/**
         * @return {?}
         */
        () => {
            // need states & cardConfig
            this.selectedCaseTypeConfig = null;
            this.caseCardConfigService.getCaseCardConfig(this.sandboxId, this.appId, this.uiAppId, this.appTypeLabel, this.DEFAULT_CASE_TYPE_COLOR, this.DEFAULT_CASE_TYPE_ICON, this.DEFAULT_CASE_STATE_COLOR, this.DEFAULT_CASE_STATE_ICON).pipe(take(1), takeUntil(this._destroyed$), map((/**
             * @param {?} caseCardConfig
             * @return {?}
             */
            caseCardConfig => {
                this.caseCardConfig = caseCardConfig;
                // set default selected to first state for this case type (0 is case type)
                this.selectedStateConfig = this.caseCardConfig.cardConfig.stateMap[1];
                /** @type {?} */
                const caseTypeRec = this.caseCardConfig.cardConfig.stateMap.find((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    return stateMap.isCaseType;
                }));
                this.caseTypeIcon = caseTypeRec.icon;
                this.caseTypeColor = caseTypeRec.fill;
                this.selectedCaseTypeConfig = this.getConfigForCaseType(this.appTypeLabel);
            }))).subscribe(null, (/**
             * @param {?} error
             * @return {?}
             */
            error => { this.errorMessage = 'Error retrieving case card config: ' + error.error.errorMsg; }));
        });
    }
    /*public saveConfig = () => {
        this.caseCardConfigService.updateCaseCardConfig(this.sandboxId, this.appId, this.uiAppId, this.caseCardConfig)
          .pipe(
            take(1),
            takeUntil(this._destroyed$),
            map(caseCardConfig => {
              this.caseCardConfig = caseCardConfig;
            })
          ).subscribe(null, error => { console.log('Unable to update case card config: ' + error.errorMsg); }
        );
      }*/
    /**
     * @param {?} state
     * @param {?} isCaseType
     * @return {?}
     */
    openDialog(state, isCaseType) {
        if (!isCaseType) {
            this.selectState(state);
        }
        else {
            state = new CaseTypeState().deserialize({ value: this.appTypeLabel });
        }
        /** @type {?} */
        const dialogRef = this.dialog.open(LiveAppsStateIconUploadDialogComponent, {
            width: '500px',
            data: { state: state, isCaseType: isCaseType }
        });
        dialogRef.componentInstance.fileevent.subscribe((/**
         * @param {?} $e
         * @return {?}
         */
        ($e) => {
            this.uploadFile($e.file, $e.state, $e.isCaseType);
        }));
        dialogRef.afterClosed().subscribe((/**
         * @param {?} result
         * @return {?}
         */
        result => {
        }));
    }
    /**
     * @param {?} file
     * @param {?} state
     * @param {?} isStateIcon
     * @return {?}
     */
    uploadFile(file, state, isStateIcon) {
        if (file) {
            /** @type {?} */
            const url = 'webresource/v1/orgFolders/' + this.folderId + '/' + this.appId + '.' + file.name;
            /** @type {?} */
            const dlUrl = 'webresource/orgFolders/' + this.folderId + '/' + this.appId + '.' + file.name;
            this.liveapps.clearFromIconSVGTextCache(url);
            this.documentsService.uploadDocument('orgFolders', this.folderId, this.sandboxId, file, (this.appId + '.' + file.name), '')
                .pipe(map((/**
             * @param {?} val
             * @return {?}
             */
            val => {
                if (!isStateIcon) {
                    this.setNewStateIcon(dlUrl);
                }
                else {
                    this.setNewCaseTypeIcon(dlUrl);
                }
            })))
                .subscribe((/**
             * @param {?} result
             * @return {?}
             */
            result => null), (/**
             * @param {?} error
             * @return {?}
             */
            error => { console.log('error'); this.errorMessage = 'Error uploading state icon: ' + error.errorMsg; }));
        }
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.appId && (changes.appId.currentValue !== changes.appId.previousValue)) {
            this.refresh();
        }
    }
}
LiveAppsApplicationConfigurationComponent.decorators = [
    { type: Component, args: [{
                selector: 'tcla-live-apps-application-configuration',
                template: "<div *ngIf=\"appId\" class=\"tcs-case-card-customization\" fxLayout=\"column\">\n    <div fxLayout=\"row\" fxLayoutAlign=\"space-around stretch\" fxFlex>\n      <div fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n        <div fxLayout=\"column\" fxLayoutAlign=\"start center\">\n          <div class=\"tcs-case-card-customization-section-text\">Preview</div>\n        </div>\n        <div class=\"tcs-case-card-customization-preview\" fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n          <div *ngIf=\"selectedStateConfig && caseTypeColor && caseTypeIcon\" style=\"border-radius: 3px; margin: 5px;\" fxLayout=\"column\" fxLayoutAlign=\"space-around center\">\n            <tcla-live-apps-case-summary style=\"margin: 5px;\" [displayType]=\"'card'\" [typeBar]=\"true\" [configMode]=\"true\" [configModeColor]=\"caseCardConfig.cardConfig.useCaseTypeColor ? caseTypeColor : selectedStateConfig.fill\" [configModeIcon]=\"selectedStateConfig.icon\" [configModeCaseTypeColor]=\"caseTypeColor\" [configModeCaseTypeIcon]=\"caseTypeIcon\" [configModeAppTypeLabel]=\"appTypeLabel\"></tcla-live-apps-case-summary>\n            <tcla-live-apps-case-summary style=\"margin: 5px;\" [displayType]=\"'miniCard'\" [typeBar]=\"true\" [configMode]=\"true\" [configModeColor]=\"caseCardConfig.cardConfig.useCaseTypeColor ? caseTypeColor : selectedStateConfig.fill\" [configModeIcon]=\"selectedStateConfig.icon\" [configModeCaseTypeColor]=\"caseTypeColor\" [configModeCaseTypeIcon]=\"caseTypeIcon\" [configModeAppTypeLabel]=\"appTypeLabel\"></tcla-live-apps-case-summary>\n          </div>\n        </div>\n      </div>\n      <div class=\"tcs-case-card-customization-divider\"></div>\n      <div fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n        <div fxLayout=\"column\" fxLayoutAlign=\"start center\">\n          <div class=\"tcs-case-card-customization-section-text\">Configure Icons</div>\n        </div>\n        <div fxFlex>\n          <div fxFlex class=\"tcs-case-states-list\" *ngIf=\"caseCardConfig && caseCardConfig.cardConfig && caseCardConfig.states\" fxLayout=\"column\" fxLayoutAlign=\"start center\">\n            <div class=\"tcs-case-states-list-inner\">\n              <div class=\"case-type-color-toggle\">\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                  <mat-slide-toggle\n                  class=\"use-case-type-color\"\n                  [labelPosition]=\"'before'\"\n                  [checked]=\"caseCardConfig.cardConfig.useCaseTypeColor\"\n                  (change)=\"handleCaseTypeColorToggleChange($event)\">\n                  Use Case Type Color for color bar\n                  </mat-slide-toggle>\n                </div>\n              </div>\n              <div class=\"tcs-case-states-list-row\">\n                  <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <div fxLayoutAlign=\"start center\" style=\"min-width: 170px;\">Case Type Icon</div>\n                    <tcla-live-apps-state-icon style=\"margin-left: 10px; margin-right: 10px; min-width: 14px;\" #iconcomp [id]=\"appTypeLabel\" [iconPath]=\"selectedCaseTypeConfig.icon\" [color]=\"selectedCaseTypeConfig.fill\"\n                                               [appId]=\"appId\" [(colorPicker)]=\"selectedCaseTypeConfig.fill\" (colorPickerChange)=\"setCaseTypeFill($event, selectedCaseTypeConfig)\" [cpPresetColors]=\"DEFAULT_COLOR_PALETTE\" [cpPositionOffset]=\"'-40%'\"\n                                              matTooltip=\"Click to change color\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </tcla-live-apps-state-icon>\n                    <mat-icon (click)=\"openDialog(null, true)\" class=\"tcs-icon tcs-icon-active tcs-config-button tcs-document-upload-button\" svgIcon=\"tcs-document-upload\"\n                              matTooltip=\"Click to upload new icon\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </mat-icon>\n                    <mat-icon class=\"tcs-icon tcs-icon-active tcs-config-button-placeholder\"></mat-icon>\n                  </div>\n              </div>\n              <div class=\"tcs-case-states-icon-divider\"></div>\n              <!-- case state icons -->\n              <div *ngFor=\"let state of caseCardConfig.states\" class=\"tcs-case-states-list-row\" (click)=\"selectState(state)\">\n                <div *ngIf=\"getConfigForState(state); let stateConfig;\">\n                  <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <div fxLayoutAlign=\"start center\" style=\"min-width: 170px;\">{{state.label | ellipsis: 25}}</div>\n                    <tcla-live-apps-state-icon style=\"margin-left: 10px; margin-right: 10px; min-width: 14px;\" #iconcomp [id]=\"state.value\" [iconPath]=\"stateConfig.icon\" [color]=\"stateConfig.fill\"\n                                               [appId]=\"appId\" [(colorPicker)]=\"stateConfig.fill\" (colorPickerChange)=\"setFill($event, stateConfig)\" [cpPresetColors]=\"DEFAULT_COLOR_PALETTE\" [cpPositionOffset]=\"'-40%'\"\n                                              matTooltip=\"Click to change color\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </tcla-live-apps-state-icon>\n                    <mat-icon (click)=\"openDialog(state, false)\" class=\"tcs-icon tcs-icon-active tcs-config-button tcs-document-upload-button\" svgIcon=\"tcs-document-upload\"\n                              matTooltip=\"Click to upload new icon\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </mat-icon>\n                    <mat-icon class=\"tcs-icon tcs-icon-active tcs-config-button-placeholder\"></mat-icon>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  <!--div class=\"tcs-case-card-customization-footer\" fxLayout=\"column\" fxLayoutAlign=\"end stretch\">\n    <div class=\"tcs-case-card-customization-action-buttons\" fxLayout=\"row\" fxLayoutAlign=\"center center\">\n      <button class=\"tcs-save-app-config-button\" mat-button (click)=\"saveConfig()\" type=\"submit\">Save Configuration</button>\n    </div>\n  </div-->\n</div>\n",
                styles: [".tcs-case-card-customization{min-width:775px;min-height:370px;background-color:#fff}.tcs-case-card-customization *{font-family:Source Sans Pro;font-size:12px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;text-align:center;color:#000}.case-type-color-toggle{margin-bottom:10px;margin-top:10px}.tcs-case-card-customization-header{height:40px;border-radius:3px 3px 0 0;box-shadow:0 1px 2px 0 #dedede;padding-left:20px;padding-right:20px}.tcs-case-card-customization .tcs-case-card-customization-header-text{font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:1.5;letter-spacing:.3px;text-align:left;color:#000;margin-left:10px}.tcs-case-card-customization-action-buttons{margin-top:10px;margin-bottom:10px}.tcs-case-card-customization-divider{padding:0;margin:4px 5px 0;border-left:1.1px solid #f4f4f4}.tcs-case-card-customization .tcs-case-card-customization-section-text{font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;color:#000}.tcs-case-states-list{margin:5px}.tcs-case-card-customization-preview app-live-apps-case-summary,.tcs-case-states-list-inner{overflow-y:auto}.tcs-case-states-list-row{border-radius:3px;padding:3px;margin-left:15px;margin-right:15px}.tcs-case-states-list-row:hover{-webkit-transition:background-color .5s;transition:background-color .5s;background-color:#eef0f7}.tcs-icon-active.tcs-config-button{display:none}.tcs-icon-active.tcs-config-button-placeholder{display:inline-block;width:24px}.tcs-case-states-list-row:hover .tcs-icon-active.tcs-config-button{display:inline-block}.tcs-case-states-list-row:hover .tcs-icon-active.tcs-config-button-placeholder{display:none}.tcs-case-states-icon-divider{padding:0;margin:2px 15px 4px 10px;border-bottom:1.1px solid #f4f4f4}.tcs-save-app-config-button{height:35px}"]
            }] }
];
/** @nocollapse */
LiveAppsApplicationConfigurationComponent.ctorParameters = () => [
    { type: HttpClient },
    { type: DomSanitizer },
    { type: LiveAppsService },
    { type: TcCaseCardConfigService },
    { type: TcDocumentService },
    { type: MatDialog },
    { type: Location }
];
LiveAppsApplicationConfigurationComponent.propDecorators = {
    stateIconComponents: [{ type: ViewChildren, args: ['iconcomp',] }],
    caseSummaryComponent: [{ type: ViewChildren, args: [LiveAppsCaseSummaryComponent,] }],
    appId: [{ type: Input }],
    appTypeLabel: [{ type: Input }],
    sandboxId: [{ type: Input }],
    uiAppId: [{ type: Input }],
    folderId: [{ type: Input }],
    configChanged: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.stateIconComponents;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseSummaryComponent;
    /**
     * The LA Application Id
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.appId;
    /**
     * The label shown above the case type in the configuration widget
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.appTypeLabel;
    /**
     * sandboxId - this comes from claims resolver
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.sandboxId;
    /**
     * The Application ID of the UI (should ideally be unique as it is shared state key)
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.uiAppId;
    /**
     * The organisation folder to store/retrieve documents
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.folderId;
    /**
     * ~event configChanged : Configuration values changed
     * ~payload CaseCardConfig : CaseCardConfig object when configuration is changed (so called can do a save with data)
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.configChanged;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.errorMessage;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseCardConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectedStateConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectedCaseTypeConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseTypeIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseTypeColor;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_TYPE_ICON;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_TYPE_COLOR;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_STATE_ICON;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_STATE_COLOR;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_COLOR_PALETTE;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.getConfigForState;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.getConfigForCaseType;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.updateIconMap;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.handleCaseTypeColorToggleChange;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setFill;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setCaseTypeFill;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectState;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setNewStateIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setNewCaseTypeIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.refresh;
    /**
     * @type {?}
     * @private
     */
    LiveAppsApplicationConfigurationComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    LiveAppsApplicationConfigurationComponent.prototype.sanitizer;
    /**
     * @type {?}
     * @private
     */
    LiveAppsApplicationConfigurationComponent.prototype.liveapps;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseCardConfigService;
    /**
     * @type {?}
     * @private
     */
    LiveAppsApplicationConfigurationComponent.prototype.documentsService;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.dialog;
    /**
     * @type {?}
     * @private
     */
    LiveAppsApplicationConfigurationComponent.prototype.location;
}
export class LiveAppsStateIconUploadDialogComponent {
    /**
     * @param {?} dialogRef
     * @param {?} data
     */
    constructor(dialogRef, data) {
        this.dialogRef = dialogRef;
        this.data = data;
        this.fileevent = new EventEmitter();
        this.fileToUpload = undefined;
        this.description = undefined;
        this.uploadFile = (/**
         * @return {?}
         */
        () => {
            if (this.fileToUpload) {
                this.fileevent.emit({ file: this.fileToUpload, state: this.data.state, isCaseType: this.data.isCaseType });
                this.dialogRef.close();
            }
        });
    }
    /**
     * @param {?} description
     * @return {?}
     */
    setFileDescription(description) {
        this.description = description;
    }
    /**
     * @param {?} files
     * @return {?}
     */
    attachFile(files) {
        this.fileToUpload = files.item(0);
        /*const myReader: FileReader = new FileReader();
        myReader.readAsText(this.fileToUpload);
        this.fileText = myReader.result.toString();*/
    }
    /**
     * @return {?}
     */
    onNoClick() {
        this.dialogRef.close();
    }
}
LiveAppsStateIconUploadDialogComponent.decorators = [
    { type: Component, args: [{
                selector: 'tcla-live-apps-state-icon-upload-dialog',
                template: "  <h1 mat-dialog-title>Upload New Icon (svg) for '{{data.state.value}}'</h1>\n  <div mat-dialog-content class=\"tcs-state-icon-upload-dialog\">\n    <form #fileUploadForm=\"ngForm\" fxFlex fxLayout=\"column\">\n      <div fxLayout=\"row\" fxLayoutAlign=\"start space-between\">\n        <button type=\"button\" mat-raised-button (click)=\"fileInput.click()\">Choose File To Upload</button>\n        <div *ngIf=\"fileToUpload\">{{fileToUpload.name}}</div>\n        <!-- below input is hidden and enabled by above button -->\n        <input class=\"tcs-hidden-input\" (change)=\"attachFile($event.target.files)\" accept=\"image/svg+xml\" #fileInput type=\"file\" id=\"file\">\n      </div>\n    </form>\n  </div>\n  <div mat-dialog-actions>\n    <button mat-button (click)=\"uploadFile()\" type=\"submit\" [disabled]=\"!fileToUpload\">Upload</button>\n    <button mat-button (click)=\"onNoClick()\">Cancel</button>\n  </div>\n",
                styles: [".tcs-hidden-input{display:none}"]
            }] }
];
/** @nocollapse */
LiveAppsStateIconUploadDialogComponent.ctorParameters = () => [
    { type: MatDialogRef },
    { type: undefined, decorators: [{ type: Inject, args: [MAT_DIALOG_DATA,] }] }
];
LiveAppsStateIconUploadDialogComponent.propDecorators = {
    fileevent: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileevent;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileToUpload;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.description;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileText;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.uploadFile;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.dialogRef;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.data;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHRpYmNvLXRjc3RrL3RjLWxpdmVhcHBzLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2xpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uL2xpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQWNBLE9BQU8sRUFDTCxTQUFTLEVBQ1QsWUFBWSxFQUNaLE1BQU0sRUFDTixLQUFLLEVBSUwsTUFBTSxFQUNOLFNBQVMsRUFFVCxZQUFZLEVBQ2IsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFDLGVBQWUsRUFBQyxNQUFNLGtDQUFrQyxDQUFDO0FBQ2pFLE9BQU8sRUFBYSxhQUFhLEVBQUUsT0FBTyxFQUFDLE1BQU0sMkJBQTJCLENBQUM7QUFDN0UsT0FBTyxFQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsU0FBUyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDcEQsT0FBTyxFQUFDLFVBQVUsRUFBYyxNQUFNLHNCQUFzQixDQUFDO0FBQzdELE9BQU8sRUFBQyxZQUFZLEVBQVcsTUFBTSwyQkFBMkIsQ0FBQztBQUdqRSxPQUFPLEVBQUMsNEJBQTRCLEVBQUMsTUFBTSw0REFBNEQsQ0FBQztBQUN4RyxPQUFPLEVBQUMsZUFBZSxFQUFFLFNBQVMsRUFBRSxZQUFZLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUUzRSxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDM0MsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sc0RBQXNELENBQUM7QUFFdkYsT0FBTyxFQUFDLGNBQWMsRUFBRSxtQkFBbUIsRUFBRSxrQkFBa0IsRUFBRSx1QkFBdUIsRUFBQyxNQUFNLDRDQUE0QyxDQUFDO0FBQzVJ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LEtBQUssRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxVQUFVLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBRSxDQUFDO2dCQUM1RyxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxDQUFDO2FBQ3hCO1FBQ0gsQ0FBQyxFQUFBO0lBUHFILENBQUM7Ozs7O0lBU3ZILGtCQUFrQixDQUFDLFdBQW1CO1FBQ3BDLElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDO0lBQ2pDLENBQUM7Ozs7O0lBRUQsVUFBVSxDQUFDLEtBQWU7UUFDeEIsSUFBSSxDQUFDLFlBQVksR0FBRyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xDOztxREFFNkM7SUFDL0MsQ0FBQzs7OztJQUVELFNBQVM7UUFDUCxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ3pCLENBQUM7OztZQWxDRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLHlDQUF5QztnQkFDbkQsdzZCQUE2RTs7YUFFOUU7Ozs7WUFsUm1DLFlBQVk7NENBMFI2QixNQUFNLFNBQUMsZUFBZTs7O3dCQU5oRyxNQUFNOzs7O0lBQVAsMkRBQThDOztJQUM5Qyw4REFBc0M7O0lBQ3RDLDZEQUF1Qzs7SUFDdkMsMERBQXdCOztJQUt4Qiw0REFLQzs7SUFQQywyREFBc0U7O0lBQUUsc0RBQXlDIiwic291cmNlc0NvbnRlbnQiOlsiXG4vKlxuKiAgICAgQ2FzZSBUeXBlIGljb25zIGFyZSBzdG9yZWQgaW4gYW4gb3JnRm9sZGVyIHNwZWNpZmllZCBpbiBsaXZlQXBwc0NvbmZpZy5qc29uIChwdXNoZWQgdG8gc2hhcmVkIHN0YXRlKVxuKiAgICAgSWNvbiBOYW1lIHdpbGwgYmUgYXBwSWQuZmlsZW5hbWUuc3ZnXG4qICAgICBJY29uIHN2ZyBzaG91bGQgY29udGFpbiA8RFlOQU1JQ0ZJTEw+IHRoaXMgd2lsbCBiZSBzZXQgYWNjb3JkaW5nIHRvIHRoZSBjb2xvciBzZWxlY3RlZCBpbiB0aGlzIGNvbXBvbmVudFxuKlxuKiAgICAgZWc6IDE3NDIuaWMtY3JlYXRlZC5zdmcgZm9yIFBhcnRuZXIgUG9ydGFsIExpdmUgQXBwcyBBcHAgKGFwcElkOiAxNzQyKSAnQ3JlYXRlZCcgc3RhdGVcbipcbiogICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTRcIiBoZWlnaHQ9XCIxNFwiIHZpZXdCb3g9XCIwIDAgMTQgMTRcIj5cbiogICAgICAgIDxwYXRoIGZpbGw9XCI8RFlOQU1JQ0ZJTEw+XCIgY2xhc3M9XCJzdmctY29udGVudFwiIGZpbGwtcnVsZT1cImV2ZW5vZGRcIiBkPVwiTTcgMTRBNyA3IDAgMSAxIDcgMGE3IDcgMCAwIDEgMCAxNHptMy40NzQtNi40NzJhLjUyNy41MjcgMCAwIDAgMC0xLjA1M0g3LjUyNlYzLjUyN2EuNTI1LjUyNSAwIDEgMC0xLjA1MiAwdjIuOTQ4SDMuNTI2YS41MjcuNTI3IDAgMCAwIDAgMS4wNTNoMi45NDh2Mi45NDhhLjUyNS41MjUgMCAwIDAgLjg5OC4zNzMuNTI1LjUyNSAwIDAgMCAuMTU0LS4zNzNWNy41MjhoMi45NDh6XCIvPlxuKiAgICAgIDwvc3ZnPlxuKlxuKlxuICovXG5pbXBvcnQge1xuICBDb21wb25lbnQsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5qZWN0LFxuICBJbnB1dCxcbiAgT25DaGFuZ2VzLFxuICBPbkRlc3Ryb3ksXG4gIE9uSW5pdCxcbiAgT3V0cHV0LFxuICBRdWVyeUxpc3QsIFNpbXBsZUNoYW5nZXMsXG4gIFZpZXdDaGlsZCxcbiAgVmlld0NoaWxkcmVuXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtPYnNlcnZhYmxlLCBvZiwgU3ViamVjdH0gZnJvbSAncnhqcyc7XG5pbXBvcnQge0xpdmVBcHBzU2VydmljZX0gZnJvbSAnLi4vLi4vc2VydmljZXMvbGl2ZS1hcHBzLnNlcnZpY2UnO1xuaW1wb3J0IHtDYXJkQ29uZmlnLCBDYXNlVHlwZVN0YXRlLCBJY29uTWFwfSBmcm9tICcuLi8uLi9tb2RlbHMvbGl2ZWFwcHNkYXRhJztcbmltcG9ydCB7bWFwLCB0YWtlLCB0YWtlVW50aWx9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7SHR0cENsaWVudCwgSHR0cEhlYWRlcnN9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7RG9tU2FuaXRpemVyLCBTYWZlSHRtbH0gZnJvbSAnQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3Nlcic7XG5pbXBvcnQge0xpdmVBcHBzQ2FzZURhdGFDb21wb25lbnR9IGZyb20gJy4uL2xpdmUtYXBwcy1jYXNlLWRhdGEvbGl2ZS1hcHBzLWNhc2UtZGF0YS5jb21wb25lbnQnO1xuaW1wb3J0IHtMaXZlQXBwc1N0YXRlSWNvbkNvbXBvbmVudH0gZnJvbSAnLi4vbGl2ZS1hcHBzLXN0YXRlLWljb24vbGl2ZS1hcHBzLXN0YXRlLWljb24uY29tcG9uZW50JztcbmltcG9ydCB7TGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudH0gZnJvbSAnLi4vbGl2ZS1hcHBzLWNhc2Utc3VtbWFyeS9saXZlLWFwcHMtY2FzZS1zdW1tYXJ5LmNvbXBvbmVudCc7XG5pbXBvcnQge01BVF9ESUFMT0dfREFUQSwgTWF0RGlhbG9nLCBNYXREaWFsb2dSZWZ9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsJztcbmltcG9ydCB7TGl2ZUFwcHNEb2N1bWVudFVwbG9hZERpYWxvZ0NvbXBvbmVudH0gZnJvbSAnLi4vbGl2ZS1hcHBzLWRvY3VtZW50cy9saXZlLWFwcHMtZG9jdW1lbnRzLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBMb2NhdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge0xpdmVBcHBzQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtY29tcG9uZW50L2xpdmUtYXBwcy1jb21wb25lbnQuY29tcG9uZW50JztcbmltcG9ydCB7Q2FzZUNhcmRDb25maWd9IGZyb20gJy4uLy4uL21vZGVscy90Yy1jYXNlLWNhcmQtY29uZmlnJztcbmltcG9ydCB7REVGQVVMVF9DT0xPUlMsIERFRkFVTFRfU1RBVEVfQ09MT1IsIERFRkFVTFRfVFlQRV9DT0xPUiwgVGNDYXNlQ2FyZENvbmZpZ1NlcnZpY2V9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3RjLWNhc2UtY2FyZC1jb25maWcuc2VydmljZSc7XG5pbXBvcnQge1RjRG9jdW1lbnRTZXJ2aWNlfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy90Yy1kb2N1bWVudC5zZXJ2aWNlJztcblxuXG5cbi8qKlxuICogTWFuYWdlcyBzdW1tYXJ5IGNhcmQgY29uZmlndXJhdGlvblxuICpcbiAqQGV4YW1wbGUgPHRjbGEtbGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24+PC90Y2xhLWxpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uPlxuICovXG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3RjbGEtbGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24nLFxuICB0ZW1wbGF0ZVVybDogJy4vbGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24uY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9saXZlLWFwcHMtYXBwbGljYXRpb24tY29uZmlndXJhdGlvbi5jb21wb25lbnQuY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgTGl2ZUFwcHNBcHBsaWNhdGlvbkNvbmZpZ3VyYXRpb25Db21wb25lbnQgZXh0ZW5kcyBMaXZlQXBwc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XG4gIC8vIFRoZSBWaWV3Q2hpbGQgZGVjbGFyYXRpb25zIGdpdmUgYWNjZXNzIHRvIGNvbXBvbmVudHMgbWFya2VkIG9uIHRoZSB0ZW1wbGF0ZSBzbyB0aGF0IEkgY2FuIGNhbGwgcHVibGljIGZ1bmN0aW9ucyBsaWtlIHJlZnJlc2hcbiAgQFZpZXdDaGlsZHJlbignaWNvbmNvbXAnKSBzdGF0ZUljb25Db21wb25lbnRzOiBRdWVyeUxpc3Q8TGl2ZUFwcHNTdGF0ZUljb25Db21wb25lbnQ+O1xuICBAVmlld0NoaWxkcmVuKExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQpIGNhc2VTdW1tYXJ5Q29tcG9uZW50OiBRdWVyeUxpc3Q8TGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudD47XG5cbiAgLyoqXG4gICAqIFRoZSBMQSBBcHBsaWNhdGlvbiBJZFxuICAgKi9cbiAgQElucHV0KCkgYXBwSWQ6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGxhYmVsIHNob3duIGFib3ZlIHRoZSBjYXNlIHR5cGUgaW4gdGhlIGNvbmZpZ3VyYXRpb24gd2lkZ2V0XG4gICAqL1xuICBASW5wdXQoKSBhcHBUeXBlTGFiZWw6IHN0cmluZztcblxuICAvKipcbiAgICogc2FuZGJveElkIC0gdGhpcyBjb21lcyBmcm9tIGNsYWltcyByZXNvbHZlclxuICAgKi9cbiAgQElucHV0KCkgc2FuZGJveElkOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBBcHBsaWNhdGlvbiBJRCBvZiB0aGUgVUkgKHNob3VsZCBpZGVhbGx5IGJlIHVuaXF1ZSBhcyBpdCBpcyBzaGFyZWQgc3RhdGUga2V5KVxuICAgKi9cbiAgQElucHV0KCkgdWlBcHBJZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgb3JnYW5pc2F0aW9uIGZvbGRlciB0byBzdG9yZS9yZXRyaWV2ZSBkb2N1bWVudHNcbiAgICovXG4gIEBJbnB1dCgpIGZvbGRlcklkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIH5ldmVudCBjb25maWdDaGFuZ2VkIDogQ29uZmlndXJhdGlvbiB2YWx1ZXMgY2hhbmdlZFxuICAgKiB+cGF5bG9hZCBDYXNlQ2FyZENvbmZpZyA6IENhc2VDYXJkQ29uZmlnIG9iamVjdCB3aGVuIGNvbmZpZ3VyYXRpb24gaXMgY2hhbmdlZCAoc28gY2FsbGVkIGNhbiBkbyBhIHNhdmUgd2l0aCBkYXRhKVxuICAgKi9cbiAgQE91dHB1dCgpIGNvbmZpZ0NoYW5nZWQ6IEV2ZW50RW1pdHRlcjxDYXNlQ2FyZENvbmZpZz4gPSBuZXcgRXZlbnRFbWl0dGVyPENhc2VDYXJkQ29uZmlnPigpO1xuXG4gIHB1YmxpYyBlcnJvck1lc3NhZ2U6IHN0cmluZztcbiAgcHVibGljIGNhc2VDYXJkQ29uZmlnOiBDYXNlQ2FyZENvbmZpZztcbiAgcHVibGljIHNlbGVjdGVkU3RhdGVDb25maWc6IEljb25NYXA7XG4gIHB1YmxpYyBzZWxlY3RlZENhc2VUeXBlQ29uZmlnOiBJY29uTWFwO1xuICBwdWJsaWMgY2FzZVR5cGVJY29uOiBzdHJpbmc7XG4gIHB1YmxpYyBjYXNlVHlwZUNvbG9yOiBzdHJpbmc7XG5cbiAgLy8gcHJlcGFyZUV4dGVybmFsVXJsIHdpbGwgYWRkIHRoZSBiYXNlIGhyZWZcbiAgcHVibGljIERFRkFVTFRfQ0FTRV9UWVBFX0lDT04gPSAnYXNzZXRzL2ljb25zL2ljLWdlbmVyaWMtY2FzZXR5cGUuc3ZnJztcbiAgcHVibGljIERFRkFVTFRfQ0FTRV9UWVBFX0NPTE9SID0gREVGQVVMVF9UWVBFX0NPTE9SO1xuICBwdWJsaWMgREVGQVVMVF9DQVNFX1NUQVRFX0lDT04gPSAnYXNzZXRzL2ljb25zL2ljLWdlbmVyaWMtc3RhdGUuc3ZnJztcbiAgcHVibGljIERFRkFVTFRfQ0FTRV9TVEFURV9DT0xPUiA9IERFRkFVTFRfU1RBVEVfQ09MT1I7XG4gIHB1YmxpYyBERUZBVUxUX0NPTE9SX1BBTEVUVEUgPSBERUZBVUxUX0NPTE9SUztcblxuICBwdWJsaWMgZ2V0Q29uZmlnRm9yU3RhdGUgPSAoc3RhdGU6IENhc2VUeXBlU3RhdGUpOiBJY29uTWFwID0+IHtcbiAgICBsZXQgcmVxSWNvbk1hcDogSWNvbk1hcDtcbiAgICBpZiAodGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnICYmIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcCkge1xuICAgICAgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwLmZvckVhY2goKHN0YXRlTWFwKSA9PiB7XG4gICAgICAgIGlmIChzdGF0ZU1hcC5zdGF0ZSA9PT0gc3RhdGUudmFsdWUpIHtcbiAgICAgICAgICByZXFJY29uTWFwID0gc3RhdGVNYXA7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVxSWNvbk1hcCA/IHJlcUljb25NYXAgOiBuZXcgSWNvbk1hcChmYWxzZSwgc3RhdGUudmFsdWUsIHRoaXMuREVGQVVMVF9DQVNFX1NUQVRFX0NPTE9SLCB0aGlzLkRFRkFVTFRfQ0FTRV9TVEFURV9JQ09OKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRDb25maWdGb3JDYXNlVHlwZSA9IChjYXNlVHlwZUlkOiBzdHJpbmcpOiBJY29uTWFwID0+IHtcbiAgICBsZXQgcmVxSWNvbk1hcDogSWNvbk1hcDtcbiAgICBpZiAodGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnICYmIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcCkge1xuICAgICAgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwLmZvckVhY2goKHN0YXRlTWFwKSA9PiB7XG4gICAgICAgIGlmIChzdGF0ZU1hcC5pc0Nhc2VUeXBlKSB7XG4gICAgICAgICAgcmVxSWNvbk1hcCA9IHN0YXRlTWFwO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcUljb25NYXAgPyByZXFJY29uTWFwIDogbmV3IEljb25NYXAodHJ1ZSwgY2FzZVR5cGVJZCwgdGhpcy5ERUZBVUxUX0NBU0VfVFlQRV9DT0xPUiwgdGhpcy5ERUZBVUxUX0NBU0VfVFlQRV9JQ09OKTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVJY29uTWFwID0gKHN0YXRlQ29uZmlnOiBJY29uTWFwKSA9PiB7XG4gICAgbGV0IGZvdW5kTWFwOiBJY29uTWFwO1xuICAgIGxldCB1cGRhdGVkTWFwOiBJY29uTWFwO1xuICAgIGlmICh0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcgJiYgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwKSB7XG4gICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXAuZm9yRWFjaChmdW5jdGlvbihzdGF0ZU1hcCkge1xuICAgICAgICBpZiAoc3RhdGVNYXAuc3RhdGUgPT09IHN0YXRlQ29uZmlnLnN0YXRlKSB7XG4gICAgICAgICAgZm91bmRNYXAgPSBzdGF0ZUNvbmZpZztcbiAgICAgICAgICBzdGF0ZU1hcC5zdGF0ZSA9IHN0YXRlQ29uZmlnLnN0YXRlO1xuICAgICAgICAgIHN0YXRlTWFwLmljb24gPSBzdGF0ZUNvbmZpZy5pY29uO1xuICAgICAgICAgIHN0YXRlTWFwLmZpbGwgPSBzdGF0ZUNvbmZpZy5maWxsO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChmb3VuZE1hcCkge1xuICAgICAgICBmb3VuZE1hcCA9IHN0YXRlQ29uZmlnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwLnB1c2goc3RhdGVDb25maWcpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXAgPSBbXTtcbiAgICAgIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcC5wdXNoKHN0YXRlQ29uZmlnKTtcbiAgICB9XG4gICAgdGhpcy5jb25maWdDaGFuZ2VkLmVtaXQodGhpcy5jYXNlQ2FyZENvbmZpZyk7XG4gIH1cblxuICBwdWJsaWMgaGFuZGxlQ2FzZVR5cGVDb2xvclRvZ2dsZUNoYW5nZSA9IChjaGFuZ2VzKSA9PiB7XG4gICAgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnVzZUNhc2VUeXBlQ29sb3IgPSBjaGFuZ2VzLmNoZWNrZWQgPyBjaGFuZ2VzLmNoZWNrZWQgOiBmYWxzZTtcbiAgICBpZiAoY2hhbmdlcy5jaGVja2VkKSB7XG4gICAgICB0aGlzLmNhc2VTdW1tYXJ5Q29tcG9uZW50LmZvckVhY2goKGNvbXA6IExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQpID0+IHtcbiAgICAgICAgY29tcC5yZXN0eWxlUHJldmlldyh0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuaWNvbiwgdGhpcy5jYXNlVHlwZUNvbG9yKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLmNvbmZpZ0NoYW5nZWQuZW1pdCh0aGlzLmNhc2VDYXJkQ29uZmlnKTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRGaWxsID0gKGZpbGwsIHN0YXRlQ29uZmlnOiBJY29uTWFwKSA9PiB7XG4gICAgdGhpcy5jYXNlU3VtbWFyeUNvbXBvbmVudC5mb3JFYWNoKChjb21wOiBMaXZlQXBwc0Nhc2VTdW1tYXJ5Q29tcG9uZW50KSA9PiB7XG4gICAgICBjb21wLnJlc3R5bGVQcmV2aWV3KHN0YXRlQ29uZmlnLmljb24sIGZpbGwpO1xuICAgIH0pO1xuICAgIHRoaXMuc3RhdGVJY29uQ29tcG9uZW50cy5maW5kKGZ1bmN0aW9uKGNvbXApIHtcbiAgICAgIHJldHVybiBjb21wLmlkID09PSBzdGF0ZUNvbmZpZy5zdGF0ZTtcbiAgICB9KS5yZWZpbGxTVkcoZmlsbCk7XG4gICAgdGhpcy5jb25maWdDaGFuZ2VkLmVtaXQodGhpcy5jYXNlQ2FyZENvbmZpZyk7XG4gIH1cblxuICBwdWJsaWMgc2V0Q2FzZVR5cGVGaWxsID0gKGZpbGwsIHN0YXRlQ29uZmlnOiBJY29uTWFwKSA9PiB7XG4gICAgdGhpcy5jYXNlU3VtbWFyeUNvbXBvbmVudC5mb3JFYWNoKChjb21wOiBMaXZlQXBwc0Nhc2VTdW1tYXJ5Q29tcG9uZW50KSA9PiB7XG4gICAgICBjb21wLnJlc3R5bGVQcmV2aWV3Q2FzZVR5cGUoc3RhdGVDb25maWcuaWNvbiwgZmlsbCk7XG4gICAgfSk7XG4gICAgdGhpcy5zdGF0ZUljb25Db21wb25lbnRzLmZpbmQoZnVuY3Rpb24oY29tcCkge1xuICAgICAgcmV0dXJuIChjb21wLmlkID09PSBzdGF0ZUNvbmZpZy5zdGF0ZSAmJiBzdGF0ZUNvbmZpZy5pc0Nhc2VUeXBlKTtcbiAgICB9KS5yZWZpbGxTVkcoZmlsbCk7XG4gICAgdGhpcy5jb25maWdDaGFuZ2VkLmVtaXQodGhpcy5jYXNlQ2FyZENvbmZpZyk7XG4gIH1cblxuICBwdWJsaWMgc2VsZWN0U3RhdGUgPSAoc3RhdGU6IENhc2VUeXBlU3RhdGUpID0+IHtcbiAgICB0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcgPSB0aGlzLmdldENvbmZpZ0ZvclN0YXRlKHN0YXRlKTtcbiAgICBpZiAoIXRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy51c2VDYXNlVHlwZUNvbG9yKSB7XG4gICAgICB0aGlzLmNhc2VTdW1tYXJ5Q29tcG9uZW50LmZvckVhY2goKGNvbXA6IExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQpID0+IHtcbiAgICAgICAgY29tcC5yZXN0eWxlUHJldmlldyh0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuaWNvbiwgdGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLmZpbGwpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLypwdWJsaWMgc2F2ZUNvbmZpZyA9ICgpID0+IHtcbiAgICB0aGlzLmNhc2VDYXJkQ29uZmlnU2VydmljZS51cGRhdGVDYXNlQ2FyZENvbmZpZyh0aGlzLnNhbmRib3hJZCwgdGhpcy5hcHBJZCwgdGhpcy51aUFwcElkLCB0aGlzLmNhc2VDYXJkQ29uZmlnKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRha2UoMSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQkKSxcbiAgICAgICAgbWFwKGNhc2VDYXJkQ29uZmlnID0+IHtcbiAgICAgICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnID0gY2FzZUNhcmRDb25maWc7XG4gICAgICAgIH0pXG4gICAgICApLnN1YnNjcmliZShudWxsLCBlcnJvciA9PiB7IGNvbnNvbGUubG9nKCdVbmFibGUgdG8gdXBkYXRlIGNhc2UgY2FyZCBjb25maWc6ICcgKyBlcnJvci5lcnJvck1zZyk7IH1cbiAgICApO1xuICB9Ki9cblxuICBwdWJsaWMgb3BlbkRpYWxvZyhzdGF0ZTogQ2FzZVR5cGVTdGF0ZSwgaXNDYXNlVHlwZTogYm9vbGVhbik6IHZvaWQge1xuXG4gICAgaWYgKCFpc0Nhc2VUeXBlKSB7XG4gICAgICB0aGlzLnNlbGVjdFN0YXRlKHN0YXRlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RhdGUgPSBuZXcgQ2FzZVR5cGVTdGF0ZSgpLmRlc2VyaWFsaXplKHsgdmFsdWU6IHRoaXMuYXBwVHlwZUxhYmVsIH0pO1xuICAgIH1cbiAgICBjb25zdCBkaWFsb2dSZWYgPSB0aGlzLmRpYWxvZy5vcGVuKExpdmVBcHBzU3RhdGVJY29uVXBsb2FkRGlhbG9nQ29tcG9uZW50LCB7XG4gICAgICB3aWR0aDogJzUwMHB4JyxcbiAgICAgIGRhdGE6IHsgc3RhdGU6IHN0YXRlLCBpc0Nhc2VUeXBlOiBpc0Nhc2VUeXBlIH1cbiAgICB9KTtcblxuICAgIGRpYWxvZ1JlZi5jb21wb25lbnRJbnN0YW5jZS5maWxlZXZlbnQuc3Vic2NyaWJlKCgkZSkgPT4ge1xuICAgICAgdGhpcy51cGxvYWRGaWxlKCRlLmZpbGUsICRlLnN0YXRlLCAkZS5pc0Nhc2VUeXBlKTtcbiAgICB9KVxuXG4gICAgZGlhbG9nUmVmLmFmdGVyQ2xvc2VkKCkuc3Vic2NyaWJlKHJlc3VsdCA9PiB7XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgc2V0TmV3U3RhdGVJY29uID0gKHVybCkgPT4ge1xuICAgIHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5pY29uID0gdXJsO1xuICAgIHRoaXMuc3RhdGVJY29uQ29tcG9uZW50cy5maW5kKChjb21wOiBMaXZlQXBwc1N0YXRlSWNvbkNvbXBvbmVudCkgPT4ge1xuICAgICAgcmV0dXJuIChjb21wLmlkID09PSB0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuc3RhdGUpO1xuICAgIH0pLnJlZnJlc2godGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLmljb24sIHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5maWxsKTtcbiAgICB0aGlzLmNhc2VTdW1tYXJ5Q29tcG9uZW50LmZvckVhY2goKGNvbXA6IExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQpID0+IHtcbiAgICAgIGNvbXAucmVzdHlsZVByZXZpZXcodGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLmljb24sIHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5maWxsKTtcbiAgICB9KTtcbiAgICB0aGlzLnVwZGF0ZUljb25NYXAodGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnKTtcbiAgfVxuXG4gIHB1YmxpYyBzZXROZXdDYXNlVHlwZUljb24gPSAodXJsKSA9PiB7XG4gICAgdGhpcy5jYXNlVHlwZUljb24gPSB1cmw7XG4gICAgdGhpcy5zdGF0ZUljb25Db21wb25lbnRzLmZpbmQoKGNvbXA6IExpdmVBcHBzU3RhdGVJY29uQ29tcG9uZW50KSA9PiB7XG4gICAgICByZXR1cm4gKGNvbXAuaWQgPT09IHRoaXMuYXBwVHlwZUxhYmVsKTtcbiAgICB9KS5yZWZyZXNoKHRoaXMuY2FzZVR5cGVJY29uLCB0aGlzLmNhc2VUeXBlQ29sb3IpO1xuICAgIHRoaXMuY2FzZVN1bW1hcnlDb21wb25lbnQuZm9yRWFjaCgoY29tcDogTGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudCkgPT4ge1xuICAgICAgY29tcC5yZXN0eWxlUHJldmlld0Nhc2VUeXBlKHRoaXMuY2FzZVR5cGVJY29uLCB0aGlzLmNhc2VUeXBlQ29sb3IpO1xuICAgIH0pO1xuICAgIHRoaXMudXBkYXRlSWNvbk1hcChuZXcgSWNvbk1hcCh0cnVlLCB0aGlzLmFwcFR5cGVMYWJlbCwgdGhpcy5jYXNlVHlwZUNvbG9yLCB0aGlzLmNhc2VUeXBlSWNvbikpO1xuICB9XG5cbiAgcHVibGljIHVwbG9hZEZpbGUoZmlsZTogRmlsZSwgc3RhdGU6IENhc2VUeXBlU3RhdGUsIGlzU3RhdGVJY29uOiBib29sZWFuKSB7XG4gICAgaWYgKGZpbGUpIHtcbiAgICAgIGNvbnN0IHVybCA9ICd3ZWJyZXNvdXJjZS92MS9vcmdGb2xkZXJzLycgKyB0aGlzLmZvbGRlcklkICsgJy8nICsgdGhpcy5hcHBJZCArICcuJyArIGZpbGUubmFtZTtcbiAgICAgIGNvbnN0IGRsVXJsID0gJ3dlYnJlc291cmNlL29yZ0ZvbGRlcnMvJyArIHRoaXMuZm9sZGVySWQgKyAnLycgKyB0aGlzLmFwcElkICsgJy4nICsgZmlsZS5uYW1lO1xuICAgICAgdGhpcy5saXZlYXBwcy5jbGVhckZyb21JY29uU1ZHVGV4dENhY2hlKHVybCk7XG4gICAgICB0aGlzLmRvY3VtZW50c1NlcnZpY2UudXBsb2FkRG9jdW1lbnQoJ29yZ0ZvbGRlcnMnLCB0aGlzLmZvbGRlcklkLCB0aGlzLnNhbmRib3hJZCxcbiAgICAgICAgZmlsZSwgKHRoaXMuYXBwSWQgKyAnLicgKyBmaWxlLm5hbWUpLCAnJylcbiAgICAgICAgLnBpcGUoXG4gICAgICAgICAgbWFwKHZhbCA9PiB7XG4gICAgICAgICAgICBpZiAoIWlzU3RhdGVJY29uKSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0TmV3U3RhdGVJY29uKGRsVXJsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0TmV3Q2FzZVR5cGVJY29uKGRsVXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgcmVzdWx0ID0+IG51bGwsXG4gICAgICAgICAgZXJyb3IgPT4geyBjb25zb2xlLmxvZygnZXJyb3InKTsgdGhpcy5lcnJvck1lc3NhZ2UgPSAnRXJyb3IgdXBsb2FkaW5nIHN0YXRlIGljb246ICcgKyBlcnJvci5lcnJvck1zZzsgfSk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHJlZnJlc2ggPSAoKSA9PiB7XG4gICAgLy8gbmVlZCBzdGF0ZXMgJiBjYXJkQ29uZmlnXG4gICAgdGhpcy5zZWxlY3RlZENhc2VUeXBlQ29uZmlnID0gbnVsbDtcbiAgICB0aGlzLmNhc2VDYXJkQ29uZmlnU2VydmljZS5nZXRDYXNlQ2FyZENvbmZpZyh0aGlzLnNhbmRib3hJZCwgdGhpcy5hcHBJZCwgdGhpcy51aUFwcElkLCB0aGlzLmFwcFR5cGVMYWJlbCwgdGhpcy5ERUZBVUxUX0NBU0VfVFlQRV9DT0xPUiwgdGhpcy5ERUZBVUxUX0NBU0VfVFlQRV9JQ09OLCB0aGlzLkRFRkFVTFRfQ0FTRV9TVEFURV9DT0xPUiwgdGhpcy5ERUZBVUxUX0NBU0VfU1RBVEVfSUNPTikucGlwZShcbiAgICAgIHRha2UoMSksXG4gICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveWVkJCksXG4gICAgICBtYXAoY2FzZUNhcmRDb25maWcgPT4ge1xuICAgICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnID0gY2FzZUNhcmRDb25maWc7XG4gICAgICAgIC8vIHNldCBkZWZhdWx0IHNlbGVjdGVkIHRvIGZpcnN0IHN0YXRlIGZvciB0aGlzIGNhc2UgdHlwZSAoMCBpcyBjYXNlIHR5cGUpXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZyA9IHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcFsxXTtcbiAgICAgICAgY29uc3QgY2FzZVR5cGVSZWMgPSB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXAuZmluZChmdW5jdGlvbihzdGF0ZU1hcCkge1xuICAgICAgICAgIHJldHVybiBzdGF0ZU1hcC5pc0Nhc2VUeXBlO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNhc2VUeXBlSWNvbiA9IGNhc2VUeXBlUmVjLmljb247XG4gICAgICAgIHRoaXMuY2FzZVR5cGVDb2xvciA9IGNhc2VUeXBlUmVjLmZpbGw7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRDYXNlVHlwZUNvbmZpZyA9IHRoaXMuZ2V0Q29uZmlnRm9yQ2FzZVR5cGUodGhpcy5hcHBUeXBlTGFiZWwpO1xuICAgICAgfSlcbiAgICApLnN1YnNjcmliZShcbiAgICAgIG51bGwsIGVycm9yID0+IHsgdGhpcy5lcnJvck1lc3NhZ2UgPSAnRXJyb3IgcmV0cmlldmluZyBjYXNlIGNhcmQgY29uZmlnOiAnICsgZXJyb3IuZXJyb3IuZXJyb3JNc2c7IH0pO1xuICB9XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50LCBwcml2YXRlIHNhbml0aXplcjogRG9tU2FuaXRpemVyLFxuICAgICAgICAgICAgICBwcml2YXRlIGxpdmVhcHBzOiBMaXZlQXBwc1NlcnZpY2UsIHB1YmxpYyBjYXNlQ2FyZENvbmZpZ1NlcnZpY2U6IFRjQ2FzZUNhcmRDb25maWdTZXJ2aWNlLCBwcml2YXRlIGRvY3VtZW50c1NlcnZpY2U6IFRjRG9jdW1lbnRTZXJ2aWNlLCBwdWJsaWMgZGlhbG9nOiBNYXREaWFsb2csIHByaXZhdGUgbG9jYXRpb246IExvY2F0aW9uKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICBpZiAoY2hhbmdlcy5hcHBJZCAmJiAoY2hhbmdlcy5hcHBJZC5jdXJyZW50VmFsdWUgIT09IGNoYW5nZXMuYXBwSWQucHJldmlvdXNWYWx1ZSkpIHtcbiAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG5cbn1cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGNsYS1saXZlLWFwcHMtc3RhdGUtaWNvbi11cGxvYWQtZGlhbG9nJyxcbiAgdGVtcGxhdGVVcmw6ICd1cGxvYWQtZmlsZS1kaWFsb2cvYXBwLWxpdmUtYXBwcy1zdGF0ZS1pY29uLXVwbG9hZC1kaWFsb2cuaHRtbCcsXG4gIHN0eWxlVXJsczogWyAndXBsb2FkLWZpbGUtZGlhbG9nL2FwcC1saXZlLWFwcHMtc3RhdGUtaWNvbi11cGxvYWQtZGlhbG9nLmNzcyddXG59KVxuZXhwb3J0IGNsYXNzIExpdmVBcHBzU3RhdGVJY29uVXBsb2FkRGlhbG9nQ29tcG9uZW50IHtcbiAgQE91dHB1dCgpIGZpbGVldmVudCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICBwdWJsaWMgZmlsZVRvVXBsb2FkOiBGaWxlID0gdW5kZWZpbmVkO1xuICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyA9IHVuZGVmaW5lZDtcbiAgcHVibGljIGZpbGVUZXh0OiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIGRpYWxvZ1JlZjogTWF0RGlhbG9nUmVmPExpdmVBcHBzU3RhdGVJY29uVXBsb2FkRGlhbG9nQ29tcG9uZW50PiwgQEluamVjdChNQVRfRElBTE9HX0RBVEEpIHB1YmxpYyBkYXRhOiBhbnkpIHt9XG5cbiAgcHVibGljIHVwbG9hZEZpbGUgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuZmlsZVRvVXBsb2FkKSB7XG4gICAgICB0aGlzLmZpbGVldmVudC5lbWl0KHsgZmlsZTogdGhpcy5maWxlVG9VcGxvYWQsIHN0YXRlOiB0aGlzLmRhdGEuc3RhdGUsIGlzQ2FzZVR5cGU6IHRoaXMuZGF0YS5pc0Nhc2VUeXBlIH0gKTtcbiAgICAgIHRoaXMuZGlhbG9nUmVmLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RmlsZURlc2NyaXB0aW9uKGRlc2NyaXB0aW9uOiBzdHJpbmcpIHtcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gIH1cblxuICBhdHRhY2hGaWxlKGZpbGVzOiBGaWxlTGlzdCkge1xuICAgIHRoaXMuZmlsZVRvVXBsb2FkID0gZmlsZXMuaXRlbSgwKTtcbiAgICAvKmNvbnN0IG15UmVhZGVyOiBGaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICBteVJlYWRlci5yZWFkQXNUZXh0KHRoaXMuZmlsZVRvVXBsb2FkKTtcbiAgICB0aGlzLmZpbGVUZXh0ID0gbXlSZWFkZXIucmVzdWx0LnRvU3RyaW5nKCk7Ki9cbiAgfVxuXG4gIG9uTm9DbGljaygpOiB2b2lkIHtcbiAgICB0aGlzLmRpYWxvZ1JlZi5jbG9zZSgpO1xuICB9XG5cbn1cblxuIl19