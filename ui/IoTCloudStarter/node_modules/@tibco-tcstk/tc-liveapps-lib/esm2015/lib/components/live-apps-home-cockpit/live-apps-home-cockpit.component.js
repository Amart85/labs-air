/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, EventEmitter, Input, Output, ViewChild } from '@angular/core';
import { TcButtonsHelperService, RouteAction } from '@tibco-tcstk/tc-core-lib';
import { LiveAppsFavoriteCasesComponent } from '../live-apps-favorite-cases/live-apps-favorite-cases.component';
import { LiveAppsRecentCasesComponent } from '../live-apps-recent-cases/live-apps-recent-cases.component';
import { LiveAppsSearchWidgetComponent } from '../live-apps-search-widget/live-apps-search-widget.component';
import { MatDialog } from '@angular/material';
import { LiveAppsCreatorDialogComponent } from '../live-apps-creator-dialog/live-apps-creator-dialog.component';
import { CaseCreatorSelectionContext } from '../../models/tc-case-creator';
import { LiveAppsNotesComponent } from '../live-apps-notes/live-apps-notes.component';
import { LiveAppsDocumentsComponent } from '../live-apps-documents/live-apps-documents.component';
import { TcRolesService } from '../../services/tc-roles-service.ts.service';
import { Roles, RouteAccessControlConfig } from '../../models/tc-groups-data';
import { LiveAppsActiveCasesWidgetComponent } from '../live-apps-active-cases-widget/live-apps-active-cases-widget.component';
import { CustomFormDefs } from '@tibco-tcstk/tc-forms-lib';
/**
 * High level component to allow home page view of system
 *
 * ![alt-text](../live-apps-home-cockpit.png "Documents Component Image")
 *
 * \@example <tcla-live-apps-home-cockpit></tcla-live-apps-home-cockpit>
 */
export class LiveAppsHomeCockpitComponent {
    /**
     * @param {?} buttonsHelper
     * @param {?} dialog
     * @param {?} rolesService
     */
    constructor(buttonsHelper, dialog, rolesService) {
        this.buttonsHelper = buttonsHelper;
        this.dialog = dialog;
        this.rolesService = rolesService;
        /**
         * ~event routeAction : Component requests route to another page
         * ~payload RouteAction : RouteAction object to tell caller to navigate somewhere
         */
        this.routeAction = new EventEmitter();
        this.toolbarButtons = [];
        this.incConfigButton = true;
        this.incRefreshButton = true;
        this.clickCaseAction = (/**
         * @param {?} caseRoute
         * @return {?}
         */
        (caseRoute) => {
            // case clicked - tell parent (will pass caseRef and appId)
            this.routeAction.emit(new RouteAction('caseClicked', caseRoute));
        });
        this.createToolbarButtons = (/**
         * @return {?}
         */
        () => {
            /** @type {?} */
            const buttons = [];
            // you can use the rolesService to either disable or hide the button as required - it returns true if the user has the roleId specified
            // const configButton = this.buttonsHelper.createButton('config', 'tcs-capabilities', true, 'Config', true, this.rolesService.checkRole('Partner Portal Configurator', this.roles));
            if (this.incConfigButton) {
                /** @type {?} */
                const configButton = this.buttonsHelper.createButton('config', 'tcs-capabilities', true, 'Config', (this.access ? this.rolesService.checkButton('configure', this.roles, this.access) : true), true);
                buttons.push(configButton);
            }
            if (this.incRefreshButton) {
                /** @type {?} */
                const refreshButton = this.buttonsHelper.createButton('refresh', 'tcs-refresh-icon', true, 'Refresh', (this.access ? this.rolesService.checkButton('refresh', this.roles, this.access) : true), true);
                buttons.push(refreshButton);
            }
            return buttons;
        });
        this.handleToolbarButtonEvent = (/**
         * @param {?} buttonId
         * @return {?}
         */
        (buttonId) => {
            if (buttonId === 'config') {
                this.routeAction.emit(new RouteAction('configClicked', null));
            }
            if (buttonId === 'refresh') {
                this.refresh();
            }
        });
        this.handleCreatorAppSelection = (/**
         * @param {?} application
         * @return {?}
         */
        (application) => {
            /** @type {?} */
            const EXAMPLE_INITIAL_DATA = {
                PartnerRequest: {
                    Customer_v1: {
                        CustomerReference_v1: 'CST-1111',
                        Name_v1: 'Roger Willis',
                    },
                    RequestDescription_v1: 'Where is my order?',
                    RequestDetails_v1: {
                        OrderReference_v1: 'ORD-55333',
                        PartReference_v1: 'PRT-102020',
                    },
                    RequestType_v1: 'Packaging Supplies'
                }
            }
            // this.openCreatorDialog(application, EXAMPLE_INITIAL_DATA, this.sandboxId);
            ;
            // this.openCreatorDialog(application, EXAMPLE_INITIAL_DATA, this.sandboxId);
            this.openCreatorDialog(application, undefined, this.sandboxId, this.customFormDefs);
        });
        this.handleReportCaseTypeSelection = (/**
         * @param {?} caseTypeReportRecord
         * @return {?}
         */
        (caseTypeReportRecord) => {
            this.selectedCaseTypeReportRecord = caseTypeReportRecord;
        });
        this.handleReportCaseTypeStateSelection = (/**
         * @param {?} state
         * @return {?}
         */
        (state) => {
            if (this.selectedCaseTypeReportRecord) {
                this.searchComponent.searchCasesByState(Number(state.id), state.label, this.selectedCaseTypeReportRecord.applicationId, this.selectedCaseTypeReportRecord.caseTypeInfo.id, this.selectedCaseTypeReportRecord.caseTypeInfo.label + '|' + state.label);
            }
        });
        this.openCreatorDialog = (/**
         * @param {?} application
         * @param {?} initialData
         * @param {?} sandboxId
         * @param {?} customFormDefs
         * @return {?}
         */
        (application, initialData, sandboxId, customFormDefs) => {
            /** @type {?} */
            const dialogRef = this.dialog.open(LiveAppsCreatorDialogComponent, {
                width: '60%',
                height: '80%',
                maxWidth: '100vw',
                maxHeight: '100vh',
                panelClass: 'tcs-style-dialog',
                data: new CaseCreatorSelectionContext(application, initialData, sandboxId, customFormDefs)
            });
            dialogRef.afterClosed().subscribe((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                if (result) {
                    this.routeAction.emit(new RouteAction('caseClicked', result));
                }
            }));
        });
        this.refresh = (/**
         * @return {?}
         */
        () => {
            if (this.favoritesComponent) {
                this.favoritesComponent.refresh();
            }
            if (this.recentsComponent) {
                this.recentsComponent.refresh();
            }
            if (this.searchComponent) {
                this.searchComponent.refresh();
            }
            if (this.collaborationComponent) {
                this.collaborationComponent.refresh();
            }
            if (this.documentsComponent) {
                this.documentsComponent.refresh();
            }
            if (this.activeCasesComponent) {
                this.activeCasesComponent.refresh();
            }
        });
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.toolbarButtons = this.toolbarButtons.concat(this.createToolbarButtons());
        this.caseStartButtonActive = this.access ? this.rolesService.checkButton('caseStart', this.roles, this.access) : true;
    }
}
LiveAppsHomeCockpitComponent.decorators = [
    { type: Component, args: [{
                selector: 'tcla-live-apps-home-cockpit',
                template: "<div fxLayout=\"column\" fxFlex>\n  <div>\n    <tc-tibco-cloud-menu-bar [toolbarButtons]=\"toolbarButtons\" [headerText]=\"title\" (toolbarButtonEvent)=\"handleToolbarButtonEvent($event)\">\n      <div>\n        <ng-content select=\"[customToolbarContent]\" fxFlex></ng-content>\n        <tcla-live-apps-application-create-button *ngIf=\"caseStartButtonActive\" style=\"margin-right: 20px; margin-left: 20px\" [sandboxId]=\"sandboxId\" [appIds]=\"appIds\" (selection)=\"handleCreatorAppSelection($event)\"></tcla-live-apps-application-create-button>\n      </div>\n    </tc-tibco-cloud-menu-bar>\n  </div>\n\n  <div class=\"tcs-home-content\" fxLayout=\"column\" fxFlex=\"grow\" fxLayoutAlign=\"start stretch\" style=\"padding-left: 20px; padding-right: 20px; margin-top: 10px;\">\n\n    <div fxFlex class=\"searchCasesWidget\" style=\"min-height: 86px\">\n      <tcla-live-apps-search-widget [appIds]=\"appIds\" [sandboxId]=\"sandboxId\" [uiAppId]=\"uiAppId\" (caseSelected)=\"clickCaseAction($event)\"></tcla-live-apps-search-widget>\n    </div>\n\n    <div fxFlex=\"noshrink\" style=\"margin-bottom: 20px; overflow: auto; min-height: 400px\" fxLayoutGap=\"20px\" fxLayout=\"row\" fxLayout.lt-md=\"column\">\n      <div fxFlex.gt-sm=\"grow\" fxLayout=\"row\" style=\"height: 100%;\" [ngStyle.lt-md]=\"'min-height: 400px;'\">\n        <mat-tab-group fxFlex>\n          <mat-tab label=\"Favorite Cases\">\n            <div class=\"favoriteCasesWidget\" fxFill>\n              <tcla-live-apps-favorite-cases class=\"padded-widget\" [showHeader]=\"true\" [sandboxId]=\"sandboxId\" [uiAppId]=\"uiAppId\" (clickCase)=\"clickCaseAction($event)\"></tcla-live-apps-favorite-cases>\n            </div>\n          </mat-tab>\n          <mat-tab label=\"Recent Cases\">\n            <div class=\"recentCasesWidget\" fxFill>\n              <tcla-live-apps-recent-cases class=\"padded-widget\" [showHeader]=\"true\" [sandboxId]=\"sandboxId\" [uiAppId]=\"uiAppId\" (clickCase)=\"clickCaseAction($event)\"></tcla-live-apps-recent-cases>\n            </div>\n          </mat-tab>\n        </mat-tab-group>\n      </div>\n\n      <div fxFlex.gt-sm=\"40\" fxLayout=\"column\" [ngStyle.lt-md]=\"'min-height: 400px'\">\n        <div style=\"padding-top: 48px; height: 350px;\">\n          <tcla-live-apps-active-cases-widget [sandboxId]=\"sandboxId\" [appIds]=\"appIds\" [showHeader]=\"true\" [showPercentages]=\"true\" [uiAppId]=\"uiAppId\" (selectedCaseTypeState)=\"handleReportCaseTypeStateSelection($event)\" (selectedCaseType)=\"handleReportCaseTypeSelection($event)\"></tcla-live-apps-active-cases-widget>\n        </div>\n        <div fxFlex=\"noshrink\" style=\"height: 350px;\">\n          <mat-tab-group fxFlex>\n            <mat-tab label=\"Collaboration\">\n              <div fxFill class=\"collaborationWidget\">\n                <tcla-live-apps-notes [userId]=\"userId\" [showHeader]=\"true\" [relatedItemId]=\"uiAppId\" [relatedItemType]=\"'CASE_APP'\"></tcla-live-apps-notes>\n              </div>\n            </mat-tab>\n            <mat-tab label=\"Documents\">\n              <div fxFill class=\"documentWidget\">\n                <tcla-live-apps-documents [showHeader]=\"true\" [sandboxId]=\"sandboxId\" [folderId]=\"uiAppId + '_Docs'\" [folderType]=\"'orgFolders'\" [folderDescription]=\"'Document Library'\"></tcla-live-apps-documents>\n              </div>\n            </mat-tab>\n          </mat-tab-group>\n        </div>\n      </div>\n    </div>\n\n  </div>\n</div>\n\n\n",
                styles: [".tc-home-welcome-text{font-family:Source Sans Pro;font-size:30px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;color:#212121}.tcs-home-content{overflow:auto}"]
            }] }
];
/** @nocollapse */
LiveAppsHomeCockpitComponent.ctorParameters = () => [
    { type: TcButtonsHelperService },
    { type: MatDialog },
    { type: TcRolesService }
];
LiveAppsHomeCockpitComponent.propDecorators = {
    uiAppId: [{ type: Input }],
    appIds: [{ type: Input }],
    sandboxId: [{ type: Input }],
    userName: [{ type: Input }],
    userId: [{ type: Input }],
    email: [{ type: Input }],
    title: [{ type: Input }],
    roles: [{ type: Input }],
    access: [{ type: Input }],
    customFormDefs: [{ type: Input }],
    routeAction: [{ type: Output }],
    favoritesComponent: [{ type: ViewChild, args: [LiveAppsFavoriteCasesComponent, { static: false },] }],
    recentsComponent: [{ type: ViewChild, args: [LiveAppsRecentCasesComponent, { static: false },] }],
    searchComponent: [{ type: ViewChild, args: [LiveAppsSearchWidgetComponent, { static: false },] }],
    collaborationComponent: [{ type: ViewChild, args: [LiveAppsNotesComponent, { static: false },] }],
    documentsComponent: [{ type: ViewChild, args: [LiveAppsDocumentsComponent, { static: false },] }],
    activeCasesComponent: [{ type: ViewChild, args: [LiveAppsActiveCasesWidgetComponent, { static: false },] }]
};
if (false) {
    /**
     * The Application ID of the UI (should ideally be unique as it is shared state key)
     * @type {?}
     */
    LiveAppsHomeCockpitComponent.prototype.uiAppId;
    /**
     * The list of LA Application IDs you want to handle
     * @type {?}
     */
    LiveAppsHomeCockpitComponent.prototype.appIds;
    /**
     * sandboxId - this comes from claims resolver
     * @type {?}
     */
    LiveAppsHomeCockpitComponent.prototype.sandboxId;
    /**
     * The name of the logged user
     * @type {?}
     */
    LiveAppsHomeCockpitComponent.prototype.userName;
    /**
     * The ID of the logged user
     * @type {?}
     */
    LiveAppsHomeCockpitComponent.prototype.userId;
    /**
     * * Email address of the user (comes from resolver)
     * @type {?}
     */
    LiveAppsHomeCockpitComponent.prototype.email;
    /**
     * page title comes from config resolver
     * @type {?}
     */
    LiveAppsHomeCockpitComponent.prototype.title;
    /**
     * Roles - The users current roles
     * @type {?}
     */
    LiveAppsHomeCockpitComponent.prototype.roles;
    /**
     * RouteAccessControlConfig - basically the config for access control
     * @type {?}
     */
    LiveAppsHomeCockpitComponent.prototype.access;
    /**
     * Custom Form configuration file
     * @type {?}
     */
    LiveAppsHomeCockpitComponent.prototype.customFormDefs;
    /**
     * ~event routeAction : Component requests route to another page
     * ~payload RouteAction : RouteAction object to tell caller to navigate somewhere
     * @type {?}
     */
    LiveAppsHomeCockpitComponent.prototype.routeAction;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.favoritesComponent;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.recentsComponent;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.searchComponent;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.collaborationComponent;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.documentsComponent;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.activeCasesComponent;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.toolbarButtons;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.caseStartButtonActive;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.selectedCaseTypeReportRecord;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.incConfigButton;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.incRefreshButton;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.clickCaseAction;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsHomeCockpitComponent.prototype.createToolbarButtons;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.handleToolbarButtonEvent;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.handleCreatorAppSelection;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.handleReportCaseTypeSelection;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.handleReportCaseTypeStateSelection;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.openCreatorDialog;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.refresh;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsHomeCockpitComponent.prototype.buttonsHelper;
    /** @type {?} */
    LiveAppsHomeCockpitComponent.prototype.dialog;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsHomeCockpitComponent.prototype.rolesService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLWhvbWUtY29ja3BpdC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AdGliY28tdGNzdGsvdGMtbGl2ZWFwcHMtbGliLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvbGl2ZS1hcHBzLWhvbWUtY29ja3BpdC9saXZlLWFwcHMtaG9tZS1jb2NrcGl0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFNBQVMsRUFBRSxZQUFZLEVBQVUsS0FBSyxFQUFVLE1BQU0sRUFBRSxTQUFTLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFFaEcsT0FBTyxFQUFnQixzQkFBc0IsRUFBRSxXQUFXLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQztBQUM1RixPQUFPLEVBQUMsOEJBQThCLEVBQUMsTUFBTSxnRUFBZ0UsQ0FBQztBQUM5RyxPQUFPLEVBQUMsNEJBQTRCLEVBQUMsTUFBTSw0REFBNEQsQ0FBQztBQUN4RyxPQUFPLEVBQUMsNkJBQTZCLEVBQUMsTUFBTSw4REFBOEQsQ0FBQztBQUMzRyxPQUFPLEVBQWtCLFNBQVMsRUFBZSxNQUFNLG1CQUFtQixDQUFDO0FBQzNFLE9BQU8sRUFBQyw4QkFBOEIsRUFBQyxNQUFNLGdFQUFnRSxDQUFDO0FBQzlHLE9BQU8sRUFBQywyQkFBMkIsRUFBQyxNQUFNLDhCQUE4QixDQUFDO0FBQ3pFLE9BQU8sRUFBQyxzQkFBc0IsRUFBQyxNQUFNLDhDQUE4QyxDQUFDO0FBQ3BGLE9BQU8sRUFBQywwQkFBMEIsRUFBQyxNQUFNLHNEQUFzRCxDQUFDO0FBQ2hHLE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSw0Q0FBNEMsQ0FBQztBQUMxRSxPQUFPLEVBQUMsS0FBSyxFQUFFLHdCQUF3QixFQUFDLE1BQU0sNkJBQTZCLENBQUM7QUFDNUUsT0FBTyxFQUFDLGtDQUFrQyxFQUFDLE1BQU0sMEVBQTBFLENBQUM7QUFFNUgsT0FBTyxFQUFDLGNBQWMsRUFBQyxNQUFNLDJCQUEyQixD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OztJQUN0QyxvRUFBMEQ7O0lBRTFELHVEQUF1Qjs7SUFDdkIsd0RBQXdCOztJQUV4Qix1REFHQzs7Ozs7SUFJRCw0REFjQzs7SUFFRCxnRUFPQzs7SUFFRCxpRUFpQkM7O0lBRUQscUVBRUM7O0lBRUQsMEVBSUM7O0lBRUQseURBZUM7O0lBRUQsK0NBbUJDOzs7OztJQTVGVyxxREFBK0M7O0lBQUUsOENBQXdCOzs7OztJQUFFLG9EQUFzQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7Q29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIEluamVjdCwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0LCBWaWV3Q2hpbGR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtDYXNlUm91dGUsIENhc2VUeXBlfSBmcm9tICcuLi8uLi9tb2RlbHMvbGl2ZWFwcHNkYXRhJztcbmltcG9ydCB7VG9vbGJhckJ1dHRvbiwgVGNCdXR0b25zSGVscGVyU2VydmljZSwgUm91dGVBY3Rpb259IGZyb20gJ0B0aWJjby10Y3N0ay90Yy1jb3JlLWxpYic7XG5pbXBvcnQge0xpdmVBcHBzRmF2b3JpdGVDYXNlc0NvbXBvbmVudH0gZnJvbSAnLi4vbGl2ZS1hcHBzLWZhdm9yaXRlLWNhc2VzL2xpdmUtYXBwcy1mYXZvcml0ZS1jYXNlcy5jb21wb25lbnQnO1xuaW1wb3J0IHtMaXZlQXBwc1JlY2VudENhc2VzQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtcmVjZW50LWNhc2VzL2xpdmUtYXBwcy1yZWNlbnQtY2FzZXMuY29tcG9uZW50JztcbmltcG9ydCB7TGl2ZUFwcHNTZWFyY2hXaWRnZXRDb21wb25lbnR9IGZyb20gJy4uL2xpdmUtYXBwcy1zZWFyY2gtd2lkZ2V0L2xpdmUtYXBwcy1zZWFyY2gtd2lkZ2V0LmNvbXBvbmVudCc7XG5pbXBvcnQge01BVF9ESUFMT0dfREFUQSwgTWF0RGlhbG9nLCBNYXREaWFsb2dSZWZ9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsJztcbmltcG9ydCB7TGl2ZUFwcHNDcmVhdG9yRGlhbG9nQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtY3JlYXRvci1kaWFsb2cvbGl2ZS1hcHBzLWNyZWF0b3ItZGlhbG9nLmNvbXBvbmVudCc7XG5pbXBvcnQge0Nhc2VDcmVhdG9yU2VsZWN0aW9uQ29udGV4dH0gZnJvbSAnLi4vLi4vbW9kZWxzL3RjLWNhc2UtY3JlYXRvcic7XG5pbXBvcnQge0xpdmVBcHBzTm90ZXNDb21wb25lbnR9IGZyb20gJy4uL2xpdmUtYXBwcy1ub3Rlcy9saXZlLWFwcHMtbm90ZXMuY29tcG9uZW50JztcbmltcG9ydCB7TGl2ZUFwcHNEb2N1bWVudHNDb21wb25lbnR9IGZyb20gJy4uL2xpdmUtYXBwcy1kb2N1bWVudHMvbGl2ZS1hcHBzLWRvY3VtZW50cy5jb21wb25lbnQnO1xuaW1wb3J0IHtUY1JvbGVzU2VydmljZX0gZnJvbSAnLi4vLi4vc2VydmljZXMvdGMtcm9sZXMtc2VydmljZS50cy5zZXJ2aWNlJztcbmltcG9ydCB7Um9sZXMsIFJvdXRlQWNjZXNzQ29udHJvbENvbmZpZ30gZnJvbSAnLi4vLi4vbW9kZWxzL3RjLWdyb3Vwcy1kYXRhJztcbmltcG9ydCB7TGl2ZUFwcHNBY3RpdmVDYXNlc1dpZGdldENvbXBvbmVudH0gZnJvbSAnLi4vbGl2ZS1hcHBzLWFjdGl2ZS1jYXNlcy13aWRnZXQvbGl2ZS1hcHBzLWFjdGl2ZS1jYXNlcy13aWRnZXQuY29tcG9uZW50JztcbmltcG9ydCB7Q2FzZVR5cGVSZXBvcnRSZWNvcmQsIENhc2VUeXBlU3RhdGVSZXBvcnRTdGF0ZUluZm99IGZyb20gJy4uLy4uL21vZGVscy90Yy1saXZlLWFwcHMtcmVwb3J0aW5nJztcbmltcG9ydCB7Q3VzdG9tRm9ybURlZnN9IGZyb20gJ0B0aWJjby10Y3N0ay90Yy1mb3Jtcy1saWInO1xuXG5cbi8qKlxuICogSGlnaCBsZXZlbCBjb21wb25lbnQgdG8gYWxsb3cgaG9tZSBwYWdlIHZpZXcgb2Ygc3lzdGVtXG4gKlxuICogIVthbHQtdGV4dF0oLi4vbGl2ZS1hcHBzLWhvbWUtY29ja3BpdC5wbmcgXCJEb2N1bWVudHMgQ29tcG9uZW50IEltYWdlXCIpXG4gKlxuICpAZXhhbXBsZSA8dGNsYS1saXZlLWFwcHMtaG9tZS1jb2NrcGl0PjwvdGNsYS1saXZlLWFwcHMtaG9tZS1jb2NrcGl0PlxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd0Y2xhLWxpdmUtYXBwcy1ob21lLWNvY2twaXQnLFxuICB0ZW1wbGF0ZVVybDogJy4vbGl2ZS1hcHBzLWhvbWUtY29ja3BpdC5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2xpdmUtYXBwcy1ob21lLWNvY2twaXQuY29tcG9uZW50LmNzcyddXG59KVxuZXhwb3J0IGNsYXNzIExpdmVBcHBzSG9tZUNvY2twaXRDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICAvKipcbiAgICogVGhlIEFwcGxpY2F0aW9uIElEIG9mIHRoZSBVSSAoc2hvdWxkIGlkZWFsbHkgYmUgdW5pcXVlIGFzIGl0IGlzIHNoYXJlZCBzdGF0ZSBrZXkpXG4gICAqL1xuICBASW5wdXQoKSB1aUFwcElkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBsaXN0IG9mIExBIEFwcGxpY2F0aW9uIElEcyB5b3Ugd2FudCB0byBoYW5kbGVcbiAgICovXG4gIEBJbnB1dCgpIGFwcElkczogc3RyaW5nW107XG5cbiAgLyoqXG4gICAqIHNhbmRib3hJZCAtIHRoaXMgY29tZXMgZnJvbSBjbGFpbXMgcmVzb2x2ZXJcbiAgICovXG4gIEBJbnB1dCgpIHNhbmRib3hJZDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgbmFtZSBvZiB0aGUgbG9nZ2VkIHVzZXJcbiAgICovXG4gIEBJbnB1dCgpIHVzZXJOYW1lOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFRoZSBJRCBvZiB0aGUgbG9nZ2VkIHVzZXJcbiAgICovXG4gIEBJbnB1dCgpIHVzZXJJZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiAqIEVtYWlsIGFkZHJlc3Mgb2YgdGhlIHVzZXIgKGNvbWVzIGZyb20gcmVzb2x2ZXIpXG4gICAqL1xuICBASW5wdXQoKSBlbWFpbDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBwYWdlIHRpdGxlIGNvbWVzIGZyb20gY29uZmlnIHJlc29sdmVyXG4gICAqL1xuICBASW5wdXQoKSB0aXRsZTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBSb2xlcyAtIFRoZSB1c2VycyBjdXJyZW50IHJvbGVzXG4gICAqL1xuICBASW5wdXQoKSByb2xlczogUm9sZXM7XG5cbiAgLyoqXG4gICAqIFJvdXRlQWNjZXNzQ29udHJvbENvbmZpZyAtIGJhc2ljYWxseSB0aGUgY29uZmlnIGZvciBhY2Nlc3MgY29udHJvbFxuICAgKi9cbiAgQElucHV0KCkgYWNjZXNzOiBSb3V0ZUFjY2Vzc0NvbnRyb2xDb25maWc7XG5cbiAgLyoqXG4gICAqIEN1c3RvbSBGb3JtIGNvbmZpZ3VyYXRpb24gZmlsZVxuICAgKi9cbiAgQElucHV0KCkgY3VzdG9tRm9ybURlZnM6IEN1c3RvbUZvcm1EZWZzO1xuXG4gIC8qKlxuICAgKiB+ZXZlbnQgcm91dGVBY3Rpb24gOiBDb21wb25lbnQgcmVxdWVzdHMgcm91dGUgdG8gYW5vdGhlciBwYWdlXG4gICAqIH5wYXlsb2FkIFJvdXRlQWN0aW9uIDogUm91dGVBY3Rpb24gb2JqZWN0IHRvIHRlbGwgY2FsbGVyIHRvIG5hdmlnYXRlIHNvbWV3aGVyZVxuICAgKi9cbiAgQE91dHB1dCgpIHJvdXRlQWN0aW9uOiBFdmVudEVtaXR0ZXI8Um91dGVBY3Rpb24+ID0gbmV3IEV2ZW50RW1pdHRlcjxSb3V0ZUFjdGlvbj4oKTtcblxuICBAVmlld0NoaWxkKExpdmVBcHBzRmF2b3JpdGVDYXNlc0NvbXBvbmVudCwge3N0YXRpYzogZmFsc2V9KSBmYXZvcml0ZXNDb21wb25lbnQ6IExpdmVBcHBzRmF2b3JpdGVDYXNlc0NvbXBvbmVudDtcbiAgQFZpZXdDaGlsZChMaXZlQXBwc1JlY2VudENhc2VzQ29tcG9uZW50LCB7c3RhdGljOiBmYWxzZX0pIHJlY2VudHNDb21wb25lbnQ6IExpdmVBcHBzUmVjZW50Q2FzZXNDb21wb25lbnQ7XG4gIEBWaWV3Q2hpbGQoTGl2ZUFwcHNTZWFyY2hXaWRnZXRDb21wb25lbnQsIHtzdGF0aWM6IGZhbHNlfSkgc2VhcmNoQ29tcG9uZW50OiBMaXZlQXBwc1NlYXJjaFdpZGdldENvbXBvbmVudDtcbiAgQFZpZXdDaGlsZChMaXZlQXBwc05vdGVzQ29tcG9uZW50LCB7c3RhdGljOiBmYWxzZX0pIGNvbGxhYm9yYXRpb25Db21wb25lbnQ6IExpdmVBcHBzTm90ZXNDb21wb25lbnQ7XG4gIEBWaWV3Q2hpbGQoTGl2ZUFwcHNEb2N1bWVudHNDb21wb25lbnQsIHtzdGF0aWM6IGZhbHNlfSkgZG9jdW1lbnRzQ29tcG9uZW50OiBMaXZlQXBwc0RvY3VtZW50c0NvbXBvbmVudDtcbiAgQFZpZXdDaGlsZChMaXZlQXBwc0FjdGl2ZUNhc2VzV2lkZ2V0Q29tcG9uZW50LCB7c3RhdGljOiBmYWxzZX0pIGFjdGl2ZUNhc2VzQ29tcG9uZW50OiBMaXZlQXBwc0FjdGl2ZUNhc2VzV2lkZ2V0Q29tcG9uZW50O1xuXG4gIHB1YmxpYyB0b29sYmFyQnV0dG9uczogVG9vbGJhckJ1dHRvbltdID0gW107XG4gIHB1YmxpYyBjYXNlU3RhcnRCdXR0b25BY3RpdmU6IGJvb2xlYW47XG4gIHB1YmxpYyBzZWxlY3RlZENhc2VUeXBlUmVwb3J0UmVjb3JkOiBDYXNlVHlwZVJlcG9ydFJlY29yZDtcblxuICBpbmNDb25maWdCdXR0b24gPSB0cnVlO1xuICBpbmNSZWZyZXNoQnV0dG9uID0gdHJ1ZTtcblxuICBwdWJsaWMgY2xpY2tDYXNlQWN0aW9uID0gKGNhc2VSb3V0ZTogQ2FzZVJvdXRlKSA9PiB7XG4gICAgLy8gY2FzZSBjbGlja2VkIC0gdGVsbCBwYXJlbnQgKHdpbGwgcGFzcyBjYXNlUmVmIGFuZCBhcHBJZClcbiAgICB0aGlzLnJvdXRlQWN0aW9uLmVtaXQobmV3IFJvdXRlQWN0aW9uKCdjYXNlQ2xpY2tlZCcsIGNhc2VSb3V0ZSkpO1xuICB9XG5cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIGJ1dHRvbnNIZWxwZXI6IFRjQnV0dG9uc0hlbHBlclNlcnZpY2UsIHB1YmxpYyBkaWFsb2c6IE1hdERpYWxvZywgcHJvdGVjdGVkIHJvbGVzU2VydmljZTogVGNSb2xlc1NlcnZpY2UpIHsgfVxuXG4gIHByb3RlY3RlZCBjcmVhdGVUb29sYmFyQnV0dG9ucyA9ICgpOiBUb29sYmFyQnV0dG9uW10gPT4ge1xuICAgIGNvbnN0IGJ1dHRvbnMgPSBbXTtcblxuICAgIC8vIHlvdSBjYW4gdXNlIHRoZSByb2xlc1NlcnZpY2UgdG8gZWl0aGVyIGRpc2FibGUgb3IgaGlkZSB0aGUgYnV0dG9uIGFzIHJlcXVpcmVkIC0gaXQgcmV0dXJucyB0cnVlIGlmIHRoZSB1c2VyIGhhcyB0aGUgcm9sZUlkIHNwZWNpZmllZFxuICAgIC8vIGNvbnN0IGNvbmZpZ0J1dHRvbiA9IHRoaXMuYnV0dG9uc0hlbHBlci5jcmVhdGVCdXR0b24oJ2NvbmZpZycsICd0Y3MtY2FwYWJpbGl0aWVzJywgdHJ1ZSwgJ0NvbmZpZycsIHRydWUsIHRoaXMucm9sZXNTZXJ2aWNlLmNoZWNrUm9sZSgnUGFydG5lciBQb3J0YWwgQ29uZmlndXJhdG9yJywgdGhpcy5yb2xlcykpO1xuICAgIGlmICh0aGlzLmluY0NvbmZpZ0J1dHRvbikge1xuICAgICAgY29uc3QgY29uZmlnQnV0dG9uID0gdGhpcy5idXR0b25zSGVscGVyLmNyZWF0ZUJ1dHRvbignY29uZmlnJywgJ3Rjcy1jYXBhYmlsaXRpZXMnLCB0cnVlLCAnQ29uZmlnJywgKHRoaXMuYWNjZXNzID8gdGhpcy5yb2xlc1NlcnZpY2UuY2hlY2tCdXR0b24oJ2NvbmZpZ3VyZScsIHRoaXMucm9sZXMsIHRoaXMuYWNjZXNzKSA6IHRydWUpLCB0cnVlKTtcbiAgICAgIGJ1dHRvbnMucHVzaChjb25maWdCdXR0b24pO1xuICAgIH1cbiAgICBpZiAodGhpcy5pbmNSZWZyZXNoQnV0dG9uKSB7XG4gICAgICBjb25zdCByZWZyZXNoQnV0dG9uID0gdGhpcy5idXR0b25zSGVscGVyLmNyZWF0ZUJ1dHRvbigncmVmcmVzaCcsICd0Y3MtcmVmcmVzaC1pY29uJywgdHJ1ZSwgJ1JlZnJlc2gnLCAodGhpcy5hY2Nlc3MgPyB0aGlzLnJvbGVzU2VydmljZS5jaGVja0J1dHRvbigncmVmcmVzaCcsIHRoaXMucm9sZXMsIHRoaXMuYWNjZXNzKSA6IHRydWUpLCB0cnVlKTtcbiAgICAgIGJ1dHRvbnMucHVzaChyZWZyZXNoQnV0dG9uKTtcbiAgICB9XG4gICAgcmV0dXJuIGJ1dHRvbnM7XG4gIH1cblxuICBwdWJsaWMgaGFuZGxlVG9vbGJhckJ1dHRvbkV2ZW50ID0gKGJ1dHRvbklkOiBzdHJpbmcpID0+IHtcbiAgICBpZiAoYnV0dG9uSWQgPT09ICdjb25maWcnKSB7XG4gICAgICB0aGlzLnJvdXRlQWN0aW9uLmVtaXQobmV3IFJvdXRlQWN0aW9uKCdjb25maWdDbGlja2VkJywgbnVsbCkpO1xuICAgIH1cbiAgICBpZiAoYnV0dG9uSWQgPT09ICdyZWZyZXNoJykge1xuICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIGhhbmRsZUNyZWF0b3JBcHBTZWxlY3Rpb24gPSAoYXBwbGljYXRpb246IENhc2VUeXBlKSA9PiB7XG4gICAgY29uc3QgRVhBTVBMRV9JTklUSUFMX0RBVEEgPSB7XG4gICAgICBQYXJ0bmVyUmVxdWVzdDoge1xuICAgICAgICBDdXN0b21lcl92MToge1xuICAgICAgICAgIEN1c3RvbWVyUmVmZXJlbmNlX3YxOiAnQ1NULTExMTEnLFxuICAgICAgICAgIE5hbWVfdjE6ICdSb2dlciBXaWxsaXMnLFxuICAgICAgICB9LFxuICAgICAgICBSZXF1ZXN0RGVzY3JpcHRpb25fdjE6ICdXaGVyZSBpcyBteSBvcmRlcj8nLFxuICAgICAgICBSZXF1ZXN0RGV0YWlsc192MToge1xuICAgICAgICAgIE9yZGVyUmVmZXJlbmNlX3YxOiAnT1JELTU1MzMzJyxcbiAgICAgICAgICBQYXJ0UmVmZXJlbmNlX3YxOiAnUFJULTEwMjAyMCcsXG4gICAgICAgIH0sXG4gICAgICAgIFJlcXVlc3RUeXBlX3YxOiAnUGFja2FnaW5nIFN1cHBsaWVzJ1xuICAgICAgfVxuICAgIH1cbiAgICAvLyB0aGlzLm9wZW5DcmVhdG9yRGlhbG9nKGFwcGxpY2F0aW9uLCBFWEFNUExFX0lOSVRJQUxfREFUQSwgdGhpcy5zYW5kYm94SWQpO1xuICAgIHRoaXMub3BlbkNyZWF0b3JEaWFsb2coYXBwbGljYXRpb24sIHVuZGVmaW5lZCwgdGhpcy5zYW5kYm94SWQsIHRoaXMuY3VzdG9tRm9ybURlZnMpO1xuICB9XG5cbiAgcHVibGljIGhhbmRsZVJlcG9ydENhc2VUeXBlU2VsZWN0aW9uID0gKGNhc2VUeXBlUmVwb3J0UmVjb3JkOiBDYXNlVHlwZVJlcG9ydFJlY29yZCkgPT4ge1xuICAgIHRoaXMuc2VsZWN0ZWRDYXNlVHlwZVJlcG9ydFJlY29yZCA9IGNhc2VUeXBlUmVwb3J0UmVjb3JkO1xuICB9XG5cbiAgcHVibGljIGhhbmRsZVJlcG9ydENhc2VUeXBlU3RhdGVTZWxlY3Rpb24gPSAoc3RhdGU6IENhc2VUeXBlU3RhdGVSZXBvcnRTdGF0ZUluZm8pID0+IHtcbiAgICBpZiAodGhpcy5zZWxlY3RlZENhc2VUeXBlUmVwb3J0UmVjb3JkKSB7XG4gICAgICB0aGlzLnNlYXJjaENvbXBvbmVudC5zZWFyY2hDYXNlc0J5U3RhdGUoTnVtYmVyKHN0YXRlLmlkKSwgc3RhdGUubGFiZWwsIHRoaXMuc2VsZWN0ZWRDYXNlVHlwZVJlcG9ydFJlY29yZC5hcHBsaWNhdGlvbklkLCB0aGlzLnNlbGVjdGVkQ2FzZVR5cGVSZXBvcnRSZWNvcmQuY2FzZVR5cGVJbmZvLmlkLCB0aGlzLnNlbGVjdGVkQ2FzZVR5cGVSZXBvcnRSZWNvcmQuY2FzZVR5cGVJbmZvLmxhYmVsICsgJ3wnICsgc3RhdGUubGFiZWwgKTtcbiAgICB9XG4gIH1cblxuICBvcGVuQ3JlYXRvckRpYWxvZyA9IChhcHBsaWNhdGlvbjogQ2FzZVR5cGUsIGluaXRpYWxEYXRhLCBzYW5kYm94SWQsIGN1c3RvbUZvcm1EZWZzKSA9PiB7XG4gICAgY29uc3QgZGlhbG9nUmVmID0gdGhpcy5kaWFsb2cub3BlbihMaXZlQXBwc0NyZWF0b3JEaWFsb2dDb21wb25lbnQsIHtcbiAgICAgIHdpZHRoOiAnNjAlJyxcbiAgICAgIGhlaWdodDogJzgwJScsXG4gICAgICBtYXhXaWR0aDogJzEwMHZ3JyxcbiAgICAgIG1heEhlaWdodDogJzEwMHZoJyxcbiAgICAgIHBhbmVsQ2xhc3M6ICd0Y3Mtc3R5bGUtZGlhbG9nJyxcbiAgICAgIGRhdGE6IG5ldyBDYXNlQ3JlYXRvclNlbGVjdGlvbkNvbnRleHQoYXBwbGljYXRpb24sIGluaXRpYWxEYXRhLCBzYW5kYm94SWQsIGN1c3RvbUZvcm1EZWZzKVxuICAgIH0pO1xuXG4gICAgZGlhbG9nUmVmLmFmdGVyQ2xvc2VkKCkuc3Vic2NyaWJlKHJlc3VsdCA9PiB7XG4gICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgIHRoaXMucm91dGVBY3Rpb24uZW1pdChuZXcgUm91dGVBY3Rpb24oJ2Nhc2VDbGlja2VkJywgcmVzdWx0KSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgcmVmcmVzaCA9ICgpID0+IHtcbiAgICBpZiAodGhpcy5mYXZvcml0ZXNDb21wb25lbnQpIHtcbiAgICAgIHRoaXMuZmF2b3JpdGVzQ29tcG9uZW50LnJlZnJlc2goKTtcbiAgICB9XG4gICAgaWYgKHRoaXMucmVjZW50c0NvbXBvbmVudCkge1xuICAgICAgdGhpcy5yZWNlbnRzQ29tcG9uZW50LnJlZnJlc2goKTtcbiAgICB9XG4gICAgaWYgKHRoaXMuc2VhcmNoQ29tcG9uZW50KSB7XG4gICAgICB0aGlzLnNlYXJjaENvbXBvbmVudC5yZWZyZXNoKCk7XG4gICAgfVxuICAgIGlmICh0aGlzLmNvbGxhYm9yYXRpb25Db21wb25lbnQpIHtcbiAgICAgIHRoaXMuY29sbGFib3JhdGlvbkNvbXBvbmVudC5yZWZyZXNoKCk7XG4gICAgfVxuICAgIGlmICh0aGlzLmRvY3VtZW50c0NvbXBvbmVudCkge1xuICAgICAgdGhpcy5kb2N1bWVudHNDb21wb25lbnQucmVmcmVzaCgpO1xuICAgIH1cbiAgICBpZiAodGhpcy5hY3RpdmVDYXNlc0NvbXBvbmVudCkge1xuICAgICAgdGhpcy5hY3RpdmVDYXNlc0NvbXBvbmVudC5yZWZyZXNoKCk7XG4gICAgfVxuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy50b29sYmFyQnV0dG9ucyA9IHRoaXMudG9vbGJhckJ1dHRvbnMuY29uY2F0KHRoaXMuY3JlYXRlVG9vbGJhckJ1dHRvbnMoKSk7XG4gICAgdGhpcy5jYXNlU3RhcnRCdXR0b25BY3RpdmUgPSB0aGlzLmFjY2VzcyA/IHRoaXMucm9sZXNTZXJ2aWNlLmNoZWNrQnV0dG9uKCdjYXNlU3RhcnQnLCB0aGlzLnJvbGVzLCB0aGlzLmFjY2VzcykgOiB0cnVlO1xuICB9XG5cbn1cbiJdfQ==