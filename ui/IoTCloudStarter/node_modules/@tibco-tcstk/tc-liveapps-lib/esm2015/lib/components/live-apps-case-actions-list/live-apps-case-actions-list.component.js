/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input } from '@angular/core';
import { map, takeUntil, take, tap } from 'rxjs/operators';
import { LiveAppsCaseActionsComponent } from '../live-apps-case-actions/live-apps-case-actions.component';
/**
 * Special (option list) rendering of LiveAppsCaseActionsComponent
 *
 * \@example <tcla-live-apps-case-actions-list></tcla-live-apps-case-actions-list>
 */
export class LiveAppsCaseActionsListComponent extends LiveAppsCaseActionsComponent {
    constructor() {
        super(...arguments);
        this.refresh = (/**
         * @return {?}
         */
        () => {
            // retrieve the schema for this case type so we can display case creators and case actions for this case type
            this.liveapps.getCaseTypeSchema(this.sandboxId, this.appId, 100).pipe(map((/**
             * @param {?} schema
             * @return {?}
             */
            schema => {
                // this.appSchema = schema;
                schema.casetypes.forEach((/**
                 * @param {?} casetype
                 * @return {?}
                 */
                (casetype) => {
                    // the schema will contain definitions for both the 'case' and any defined types in that case.
                    // We want the schema for this 'case'.
                    if (casetype.applicationId === this.appId && casetype.id === this.typeId) {
                        if (casetype.jsonSchema !== undefined) {
                            // this.caseType = casetype;
                            this.caseActionList = casetype.actions ? casetype.actions : [];
                            // if (this.caseActionList.length == 1) {
                            //     this.selectProcess(this.caseActionList[0]);
                            // }
                        }
                        else {
                            console.error('No schema returned for this case type: You may need to update/re-deploy the live apps application');
                        }
                    }
                }));
            }))).subscribe();
        });
        this.compareObjects = (/**
         * @param {?} o1
         * @param {?} o2
         * @return {?}
         */
        (o1, o2) => {
            return o1.id === this.seletedActionId;
        });
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        if (changes.appId && (changes.appId.currentValue !== changes.appId.previousValue)) {
            this.caseActionList = [];
            this.refresh();
        }
    }
    /**
     * @param {?} action
     * @return {?}
     */
    selectAction(action) {
        this.caseProcessesService.getProcessDetails(this.caseRef, this.appId, this.typeId, this.sandboxId, action, null, 100).pipe(take(1), takeUntil(this._destroyed$), tap((/**
         * @param {?} processDetails
         * @return {?}
         */
        processDetails => {
            if (!processDetails || !processDetails.process) {
                // This will be triggered when no form schema is available
                // Typically happens when:
                // 1) The form has elements that are not supported by the Live Apps API for form schemas such as participant selectors
                // 2) The Live Apps application is legacy and has no form schema at all, redeploying the live apps application would fix this.
                console.error('No schema available for this case type: The form may not be supported or you may need to update/re-deploy the live apps application');
            }
        })), map((/**
         * @param {?} processSchema
         * @return {?}
         */
        processSchema => {
            this.actionClicked.emit(processSchema);
            return processSchema;
        })))
            .subscribe(null, (/**
         * @param {?} error
         * @return {?}
         */
        error => { this.errorMessage = 'Error retrieving case actions: ' + error.error.errorMsg; }));
    }
}
LiveAppsCaseActionsListComponent.decorators = [
    { type: Component, args: [{
                selector: 'tcla-live-apps-case-actions-list',
                template: "<div fxFlex style=\"margin-left: 10px;\">\n    <mat-select class=\"tcs-action-selector-option\" [disableOptionCentering]=\"true\" [(ngModel)]=\"selectedAction\" [compareWith]=\"compareObjects\"\n        placeholder=\"Case Actions\" >\n        <mat-option *ngFor=\"let action of caseActionList\" [value]=\"action\" (click)=\"selectAction(action)\">\n            <span>{{action.name}}</span>\n        </mat-option>\n    </mat-select>\n</div>",
                styles: [":host ::ng-deep .tcs-action-selector-option .mat-select-value span{font-family:Source Sans Pro;font-size:16px;font-weight:400;font-style:normal;font-stretch:normal;line-height:1.5;letter-spacing:.3px;color:#0081cb}:host ::ng-deep .tcs-action-selector-option .mat-select-arrow-wrapper div{color:#0081cb}:host ::ng-deep .mat-select-value{min-width:100px;max-width:100%;width:auto}.tcs-actions-box{width:200px;height:44px;box-shadow:inset 0 1px 3px 0 rgba(0,0,0,.5);background-color:#fff}tcs-action-selector-option{width:170px;margin-left:5px;margin-right:5px;background-color:#eee;padding-left:20px;padding-right:20px;height:35px}.tcs-case-creation-dialog-instruction{font-family:Source Sans Pro;font-size:16px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;color:#727272}"]
            }] }
];
LiveAppsCaseActionsListComponent.propDecorators = {
    seletedActionId: [{ type: Input }]
};
if (false) {
    /**
     * The actionId selected (output)
     * @type {?}
     */
    LiveAppsCaseActionsListComponent.prototype.seletedActionId;
    /** @type {?} */
    LiveAppsCaseActionsListComponent.prototype.caseActionList;
    /** @type {?} */
    LiveAppsCaseActionsListComponent.prototype.selectedAction;
    /** @type {?} */
    LiveAppsCaseActionsListComponent.prototype.refresh;
    /** @type {?} */
    LiveAppsCaseActionsListComponent.prototype.compareObjects;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLWNhc2UtYWN0aW9ucy1saXN0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0aWJjby10Y3N0ay90Yy1saXZlYXBwcy1saWIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9saXZlLWFwcHMtY2FzZS1hY3Rpb25zLWxpc3QvbGl2ZS1hcHBzLWNhc2UtYWN0aW9ucy1saXN0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFNBQVMsRUFBVSxLQUFLLEVBQWtELE1BQU0sZUFBZSxDQUFDO0FBRXpHLE9BQU8sRUFBRSxHQUFHLEVBQUUsU0FBUyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUczRCxPQUFPLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSw0REFBNEQsQ0FBQzs7Ozs7O0FBYzFHLE1BQU0sT0FBTyxnQ0FBaUMsU0FBUSw0QkFBNEI7SUFMbEY7O1FBY1csWUFBTzs7O1FBQUcsR0FBRyxFQUFFO1lBQ2xCLDZHQUE2RztZQUM3RyxJQUFJLENBQUMsUUFBUSxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxTQUFTLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQ2pFLEdBQUc7Ozs7WUFBQyxNQUFNLENBQUMsRUFBRTtnQkFDVCwyQkFBMkI7Z0JBQzNCLE1BQU0sQ0FBQyxTQUFTLENBQUMsT0FBTzs7OztnQkFBQyxDQUFDLFFBQVEsRUFBRSxFQUFFO29CQUNsQyw4RkFBOEY7b0JBQzlGLHNDQUFzQztvQkFDdEMsSUFBSSxRQUFRLENBQUMsYUFBYSxLQUFLLElBQUksQ0FBQyxLQUFLLElBQUksUUFBUSxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsTUFBTSxFQUFFO3dCQUN0RSxJQUFJLFFBQVEsQ0FBQyxVQUFVLEtBQUssU0FBUyxFQUFFOzRCQUNuQyw0QkFBNEI7NEJBQzVCLElBQUksQ0FBQyxjQUFjLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDOzRCQUMvRCx5Q0FBeUM7NEJBQ3pDLGtEQUFrRDs0QkFDbEQsSUFBSTt5QkFDUDs2QkFBTTs0QkFDSCxPQUFPLENBQUMsS0FBSyxDQUFDLG1HQUFtRyxDQUFDLENBQUM7eUJBQ3RIO3FCQUNKO2dCQUNMLENBQUMsRUFDQSxDQUFDO1lBQ04sQ0FBQyxFQUNBLENBQ0osQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUNsQixDQUFDLEVBQUE7UUFTRCxtQkFBYzs7Ozs7UUFBRyxDQUFDLEVBQU8sRUFBRSxFQUFPLEVBQVcsRUFBRTtZQUMzQyxPQUFPLEVBQUUsQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLGVBQWUsQ0FBQztRQUMxQyxDQUFDLEVBQUE7SUF1QkwsQ0FBQzs7Ozs7SUFoQ0csV0FBVyxDQUFDLE9BQXNCO1FBQzlCLElBQUksT0FBTyxDQUFDLEtBQUssSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxLQUFLLE9BQU8sQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLEVBQUU7WUFDL0UsSUFBSSxDQUFDLGNBQWMsR0FBRyxFQUFFLENBQUM7WUFDekIsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1NBQ2xCO0lBQ0wsQ0FBQzs7Ozs7SUFNTSxZQUFZLENBQUMsTUFBa0I7UUFDbEMsSUFBSSxDQUFDLG9CQUFvQixDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLElBQUksQ0FBQyxTQUFTLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQ3RILElBQUksQ0FBQyxDQUFDLENBQUMsRUFDUCxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUMzQixHQUFHOzs7O1FBQUMsY0FBYyxDQUFDLEVBQUU7WUFDakIsSUFBSSxDQUFDLGNBQWMsSUFBSSxDQUFDLGNBQWMsQ0FBQyxPQUFPLEVBQUU7Z0JBQzVDLDBEQUEwRDtnQkFDMUQsMEJBQTBCO2dCQUMxQixzSEFBc0g7Z0JBQ3RILDhIQUE4SDtnQkFDOUgsT0FBTyxDQUFDLEtBQUssQ0FBQyxxSUFBcUksQ0FBQyxDQUFDO2FBQ3hKO1FBQ0wsQ0FBQyxFQUNBLEVBQ0QsR0FBRzs7OztRQUFDLGFBQWEsQ0FBQyxFQUFFO1lBQ2hCLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO1lBQ3ZDLE9BQU8sYUFBYSxDQUFDO1FBQ3pCLENBQUMsRUFBQyxDQUNMO2FBQ0ksU0FBUyxDQUFDLElBQUk7Ozs7UUFBRSxLQUFLLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxZQUFZLEdBQUcsaUNBQWlDLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQztJQUNySCxDQUFDOzs7WUF2RUosU0FBUyxTQUFDO2dCQUNQLFFBQVEsRUFBRSxrQ0FBa0M7Z0JBQzVDLG1jQUEyRDs7YUFFOUQ7Ozs4QkFLRSxLQUFLOzs7Ozs7O0lBQU4sMkRBQWlDOztJQUUvQiwwREFBMEI7O0lBQzFCLDBEQUF3Qjs7SUFFeEIsbURBd0JDOztJQVNELDBEQUVDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIElucHV0LCBPbkNoYW5nZXMsIFNpbXBsZUNoYW5nZXMsIE91dHB1dCwgRXZlbnRFbWl0dGVyIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBMaXZlQXBwc1NlcnZpY2UgfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9saXZlLWFwcHMuc2VydmljZSc7XG5pbXBvcnQgeyBtYXAsIHRha2VVbnRpbCwgdGFrZSwgdGFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHsgUHJvY2VzcywgQ2FzZUFjdGlvbiB9IGZyb20gJy4uLy4uL21vZGVscy9saXZlYXBwc2RhdGEnO1xuaW1wb3J0IHsgTGFQcm9jZXNzU2VsZWN0aW9uIH0gZnJvbSAnLi4vLi4vbW9kZWxzL3RjLWNhc2UtcHJvY2Vzc2VzJztcbmltcG9ydCB7IExpdmVBcHBzQ2FzZUFjdGlvbnNDb21wb25lbnQgfSBmcm9tICcuLi9saXZlLWFwcHMtY2FzZS1hY3Rpb25zL2xpdmUtYXBwcy1jYXNlLWFjdGlvbnMuY29tcG9uZW50JztcblxuXG4vKipcbiAqIFNwZWNpYWwgKG9wdGlvbiBsaXN0KSByZW5kZXJpbmcgb2YgTGl2ZUFwcHNDYXNlQWN0aW9uc0NvbXBvbmVudFxuICpcbiAqQGV4YW1wbGUgPHRjbGEtbGl2ZS1hcHBzLWNhc2UtYWN0aW9ucy1saXN0PjwvdGNsYS1saXZlLWFwcHMtY2FzZS1hY3Rpb25zLWxpc3Q+XG4gKi9cblxuQENvbXBvbmVudCh7XG4gICAgc2VsZWN0b3I6ICd0Y2xhLWxpdmUtYXBwcy1jYXNlLWFjdGlvbnMtbGlzdCcsXG4gICAgdGVtcGxhdGVVcmw6ICcuL2xpdmUtYXBwcy1jYXNlLWFjdGlvbnMtbGlzdC5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJy4vbGl2ZS1hcHBzLWNhc2UtYWN0aW9ucy1saXN0LmNvbXBvbmVudC5jc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBMaXZlQXBwc0Nhc2VBY3Rpb25zTGlzdENvbXBvbmVudCBleHRlbmRzIExpdmVBcHBzQ2FzZUFjdGlvbnNDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XG4gIC8qKlxuICAgKiBUaGUgYWN0aW9uSWQgc2VsZWN0ZWQgKG91dHB1dClcbiAgICovXG4gIEBJbnB1dCgpIHNlbGV0ZWRBY3Rpb25JZDogc3RyaW5nO1xuXG4gICAgY2FzZUFjdGlvbkxpc3Q6IFByb2Nlc3NbXTtcbiAgICBzZWxlY3RlZEFjdGlvbjogUHJvY2VzcztcblxuICAgIHB1YmxpYyByZWZyZXNoID0gKCkgPT4ge1xuICAgICAgICAvLyByZXRyaWV2ZSB0aGUgc2NoZW1hIGZvciB0aGlzIGNhc2UgdHlwZSBzbyB3ZSBjYW4gZGlzcGxheSBjYXNlIGNyZWF0b3JzIGFuZCBjYXNlIGFjdGlvbnMgZm9yIHRoaXMgY2FzZSB0eXBlXG4gICAgICAgIHRoaXMubGl2ZWFwcHMuZ2V0Q2FzZVR5cGVTY2hlbWEodGhpcy5zYW5kYm94SWQsIHRoaXMuYXBwSWQsIDEwMCkucGlwZShcbiAgICAgICAgICAgIG1hcChzY2hlbWEgPT4ge1xuICAgICAgICAgICAgICAgIC8vIHRoaXMuYXBwU2NoZW1hID0gc2NoZW1hO1xuICAgICAgICAgICAgICAgIHNjaGVtYS5jYXNldHlwZXMuZm9yRWFjaCgoY2FzZXR5cGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhlIHNjaGVtYSB3aWxsIGNvbnRhaW4gZGVmaW5pdGlvbnMgZm9yIGJvdGggdGhlICdjYXNlJyBhbmQgYW55IGRlZmluZWQgdHlwZXMgaW4gdGhhdCBjYXNlLlxuICAgICAgICAgICAgICAgICAgICAvLyBXZSB3YW50IHRoZSBzY2hlbWEgZm9yIHRoaXMgJ2Nhc2UnLlxuICAgICAgICAgICAgICAgICAgICBpZiAoY2FzZXR5cGUuYXBwbGljYXRpb25JZCA9PT0gdGhpcy5hcHBJZCAmJiBjYXNldHlwZS5pZCA9PT0gdGhpcy50eXBlSWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjYXNldHlwZS5qc29uU2NoZW1hICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzLmNhc2VUeXBlID0gY2FzZXR5cGU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYXNlQWN0aW9uTGlzdCA9IGNhc2V0eXBlLmFjdGlvbnMgPyBjYXNldHlwZS5hY3Rpb25zIDogW107XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgKHRoaXMuY2FzZUFjdGlvbkxpc3QubGVuZ3RoID09IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5zZWxlY3RQcm9jZXNzKHRoaXMuY2FzZUFjdGlvbkxpc3RbMF0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTm8gc2NoZW1hIHJldHVybmVkIGZvciB0aGlzIGNhc2UgdHlwZTogWW91IG1heSBuZWVkIHRvIHVwZGF0ZS9yZS1kZXBsb3kgdGhlIGxpdmUgYXBwcyBhcHBsaWNhdGlvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICkuc3Vic2NyaWJlKCk7XG4gICAgfVxuXG4gICAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgICAgICBpZiAoY2hhbmdlcy5hcHBJZCAmJiAoY2hhbmdlcy5hcHBJZC5jdXJyZW50VmFsdWUgIT09IGNoYW5nZXMuYXBwSWQucHJldmlvdXNWYWx1ZSkpIHtcbiAgICAgICAgICAgIHRoaXMuY2FzZUFjdGlvbkxpc3QgPSBbXTtcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29tcGFyZU9iamVjdHMgPSAobzE6IGFueSwgbzI6IGFueSk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gbzEuaWQgPT09IHRoaXMuc2VsZXRlZEFjdGlvbklkO1xuICAgIH1cblxuICAgIHB1YmxpYyBzZWxlY3RBY3Rpb24oYWN0aW9uOiBDYXNlQWN0aW9uKSB7XG4gICAgICAgIHRoaXMuY2FzZVByb2Nlc3Nlc1NlcnZpY2UuZ2V0UHJvY2Vzc0RldGFpbHModGhpcy5jYXNlUmVmLCB0aGlzLmFwcElkLCB0aGlzLnR5cGVJZCwgdGhpcy5zYW5kYm94SWQsIGFjdGlvbiwgbnVsbCwgMTAwKS5waXBlKFxuICAgICAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQkKSxcbiAgICAgICAgICAgIHRhcChwcm9jZXNzRGV0YWlscyA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKCFwcm9jZXNzRGV0YWlscyB8fCAhcHJvY2Vzc0RldGFpbHMucHJvY2Vzcykge1xuICAgICAgICAgICAgICAgICAgICAvLyBUaGlzIHdpbGwgYmUgdHJpZ2dlcmVkIHdoZW4gbm8gZm9ybSBzY2hlbWEgaXMgYXZhaWxhYmxlXG4gICAgICAgICAgICAgICAgICAgIC8vIFR5cGljYWxseSBoYXBwZW5zIHdoZW46XG4gICAgICAgICAgICAgICAgICAgIC8vIDEpIFRoZSBmb3JtIGhhcyBlbGVtZW50cyB0aGF0IGFyZSBub3Qgc3VwcG9ydGVkIGJ5IHRoZSBMaXZlIEFwcHMgQVBJIGZvciBmb3JtIHNjaGVtYXMgc3VjaCBhcyBwYXJ0aWNpcGFudCBzZWxlY3RvcnNcbiAgICAgICAgICAgICAgICAgICAgLy8gMikgVGhlIExpdmUgQXBwcyBhcHBsaWNhdGlvbiBpcyBsZWdhY3kgYW5kIGhhcyBubyBmb3JtIHNjaGVtYSBhdCBhbGwsIHJlZGVwbG95aW5nIHRoZSBsaXZlIGFwcHMgYXBwbGljYXRpb24gd291bGQgZml4IHRoaXMuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ05vIHNjaGVtYSBhdmFpbGFibGUgZm9yIHRoaXMgY2FzZSB0eXBlOiBUaGUgZm9ybSBtYXkgbm90IGJlIHN1cHBvcnRlZCBvciB5b3UgbWF5IG5lZWQgdG8gdXBkYXRlL3JlLWRlcGxveSB0aGUgbGl2ZSBhcHBzIGFwcGxpY2F0aW9uJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKSxcbiAgICAgICAgICAgIG1hcChwcm9jZXNzU2NoZW1hID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjdGlvbkNsaWNrZWQuZW1pdChwcm9jZXNzU2NoZW1hKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvY2Vzc1NjaGVtYTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUobnVsbCwgZXJyb3IgPT4geyB0aGlzLmVycm9yTWVzc2FnZSA9ICdFcnJvciByZXRyaWV2aW5nIGNhc2UgYWN0aW9uczogJyArIGVycm9yLmVycm9yLmVycm9yTXNnOyB9KTtcbiAgICB9XG59XG4iXX0=