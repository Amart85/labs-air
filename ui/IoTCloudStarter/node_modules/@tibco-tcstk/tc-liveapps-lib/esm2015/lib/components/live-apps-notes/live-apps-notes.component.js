/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input } from '@angular/core';
import { LiveAppsService } from '../../services/live-apps.service';
import { take, takeUntil } from 'rxjs/operators';
import { LiveAppsComponent } from '../live-apps-component/live-apps-component.component';
import { TcButtonsHelperService } from '@tibco-tcstk/tc-core-lib';
/**
 * This Component allows to list, and add Notes to a Case-Instance or other Context e.g. a whole Application.
 * Any Note can have Sub-Notes to allow real collaboration.
 *
 * Note that since this component uses a virtual scroll the parent container must have height set or the notes won't appear
 *
 * ![alt-text](../live-apps-notes.png "Notes Component Image")
 *
 * \@example <tcla-live-apps-notes></tcla-live-apps-notes>
 */
export class LiveAppsNotesComponent extends LiveAppsComponent {
    /**
     * @param {?} liveapps
     * @param {?} buttonsHelper
     */
    constructor(liveapps, buttonsHelper) {
        super();
        this.liveapps = liveapps;
        this.buttonsHelper = buttonsHelper;
        /**
         * Whether to show the header bar in the widget - eg. favorites on home page (contains icon etc) - if off icons still appear without bar
         */
        this.showHeader = this.showHeader ? this.showHeader : true;
        this.newNote = {};
        this.skip = 0;
        this.top = 20;
        this.end = false;
        this.toolbarButtons = [];
        this.refresh = (/**
         * @return {?}
         */
        () => {
            this.skip = 0;
            this.top = 20;
            this.end = false;
            if (this.threads && this.threads.threads) {
                this.threads.threads.length = 0;
            }
            this.getBatch();
            this.getNotifications();
        });
        this.getBatch = (/**
         * @return {?}
         */
        () => {
            if (!this.end) {
                this.liveapps.getThreads(this.relatedItemType, this.relatedItemId, this.skip, this.top)
                    .pipe(take(1), takeUntil(this._destroyed$)).subscribe((/**
                 * @param {?} threadList
                 * @return {?}
                 */
                threadList => {
                    if (!this.threads) {
                        this.threads = threadList;
                    }
                    else {
                        // this will strip any duplicates that may have been retrieved due to fast scrolling
                        /** @type {?} */
                        const filteredEvents = threadList.threads.filter((/**
                         * @param {?} x
                         * @return {?}
                         */
                        x => this.threads.threads.every((/**
                         * @param {?} y
                         * @return {?}
                         */
                        y => y.note.id !== x.note.id))));
                        this.threads.threads = this.threads.threads.concat(filteredEvents);
                    }
                    if (threadList.threads.length < this.top) {
                        this.end = true;
                    }
                    else {
                        this.skip = this.skip + threadList.threads.length - 1;
                    }
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                error => {
                    this.errorMessage = 'Error retrieving notes: ' + error.error.errorMsg;
                }));
            }
        });
        this.toggleReplies = (/**
         * @param {?} thread
         * @return {?}
         */
        (thread) => {
            thread.showReplies = !thread.showReplies;
        });
        this.toggleNewReply = (/**
         * @param {?} thread
         * @return {?}
         */
        (thread) => {
            if (!thread.newReply) {
                thread.newReply = {};
            }
            if (thread.showReplies && !thread.showNewReply) {
                thread.newReply = {};
                thread.showNewReply = true;
            }
            else {
                thread.showNewReply = !thread.showNewReply;
                thread.showReplies = !thread.showReplies;
            }
        });
        this.createReply = (/**
         * @param {?} thread
         * @param {?} replyText
         * @return {?}
         */
        (thread, replyText) => {
            this.liveapps.createReplyNote(thread.note, replyText, thread.note.id)
                .pipe(take(1), takeUntil(this._destroyed$))
                .subscribe((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                this.newNoteId = result;
                thread.newReply.text = undefined;
                this.refresh();
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
        });
        this.createThread = (/**
         * @param {?} noteText
         * @return {?}
         */
        (noteText) => {
            if (noteText !== undefined) {
                this.liveapps.createNote(this.relatedItemType, 'RT_CASE', this.relatedItemId, 'comments update', '', '', noteText)
                    .pipe(take(1), takeUntil(this._destroyed$))
                    .subscribe((/**
                 * @param {?} result
                 * @return {?}
                 */
                result => {
                    this.newNoteId = result;
                    this.newNote.text = undefined;
                    this.refresh();
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
            }
        });
        this.createToolbarButtons = (/**
         * @param {?} subscribed
         * @return {?}
         */
        (subscribed) => {
            /** @type {?} */
            const subscribeButton = this.buttonsHelper.createButton('subscribe', 'tcs-collaboration-unsubscribed', true, 'Enable Notifications', !subscribed, !subscribed);
            /** @type {?} */
            const unSubscribeButton = this.buttonsHelper.createButton('unsubscribe', 'tcs-collaboration-subscribed', true, 'Disable Notifications', subscribed, subscribed);
            /** @type {?} */
            const buttons = [subscribeButton, unSubscribeButton];
            return buttons;
        });
        this.setupNotificationButtons = (/**
         * @param {?} subscribed
         * @return {?}
         */
        (subscribed) => {
            /** @type {?} */
            const buttons = this.createToolbarButtons(subscribed);
            this.buttonsHelper.updateButtons(buttons, this.toolbarButtons);
        });
        this.updateButtonDef = (/**
         * @param {?} updatedToolbarButtons
         * @return {?}
         */
        (updatedToolbarButtons) => {
            updatedToolbarButtons.forEach((/**
             * @param {?} updatedButton
             * @return {?}
             */
            updatedButton => {
                /** @type {?} */
                const idx = this.toolbarButtons.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item.id === updatedButton.id));
                this.toolbarButtons[idx] = updatedButton;
            }));
        });
        this.handleToolbarButtonEvent = (/**
         * @param {?} id
         * @return {?}
         */
        (id) => {
            if (id === 'subscribe') {
                this.subscribe();
            }
            else if (id === 'unsubscribe') {
                this.unsubscribe();
            }
        });
        this.recreateButtonsForNotifications = (/**
         * @param {?} subscribed
         * @return {?}
         */
        (subscribed) => {
            /** @type {?} */
            const buttons = this.createToolbarButtons(subscribed);
            this.buttonsHelper.updateButtons(buttons, this.toolbarButtons);
        });
        this.getNotifications = (/**
         * @return {?}
         */
        () => {
            this.liveapps.getNotifications(this.relatedItemType, this.relatedItemId, this.userId)
                .pipe(take(1), takeUntil(this._destroyed$))
                .subscribe((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                /** @type {?} */
                const notificationList = result;
                if (notificationList.notifications.length > 0) {
                    this.subscribed = true;
                    this.setupNotificationButtons(true);
                }
                else {
                    this.subscribed = false;
                    this.setupNotificationButtons(false);
                }
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
        });
        this.subscribe = (/**
         * @return {?}
         */
        () => {
            this.liveapps.subscribeToNotes(this.relatedItemType, this.relatedItemId)
                .pipe(take(1), takeUntil(this._destroyed$))
                .subscribe((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                if (result) {
                    this.subscribed = true;
                    this.recreateButtonsForNotifications(true);
                }
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
        });
        this.unsubscribe = (/**
         * @return {?}
         */
        () => {
            this.liveapps.unsubscribeToNotes(this.relatedItemType, this.relatedItemId, this.userId)
                .pipe(take(1), takeUntil(this._destroyed$))
                .subscribe((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                this.subscribed = false;
                this.recreateButtonsForNotifications(false);
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
        });
        this.editNote = (/**
         * @param {?} thread
         * @return {?}
         */
        (thread) => {
            thread.editMode = !thread.editMode;
        });
        this.updateNote = (/**
         * @param {?} note
         * @param {?} updatedText
         * @return {?}
         */
        (note, updatedText) => {
            console.log('Updating note');
            note.text = updatedText;
            this.liveapps.updateNote(note, note.id)
                .pipe(take(1), takeUntil(this._destroyed$))
                .subscribe((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                console.log('Note updated');
                this.refresh();
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error updating note: ' + error.error.errorMessage));
        });
        this.deleteNote = (/**
         * @param {?} id
         * @return {?}
         */
        (id) => {
            console.log('Deleting note');
            this.liveapps.deleteNote(id)
                .pipe(take(1), takeUntil(this._destroyed$))
                .subscribe((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                console.log('Note deleted: ' + result);
                this.refresh();
            }), (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
        });
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        // this.refresh();
        this.newNote.text = '';
    }
}
LiveAppsNotesComponent.decorators = [
    { type: Component, args: [{
                selector: 'tcla-live-apps-notes',
                template: "<div class=\"tcs-notes-pane\" fxLayout=\"column\" fxFill style=\"overflow: hidden;\">\n  <tc-tibco-cloud-widget-header fxFlex=\"nogrow\" [headerText]=\"'Notes'\" [icon]=\"'tcs-collaboration-feed'\"\n                                [toolbarButtons]=\"toolbarButtons\" [showHeader]=\"showHeader\"\n                                (toolbarButtonEvent)=\"handleToolbarButtonEvent($event)\"></tc-tibco-cloud-widget-header>\n  <div class=\"tcs-collaboration-pane\" fxLayout=\"column\" fxFlex=\"grow\" style=\"\">\n    <div class=\"tcs-collaboration-existing-threads\" fxLayout=\"column\" fxFlex>\n      <!--div *ngIf=\"threads && threads.threads.length > 0\"-->\n      <div style=\"height: 100%;\">\n        <cdk-virtual-scroll-viewport style=\"height: 100%\" itemSize=\"50\" (scrolledIndexChange)=\"getBatch()\">\n\n          <!--div class=\"tcs-collaboration-detail-box tcs-collaboration-thread\" [ngClass]=\"{ editing: thread.editMode }\" *ngFor=\"let thread of threads.threads | reverse\" fxLayout=\"column\"-->\n          <div *ngIf=\"threads && threads.threads\">\n            <div class=\"tcs-collaboration-detail-box tcs-collaboration-thread\" [ngClass]=\"{ editing: thread.editMode }\"\n                 *cdkVirtualFor=\"let thread of threads.threads\" fxLayout=\"column\">\n              <div class=\"tcs-thread-box\">\n                <!-- collaboration threads -->\n                <div class=\"tcs-collaboration-entry\">\n                  <div *ngIf=\"!thread.editMode\">\n                    <div fxLayout=\"row\" fxLayoutAlign=\"space-between start\">\n                      <span class=\"tcs-collaboration-thread-author\">{{thread.note.createdByName}}</span>\n                      <div fxLayoutAlign=\"row\">\n                      <span *ngIf=\"thread.note.modifiedDate > thread.note.createdDate\" class=\"tcs-collaboration-edited\">Edited\n                      </span>\n                        <span class=\"tcs-collaboration-thread-date\">{{thread.note.modifiedDate | durationSince}}</span>\n                      </div>\n                    </div>\n                    <span class=\"tcs-collaboration-thread-text\" matTooltip=\"{{thread.note.text}}\"\n                          matTooltipShowDelay=\"1000\"\n                          matTooltipPosition=\"below\">{{thread.note.text | ellipsis: 70}}</span>\n                  </div>\n                  <tcla-live-apps-notes-editor *ngIf=\"thread.editMode\" [noteText]=\"thread.note.text\"\n                                               (noteSubmitted)=\"updateNote(thread.note, $event)\"></tcla-live-apps-notes-editor>\n                </div>\n                <div class=\"tcs-icon-row\" fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                  <div class=\"tcs-collaboration-thread-icon-left\">\n                    <mat-icon (click)=\"deleteNote(thread.note.id)\"\n                              class=\"tcs-icon tcs-icon-active tcs-collaboration-edit-buttons tcs-collaboration-delete-icon\"\n                              svgIcon=\"tcs-collaboration-delete\"></mat-icon>\n                    <mat-icon (click)=\"editNote(thread)\"\n                              class=\"tcs-icon tcs-icon-active tcs-collaboration-edit-buttons tcs-collaboration-edit-icon\"\n                              svgIcon=\"tcs-collaboration-edit\"></mat-icon>\n                  </div>\n                  <div class=\"tcs-collaboration-thread-icon-right\" fxLayoutAlign=\"end center\" fxLayoutGap=\"8px\">\n                    <span *ngIf=\"thread.note.thread.totalCount > 1\" class=\"tcs-collaboration-thread-replies\"\n                          (click)=\"toggleReplies(thread)\">{{thread.note.thread.totalCount - 1}} replies</span>\n                    <mat-icon (click)=\"toggleNewReply(thread)\" class=\"tcs-icon tcs-collaboration-reply-icon\"\n                              svgIcon=\"tcs-collaboration-reply\"></mat-icon>\n                  </div>\n                </div>\n              </div>\n              <div class=\"tcs-collaboration-line\"></div>\n              <!-- replies -->\n              <div class=\"tcs-collaboration-reply-box\" *ngIf=\"thread.showReplies\">\n                <div fxLayout=\"column\">\n                  <tcla-live-apps-notes-editor class=\"tcs-collaboration-new-reply-component\" *ngIf=\"thread.showNewReply\"\n                                               [isReply]=\"true\" [noteText]=\"thread.newReply.text\"\n                                               (noteSubmitted)=\"createReply(thread, $event)\"></tcla-live-apps-notes-editor>\n                  <div class=\"tcs-collaboration-line\"></div>\n                </div>\n                <div class=\"tcs-collaboration-detail-box tcs-collaboration-reply\"\n                     [ngClass]=\"{ editing: reply.editMode }\" *ngFor=\"let reply of thread.thread | reverse\"\n                     fxLayout=\"column\">\n                  <div class=\"tcs-thread-box\" fxLayout=\"row\">\n                    <mat-icon class=\"tcs-icon tcs-collaboration-reply-item-icon\"\n                              svgIcon=\"tcs-collaboration-reply\"></mat-icon>\n                    <div fxLayout=\"column\" class=\"tcs-collaboration-reply-details\">\n                      <div class=\"tcs-collaboration-entry\">\n                        <div *ngIf=\"!reply.editMode\">\n                          <div fxLayout=\"row\" fxLayoutAlign=\"space-between start\">\n                            <span class=\"tcs-collaboration-thread-author\">{{reply.createdByName}}</span>\n                            <span class=\"tcs-collaboration-thread-date\">{{reply.modifiedDate | durationSince}}</span>\n                          </div>\n                          <span class=\"tcs-collaboration-thread-text\" matTooltip=\"{{reply.text}}\"\n                                matTooltipShowDelay=\"1000\"\n                                matTooltipPosition=\"below\">{{reply.text | ellipsis: 60}}</span>\n                        </div>\n                        <tcla-live-apps-notes-editor *ngIf=\"reply.editMode\" [noteText]=\"reply.text\"\n                                                     (noteSubmitted)=\"updateNote(reply, $event)\"></tcla-live-apps-notes-editor>\n                      </div>\n                      <div class=\"tcs-icon-row\" fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                        <div class=\"tcs-collaboration-thread-icon-left\">\n                          <mat-icon (click)=\"deleteNote(reply.id)\"\n                                    class=\"tcs-icon tcs-icon-active tcs-collaboration-edit-buttons tcs-collaboration-delete-icon\"\n                                    svgIcon=\"tcs-collaboration-delete\"></mat-icon>\n                          <mat-icon (click)=\"editNote(reply)\"\n                                    class=\"tcs-icon tcs-icon-active tcs-collaboration-edit-buttons tcs-collaboration-edit-icon\"\n                                    svgIcon=\"tcs-collaboration-edit\"></mat-icon>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"tcs-collaboration-reply-line\"></div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div *ngIf=\"!(threads?.threads?.length > 0)\" fxLayout=\"row\" fxLayoutAlign=\"center start\" fxLayoutGap=\"10px\"\n               style=\"margin-top: 20px;\">\n            <mat-icon [svgIcon]=\"'ic-no-notes-icon'\" style=\"height: 48px; width: 48px;\"></mat-icon>\n            <div style=\"height: 100%\" fxLayout=\"row\" fxLayoutAlign=\"start center\">\n              <span class=\"tcs-no-item-text\">No notes found</span>\n            </div>\n          </div>\n        </cdk-virtual-scroll-viewport>\n      </div>\n    </div>\n    <tcla-live-apps-notes-editor class=\"tcs-collaboration-new-note-component\" [noteText]=\"newNote.text\"\n                                 (noteSubmitted)=\"createThread($event)\"></tcla-live-apps-notes-editor>\n  </div>\n</div>\n",
                styles: [".tcs-notes-pane{border-radius:3px;box-shadow:0 2px 4px 0 rgba(0,0,0,.33);background-color:#fff}.tcs-collaboration-pane{padding-top:10px}.tcs-collaboration-header{min-height:40px;height:40px;border-radius:3px 3px 0 0;box-shadow:0 1px 2px 0 #dedede;padding-left:20px;padding-right:20px}.tcs-collaboration-header-text{margin-left:10px;font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:1.5;letter-spacing:.3px}.tcs-collaboration-thread-icon-left{height:24px;width:50px}.tcs-collaboration-existing-threads{overflow-y:auto}.tcs-collaboration-detail-box{min-height:85px;flex-shrink:0}.tcs-collaboration-detail-box.editing{min-height:109px}.tcs-collaboration-detail-box.editing>.tcs-thread-box{height:110px;background-color:#eef0f7}.tcs-collaboration-new-reply-box{-webkit-transition:background-color .5s;transition:background-color .5s;background-color:#eef0f7;margin-left:20px;padding-right:20px}.tcs-collaboration-detail-box.tcs-collaboration-reply.editing{min-height:100px}.tcs-collaboration-reply{padding-left:20px}.tcs-thread-box{height:86px}.tcs-thread-box:hover{background-color:#eef0f7;-webkit-transition:background-color .5s;transition:background-color .5s}.tcs-thread-box:hover .tcs-icon.tcs-icon-active{display:inline-block}.tcs-thread-box .tcs-icon.tcs-icon-active{display:none}.tcs-collaboration-entry{padding:10px 20px}.tcs-icon-row{padding-left:20px;padding-right:20px;padding-bottom:5px}.tcs-collaboration-thread-author{font-size:14px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px}.tcs-collaboration-thread-text{font-size:11px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px}.tcs-collaboration-thread-date{font-size:10px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#b6b6b6}.tcs-collaboration-edited{font-size:10px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#ef5350;padding-right:4px}.tcs-collaboration-reply-icon{-webkit-transform:scale(-1,1);transform:scale(-1,1)}.tcs-collaboration-reply-item-icon{-webkit-transform:scale(1,-1);transform:scale(1,-1);margin-top:10px}.tcs-collaboration-reply-details{width:100%}.tcs-collaboration-thread-replies{font-size:12px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#0081cb}.tcs-icon{height:20px;width:20px}:host ::ng-deep .tcs-icon.tcs-collaboration-edit-buttons:hover path.svg-content{fill:#0081cb;cursor:pointer}:host ::ng-deep .tcs-icon.tcs-collaboration-edit-buttons:hover g.svg-content{fill:#0081cb;cursor:pointer}.tcs-icon.tcs-collaboration-edit-icon{margin-left:5px}.tcs-icon.tcs-collaboration-send-icon{height:24px;width:24px;margin-left:12px}:host ::ng-deep .tcs-icon.tcs-collaboration-send-icon:hover path.svg-content{fill:#0081cb}.tcs-collaboration-line{padding:0;margin:0 20px;border-bottom:1.1px solid #f4f4f4}.tcs-collaboration-reply-line{padding:0;margin-top:0;margin-right:20px;margin-bottom:0;border-bottom:1.1px solid #f4f4f4}.tcs-collaboration-new-thread{margin-left:20px;margin-right:20px;max-height:85px;height:85px;min-height:85px}.tcs-collaboration-edit-thread{margin-top:10px}.tcs-collaboration-new-reply{margin:10px 20px}.tcs-collaboration-input{height:55px;max-width:100%;border-color:#d5e6ff;font-size:11px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#b6b6b6;resize:none;border-radius:3px}.tcs-collaboration-reply-textbox{height:55px;max-width:100%;border-color:#d5e6ff;font-size:11px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#b6b6b6;resize:none;border-radius:3px;margin-top:20px;margin-bottom:20px}.tcs-collaboration-edit{height:55px;max-width:100%;border-color:#d5e6ff;font-size:11px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#b6b6b6;resize:none;border-radius:3px}.tcs-collaboration-new-thread-form{max-width:90%;max-height:100%}.tcs-collaboration-new-note-component,.tcs-collaboration-new-reply-component{height:85px;min-height:85px;max-height:85px;margin-left:20px;margin-right:20px}.tcs-no-item-text{font-family:Source Sans Pro;font-size:16px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;color:#b6b6b6}"]
            }] }
];
/** @nocollapse */
LiveAppsNotesComponent.ctorParameters = () => [
    { type: LiveAppsService },
    { type: TcButtonsHelperService }
];
LiveAppsNotesComponent.propDecorators = {
    relatedItemType: [{ type: Input }],
    relatedItemId: [{ type: Input }],
    userId: [{ type: Input }],
    showHeader: [{ type: Input }]
};
if (false) {
    /**
     * itemType for notes collection
     * @type {?}
     */
    LiveAppsNotesComponent.prototype.relatedItemType;
    /**
     * itemId for notes collection
     * @type {?}
     */
    LiveAppsNotesComponent.prototype.relatedItemId;
    /**
     * The ID of the logged user
     * @type {?}
     */
    LiveAppsNotesComponent.prototype.userId;
    /**
     * Whether to show the header bar in the widget - eg. favorites on home page (contains icon etc) - if off icons still appear without bar
     * @type {?}
     */
    LiveAppsNotesComponent.prototype.showHeader;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.notes;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.errorMessage;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.newNote;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.newNoteId;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.delNoteId;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.threads;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.subscribed;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.skip;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.top;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.end;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.toolbarButtons;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.refresh;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.getBatch;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.toggleReplies;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.toggleNewReply;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.createReply;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.createThread;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsNotesComponent.prototype.createToolbarButtons;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.setupNotificationButtons;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.updateButtonDef;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.handleToolbarButtonEvent;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.recreateButtonsForNotifications;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.getNotifications;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.subscribe;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.unsubscribe;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.editNote;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.updateNote;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.deleteNote;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsNotesComponent.prototype.liveapps;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsNotesComponent.prototype.buttonsHelper;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLW5vdGVzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0aWJjby10Y3N0ay90Yy1saXZlYXBwcy1saWIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9saXZlLWFwcHMtbm90ZXMvbGl2ZS1hcHBzLW5vdGVzLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQW9CLE1BQU0sZUFBZSxDQUFDO0FBRWxFLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxrQ0FBa0MsQ0FBQztBQUNqRSxPQUFPLEVBQU0sSUFBSSxFQUFFLFNBQVMsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBRXBELE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLHNEQUFzRCxDQUFDO0FBRXZGLE9BQU8sRUFBQyxzQkFBc0IsRUFBQyxNQUFNLDBCQUEwQixDQUFDOzs7Ozs7Ozs7OztBQW1CaEUsTUFBTSxPQUFPLHNCQUF1QixTQUFRLGlCQUFpQjs7Ozs7SUFpQzNELFlBQXNCLFFBQXlCLEVBQVksYUFBcUM7UUFDOUYsS0FBSyxFQUFFLENBQUM7UUFEWSxhQUFRLEdBQVIsUUFBUSxDQUFpQjtRQUFZLGtCQUFhLEdBQWIsYUFBYSxDQUF3Qjs7OztRQWR2RixlQUFVLEdBQVksSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO1FBSWpFLFlBQU8sR0FBUSxFQUFFLENBQUM7UUFLbEIsU0FBSSxHQUFHLENBQUMsQ0FBQztRQUNULFFBQUcsR0FBRyxFQUFFLENBQUM7UUFDVCxRQUFHLEdBQUcsS0FBSyxDQUFDO1FBQ1osbUJBQWMsR0FBb0IsRUFBRSxDQUFDO1FBTXJDLFlBQU87OztRQUFHLEdBQUcsRUFBRTtZQUNwQixJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQztZQUNkLElBQUksQ0FBQyxHQUFHLEdBQUcs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VUM7O0lBRUQsMENBRUM7O0lBRUQsNENBWUM7O0lBRUQsNENBV0M7Ozs7O0lBbE1XLDBDQUFtQzs7Ozs7SUFBRSwrQ0FBK0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NvbXBvbmVudCwgSW5wdXQsIE9uRGVzdHJveSwgT25Jbml0fSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7U3ViamVjdH0gZnJvbSAncnhqcyc7XG5pbXBvcnQge0xpdmVBcHBzU2VydmljZX0gZnJvbSAnLi4vLi4vc2VydmljZXMvbGl2ZS1hcHBzLnNlcnZpY2UnO1xuaW1wb3J0IHttYXAsIHRha2UsIHRha2VVbnRpbH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHtOb3RlLCBOb3RlVGhyZWFkLCBOb3RpZmljYXRpb25MaXN0LCBUaHJlYWRMaXN0fSBmcm9tICcuLi8uLi9tb2RlbHMvbGl2ZWFwcHNkYXRhJztcbmltcG9ydCB7TGl2ZUFwcHNDb21wb25lbnR9IGZyb20gJy4uL2xpdmUtYXBwcy1jb21wb25lbnQvbGl2ZS1hcHBzLWNvbXBvbmVudC5jb21wb25lbnQnO1xuaW1wb3J0IHtUb29sYmFyQnV0dG9ufSBmcm9tICdAdGliY28tdGNzdGsvdGMtY29yZS1saWInO1xuaW1wb3J0IHtUY0J1dHRvbnNIZWxwZXJTZXJ2aWNlfSBmcm9tICdAdGliY28tdGNzdGsvdGMtY29yZS1saWInO1xuXG5cbi8qKlxuICogVGhpcyBDb21wb25lbnQgYWxsb3dzIHRvIGxpc3QsIGFuZCBhZGQgTm90ZXMgdG8gYSBDYXNlLUluc3RhbmNlIG9yIG90aGVyIENvbnRleHQgZS5nLiBhIHdob2xlIEFwcGxpY2F0aW9uLlxuICogQW55IE5vdGUgY2FuIGhhdmUgU3ViLU5vdGVzIHRvIGFsbG93IHJlYWwgY29sbGFib3JhdGlvbi5cbiAqXG4gKiBOb3RlIHRoYXQgc2luY2UgdGhpcyBjb21wb25lbnQgdXNlcyBhIHZpcnR1YWwgc2Nyb2xsIHRoZSBwYXJlbnQgY29udGFpbmVyIG11c3QgaGF2ZSBoZWlnaHQgc2V0IG9yIHRoZSBub3RlcyB3b24ndCBhcHBlYXJcbiAqXG4gKiAhW2FsdC10ZXh0XSguLi9saXZlLWFwcHMtbm90ZXMucG5nIFwiTm90ZXMgQ29tcG9uZW50IEltYWdlXCIpXG4gKlxuICpAZXhhbXBsZSA8dGNsYS1saXZlLWFwcHMtbm90ZXM+PC90Y2xhLWxpdmUtYXBwcy1ub3Rlcz5cbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGNsYS1saXZlLWFwcHMtbm90ZXMnLFxuICB0ZW1wbGF0ZVVybDogJy4vbGl2ZS1hcHBzLW5vdGVzLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vbGl2ZS1hcHBzLW5vdGVzLmNvbXBvbmVudC5jc3MnXVxufSlcblxuZXhwb3J0IGNsYXNzIExpdmVBcHBzTm90ZXNDb21wb25lbnQgZXh0ZW5kcyBMaXZlQXBwc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIC8qKlxuICAgKiBpdGVtVHlwZSBmb3Igbm90ZXMgY29sbGVjdGlvblxuICAgKi9cbiAgQElucHV0KCkgcmVsYXRlZEl0ZW1UeXBlOiBzdHJpbmc7IC8vIHVzZSAnQ0FTRV9BUFAnIHRvIHNoYXJlIG5vdGVzIHdpdGggY2FzZSBtYW5hZ2VyXG5cbiAgLyoqXG4gICAqIGl0ZW1JZCBmb3Igbm90ZXMgY29sbGVjdGlvblxuICAgKi9cbiAgQElucHV0KCkgcmVsYXRlZEl0ZW1JZDogc3RyaW5nOyAvLyAnY2FzZVJlZicgZm9yIGNhc2UgcmVsYXRlZFxuXG4gIC8qKlxuICAgKiBUaGUgSUQgb2YgdGhlIGxvZ2dlZCB1c2VyXG4gICAqL1xuICBASW5wdXQoKSB1c2VySWQ6IHN0cmluZztcblxuICAvKipcbiAgICogV2hldGhlciB0byBzaG93IHRoZSBoZWFkZXIgYmFyIGluIHRoZSB3aWRnZXQgLSBlZy4gZmF2b3JpdGVzIG9uIGhvbWUgcGFnZSAoY29udGFpbnMgaWNvbiBldGMpIC0gaWYgb2ZmIGljb25zIHN0aWxsIGFwcGVhciB3aXRob3V0IGJhclxuICAgKi9cbiAgQElucHV0KCkgc2hvd0hlYWRlcjogYm9vbGVhbiA9IHRoaXMuc2hvd0hlYWRlciA/IHRoaXMuc2hvd0hlYWRlciA6IHRydWU7XG5cbiAgcHVibGljIG5vdGVzOiBOb3RlW107XG4gIHB1YmxpYyBlcnJvck1lc3NhZ2U6IHN0cmluZztcbiAgcHVibGljIG5ld05vdGU6IGFueSA9IHt9O1xuICBwdWJsaWMgbmV3Tm90ZUlkOiBudW1iZXI7XG4gIHB1YmxpYyBkZWxOb3RlSWQ6IG51bWJlcjtcbiAgcHVibGljIHRocmVhZHM6IFRocmVhZExpc3Q7XG4gIHB1YmxpYyBzdWJzY3JpYmVkOiBCb29sZWFuO1xuICBwdWJsaWMgc2tpcCA9IDA7XG4gIHB1YmxpYyB0b3AgPSAyMDtcbiAgcHVibGljIGVuZCA9IGZhbHNlO1xuICBwdWJsaWMgdG9vbGJhckJ1dHRvbnM6IFRvb2xiYXJCdXR0b25bXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBsaXZlYXBwczogTGl2ZUFwcHNTZXJ2aWNlLCBwcm90ZWN0ZWQgYnV0dG9uc0hlbHBlcjogVGNCdXR0b25zSGVscGVyU2VydmljZSkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBwdWJsaWMgcmVmcmVzaCA9ICgpID0+IHtcbiAgICB0aGlzLnNraXAgPSAwO1xuICAgIHRoaXMudG9wID0gMjA7XG4gICAgdGhpcy5lbmQgPSBmYWxzZTtcbiAgICBpZiAodGhpcy50aHJlYWRzICYmIHRoaXMudGhyZWFkcy50aHJlYWRzKSB7XG4gICAgICB0aGlzLnRocmVhZHMudGhyZWFkcy5sZW5ndGggPSAwO1xuICAgIH1cbiAgICB0aGlzLmdldEJhdGNoKCk7XG4gICAgdGhpcy5nZXROb3RpZmljYXRpb25zKCk7XG4gIH1cblxuICBwdWJsaWMgZ2V0QmF0Y2ggPSAoKSA9PiB7XG4gICAgaWYgKCF0aGlzLmVuZCkge1xuICAgICAgdGhpcy5saXZlYXBwcy5nZXRUaHJlYWRzKHRoaXMucmVsYXRlZEl0ZW1UeXBlLCB0aGlzLnJlbGF0ZWRJdGVtSWQsIHRoaXMuc2tpcCwgdGhpcy50b3ApXG4gICAgICAgIC5waXBlKFxuICAgICAgICAgIHRha2UoMSksXG4gICAgICAgICAgdGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3llZCQpXG4gICAgICAgICkuc3Vic2NyaWJlKHRocmVhZExpc3QgPT4ge1xuICAgICAgICBpZiAoIXRoaXMudGhyZWFkcykge1xuICAgICAgICAgIHRoaXMudGhyZWFkcyA9IHRocmVhZExpc3Q7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gdGhpcyB3aWxsIHN0cmlwIGFueSBkdXBsaWNhdGVzIHRoYXQgbWF5IGhhdmUgYmVlbiByZXRyaWV2ZWQgZHVlIHRvIGZhc3Qgc2Nyb2xsaW5nXG4gICAgICAgICAgY29uc3QgZmlsdGVyZWRFdmVudHMgPSB0aHJlYWRMaXN0LnRocmVhZHMuZmlsdGVyKHggPT4gdGhpcy50aHJlYWRzLnRocmVhZHMuZXZlcnkoeSA9PiB5Lm5vdGUuaWQgIT09IHgubm90ZS5pZCkpO1xuICAgICAgICAgIHRoaXMudGhyZWFkcy50aHJlYWRzID0gdGhpcy50aHJlYWRzLnRocmVhZHMuY29uY2F0KGZpbHRlcmVkRXZlbnRzKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhyZWFkTGlzdC50aHJlYWRzLmxlbmd0aCA8IHRoaXMudG9wKSB7XG4gICAgICAgICAgdGhpcy5lbmQgPSB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMuc2tpcCA9IHRoaXMuc2tpcCArIHRocmVhZExpc3QudGhyZWFkcy5sZW5ndGggLSAxO1xuICAgICAgICB9XG4gICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gJ0Vycm9yIHJldHJpZXZpbmcgbm90ZXM6ICcgKyBlcnJvci5lcnJvci5lcnJvck1zZztcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyB0b2dnbGVSZXBsaWVzID0gKHRocmVhZCkgPT4ge1xuICAgIHRocmVhZC5zaG93UmVwbGllcyA9ICF0aHJlYWQuc2hvd1JlcGxpZXM7XG4gIH1cblxuICBwdWJsaWMgdG9nZ2xlTmV3UmVwbHkgPSAodGhyZWFkKSA9PiB7XG4gICAgaWYgKCF0aHJlYWQubmV3UmVwbHkpIHtcbiAgICAgIHRocmVhZC5uZXdSZXBseSA9IHt9O1xuICAgIH1cbiAgICBpZiAodGhyZWFkLnNob3dSZXBsaWVzICYmICF0aHJlYWQuc2hvd05ld1JlcGx5KSB7XG4gICAgICB0aHJlYWQubmV3UmVwbHkgPSB7fTtcbiAgICAgIHRocmVhZC5zaG93TmV3UmVwbHkgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJlYWQuc2hvd05ld1JlcGx5ID0gIXRocmVhZC5zaG93TmV3UmVwbHk7XG4gICAgICB0aHJlYWQuc2hvd1JlcGxpZXMgPSAhdGhyZWFkLnNob3dSZXBsaWVzO1xuICAgIH1cblxuICB9XG5cbiAgcHVibGljIGNyZWF0ZVJlcGx5ID0gKHRocmVhZCwgcmVwbHlUZXh0KSA9PiB7XG4gICAgdGhpcy5saXZlYXBwcy5jcmVhdGVSZXBseU5vdGUodGhyZWFkLm5vdGUsIHJlcGx5VGV4dCwgdGhyZWFkLm5vdGUuaWQpXG4gICAgICAucGlwZShcbiAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3llZCQpXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKHJlc3VsdCA9PiB7XG4gICAgICAgIHRoaXMubmV3Tm90ZUlkID0gcmVzdWx0O1xuICAgICAgICB0aHJlYWQubmV3UmVwbHkudGV4dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICB9LCBlcnJvciA9PiB0aGlzLmVycm9yTWVzc2FnZSA9ICdFcnJvciBjcmVhdGluZyBuZXcgbm90ZTogJyArIGVycm9yLmVycm9yLmVycm9yTWVzc2FnZSk7XG4gIH1cblxuICBwdWJsaWMgY3JlYXRlVGhyZWFkID0gKG5vdGVUZXh0KSA9PiB7XG4gICAgaWYgKG5vdGVUZXh0ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMubGl2ZWFwcHMuY3JlYXRlTm90ZSh0aGlzLnJlbGF0ZWRJdGVtVHlwZSwgJ1JUX0NBU0UnLCB0aGlzLnJlbGF0ZWRJdGVtSWQsICdjb21tZW50cyB1cGRhdGUnLCAnJywgJycsIG5vdGVUZXh0KVxuICAgICAgICAucGlwZShcbiAgICAgICAgICB0YWtlKDEpLFxuICAgICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQkKVxuICAgICAgICApXG4gICAgICAgIC5zdWJzY3JpYmUocmVzdWx0ID0+IHtcbiAgICAgICAgICB0aGlzLm5ld05vdGVJZCA9IHJlc3VsdDtcbiAgICAgICAgICB0aGlzLm5ld05vdGUudGV4dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgfSwgZXJyb3IgPT4gdGhpcy5lcnJvck1lc3NhZ2UgPSAnRXJyb3IgY3JlYXRpbmcgbmV3IG5vdGU6ICcgKyBlcnJvci5lcnJvci5lcnJvck1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuXG5cbiAgcHJvdGVjdGVkIGNyZWF0ZVRvb2xiYXJCdXR0b25zID0gKHN1YnNjcmliZWQpOiBUb29sYmFyQnV0dG9uW10gPT4ge1xuICAgIGNvbnN0IHN1YnNjcmliZUJ1dHRvbjogVG9vbGJhckJ1dHRvbiA9IHRoaXMuYnV0dG9uc0hlbHBlci5jcmVhdGVCdXR0b24oXG4gICAgICAnc3Vic2NyaWJlJywgJ3Rjcy1jb2xsYWJvcmF0aW9uLXVuc3Vic2NyaWJlZCcsIHRydWUsICdFbmFibGUgTm90aWZpY2F0aW9ucycsICFzdWJzY3JpYmVkLCAhc3Vic2NyaWJlZCk7XG4gICAgY29uc3QgdW5TdWJzY3JpYmVCdXR0b246IFRvb2xiYXJCdXR0b24gPSB0aGlzLmJ1dHRvbnNIZWxwZXIuY3JlYXRlQnV0dG9uKFxuICAgICAgJ3Vuc3Vic2NyaWJlJywgJ3Rjcy1jb2xsYWJvcmF0aW9uLXN1YnNjcmliZWQnLCB0cnVlLCAnRGlzYWJsZSBOb3RpZmljYXRpb25zJywgc3Vic2NyaWJlZCwgc3Vic2NyaWJlZCk7XG4gICAgY29uc3QgYnV0dG9ucyA9IFsgc3Vic2NyaWJlQnV0dG9uLCB1blN1YnNjcmliZUJ1dHRvbiBdO1xuICAgIHJldHVybiBidXR0b25zO1xuICB9XG5cbiAgcHVibGljIHNldHVwTm90aWZpY2F0aW9uQnV0dG9ucyA9IChzdWJzY3JpYmVkOiBib29sZWFuKSA9PiB7XG4gICAgY29uc3QgYnV0dG9uczogVG9vbGJhckJ1dHRvbltdID0gdGhpcy5jcmVhdGVUb29sYmFyQnV0dG9ucyhzdWJzY3JpYmVkKTtcbiAgICB0aGlzLmJ1dHRvbnNIZWxwZXIudXBkYXRlQnV0dG9ucyhidXR0b25zLCB0aGlzLnRvb2xiYXJCdXR0b25zKTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVCdXR0b25EZWYgPSAodXBkYXRlZFRvb2xiYXJCdXR0b25zOiBUb29sYmFyQnV0dG9uW10pID0+IHtcbiAgICB1cGRhdGVkVG9vbGJhckJ1dHRvbnMuZm9yRWFjaCggdXBkYXRlZEJ1dHRvbiA9PiB7XG4gICAgICBjb25zdCBpZHggPSB0aGlzLnRvb2xiYXJCdXR0b25zLmZpbmRJbmRleChpdGVtID0+IGl0ZW0uaWQgPT09IHVwZGF0ZWRCdXR0b24uaWQpO1xuICAgICAgdGhpcy50b29sYmFyQnV0dG9uc1tpZHhdID0gdXBkYXRlZEJ1dHRvbjtcbiAgICB9KTtcbiAgfVxuXG4gIHB1YmxpYyBoYW5kbGVUb29sYmFyQnV0dG9uRXZlbnQgPSAoaWQpID0+IHtcbiAgICBpZiAoaWQgPT09ICdzdWJzY3JpYmUnKSB7XG4gICAgICB0aGlzLnN1YnNjcmliZSgpO1xuICAgIH0gZWxzZSBpZiAoaWQgPT09ICd1bnN1YnNjcmliZScpIHtcbiAgICAgIHRoaXMudW5zdWJzY3JpYmUoKTtcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgcmVjcmVhdGVCdXR0b25zRm9yTm90aWZpY2F0aW9ucyA9IChzdWJzY3JpYmVkKSA9PiB7XG4gICAgICBjb25zdCBidXR0b25zOiBUb29sYmFyQnV0dG9uW10gPSB0aGlzLmNyZWF0ZVRvb2xiYXJCdXR0b25zKHN1YnNjcmliZWQpO1xuICAgICAgdGhpcy5idXR0b25zSGVscGVyLnVwZGF0ZUJ1dHRvbnMoYnV0dG9ucywgdGhpcy50b29sYmFyQnV0dG9ucyk7XG4gIH1cblxuICBwdWJsaWMgZ2V0Tm90aWZpY2F0aW9ucyA9ICgpID0+IHtcbiAgICB0aGlzLmxpdmVhcHBzLmdldE5vdGlmaWNhdGlvbnModGhpcy5yZWxhdGVkSXRlbVR5cGUsIHRoaXMucmVsYXRlZEl0ZW1JZCwgdGhpcy51c2VySWQpXG4gICAgICAucGlwZShcbiAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3llZCQpXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKHJlc3VsdCA9PiB7XG4gICAgICAgIGNvbnN0IG5vdGlmaWNhdGlvbkxpc3Q6IE5vdGlmaWNhdGlvbkxpc3QgPSByZXN1bHQ7XG4gICAgICAgIGlmIChub3RpZmljYXRpb25MaXN0Lm5vdGlmaWNhdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHRoaXMuc3Vic2NyaWJlZCA9IHRydWU7XG4gICAgICAgICAgdGhpcy5zZXR1cE5vdGlmaWNhdGlvbkJ1dHRvbnModHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5zdWJzY3JpYmVkID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5zZXR1cE5vdGlmaWNhdGlvbkJ1dHRvbnMoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9LCBlcnJvciA9PiB0aGlzLmVycm9yTWVzc2FnZSA9ICdFcnJvciBjcmVhdGluZyBuZXcgbm90ZTogJyArIGVycm9yLmVycm9yLmVycm9yTWVzc2FnZSk7XG4gIH1cblxuICBwdWJsaWMgc3Vic2NyaWJlID0gKCkgPT4ge1xuICAgIHRoaXMubGl2ZWFwcHMuc3Vic2NyaWJlVG9Ob3Rlcyh0aGlzLnJlbGF0ZWRJdGVtVHlwZSwgdGhpcy5yZWxhdGVkSXRlbUlkKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRha2UoMSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQkKVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZShyZXN1bHQgPT4ge1xuICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgdGhpcy5zdWJzY3JpYmVkID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLnJlY3JlYXRlQnV0dG9uc0Zvck5vdGlmaWNhdGlvbnModHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0sIGVycm9yID0+IHRoaXMuZXJyb3JNZXNzYWdlID0gJ0Vycm9yIGNyZWF0aW5nIG5ldyBub3RlOiAnICsgZXJyb3IuZXJyb3IuZXJyb3JNZXNzYWdlKTtcbiAgfVxuXG4gIHB1YmxpYyB1bnN1YnNjcmliZSA9ICgpID0+IHtcbiAgICB0aGlzLmxpdmVhcHBzLnVuc3Vic2NyaWJlVG9Ob3Rlcyh0aGlzLnJlbGF0ZWRJdGVtVHlwZSwgdGhpcy5yZWxhdGVkSXRlbUlkLCB0aGlzLnVzZXJJZClcbiAgICAgIC5waXBlKFxuICAgICAgICB0YWtlKDEpLFxuICAgICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveWVkJClcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUocmVzdWx0ID0+IHtcbiAgICAgICAgdGhpcy5zdWJzY3JpYmVkID0gZmFsc2U7XG4gICAgICAgIHRoaXMucmVjcmVhdGVCdXR0b25zRm9yTm90aWZpY2F0aW9ucyhmYWxzZSk7XG4gICAgICB9LCBlcnJvciA9PiB0aGlzLmVycm9yTWVzc2FnZSA9ICdFcnJvciBjcmVhdGluZyBuZXcgbm90ZTogJyArIGVycm9yLmVycm9yLmVycm9yTWVzc2FnZSk7XG4gIH1cblxuICBwdWJsaWMgZWRpdE5vdGUgPSAodGhyZWFkKSA9PiB7XG4gICAgdGhyZWFkLmVkaXRNb2RlID0gIXRocmVhZC5lZGl0TW9kZTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVOb3RlID0gKG5vdGUsIHVwZGF0ZWRUZXh0KSA9PiB7XG4gICAgY29uc29sZS5sb2coJ1VwZGF0aW5nIG5vdGUnKTtcbiAgICBub3RlLnRleHQgPSB1cGRhdGVkVGV4dDtcbiAgICB0aGlzLmxpdmVhcHBzLnVwZGF0ZU5vdGUobm90ZSwgbm90ZS5pZClcbiAgICAgIC5waXBlKFxuICAgICAgICB0YWtlKDEpLFxuICAgICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveWVkJClcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUocmVzdWx0ID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ05vdGUgdXBkYXRlZCcpO1xuICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgIH0sIGVycm9yID0+IHRoaXMuZXJyb3JNZXNzYWdlID0gJ0Vycm9yIHVwZGF0aW5nIG5vdGU6ICcgKyBlcnJvci5lcnJvci5lcnJvck1lc3NhZ2UpO1xuICB9XG5cbiAgcHVibGljIGRlbGV0ZU5vdGUgPSAoaWQpID0+IHtcbiAgICBjb25zb2xlLmxvZygnRGVsZXRpbmcgbm90ZScpO1xuICAgIHRoaXMubGl2ZWFwcHMuZGVsZXRlTm90ZShpZClcbiAgICAgIC5waXBlKFxuICAgICAgICB0YWtlKDEpLFxuICAgICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveWVkJClcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUocmVzdWx0ID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coJ05vdGUgZGVsZXRlZDogJyArIHJlc3VsdCk7XG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgfSwgZXJyb3IgPT4gdGhpcy5lcnJvck1lc3NhZ2UgPSAnRXJyb3IgY3JlYXRpbmcgbmV3IG5vdGU6ICcgKyBlcnJvci5lcnJvci5lcnJvck1lc3NhZ2UpO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgLy8gdGhpcy5yZWZyZXNoKCk7XG4gICAgdGhpcy5uZXdOb3RlLnRleHQgPSAnJztcblxuICB9XG5cbn1cbiJdfQ==