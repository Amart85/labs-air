/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input } from '@angular/core';
import { LiveAppsService } from '../../services/live-apps.service';
import { map, take, takeUntil } from 'rxjs/operators';
import { LiveAppsComponent } from '../live-apps-component/live-apps-component.component';
import { TcButtonsHelperService } from '@tibco-tcstk/tc-core-lib';
/**
 * This Component allows to list, and add Notes to a Case-Instance or other Context e.g. a whole Application.
 * Any Note can have Sub-Notes to allow real collaboration.
 *
 * ![alt-text](../live-apps-notes.png "Notes Component Image")
 *
 * \@example <tcla-live-apps-notes></tcla-live-apps-notes>
 */
export class LiveAppsNotesComponent extends LiveAppsComponent {
    /**
     * @param {?} liveapps
     * @param {?} buttonsHelper
     */
    constructor(liveapps, buttonsHelper) {
        super();
        this.liveapps = liveapps;
        this.buttonsHelper = buttonsHelper;
        /**
         * Whether to show the header bar in the widget - eg. favorites on home page (contains icon etc) - if off icons still appear without bar
         */
        this.showHeader = this.showHeader ? this.showHeader : true;
        this.newNote = {};
        this.skip = 0;
        this.top = 5;
        this.end = false;
        this.toolbarButtons = [];
        this.refresh = (/**
         * @return {?}
         */
        () => {
            this.skip = 0;
            this.top = 5;
            this.end = false;
            if (this.threads && this.threads.threads) {
                this.threads.threads.length = 0;
            }
            this.getBatch();
            this.getNotifications();
        });
        this.getBatch = (/**
         * @return {?}
         */
        () => {
            if (!this.end) {
                this.liveapps.getThreads(this.relatedItemType, this.relatedItemId, this.skip, this.top)
                    .pipe(take(1), takeUntil(this._destroyed$), map((/**
                 * @param {?} threadList
                 * @return {?}
                 */
                threadList => {
                    if (!this.threads) {
                        this.threads = threadList;
                    }
                    else {
                        // this will strip any duplicates that may have been retrieved due to fast scrolling
                        /** @type {?} */
                        const filteredEvents = threadList.threads.filter((/**
                         * @param {?} x
                         * @return {?}
                         */
                        x => this.threads.threads.every((/**
                         * @param {?} y
                         * @return {?}
                         */
                        y => y.note.id !== x.note.id))));
                        this.threads.threads = this.threads.threads.concat(filteredEvents);
                    }
                    if (threadList.threads.length < this.top) {
                        this.end = true;
                    }
                    else {
                        this.skip = this.skip + threadList.threads.length - 1;
                    }
                }))).subscribe(null, (/**
                 * @param {?} error
                 * @return {?}
                 */
                error => {
                    this.errorMessage = 'Error retrieving notes: ' + error.error.errorMsg;
                }));
            }
        });
        this.toggleReplies = (/**
         * @param {?} thread
         * @return {?}
         */
        (thread) => {
            thread.showReplies = !thread.showReplies;
        });
        this.toggleNewReply = (/**
         * @param {?} thread
         * @return {?}
         */
        (thread) => {
            if (!thread.newReply) {
                thread.newReply = {};
            }
            if (thread.showReplies && !thread.showNewReply) {
                thread.newReply = {};
                thread.showNewReply = true;
            }
            else {
                thread.showNewReply = !thread.showNewReply;
                thread.showReplies = !thread.showReplies;
            }
        });
        this.createReply = (/**
         * @param {?} thread
         * @param {?} replyText
         * @return {?}
         */
        (thread, replyText) => {
            this.liveapps.createReplyNote(thread.note, replyText, thread.note.id)
                .pipe(take(1), takeUntil(this._destroyed$), map((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                this.newNoteId = result;
                thread.newReply.text = undefined;
                this.refresh();
            })))
                .subscribe(null, (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
        });
        this.createThread = (/**
         * @param {?} noteText
         * @return {?}
         */
        (noteText) => {
            if (noteText !== undefined) {
                this.liveapps.createNote(this.relatedItemType, 'RT_CASE', this.relatedItemId, 'comments update', '', '', noteText)
                    .pipe(take(1), takeUntil(this._destroyed$), map((/**
                 * @param {?} result
                 * @return {?}
                 */
                result => {
                    this.newNoteId = result;
                    this.newNote.text = undefined;
                    this.refresh();
                })))
                    .subscribe(null, (/**
                 * @param {?} error
                 * @return {?}
                 */
                error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
            }
        });
        this.createToolbarButtons = (/**
         * @param {?} subscribed
         * @return {?}
         */
        (subscribed) => {
            /** @type {?} */
            const subscribeButton = this.buttonsHelper.createButton('subscribe', 'tcs-collaboration-unsubscribed', true, 'Enable Notifications', !subscribed, !subscribed);
            /** @type {?} */
            const unSubscribeButton = this.buttonsHelper.createButton('unsubscribe', 'tcs-collaboration-subscribed', true, 'Disable Notifications', subscribed, subscribed);
            /** @type {?} */
            const buttons = [subscribeButton, unSubscribeButton];
            return buttons;
        });
        this.setupNotificationButtons = (/**
         * @param {?} subscribed
         * @return {?}
         */
        (subscribed) => {
            /** @type {?} */
            const buttons = this.createToolbarButtons(subscribed);
            this.buttonsHelper.updateButtons(buttons, this.toolbarButtons);
        });
        this.updateButtonDef = (/**
         * @param {?} updatedToolbarButtons
         * @return {?}
         */
        (updatedToolbarButtons) => {
            updatedToolbarButtons.forEach((/**
             * @param {?} updatedButton
             * @return {?}
             */
            updatedButton => {
                /** @type {?} */
                const idx = this.toolbarButtons.findIndex((/**
                 * @param {?} item
                 * @return {?}
                 */
                item => item.id === updatedButton.id));
                this.toolbarButtons[idx] = updatedButton;
            }));
        });
        this.handleToolbarButtonEvent = (/**
         * @param {?} id
         * @return {?}
         */
        (id) => {
            if (id === 'subscribe') {
                this.subscribe();
            }
            else if (id === 'unsubscribe') {
                this.unsubscribe();
            }
        });
        this.recreateButtonsForNotifications = (/**
         * @param {?} subscribed
         * @return {?}
         */
        (subscribed) => {
            /** @type {?} */
            const buttons = this.createToolbarButtons(subscribed);
            this.buttonsHelper.updateButtons(buttons, this.toolbarButtons);
        });
        this.getNotifications = (/**
         * @return {?}
         */
        () => {
            this.liveapps.getNotifications(this.relatedItemType, this.relatedItemId, this.userId)
                .pipe(take(1), takeUntil(this._destroyed$), map((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                /** @type {?} */
                const notificationList = result;
                if (notificationList.notifications.length > 0) {
                    this.subscribed = true;
                    this.setupNotificationButtons(true);
                }
                else {
                    this.subscribed = false;
                    this.setupNotificationButtons(false);
                }
            })))
                .subscribe(null, (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
        });
        this.subscribe = (/**
         * @return {?}
         */
        () => {
            this.liveapps.subscribeToNotes(this.relatedItemType, this.relatedItemId)
                .pipe(take(1), takeUntil(this._destroyed$), map((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                if (result) {
                    this.subscribed = true;
                    this.recreateButtonsForNotifications(true);
                }
            })))
                .subscribe(null, (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
        });
        this.unsubscribe = (/**
         * @return {?}
         */
        () => {
            this.liveapps.unsubscribeToNotes(this.relatedItemType, this.relatedItemId, this.userId)
                .pipe(take(1), takeUntil(this._destroyed$), map((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                this.subscribed = false;
                this.recreateButtonsForNotifications(false);
            })))
                .subscribe(null, (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
        });
        this.editNote = (/**
         * @param {?} thread
         * @return {?}
         */
        (thread) => {
            thread.editMode = !thread.editMode;
        });
        this.updateNote = (/**
         * @param {?} note
         * @param {?} updatedText
         * @return {?}
         */
        (note, updatedText) => {
            console.log('Updating note');
            note.text = updatedText;
            this.liveapps.updateNote(note, note.id)
                .pipe(take(1), takeUntil(this._destroyed$), map((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                console.log('Note updated');
                this.refresh();
            })))
                .subscribe(null, (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error updating note: ' + error.error.errorMessage));
        });
        this.deleteNote = (/**
         * @param {?} id
         * @return {?}
         */
        (id) => {
            console.log('Deleting note');
            this.liveapps.deleteNote(id)
                .pipe(take(1), takeUntil(this._destroyed$), map((/**
             * @param {?} result
             * @return {?}
             */
            result => {
                console.log('Note deleted: ' + result);
                this.refresh();
            })))
                .subscribe(null, (/**
             * @param {?} error
             * @return {?}
             */
            error => this.errorMessage = 'Error creating new note: ' + error.error.errorMessage));
        });
    }
    /**
     * @return {?}
     */
    ngOnInit() {
        this.refresh();
        this.newNote.text = '';
    }
}
LiveAppsNotesComponent.decorators = [
    { type: Component, args: [{
                selector: 'tcla-live-apps-notes',
                template: "<div class=\"tcs-notes-pane\" fxLayout=\"column\" fxFill style=\"overflow: hidden;\">\n  <tc-tibco-cloud-widget-header fxFlex=\"nogrow\" [headerText]=\"'Notes'\" [icon]=\"'tcs-collaboration-feed'\"\n                                [toolbarButtons]=\"toolbarButtons\" [showHeader]=\"showHeader\"\n                                (toolbarButtonEvent)=\"handleToolbarButtonEvent($event)\"></tc-tibco-cloud-widget-header>\n  <div class=\"tcs-collaboration-pane\" fxLayout=\"column\" fxFlex=\"grow\" style=\"\">\n    <div class=\"tcs-collaboration-existing-threads\" fxLayout=\"column\" fxFlex>\n      <!--div *ngIf=\"threads && threads.threads.length > 0\"-->\n      <div style=\"height: 100%;\">\n        <cdk-virtual-scroll-viewport style=\"height: 100%\" itemSize=\"50\" (scrolledIndexChange)=\"getBatch()\">\n\n          <!--div class=\"tcs-collaboration-detail-box tcs-collaboration-thread\" [ngClass]=\"{ editing: thread.editMode }\" *ngFor=\"let thread of threads.threads | reverse\" fxLayout=\"column\"-->\n          <div *ngIf=\"threads && threads.threads\">\n            <div class=\"tcs-collaboration-detail-box tcs-collaboration-thread\" [ngClass]=\"{ editing: thread.editMode }\"\n                 *cdkVirtualFor=\"let thread of threads.threads\" fxLayout=\"column\">\n              <div class=\"tcs-thread-box\">\n                <!-- collaboration threads -->\n                <div class=\"tcs-collaboration-entry\">\n                  <div *ngIf=\"!thread.editMode\">\n                    <div fxLayout=\"row\" fxLayoutAlign=\"space-between start\">\n                      <span class=\"tcs-collaboration-thread-author\">{{thread.note.createdByName}}</span>\n                      <div fxLayoutAlign=\"row\">\n                      <span *ngIf=\"thread.note.modifiedDate > thread.note.createdDate\" class=\"tcs-collaboration-edited\">Edited\n                      </span>\n                        <span class=\"tcs-collaboration-thread-date\">{{thread.note.modifiedDate | durationSince}}</span>\n                      </div>\n                    </div>\n                    <span class=\"tcs-collaboration-thread-text\" matTooltip=\"{{thread.note.text}}\"\n                          matTooltipShowDelay=\"1000\"\n                          matTooltipPosition=\"below\">{{thread.note.text | ellipsis: 70}}</span>\n                  </div>\n                  <tcla-live-apps-notes-editor *ngIf=\"thread.editMode\" [noteText]=\"thread.note.text\"\n                                               (noteSubmitted)=\"updateNote(thread.note, $event)\"></tcla-live-apps-notes-editor>\n                </div>\n                <div class=\"tcs-icon-row\" fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                  <div class=\"tcs-collaboration-thread-icon-left\">\n                    <mat-icon (click)=\"deleteNote(thread.note.id)\"\n                              class=\"tcs-icon tcs-icon-active tcs-collaboration-edit-buttons tcs-collaboration-delete-icon\"\n                              svgIcon=\"tcs-collaboration-delete\"></mat-icon>\n                    <mat-icon (click)=\"editNote(thread)\"\n                              class=\"tcs-icon tcs-icon-active tcs-collaboration-edit-buttons tcs-collaboration-edit-icon\"\n                              svgIcon=\"tcs-collaboration-edit\"></mat-icon>\n                  </div>\n                  <div class=\"tcs-collaboration-thread-icon-right\" fxLayoutAlign=\"end center\" fxLayoutGap=\"8px\">\n                    <span *ngIf=\"thread.note.thread.totalCount > 1\" class=\"tcs-collaboration-thread-replies\"\n                          (click)=\"toggleReplies(thread)\">{{thread.note.thread.totalCount - 1}} replies</span>\n                    <mat-icon (click)=\"toggleNewReply(thread)\" class=\"tcs-icon tcs-collaboration-reply-icon\"\n                              svgIcon=\"tcs-collaboration-reply\"></mat-icon>\n                  </div>\n                </div>\n              </div>\n              <div class=\"tcs-collaboration-line\"></div>\n              <!-- replies -->\n              <div class=\"tcs-collaboration-reply-box\" *ngIf=\"thread.showReplies\">\n                <div fxLayout=\"column\">\n                  <tcla-live-apps-notes-editor class=\"tcs-collaboration-new-reply-component\" *ngIf=\"thread.showNewReply\"\n                                               [isReply]=\"true\" [noteText]=\"thread.newReply.text\"\n                                               (noteSubmitted)=\"createReply(thread, $event)\"></tcla-live-apps-notes-editor>\n                  <div class=\"tcs-collaboration-line\"></div>\n                </div>\n                <div class=\"tcs-collaboration-detail-box tcs-collaboration-reply\"\n                     [ngClass]=\"{ editing: reply.editMode }\" *ngFor=\"let reply of thread.thread | reverse\"\n                     fxLayout=\"column\">\n                  <div class=\"tcs-thread-box\" fxLayout=\"row\">\n                    <mat-icon class=\"tcs-icon tcs-collaboration-reply-item-icon\"\n                              svgIcon=\"tcs-collaboration-reply\"></mat-icon>\n                    <div fxLayout=\"column\" class=\"tcs-collaboration-reply-details\">\n                      <div class=\"tcs-collaboration-entry\">\n                        <div *ngIf=\"!reply.editMode\">\n                          <div fxLayout=\"row\" fxLayoutAlign=\"space-between start\">\n                            <span class=\"tcs-collaboration-thread-author\">{{reply.createdByName}}</span>\n                            <span class=\"tcs-collaboration-thread-date\">{{reply.modifiedDate | durationSince}}</span>\n                          </div>\n                          <span class=\"tcs-collaboration-thread-text\" matTooltip=\"{{reply.text}}\"\n                                matTooltipShowDelay=\"1000\"\n                                matTooltipPosition=\"below\">{{reply.text | ellipsis: 60}}</span>\n                        </div>\n                        <tcla-live-apps-notes-editor *ngIf=\"reply.editMode\" [noteText]=\"reply.text\"\n                                                     (noteSubmitted)=\"updateNote(reply, $event)\"></tcla-live-apps-notes-editor>\n                      </div>\n                      <div class=\"tcs-icon-row\" fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                        <div class=\"tcs-collaboration-thread-icon-left\">\n                          <mat-icon (click)=\"deleteNote(reply.id)\"\n                                    class=\"tcs-icon tcs-icon-active tcs-collaboration-edit-buttons tcs-collaboration-delete-icon\"\n                                    svgIcon=\"tcs-collaboration-delete\"></mat-icon>\n                          <mat-icon (click)=\"editNote(reply)\"\n                                    class=\"tcs-icon tcs-icon-active tcs-collaboration-edit-buttons tcs-collaboration-edit-icon\"\n                                    svgIcon=\"tcs-collaboration-edit\"></mat-icon>\n                        </div>\n                      </div>\n                    </div>\n                  </div>\n                  <div class=\"tcs-collaboration-reply-line\"></div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div *ngIf=\"!(threads?.threads?.length > 0)\" fxLayout=\"row\" fxLayoutAlign=\"center start\" fxLayoutGap=\"10px\"\n               style=\"margin-top: 20px;\">\n            <mat-icon [svgIcon]=\"'ic-no-notes-icon'\" style=\"height: 48px; width: 48px;\"></mat-icon>\n            <div style=\"height: 100%\" fxLayout=\"row\" fxLayoutAlign=\"start center\">\n              <span class=\"tcs-no-item-text\">No notes found</span>\n            </div>\n          </div>\n        </cdk-virtual-scroll-viewport>\n      </div>\n    </div>\n    <tcla-live-apps-notes-editor class=\"tcs-collaboration-new-note-component\" [noteText]=\"newNote.text\"\n                                 (noteSubmitted)=\"createThread($event)\"></tcla-live-apps-notes-editor>\n  </div>\n</div>\n",
                styles: [".tcs-notes-pane{border-radius:3px;box-shadow:0 2px 4px 0 rgba(0,0,0,.33);background-color:#fff}.tcs-collaboration-pane{padding-top:10px}.tcs-collaboration-header{height:40px;border-radius:3px 3px 0 0;box-shadow:0 1px 2px 0 #dedede;padding-left:20px;padding-right:20px}.tcs-collaboration-header-text{margin-left:10px;font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:1.5;letter-spacing:.3px}.tcs-collaboration-thread-icon-left{height:24px;width:50px}.tcs-collaboration-existing-threads{overflow-y:auto}.tcs-collaboration-detail-box{min-height:85px;flex-shrink:0}.tcs-collaboration-detail-box.editing{min-height:109px}.tcs-collaboration-detail-box.editing>.tcs-thread-box{height:110px;background-color:#eef0f7}.tcs-collaboration-new-reply-box{-webkit-transition:background-color .5s;transition:background-color .5s;background-color:#eef0f7;margin-left:20px;padding-right:20px}.tcs-collaboration-detail-box.tcs-collaboration-reply.editing{min-height:100px}.tcs-collaboration-reply{padding-left:20px}.tcs-thread-box{height:86px}.tcs-thread-box:hover{background-color:#eef0f7;-webkit-transition:background-color .5s;transition:background-color .5s}.tcs-thread-box:hover .tcs-icon.tcs-icon-active{display:inline-block}.tcs-thread-box .tcs-icon.tcs-icon-active{display:none}.tcs-collaboration-entry{padding:10px 20px}.tcs-icon-row{padding-left:20px;padding-right:20px;padding-bottom:5px}.tcs-collaboration-thread-author{font-size:14px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px}.tcs-collaboration-thread-text{font-size:11px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px}.tcs-collaboration-thread-date{font-size:10px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#b6b6b6}.tcs-collaboration-edited{font-size:10px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#ef5350;padding-right:4px}.tcs-collaboration-reply-icon{-webkit-transform:scale(-1,1);transform:scale(-1,1)}.tcs-collaboration-reply-item-icon{-webkit-transform:scale(1,-1);transform:scale(1,-1);margin-top:10px}.tcs-collaboration-reply-details{width:100%}.tcs-collaboration-thread-replies{font-size:12px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#0081cb}.tcs-icon{height:20px;width:20px}:host ::ng-deep .tcs-icon.tcs-collaboration-edit-buttons:hover path.svg-content{fill:#0081cb;cursor:pointer}:host ::ng-deep .tcs-icon.tcs-collaboration-edit-buttons:hover g.svg-content{fill:#0081cb;cursor:pointer}.tcs-icon.tcs-collaboration-edit-icon{margin-left:5px}.tcs-icon.tcs-collaboration-send-icon{height:24px;width:24px;margin-left:12px}:host ::ng-deep .tcs-icon.tcs-collaboration-send-icon:hover path.svg-content{fill:#0081cb}.tcs-collaboration-line{padding:0;margin:0 20px;border-bottom:1.1px solid #f4f4f4}.tcs-collaboration-reply-line{padding:0;margin-top:0;margin-right:20px;margin-bottom:0;border-bottom:1.1px solid #f4f4f4}.tcs-collaboration-new-thread{margin-left:20px;margin-right:20px;max-height:85px;height:85px;min-height:85px}.tcs-collaboration-edit-thread{margin-top:10px}.tcs-collaboration-new-reply{margin:10px 20px}.tcs-collaboration-input{height:55px;max-width:100%;border-color:#d5e6ff;font-size:11px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#b6b6b6;resize:none;border-radius:3px}.tcs-collaboration-reply-textbox{height:55px;max-width:100%;border-color:#d5e6ff;font-size:11px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#b6b6b6;resize:none;border-radius:3px;margin-top:20px;margin-bottom:20px}.tcs-collaboration-edit{height:55px;max-width:100%;border-color:#d5e6ff;font-size:11px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:-.1px;color:#b6b6b6;resize:none;border-radius:3px}.tcs-collaboration-new-thread-form{max-width:90%;max-height:100%}.tcs-collaboration-new-note-component,.tcs-collaboration-new-reply-component{height:85px;min-height:85px;max-height:85px;margin-left:20px;margin-right:20px}.tcs-no-item-text{font-family:Source Sans Pro;font-size:16px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;color:#b6b6b6}"]
            }] }
];
/** @nocollapse */
LiveAppsNotesComponent.ctorParameters = () => [
    { type: LiveAppsService },
    { type: TcButtonsHelperService }
];
LiveAppsNotesComponent.propDecorators = {
    relatedItemType: [{ type: Input }],
    relatedItemId: [{ type: Input }],
    userId: [{ type: Input }],
    showHeader: [{ type: Input }]
};
if (false) {
    /**
     * itemType for notes collection
     * @type {?}
     */
    LiveAppsNotesComponent.prototype.relatedItemType;
    /**
     * itemId for notes collection
     * @type {?}
     */
    LiveAppsNotesComponent.prototype.relatedItemId;
    /**
     * The ID of the logged user
     * @type {?}
     */
    LiveAppsNotesComponent.prototype.userId;
    /**
     * Whether to show the header bar in the widget - eg. favorites on home page (contains icon etc) - if off icons still appear without bar
     * @type {?}
     */
    LiveAppsNotesComponent.prototype.showHeader;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.notes;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.errorMessage;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.newNote;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.newNoteId;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.delNoteId;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.threads;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.subscribed;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.skip;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.top;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.end;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.toolbarButtons;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.refresh;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.getBatch;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.toggleReplies;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.toggleNewReply;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.createReply;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.createThread;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsNotesComponent.prototype.createToolbarButtons;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.setupNotificationButtons;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.updateButtonDef;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.handleToolbarButtonEvent;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.recreateButtonsForNotifications;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.getNotifications;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.subscribe;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.unsubscribe;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.editNote;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.updateNote;
    /** @type {?} */
    LiveAppsNotesComponent.prototype.deleteNote;
    /**
     * @type {?}
     * @private
     */
    LiveAppsNotesComponent.prototype.liveapps;
    /**
     * @type {?}
     * @private
     */
    LiveAppsNotesComponent.prototype.buttonsHelper;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLW5vdGVzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0aWJjby10Y3N0ay90Yy1saXZlYXBwcy1saWIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9saXZlLWFwcHMtbm90ZXMvbGl2ZS1hcHBzLW5vdGVzLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFDLFNBQVMsRUFBRSxLQUFLLEVBQW9CLE1BQU0sZUFBZSxDQUFDO0FBRWxFLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxrQ0FBa0MsQ0FBQztBQUNqRSxPQUFPLEVBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxTQUFTLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUVwRCxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSxzREFBc0QsQ0FBQztBQUV2RixPQUFPLEVBQUMsc0JBQXNCLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQzs7Ozs7Ozs7O0FBaUJoRSxNQUFNLE9BQU8sc0JBQXVCLFNBQVEsaUJBQWlCOzs7OztJQWlDM0QsWUFBb0IsUUFBeUIsRUFBVSxhQUFxQztRQUMxRixLQUFLLEVBQUUsQ0FBQztRQURVLGFBQVEsR0FBUixRQUFRLENBQWlCO1FBQVUsa0JBQWEsR0FBYixhQUFhLENBQXdCOzs7O1FBZG5GLGVBQVUsR0FBWSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7UUFJakUsWUFBTyxHQUFRLEVBQUUsQ0FBQztRQUtsQixTQUFJLEdBQUcsQ0FBQyxDQUFDO1FBQ1QsUUFBRyxHQUFHLENBQUMsQ0FBQztRQUNSLFFBQUcsR0FBRyxLQUFLLENBQUM7UUFDWixtQkFBYyxHQUFvQixFQUFFLENBQUM7UUFNckMsWUFBTzs7O1FBQUcsR0FBRyxFQUFFO1lBQ3BCLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDO1lBQ2QsSUFBSSxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUM7WUFDYixJQUFJLENBQUMsR0FBRyxHQUFHLEtBQUssQ0FBQztZQUNqQixJQUFJLElBQUksQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLE9BQU8sQ0FBQyxPQUFPLEVBQUU7Z0JBQ3hDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7YUFDakM7WUFDRCxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7WUFDaEIsSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDMUIsQ0FBQyxFQUFBO1FBRU0sYUFBUTs7O1FBQUcsR0FBRyxFQUFFO1lBQ3JCLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFO2dCQUNiLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsSUFBSSxDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxHQUFHLENBQUM7cUJBQ3BGLElBQUksQ0FDSCxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQ1AsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsRUFDM0IsR0FBRzs7OztnQkFBQyxVQUFVLENBQUMsRUFBRTtvQkFDZixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRTt3QkFDakIsSUFBSSxDQUFDLE9BQU8sR0FBRyxVQUFVLENBQUM7cUJBQzNCO3lCQUFNOzs7OEJBRUMsY0FBYyxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUMsTUFBTTs7Ozt3QkFBQyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEtBQUs7Ozs7d0JBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBQyxFQUFDO3dCQUMvRyxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUM7cUJBQ3BFO29CQUNELElBQUksVUFBVSxDQUFDLE9BQU8sQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRTt3QkFDeEMsSUFBSSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUM7cUJBQ2pCO3lCQUFNO3dCQUNMLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksR0FBRyxVQUFVLENBQUMsT0FBTyxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUM7cUJBQ3ZEO2dCQUNILENBQUMsRUFBQyxDQUNILENBQUMsU0FBUyxDQUFDLElBQUk7Ozs7Z0JBQUUsS0FBSyxDQUFDLEVBQUU7b0JBQzFCLElBQUksQ0FBQyxZQUFZLEdBQUcsMEJBQTBCLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUM7Z0JBQ3hFLENBQUMsRUFBQyxDQUFDO2FBQ0o7UUFDSCxDQUFDLEVBQUE7UUFFTSxrQkFBYTs7OztRQUFHLENBQUMsTUFBTSxFQUFFLEVBQUU7WUFDaEMsTUFBTSxDQUFDLFdBQVcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUM7UUFDM0MsQ0FBQyxFQUFBO1FBRU0sbUJBQWM7Ozs7UUFBRyxDQUFDLE1BQU0sRUFBRSxFQUFFO1lBQ2pDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxFQUFFO2dCQUNwQixNQUFNLENBQUMsUUFBUSxHQUFHLEVBQUUsQ0FBQzthQUN0QjtZQUNELElBQUksTUFBTSxDQUFDLFdBQVcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUU7Z0JBQzlDLE1BQU0sQ0FBQyxRQUFRLEdBQUcsRUFBRSxDQUFDO2dCQUNyQixNQUFNLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQzthQUM1QjtpQkFBTTtnQkFDTCxNQUFNLENBQUMsWUFBWSxHQUFHLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQztnQkFDM0MsTUFBTSxDQUFDLFdBQVcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUM7YUFDMUM7UUFFSCxDQUFDLEVBQUE7UUFFTSxnQkFBVzs7Ozs7UUFBRyxDQUFDLE1BQU0sRUFBRSxTQUFTLEVBQUUsRUFBRTtZQUN6QyxJQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLFNBQVMsRUFBRSxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQztpQkFDbEUsSUFBSSxDQUNILElBQUksQ0FBQyxDQUFDLENBQUMsRUFDUCxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUMzQixHQUFHOzs7O1lBQUMsTUFBTSxDQUFDLEVBQUU7Z0JBQ1gsSUFBSSxDQUFDLFNBQVMsR0FBRyxNQUFNLENBQUM7Z0JBQ3hCLE1BQU0sQ0FBQyxRQUFRLENBQUMsSUFBSSxHQUFHLFNBQVMsQ0FBQztnQkFDakMsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1lBQ2pCLENBQUMsRUFBQyxDQUNIO2lCQUNBLFNBQVMsQ0FBQyxJQUFJOzs7O1lBQUUsS0FBSyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsWUFBWSxHQUFHLDJCQUEyQixHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFDLENBQUM7UUFDMUcsQ0FBQyxFQUFBO1FBRU0saUJBQVk7Ozs7UUFBRyxDQUFDLFFBQVEsRUFBRSxFQUFFO1lBQ2pDLElBQUksUUFBUSxLQUFLLFNBQVMsRUFBRTtnQkFDMUIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLGFBQWEsRUFBRSxpQkFBaUIsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLFFBQVEsQ0FBQztxQkFDL0csSUFBSSxDQUNILElBQUksQ0FBQyxDQUFDLENBQUMsRUFDUCxTQUFTLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxFQUMzQixHQUFHOzs7O2dCQUFDLE1BQU0sQ0FBQyxFQUFFO29CQUNYLElBQUksQ0FBQyxTQUFTLEdBQUcsTUFBTSxDQUFDO29CQUN4QixJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksR0FBRyxTQUFTLENBQUM7b0JBQzlCLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztnQkFDakIsQ0FBQyxFQUFDLENBQ0g7cUJBQ0EsU0FBUyxDQUFDLElBQUk7Ozs7Z0JBQUUsS0FBSyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsWUFBWSxHQUFHLDJCQUEyQixHQUFHLEtBQUssQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFDLENBQUM7YUFDekc7UUFDSCxDQUFDLEVBQUE7UUFHUyx5QkFBb0I7Ozs7UUFBRyxDQUFDLFVBQVUsRUFBbUIsRUFBRTs7a0JBQ3pELGVBQWUsR0FBa0IsSUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQ3BFLFdBQVcsRUFBRSxnQ0FBZ0MsRUFBRSxJQUFJLEVBQUUsc0JBQXNCLEVBQUUsQ0FBQyxVQUFVLEVBQUUsQ0FBQyxVQUFVLENBQUM7O2tCQUNsRyxpQkFBaUIsR0FBa0IsSUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZLENBQ3RFLGFBQWEsRUFBRSw4QkFBOEIsRUFBRSxJQUFJLEVBQUUsdUJBQXVCLEVBQUUsVUFBVSxFQUFFLFVBQVUsQ0FBQzs7a0JBQ2pHLE9BQU8sR0FBRyxDQUFFLGVBQWUsRUFBRSxpQkFBaUIsQ0FBRTtZQUN0RCxPQUFPLE9BQU8sQ0FBQztRQUNqQixDQUFDLEVBQUE7UUFFTSw2QkFBd0I7Ozs7UUFBRyxDQUFDLFVBQW1CLEVBQUUsRUFBRTs7a0JBQ2xELE9BQU8sR0FBb0IsSUFBSSxDQUFDLG9CQUFvQixDQUFDLFVBQVUsQ0FBQztZQUN0RSxJQUFJLENBQUMsYUFBYSxDQUFDLGFBQWEsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ2pFLENBQUMsRUFBQTtRQUVNLG9CQUFlOzs7O1FBQUcsQ0FBQyxxQkFBc0MsRUFBRSxFQUFFO1lBQ2xFLHFCQUFxQixDQUFDLE9BQU87Ozs7WUFBRSxhQUFhLENBQUMsRUFBRTs7c0JBQ3ZDLEdBQUcsR0FBRyxJQUFJLENBQUMsY0FBYyxDQUFDLFNBQVM7Ozs7Z0JBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLGFBQWEsQ0FBQyxFQUFFLEVBQUM7Z0JBQy9FLElBQUksQ0FBQyxjQUFjLENBQUMsR0FBRyxDQUFDLEdBQUcsYUFBYSxDQUFDO1lBQzNDLENBQUMsRUFBQyxDQUFDO1FBQ0wsQ0FBQyxFQUFBO1FBRU0sNkJBQXdCOzs7O1FBQUcsQ0FBQyxFQUFFLEVBQUUsRUFBRTtZQUN2QyxJQUFJLEVBQUUsS0FBSyxXQUFXLEVBQUU7Z0JBQ3RCLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQzthQUNsQjtpQkFBTSxJQUFJLEVBQUUsS0FBSyxhQUFhLEVBQUU7Z0JBQy9CLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQzthQUNwQjtRQUNILENBQUMsRUFBQTtRQUVNLG9DQUErQjs7OztRQUFHLENBQUMsVUFBVSxFQUFFLEVBQUU7O2tCQUM5QyxPQUFPLEdBQW9CLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxVQUFVLENBQUM7WUFDdEUsSUFBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUNuRSxDQUFDLEVBQUE7UUFFTSxxQkFBZ0I7OztRQUFHLEdBQUcsRUFBRTtZQUM3QixJQUFJLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsSUFBSSxDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUMsTUFBTSxDQUFDO2lCQUNsRixJQUFJLENBQ0gsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUNQLFNBQVMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQzNCLEdBQUc7Ozs7WUFBQyxNQUFNLENBQUMsRUFBRTs7c0JBQ0wsZ0JBQWdCLEdBQXFCLE1BQU07Z0JBQ2pELElBQUksZ0JBQWdCLENBQUMsYUFBYSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUU7b0JBQzdDLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO29CQUN2QixJQUFJLENBQUMsd0JBQXdCLENBQUMsSUFBSSxDQUFDLENBQUM7aUJBQ3JDO3FCQUFNO29CQUNMLElBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDO29CQUN4QixJQUFJLENBQUMsd0JBQXdCLENBQUMsS0FBSyxDQUFDLENBQUM7aUJBQ3RDO1lBQ0gsQ0FBQyxFQUFDLENBQ0g7aUJBQ0EsU0FBUyxDQUFDLElBQUk7Ozs7WUFBRSxLQUFLLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxZQUFZLEdBQUcsMkJBQTJCLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUMsQ0FBQztRQUMxRyxDQUFDLEVBQUE7UUFFTSxjQUFTOzs7UUFBRyxHQUFHLEVBQUU7WUFDdEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLElBQUksQ0FBQyxhQUFhLENBQUM7aUJBQ3JFLElBQUksQ0FDSCxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQ1AsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsRUFDM0IsR0FBRzs7OztZQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUNYLElBQUksTUFBTSxFQUFFO29CQUNWLElBQUksQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDO29CQUN2QixJQUFJLENBQUMsK0JBQStCLENBQUMsSUFBSSxDQUFDLENBQUM7aUJBQzVDO1lBQ0gsQ0FBQyxFQUFDLENBQ0g7aUJBQ0EsU0FBUyxDQUFDLElBQUk7Ozs7WUFBRSxLQUFLLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxZQUFZLEdBQUcsMkJBQTJCLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUMsQ0FBQztRQUMxRyxDQUFDLEVBQUE7UUFFTSxnQkFBVzs7O1FBQUcsR0FBRyxFQUFFO1lBQ3hCLElBQUksQ0FBQyxRQUFRLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxJQUFJLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxNQUFNLENBQUM7aUJBQ3BGLElBQUksQ0FDSCxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQ1AsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsRUFDM0IsR0FBRzs7OztZQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUNYLElBQUksQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDO2dCQUN4QixJQUFJLENBQUMsK0JBQStCLENBQUMsS0FBSyxDQUFDLENBQUM7WUFDOUMsQ0FBQyxFQUFDLENBQ0g7aUJBQ0EsU0FBUyxDQUFDLElBQUk7Ozs7WUFBRSxLQUFLLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxZQUFZLEdBQUcsMkJBQTJCLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUMsQ0FBQztRQUMxRyxDQUFDLEVBQUE7UUFFTSxhQUFROzs7O1FBQUcsQ0FBQyxNQUFNLEVBQUUsRUFBRTtZQUMzQixNQUFNLENBQUMsUUFBUSxHQUFHLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQztRQUNyQyxDQUFDLEVBQUE7UUFFTSxlQUFVOzs7OztRQUFHLENBQUMsSUFBSSxFQUFFLFdBQVcsRUFBRSxFQUFFO1lBQ3hDLE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDN0IsSUFBSSxDQUFDLElBQUksR0FBRyxXQUFXLENBQUM7WUFDeEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUM7aUJBQ3BDLElBQUksQ0FDSCxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQ1AsU0FBUyxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsRUFDM0IsR0FBRzs7OztZQUFDLE1BQU0sQ0FBQyxFQUFFO2dCQUNYLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDLENBQUM7Z0JBQzVCLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUNqQixDQUFDLEVBQUMsQ0FDSDtpQkFDQSxTQUFTLENBQUMsSUFBSTs7OztZQUFFLEtBQUssQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVksR0FBRyx1QkFBdUIsR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDLFlBQVksRUFBQyxDQUFDO1FBQ3RHLENBQUMsRUFBQTtRQUVNLGVBQVU7Ozs7UUFBRyxDQUFDLEVBQUUsRUFBRSxFQUFFO1lBQ3pCLE9BQU8sQ0FBQyxHQUFHLENBQUMsZUFBZSxDQUFDLENBQUM7WUFDN0IsSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsRUFBRSxDQUFDO2lCQUN6QixJQUFJLENBQ0gsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUNQLFNBQVMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEVBQzNCLEdBQUc7Ozs7WUFBQyxNQUFNLENBQUMsRUFBRTtnQkFDWCxPQUFPLENBQUMsR0FBRyxDQUFDLGdCQUFnQixHQUFHLE1BQU0sQ0FBQyxDQUFDO2dCQUN2QyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7WUFDakIsQ0FBQyxFQUFDLENBQ0g7aUJBQ0EsU0FBUyxDQUFDLElBQUk7Ozs7WUFBRSxLQUFLLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxZQUFZLEdBQUcsMkJBQTJCLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUMsQ0FBQztRQUMxRyxDQUFDLEVBQUE7SUF4TUQsQ0FBQzs7OztJQTBNRCxRQUFRO1FBQ04sSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQ2YsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLEdBQUcsRUFBRSxDQUFDO0lBRXpCLENBQUM7OztZQXZQRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLHNCQUFzQjtnQkFDaEMsODFQQUErQzs7YUFFaEQ7Ozs7WUFwQk8sZUFBZTtZQUtmLHNCQUFzQjs7OzhCQXFCM0IsS0FBSzs0QkFLTCxLQUFLO3FCQUtMLEtBQUs7eUJBS0wsS0FBSzs7Ozs7OztJQWZOLGlEQUFpQzs7Ozs7SUFLakMsK0NBQStCOzs7OztJQUsvQix3Q0FBd0I7Ozs7O0lBS3hCLDRDQUF3RTs7SUFFeEUsdUNBQXFCOztJQUNyQiw4Q0FBNEI7O0lBQzVCLHlDQUF5Qjs7SUFDekIsMkNBQXlCOztJQUN6QiwyQ0FBeUI7O0lBQ3pCLHlDQUEyQjs7SUFDM0IsNENBQTJCOztJQUMzQixzQ0FBZ0I7O0lBQ2hCLHFDQUFlOztJQUNmLHFDQUFtQjs7SUFDbkIsZ0RBQTRDOztJQU01Qyx5Q0FTQzs7SUFFRCwwQ0F3QkM7O0lBRUQsK0NBRUM7O0lBRUQsZ0RBWUM7O0lBRUQsNkNBWUM7O0lBRUQsOENBY0M7Ozs7O0lBR0Qsc0RBT0M7O0lBRUQsMERBR0M7O0lBRUQsaURBS0M7O0lBRUQsMERBTUM7O0lBRUQsaUVBR0M7O0lBRUQsa0RBaUJDOztJQUVELDJDQWFDOztJQUVELDZDQVdDOztJQUVELDBDQUVDOztJQUVELDRDQWFDOztJQUVELDRDQVlDOzs7OztJQTFNVywwQ0FBaUM7Ozs7O0lBQUUsK0NBQTZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtDb21wb25lbnQsIElucHV0LCBPbkRlc3Ryb3ksIE9uSW5pdH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1N1YmplY3R9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtMaXZlQXBwc1NlcnZpY2V9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2xpdmUtYXBwcy5zZXJ2aWNlJztcbmltcG9ydCB7bWFwLCB0YWtlLCB0YWtlVW50aWx9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7Tm90ZSwgTm90ZVRocmVhZCwgTm90aWZpY2F0aW9uTGlzdCwgVGhyZWFkTGlzdH0gZnJvbSAnLi4vLi4vbW9kZWxzL2xpdmVhcHBzZGF0YSc7XG5pbXBvcnQge0xpdmVBcHBzQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtY29tcG9uZW50L2xpdmUtYXBwcy1jb21wb25lbnQuY29tcG9uZW50JztcbmltcG9ydCB7VG9vbGJhckJ1dHRvbn0gZnJvbSAnQHRpYmNvLXRjc3RrL3RjLWNvcmUtbGliJztcbmltcG9ydCB7VGNCdXR0b25zSGVscGVyU2VydmljZX0gZnJvbSAnQHRpYmNvLXRjc3RrL3RjLWNvcmUtbGliJztcblxuXG4vKipcbiAqIFRoaXMgQ29tcG9uZW50IGFsbG93cyB0byBsaXN0LCBhbmQgYWRkIE5vdGVzIHRvIGEgQ2FzZS1JbnN0YW5jZSBvciBvdGhlciBDb250ZXh0IGUuZy4gYSB3aG9sZSBBcHBsaWNhdGlvbi5cbiAqIEFueSBOb3RlIGNhbiBoYXZlIFN1Yi1Ob3RlcyB0byBhbGxvdyByZWFsIGNvbGxhYm9yYXRpb24uXG4gKlxuICogIVthbHQtdGV4dF0oLi4vbGl2ZS1hcHBzLW5vdGVzLnBuZyBcIk5vdGVzIENvbXBvbmVudCBJbWFnZVwiKVxuICpcbiAqQGV4YW1wbGUgPHRjbGEtbGl2ZS1hcHBzLW5vdGVzPjwvdGNsYS1saXZlLWFwcHMtbm90ZXM+XG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3RjbGEtbGl2ZS1hcHBzLW5vdGVzJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2xpdmUtYXBwcy1ub3Rlcy5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2xpdmUtYXBwcy1ub3Rlcy5jb21wb25lbnQuY3NzJ11cbn0pXG5cbmV4cG9ydCBjbGFzcyBMaXZlQXBwc05vdGVzQ29tcG9uZW50IGV4dGVuZHMgTGl2ZUFwcHNDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICAvKipcbiAgICogaXRlbVR5cGUgZm9yIG5vdGVzIGNvbGxlY3Rpb25cbiAgICovXG4gIEBJbnB1dCgpIHJlbGF0ZWRJdGVtVHlwZTogc3RyaW5nOyAvLyB1c2UgJ0NBU0VfQVBQJyB0byBzaGFyZSBub3RlcyB3aXRoIGNhc2UgbWFuYWdlclxuXG4gIC8qKlxuICAgKiBpdGVtSWQgZm9yIG5vdGVzIGNvbGxlY3Rpb25cbiAgICovXG4gIEBJbnB1dCgpIHJlbGF0ZWRJdGVtSWQ6IHN0cmluZzsgLy8gJ2Nhc2VSZWYnIGZvciBjYXNlIHJlbGF0ZWRcblxuICAvKipcbiAgICogVGhlIElEIG9mIHRoZSBsb2dnZWQgdXNlclxuICAgKi9cbiAgQElucHV0KCkgdXNlcklkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gc2hvdyB0aGUgaGVhZGVyIGJhciBpbiB0aGUgd2lkZ2V0IC0gZWcuIGZhdm9yaXRlcyBvbiBob21lIHBhZ2UgKGNvbnRhaW5zIGljb24gZXRjKSAtIGlmIG9mZiBpY29ucyBzdGlsbCBhcHBlYXIgd2l0aG91dCBiYXJcbiAgICovXG4gIEBJbnB1dCgpIHNob3dIZWFkZXI6IGJvb2xlYW4gPSB0aGlzLnNob3dIZWFkZXIgPyB0aGlzLnNob3dIZWFkZXIgOiB0cnVlO1xuXG4gIHB1YmxpYyBub3RlczogTm90ZVtdO1xuICBwdWJsaWMgZXJyb3JNZXNzYWdlOiBzdHJpbmc7XG4gIHB1YmxpYyBuZXdOb3RlOiBhbnkgPSB7fTtcbiAgcHVibGljIG5ld05vdGVJZDogbnVtYmVyO1xuICBwdWJsaWMgZGVsTm90ZUlkOiBudW1iZXI7XG4gIHB1YmxpYyB0aHJlYWRzOiBUaHJlYWRMaXN0O1xuICBwdWJsaWMgc3Vic2NyaWJlZDogQm9vbGVhbjtcbiAgcHVibGljIHNraXAgPSAwO1xuICBwdWJsaWMgdG9wID0gNTtcbiAgcHVibGljIGVuZCA9IGZhbHNlO1xuICBwdWJsaWMgdG9vbGJhckJ1dHRvbnM6IFRvb2xiYXJCdXR0b25bXSA9IFtdO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbGl2ZWFwcHM6IExpdmVBcHBzU2VydmljZSwgcHJpdmF0ZSBidXR0b25zSGVscGVyOiBUY0J1dHRvbnNIZWxwZXJTZXJ2aWNlKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIHB1YmxpYyByZWZyZXNoID0gKCkgPT4ge1xuICAgIHRoaXMuc2tpcCA9IDA7XG4gICAgdGhpcy50b3AgPSA1O1xuICAgIHRoaXMuZW5kID0gZmFsc2U7XG4gICAgaWYgKHRoaXMudGhyZWFkcyAmJiB0aGlzLnRocmVhZHMudGhyZWFkcykge1xuICAgICAgdGhpcy50aHJlYWRzLnRocmVhZHMubGVuZ3RoID0gMDtcbiAgICB9XG4gICAgdGhpcy5nZXRCYXRjaCgpO1xuICAgIHRoaXMuZ2V0Tm90aWZpY2F0aW9ucygpO1xuICB9XG5cbiAgcHVibGljIGdldEJhdGNoID0gKCkgPT4ge1xuICAgIGlmICghdGhpcy5lbmQpIHtcbiAgICAgIHRoaXMubGl2ZWFwcHMuZ2V0VGhyZWFkcyh0aGlzLnJlbGF0ZWRJdGVtVHlwZSwgdGhpcy5yZWxhdGVkSXRlbUlkLCB0aGlzLnNraXAsIHRoaXMudG9wKVxuICAgICAgICAucGlwZShcbiAgICAgICAgICB0YWtlKDEpLFxuICAgICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQkKSxcbiAgICAgICAgICBtYXAodGhyZWFkTGlzdCA9PiB7XG4gICAgICAgICAgICBpZiAoIXRoaXMudGhyZWFkcykge1xuICAgICAgICAgICAgICB0aGlzLnRocmVhZHMgPSB0aHJlYWRMaXN0O1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgLy8gdGhpcyB3aWxsIHN0cmlwIGFueSBkdXBsaWNhdGVzIHRoYXQgbWF5IGhhdmUgYmVlbiByZXRyaWV2ZWQgZHVlIHRvIGZhc3Qgc2Nyb2xsaW5nXG4gICAgICAgICAgICAgIGNvbnN0IGZpbHRlcmVkRXZlbnRzID0gdGhyZWFkTGlzdC50aHJlYWRzLmZpbHRlcih4ID0+IHRoaXMudGhyZWFkcy50aHJlYWRzLmV2ZXJ5KHkgPT4geS5ub3RlLmlkICE9PSB4Lm5vdGUuaWQpKTtcbiAgICAgICAgICAgICAgdGhpcy50aHJlYWRzLnRocmVhZHMgPSB0aGlzLnRocmVhZHMudGhyZWFkcy5jb25jYXQoZmlsdGVyZWRFdmVudHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRocmVhZExpc3QudGhyZWFkcy5sZW5ndGggPCB0aGlzLnRvcCkge1xuICAgICAgICAgICAgICB0aGlzLmVuZCA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICB0aGlzLnNraXAgPSB0aGlzLnNraXAgKyB0aHJlYWRMaXN0LnRocmVhZHMubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICApLnN1YnNjcmliZShudWxsLCBlcnJvciA9PiB7XG4gICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gJ0Vycm9yIHJldHJpZXZpbmcgbm90ZXM6ICcgKyBlcnJvci5lcnJvci5lcnJvck1zZztcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyB0b2dnbGVSZXBsaWVzID0gKHRocmVhZCkgPT4ge1xuICAgIHRocmVhZC5zaG93UmVwbGllcyA9ICF0aHJlYWQuc2hvd1JlcGxpZXM7XG4gIH1cblxuICBwdWJsaWMgdG9nZ2xlTmV3UmVwbHkgPSAodGhyZWFkKSA9PiB7XG4gICAgaWYgKCF0aHJlYWQubmV3UmVwbHkpIHtcbiAgICAgIHRocmVhZC5uZXdSZXBseSA9IHt9O1xuICAgIH1cbiAgICBpZiAodGhyZWFkLnNob3dSZXBsaWVzICYmICF0aHJlYWQuc2hvd05ld1JlcGx5KSB7XG4gICAgICB0aHJlYWQubmV3UmVwbHkgPSB7fTtcbiAgICAgIHRocmVhZC5zaG93TmV3UmVwbHkgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJlYWQuc2hvd05ld1JlcGx5ID0gIXRocmVhZC5zaG93TmV3UmVwbHk7XG4gICAgICB0aHJlYWQuc2hvd1JlcGxpZXMgPSAhdGhyZWFkLnNob3dSZXBsaWVzO1xuICAgIH1cblxuICB9XG5cbiAgcHVibGljIGNyZWF0ZVJlcGx5ID0gKHRocmVhZCwgcmVwbHlUZXh0KSA9PiB7XG4gICAgdGhpcy5saXZlYXBwcy5jcmVhdGVSZXBseU5vdGUodGhyZWFkLm5vdGUsIHJlcGx5VGV4dCwgdGhyZWFkLm5vdGUuaWQpXG4gICAgICAucGlwZShcbiAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3llZCQpLFxuICAgICAgICBtYXAocmVzdWx0ID0+IHtcbiAgICAgICAgICB0aGlzLm5ld05vdGVJZCA9IHJlc3VsdDtcbiAgICAgICAgICB0aHJlYWQubmV3UmVwbHkudGV4dCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgfSlcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUobnVsbCwgZXJyb3IgPT4gdGhpcy5lcnJvck1lc3NhZ2UgPSAnRXJyb3IgY3JlYXRpbmcgbmV3IG5vdGU6ICcgKyBlcnJvci5lcnJvci5lcnJvck1lc3NhZ2UpO1xuICB9XG5cbiAgcHVibGljIGNyZWF0ZVRocmVhZCA9IChub3RlVGV4dCkgPT4ge1xuICAgIGlmIChub3RlVGV4dCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmxpdmVhcHBzLmNyZWF0ZU5vdGUodGhpcy5yZWxhdGVkSXRlbVR5cGUsICdSVF9DQVNFJywgdGhpcy5yZWxhdGVkSXRlbUlkLCAnY29tbWVudHMgdXBkYXRlJywgJycsICcnLCBub3RlVGV4dClcbiAgICAgICAgLnBpcGUoXG4gICAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveWVkJCksXG4gICAgICAgICAgbWFwKHJlc3VsdCA9PiB7XG4gICAgICAgICAgICB0aGlzLm5ld05vdGVJZCA9IHJlc3VsdDtcbiAgICAgICAgICAgIHRoaXMubmV3Tm90ZS50ZXh0ID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgICAuc3Vic2NyaWJlKG51bGwsIGVycm9yID0+IHRoaXMuZXJyb3JNZXNzYWdlID0gJ0Vycm9yIGNyZWF0aW5nIG5ldyBub3RlOiAnICsgZXJyb3IuZXJyb3IuZXJyb3JNZXNzYWdlKTtcbiAgICB9XG4gIH1cblxuXG4gIHByb3RlY3RlZCBjcmVhdGVUb29sYmFyQnV0dG9ucyA9IChzdWJzY3JpYmVkKTogVG9vbGJhckJ1dHRvbltdID0+IHtcbiAgICBjb25zdCBzdWJzY3JpYmVCdXR0b246IFRvb2xiYXJCdXR0b24gPSB0aGlzLmJ1dHRvbnNIZWxwZXIuY3JlYXRlQnV0dG9uKFxuICAgICAgJ3N1YnNjcmliZScsICd0Y3MtY29sbGFib3JhdGlvbi11bnN1YnNjcmliZWQnLCB0cnVlLCAnRW5hYmxlIE5vdGlmaWNhdGlvbnMnLCAhc3Vic2NyaWJlZCwgIXN1YnNjcmliZWQpO1xuICAgIGNvbnN0IHVuU3Vic2NyaWJlQnV0dG9uOiBUb29sYmFyQnV0dG9uID0gdGhpcy5idXR0b25zSGVscGVyLmNyZWF0ZUJ1dHRvbihcbiAgICAgICd1bnN1YnNjcmliZScsICd0Y3MtY29sbGFib3JhdGlvbi1zdWJzY3JpYmVkJywgdHJ1ZSwgJ0Rpc2FibGUgTm90aWZpY2F0aW9ucycsIHN1YnNjcmliZWQsIHN1YnNjcmliZWQpO1xuICAgIGNvbnN0IGJ1dHRvbnMgPSBbIHN1YnNjcmliZUJ1dHRvbiwgdW5TdWJzY3JpYmVCdXR0b24gXTtcbiAgICByZXR1cm4gYnV0dG9ucztcbiAgfVxuXG4gIHB1YmxpYyBzZXR1cE5vdGlmaWNhdGlvbkJ1dHRvbnMgPSAoc3Vic2NyaWJlZDogYm9vbGVhbikgPT4ge1xuICAgIGNvbnN0IGJ1dHRvbnM6IFRvb2xiYXJCdXR0b25bXSA9IHRoaXMuY3JlYXRlVG9vbGJhckJ1dHRvbnMoc3Vic2NyaWJlZCk7XG4gICAgdGhpcy5idXR0b25zSGVscGVyLnVwZGF0ZUJ1dHRvbnMoYnV0dG9ucywgdGhpcy50b29sYmFyQnV0dG9ucyk7XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlQnV0dG9uRGVmID0gKHVwZGF0ZWRUb29sYmFyQnV0dG9uczogVG9vbGJhckJ1dHRvbltdKSA9PiB7XG4gICAgdXBkYXRlZFRvb2xiYXJCdXR0b25zLmZvckVhY2goIHVwZGF0ZWRCdXR0b24gPT4ge1xuICAgICAgY29uc3QgaWR4ID0gdGhpcy50b29sYmFyQnV0dG9ucy5maW5kSW5kZXgoaXRlbSA9PiBpdGVtLmlkID09PSB1cGRhdGVkQnV0dG9uLmlkKTtcbiAgICAgIHRoaXMudG9vbGJhckJ1dHRvbnNbaWR4XSA9IHVwZGF0ZWRCdXR0b247XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgaGFuZGxlVG9vbGJhckJ1dHRvbkV2ZW50ID0gKGlkKSA9PiB7XG4gICAgaWYgKGlkID09PSAnc3Vic2NyaWJlJykge1xuICAgICAgdGhpcy5zdWJzY3JpYmUoKTtcbiAgICB9IGVsc2UgaWYgKGlkID09PSAndW5zdWJzY3JpYmUnKSB7XG4gICAgICB0aGlzLnVuc3Vic2NyaWJlKCk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHJlY3JlYXRlQnV0dG9uc0Zvck5vdGlmaWNhdGlvbnMgPSAoc3Vic2NyaWJlZCkgPT4ge1xuICAgICAgY29uc3QgYnV0dG9uczogVG9vbGJhckJ1dHRvbltdID0gdGhpcy5jcmVhdGVUb29sYmFyQnV0dG9ucyhzdWJzY3JpYmVkKTtcbiAgICAgIHRoaXMuYnV0dG9uc0hlbHBlci51cGRhdGVCdXR0b25zKGJ1dHRvbnMsIHRoaXMudG9vbGJhckJ1dHRvbnMpO1xuICB9XG5cbiAgcHVibGljIGdldE5vdGlmaWNhdGlvbnMgPSAoKSA9PiB7XG4gICAgdGhpcy5saXZlYXBwcy5nZXROb3RpZmljYXRpb25zKHRoaXMucmVsYXRlZEl0ZW1UeXBlLCB0aGlzLnJlbGF0ZWRJdGVtSWQsIHRoaXMudXNlcklkKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRha2UoMSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQkKSxcbiAgICAgICAgbWFwKHJlc3VsdCA9PiB7XG4gICAgICAgICAgY29uc3Qgbm90aWZpY2F0aW9uTGlzdDogTm90aWZpY2F0aW9uTGlzdCA9IHJlc3VsdDtcbiAgICAgICAgICBpZiAobm90aWZpY2F0aW9uTGlzdC5ub3RpZmljYXRpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRoaXMuc3Vic2NyaWJlZCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLnNldHVwTm90aWZpY2F0aW9uQnV0dG9ucyh0cnVlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVkID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnNldHVwTm90aWZpY2F0aW9uQnV0dG9ucyhmYWxzZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZShudWxsLCBlcnJvciA9PiB0aGlzLmVycm9yTWVzc2FnZSA9ICdFcnJvciBjcmVhdGluZyBuZXcgbm90ZTogJyArIGVycm9yLmVycm9yLmVycm9yTWVzc2FnZSk7XG4gIH1cblxuICBwdWJsaWMgc3Vic2NyaWJlID0gKCkgPT4ge1xuICAgIHRoaXMubGl2ZWFwcHMuc3Vic2NyaWJlVG9Ob3Rlcyh0aGlzLnJlbGF0ZWRJdGVtVHlwZSwgdGhpcy5yZWxhdGVkSXRlbUlkKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRha2UoMSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQkKSxcbiAgICAgICAgbWFwKHJlc3VsdCA9PiB7XG4gICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgdGhpcy5zdWJzY3JpYmVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMucmVjcmVhdGVCdXR0b25zRm9yTm90aWZpY2F0aW9ucyh0cnVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKG51bGwsIGVycm9yID0+IHRoaXMuZXJyb3JNZXNzYWdlID0gJ0Vycm9yIGNyZWF0aW5nIG5ldyBub3RlOiAnICsgZXJyb3IuZXJyb3IuZXJyb3JNZXNzYWdlKTtcbiAgfVxuXG4gIHB1YmxpYyB1bnN1YnNjcmliZSA9ICgpID0+IHtcbiAgICB0aGlzLmxpdmVhcHBzLnVuc3Vic2NyaWJlVG9Ob3Rlcyh0aGlzLnJlbGF0ZWRJdGVtVHlwZSwgdGhpcy5yZWxhdGVkSXRlbUlkLCB0aGlzLnVzZXJJZClcbiAgICAgIC5waXBlKFxuICAgICAgICB0YWtlKDEpLFxuICAgICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveWVkJCksXG4gICAgICAgIG1hcChyZXN1bHQgPT4ge1xuICAgICAgICAgIHRoaXMuc3Vic2NyaWJlZCA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMucmVjcmVhdGVCdXR0b25zRm9yTm90aWZpY2F0aW9ucyhmYWxzZSk7XG4gICAgICAgIH0pXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKG51bGwsIGVycm9yID0+IHRoaXMuZXJyb3JNZXNzYWdlID0gJ0Vycm9yIGNyZWF0aW5nIG5ldyBub3RlOiAnICsgZXJyb3IuZXJyb3IuZXJyb3JNZXNzYWdlKTtcbiAgfVxuXG4gIHB1YmxpYyBlZGl0Tm90ZSA9ICh0aHJlYWQpID0+IHtcbiAgICB0aHJlYWQuZWRpdE1vZGUgPSAhdGhyZWFkLmVkaXRNb2RlO1xuICB9XG5cbiAgcHVibGljIHVwZGF0ZU5vdGUgPSAobm90ZSwgdXBkYXRlZFRleHQpID0+IHtcbiAgICBjb25zb2xlLmxvZygnVXBkYXRpbmcgbm90ZScpO1xuICAgIG5vdGUudGV4dCA9IHVwZGF0ZWRUZXh0O1xuICAgIHRoaXMubGl2ZWFwcHMudXBkYXRlTm90ZShub3RlLCBub3RlLmlkKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRha2UoMSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQkKSxcbiAgICAgICAgbWFwKHJlc3VsdCA9PiB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ05vdGUgdXBkYXRlZCcpO1xuICAgICAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgICB9KVxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZShudWxsLCBlcnJvciA9PiB0aGlzLmVycm9yTWVzc2FnZSA9ICdFcnJvciB1cGRhdGluZyBub3RlOiAnICsgZXJyb3IuZXJyb3IuZXJyb3JNZXNzYWdlKTtcbiAgfVxuXG4gIHB1YmxpYyBkZWxldGVOb3RlID0gKGlkKSA9PiB7XG4gICAgY29uc29sZS5sb2coJ0RlbGV0aW5nIG5vdGUnKTtcbiAgICB0aGlzLmxpdmVhcHBzLmRlbGV0ZU5vdGUoaWQpXG4gICAgICAucGlwZShcbiAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3llZCQpLFxuICAgICAgICBtYXAocmVzdWx0ID0+IHtcbiAgICAgICAgICBjb25zb2xlLmxvZygnTm90ZSBkZWxldGVkOiAnICsgcmVzdWx0KTtcbiAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcbiAgICAgICAgfSlcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUobnVsbCwgZXJyb3IgPT4gdGhpcy5lcnJvck1lc3NhZ2UgPSAnRXJyb3IgY3JlYXRpbmcgbmV3IG5vdGU6ICcgKyBlcnJvci5lcnJvci5lcnJvck1lc3NhZ2UpO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgdGhpcy5uZXdOb3RlLnRleHQgPSAnJztcblxuICB9XG5cbn1cbiJdfQ==