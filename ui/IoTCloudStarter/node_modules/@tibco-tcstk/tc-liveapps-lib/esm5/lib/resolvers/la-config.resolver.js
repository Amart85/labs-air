/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
// this resolver wraps claims and appConfig resolvers because we need claims to get and set AppConfig to default values.
// we actually cache the claims call using a HTTP interceptor to avoid making multiple REST calls
// note: claims only changes on logout/login so no point making lots of calls to claims
import { Injectable } from '@angular/core';
import { forkJoin } from 'rxjs';
import { GeneralConfigResolver, TcGeneralConfigService } from '@tibco-tcstk/tc-core-lib';
import { flatMap, map } from 'rxjs/operators';
import { TcSharedStateService } from '@tibco-tcstk/tc-core-lib';
import { ClaimsResolver } from './claims.resolver';
import { LiveAppsService } from '../services/live-apps.service';
import { HttpClient } from '@angular/common/http';
import { TcDocumentService } from '../services/tc-document.service';
import { LiveAppsConfigHolder } from '../models/tc-liveapps-config';
import { LiveAppsConfigResolver } from './liveapps-config.resolver';
import { TcLiveAppsConfigService } from '../services/tc-live-apps-config.service';
import { TcCaseCardConfigService } from '../services/tc-case-card-config.service';
import { Location } from '@angular/common';
var LaConfigResolver = /** @class */ (function () {
    function LaConfigResolver(sharedStateService, generalConfigService, liveAppsConfigService, documentService, http, liveAppsService, caseCardConfigService, location) {
        this.sharedStateService = sharedStateService;
        this.generalConfigService = generalConfigService;
        this.liveAppsConfigService = liveAppsConfigService;
        this.documentService = documentService;
        this.http = http;
        this.liveAppsService = liveAppsService;
        this.caseCardConfigService = caseCardConfigService;
        this.location = location;
    }
    /**
     * @param {?} routeSnapshot
     * @return {?}
     */
    LaConfigResolver.prototype.resolve = /**
     * @param {?} routeSnapshot
     * @return {?}
     */
    function (routeSnapshot) {
        // we will return a holder object that contains both general config and live apps config
        var _this = this;
        // we will return a holder object that contains both general config and live apps config
        /** @type {?} */
        var generalConfigResolver = new GeneralConfigResolver(this.sharedStateService, this.generalConfigService, this.http, this.location);
        /** @type {?} */
        var liveAppsConfigResolver = new LiveAppsConfigResolver(this.sharedStateService, this.liveAppsConfigService, this.caseCardConfigService, this.http, this.location);
        /** @type {?} */
        var claimResolver$ = new ClaimsResolver(this.liveAppsService).resolve().pipe(flatMap((/**
         * @param {?} value
         * @return {?}
         */
        function (value) {
            /** @type {?} */
            var sandboxId = value.primaryProductionSandbox.id;
            generalConfigResolver.setSandbox(Number(sandboxId));
            liveAppsConfigResolver.setSandbox(Number(sandboxId));
            /** @type {?} */
            var generalConfig$ = generalConfigResolver.resolve();
            /** @type {?} */
            var liveAppsConfig$ = liveAppsConfigResolver.resolve(routeSnapshot);
            /** @type {?} */
            var forkJoinArray = [generalConfig$, liveAppsConfig$];
            return forkJoin(forkJoinArray).pipe(map((/**
             * @param {?} resultArr
             * @return {?}
             */
            function (resultArr) {
                return new LiveAppsConfigHolder().deserialize({ generalConfig: resultArr[0], liveAppsConfig: resultArr[1] });
            })));
        })));
        /** @type {?} */
        var resolveResp$ = claimResolver$.pipe(flatMap((/**
         * @param {?} liveAppsConfigHolder
         * @return {?}
         */
        function (liveAppsConfigHolder) {
            /** @type {?} */
            var iconsFolder$ = _this.documentService.initOrgFolder(liveAppsConfigHolder.generalConfig.uiAppId + '_Icons');
            /** @type {?} */
            var docsFolder$ = _this.documentService.initOrgFolder(liveAppsConfigHolder.generalConfig.uiAppId + '_Docs');
            /** @type {?} */
            var forkJoinArray = [iconsFolder$, docsFolder$];
            return forkJoin(forkJoinArray).pipe(map((/**
             * @param {?} resultArr
             * @return {?}
             */
            function (resultArr) {
                return liveAppsConfigHolder;
            })));
        })));
        return resolveResp$;
    };
    LaConfigResolver.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    LaConfigResolver.ctorParameters = function () { return [
        { type: TcSharedStateService },
        { type: TcGeneralConfigService },
        { type: TcLiveAppsConfigService },
        { type: TcDocumentService },
        { type: HttpClient },
        { type: LiveAppsService },
        { type: TcCaseCardConfigService },
        { type: Location }
    ]; };
    return LaConfigResolver;
}());
export { LaConfigResolver };
if (false) {
    /**
     * @type {?}
     * @private
     */
    LaConfigResolver.prototype.sharedStateService;
    /**
     * @type {?}
     * @private
     */
    LaConfigResolver.prototype.generalConfigService;
    /**
     * @type {?}
     * @private
     */
    LaConfigResolver.prototype.liveAppsConfigService;
    /**
     * @type {?}
     * @private
     */
    LaConfigResolver.prototype.documentService;
    /**
     * @type {?}
     * @private
     */
    LaConfigResolver.prototype.http;
    /**
     * @type {?}
     * @private
     */
    LaConfigResolver.prototype.liveAppsService;
    /**
     * @type {?}
     * @private
     */
    LaConfigResolver.prototype.caseCardConfigService;
    /**
     * @type {?}
     * @private
     */
    LaConfigResolver.prototype.location;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGEtY29uZmlnLnJlc29sdmVyLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHRpYmNvLXRjc3RrL3RjLWxpdmVhcHBzLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9yZXNvbHZlcnMvbGEtY29uZmlnLnJlc29sdmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFJQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTNDLE9BQU8sRUFBQyxRQUFRLEVBQWlCLE1BQU0sTUFBTSxDQUFDO0FBQzlDLE9BQU8sRUFBQyxxQkFBcUIsRUFBOEIsc0JBQXNCLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQztBQUNuSCxPQUFPLEVBQUMsT0FBTyxFQUFFLEdBQUcsRUFBVyxNQUFNLGdCQUFnQixDQUFDO0FBQ3RELE9BQU8sRUFBQyxvQkFBb0IsRUFBQyxNQUFNLDBCQUEwQixDQUFDO0FBRTlELE9BQU8sRUFBQyxjQUFjLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUNqRCxPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0sK0JBQStCLENBQUM7QUFDOUQsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLHNCQUFzQixDQUFDO0FBQ2hELE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLGlDQUFpQyxDQUFDO0FBQ2xFLE9BQU8sRUFBaUIsb0JBQW9CLEVBQUMsTUFBTSw4QkFBOEIsQ0FBQztBQUNsRixPQUFPLEVBQUMsc0JBQXNCLEVBQUMsTUFBTSw0QkFBNEIsQ0FBQztBQUNsRSxPQUFPLEVBQUMsdUJBQXVCLEVBQUMsTUFBTSx5Q0FBeUMsQ0FBQztBQUNoRixPQUFPLEVBQUMsdUJBQXVCLEVBQUMsTUFBTSx5Q0FBeUMsQ0FBQztBQUNoRixPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFFekM7SUFHRSwwQkFBb0Isa0JBQXdDLEVBQVUsb0JBQTRDLEVBQVUscUJBQThDLEVBQVUsZUFBa0MsRUFBVSxJQUFnQixFQUFVLGVBQWdDLEVBQVUscUJB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aEIsdUJBQUM7Q0FBQSxBQTlDRCxJQThDQztTQTdDWSxnQkFBZ0I7Ozs7OztJQUVmLDhDQUFnRDs7Ozs7SUFBRSxnREFBb0Q7Ozs7O0lBQUUsaURBQXNEOzs7OztJQUFFLDJDQUEwQzs7Ozs7SUFBRSxnQ0FBd0I7Ozs7O0lBQUUsMkNBQXdDOzs7OztJQUFFLGlEQUFzRDs7Ozs7SUFBRSxvQ0FBMEIiLCJzb3VyY2VzQ29udGVudCI6WyIvLyB0aGlzIHJlc29sdmVyIHdyYXBzIGNsYWltcyBhbmQgYXBwQ29uZmlnIHJlc29sdmVycyBiZWNhdXNlIHdlIG5lZWQgY2xhaW1zIHRvIGdldCBhbmQgc2V0IEFwcENvbmZpZyB0byBkZWZhdWx0IHZhbHVlcy5cbi8vIHdlIGFjdHVhbGx5IGNhY2hlIHRoZSBjbGFpbXMgY2FsbCB1c2luZyBhIEhUVFAgaW50ZXJjZXB0b3IgdG8gYXZvaWQgbWFraW5nIG11bHRpcGxlIFJFU1QgY2FsbHNcbi8vIG5vdGU6IGNsYWltcyBvbmx5IGNoYW5nZXMgb24gbG9nb3V0L2xvZ2luIHNvIG5vIHBvaW50IG1ha2luZyBsb3RzIG9mIGNhbGxzIHRvIGNsYWltc1xuXG5pbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0FjdGl2YXRlZFJvdXRlU25hcHNob3QsIFJlc29sdmV9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQge2ZvcmtKb2luLCBPYnNlcnZhYmxlLCBvZn0gZnJvbSAncnhqcyc7XG5pbXBvcnQge0dlbmVyYWxDb25maWdSZXNvbHZlciwgVWlBcHBDb25maWcsIEdlbmVyYWxDb25maWcsIFRjR2VuZXJhbENvbmZpZ1NlcnZpY2V9IGZyb20gJ0B0aWJjby10Y3N0ay90Yy1jb3JlLWxpYic7XG5pbXBvcnQge2ZsYXRNYXAsIG1hcCwgbWVyZ2VNYXB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7VGNTaGFyZWRTdGF0ZVNlcnZpY2V9IGZyb20gJ0B0aWJjby10Y3N0ay90Yy1jb3JlLWxpYic7XG5pbXBvcnQge0NsYWltfSBmcm9tICdAdGliY28tdGNzdGsvdGMtY29yZS1saWInO1xuaW1wb3J0IHtDbGFpbXNSZXNvbHZlcn0gZnJvbSAnLi9jbGFpbXMucmVzb2x2ZXInO1xuaW1wb3J0IHtMaXZlQXBwc1NlcnZpY2V9IGZyb20gJy4uL3NlcnZpY2VzL2xpdmUtYXBwcy5zZXJ2aWNlJztcbmltcG9ydCB7SHR0cENsaWVudH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHtUY0RvY3VtZW50U2VydmljZX0gZnJvbSAnLi4vc2VydmljZXMvdGMtZG9jdW1lbnQuc2VydmljZSc7XG5pbXBvcnQge0xpdmVBcHBzQ29uZmlnLCBMaXZlQXBwc0NvbmZpZ0hvbGRlcn0gZnJvbSAnLi4vbW9kZWxzL3RjLWxpdmVhcHBzLWNvbmZpZyc7XG5pbXBvcnQge0xpdmVBcHBzQ29uZmlnUmVzb2x2ZXJ9IGZyb20gJy4vbGl2ZWFwcHMtY29uZmlnLnJlc29sdmVyJztcbmltcG9ydCB7VGNMaXZlQXBwc0NvbmZpZ1NlcnZpY2V9IGZyb20gJy4uL3NlcnZpY2VzL3RjLWxpdmUtYXBwcy1jb25maWcuc2VydmljZSc7XG5pbXBvcnQge1RjQ2FzZUNhcmRDb25maWdTZXJ2aWNlfSBmcm9tICcuLi9zZXJ2aWNlcy90Yy1jYXNlLWNhcmQtY29uZmlnLnNlcnZpY2UnO1xuaW1wb3J0IHtMb2NhdGlvbn0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIExhQ29uZmlnUmVzb2x2ZXIgaW1wbGVtZW50cyBSZXNvbHZlPE9ic2VydmFibGU8TGl2ZUFwcHNDb25maWdIb2xkZXI+PiB7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBzaGFyZWRTdGF0ZVNlcnZpY2U6IFRjU2hhcmVkU3RhdGVTZXJ2aWNlLCBwcml2YXRlIGdlbmVyYWxDb25maWdTZXJ2aWNlOiBUY0dlbmVyYWxDb25maWdTZXJ2aWNlLCBwcml2YXRlIGxpdmVBcHBzQ29uZmlnU2VydmljZTogVGNMaXZlQXBwc0NvbmZpZ1NlcnZpY2UsIHByaXZhdGUgZG9jdW1lbnRTZXJ2aWNlOiBUY0RvY3VtZW50U2VydmljZSwgcHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50LCBwcml2YXRlIGxpdmVBcHBzU2VydmljZTogTGl2ZUFwcHNTZXJ2aWNlLCBwcml2YXRlIGNhc2VDYXJkQ29uZmlnU2VydmljZTogVGNDYXNlQ2FyZENvbmZpZ1NlcnZpY2UsIHByaXZhdGUgbG9jYXRpb246IExvY2F0aW9uKSB7fVxuXG4gIHJlc29sdmUocm91dGVTbmFwc2hvdDogQWN0aXZhdGVkUm91dGVTbmFwc2hvdCk6IE9ic2VydmFibGU8TGl2ZUFwcHNDb25maWdIb2xkZXI+IHtcbiAgICAvLyB3ZSB3aWxsIHJldHVybiBhIGhvbGRlciBvYmplY3QgdGhhdCBjb250YWlucyBib3RoIGdlbmVyYWwgY29uZmlnIGFuZCBsaXZlIGFwcHMgY29uZmlnXG5cbiAgICBjb25zdCBnZW5lcmFsQ29uZmlnUmVzb2x2ZXIgPSBuZXcgR2VuZXJhbENvbmZpZ1Jlc29sdmVyKHRoaXMuc2hhcmVkU3RhdGVTZXJ2aWNlLCB0aGlzLmdlbmVyYWxDb25maWdTZXJ2aWNlLCB0aGlzLmh0dHAsIHRoaXMubG9jYXRpb24pO1xuICAgIGNvbnN0IGxpdmVBcHBzQ29uZmlnUmVzb2x2ZXIgPSBuZXcgTGl2ZUFwcHNDb25maWdSZXNvbHZlcih0aGlzLnNoYXJlZFN0YXRlU2VydmljZSwgdGhpcy5saXZlQXBwc0NvbmZpZ1NlcnZpY2UsIHRoaXMuY2FzZUNhcmRDb25maWdTZXJ2aWNlLCB0aGlzLmh0dHAsIHRoaXMubG9jYXRpb24pO1xuXG4gICAgY29uc3QgY2xhaW1SZXNvbHZlciQgPSBuZXcgQ2xhaW1zUmVzb2x2ZXIodGhpcy5saXZlQXBwc1NlcnZpY2UpLnJlc29sdmUoKS5waXBlKFxuICAgICAgZmxhdE1hcCh2YWx1ZSA9PiB7XG4gICAgICAgICAgY29uc3Qgc2FuZGJveElkID0gdmFsdWUucHJpbWFyeVByb2R1Y3Rpb25TYW5kYm94LmlkO1xuICAgICAgICAgIGdlbmVyYWxDb25maWdSZXNvbHZlci5zZXRTYW5kYm94KE51bWJlcihzYW5kYm94SWQpKTtcbiAgICAgICAgICBsaXZlQXBwc0NvbmZpZ1Jlc29sdmVyLnNldFNhbmRib3goTnVtYmVyKHNhbmRib3hJZCkpO1xuXG4gICAgICAgICAgY29uc3QgZ2VuZXJhbENvbmZpZyQgPSBnZW5lcmFsQ29uZmlnUmVzb2x2ZXIucmVzb2x2ZSgpO1xuICAgICAgICAgIGNvbnN0IGxpdmVBcHBzQ29uZmlnJCA9IGxpdmVBcHBzQ29uZmlnUmVzb2x2ZXIucmVzb2x2ZShyb3V0ZVNuYXBzaG90KTtcbiAgICAgICAgICBjb25zdCBmb3JrSm9pbkFycmF5ID0gW2dlbmVyYWxDb25maWckLCBsaXZlQXBwc0NvbmZpZyRdO1xuICAgICAgICAgIHJldHVybiBmb3JrSm9pbihmb3JrSm9pbkFycmF5KS5waXBlKFxuICAgICAgICAgICAgbWFwKHJlc3VsdEFyciA9PiB7XG4gICAgICAgICAgICAgIHJldHVybiBuZXcgTGl2ZUFwcHNDb25maWdIb2xkZXIoKS5kZXNlcmlhbGl6ZSh7IGdlbmVyYWxDb25maWc6IHJlc3VsdEFyclswXSwgbGl2ZUFwcHNDb25maWc6IHJlc3VsdEFyclsxXSB9KTtcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgICAgICApXG4gICAgKTtcblxuICAgIGNvbnN0IHJlc29sdmVSZXNwJCA9IGNsYWltUmVzb2x2ZXIkLnBpcGUoXG4gICAgICBmbGF0TWFwKGxpdmVBcHBzQ29uZmlnSG9sZGVyID0+IHtcbiAgICAgICAgY29uc3QgaWNvbnNGb2xkZXIkID0gdGhpcy5kb2N1bWVudFNlcnZpY2UuaW5pdE9yZ0ZvbGRlcihsaXZlQXBwc0NvbmZpZ0hvbGRlci5nZW5lcmFsQ29uZmlnLnVpQXBwSWQgKyAnX0ljb25zJyk7XG4gICAgICAgIGNvbnN0IGRvY3NGb2xkZXIkID0gdGhpcy5kb2N1bWVudFNlcnZpY2UuaW5pdE9yZ0ZvbGRlcihsaXZlQXBwc0NvbmZpZ0hvbGRlci5nZW5lcmFsQ29uZmlnLnVpQXBwSWQgKyAnX0RvY3MnKTtcbiAgICAgICAgY29uc3QgZm9ya0pvaW5BcnJheSA9IFtpY29uc0ZvbGRlciQsIGRvY3NGb2xkZXIkXTtcbiAgICAgICAgcmV0dXJuIGZvcmtKb2luKGZvcmtKb2luQXJyYXkpLnBpcGUoXG4gICAgICAgICAgbWFwKFxuICAgICAgICAgICAgcmVzdWx0QXJyID0+IHtcbiAgICAgICAgICAgICAgcmV0dXJuIGxpdmVBcHBzQ29uZmlnSG9sZGVyO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICAgIH0pXG4gICAgKVxuXG4gICAgcmV0dXJuIHJlc29sdmVSZXNwJDtcbiAgfVxuXG59XG4iXX0=