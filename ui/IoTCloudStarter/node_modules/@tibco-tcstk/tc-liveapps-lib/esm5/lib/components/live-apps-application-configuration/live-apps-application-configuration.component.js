/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
/*
*     Case Type icons are stored in an orgFolder specified in liveAppsConfig.json (pushed to shared state)
*     Icon Name will be appId.filename.svg
*     Icon svg should contain <DYNAMICFILL> this will be set according to the color selected in this component
*
*     eg: 1742.ic-created.svg for Partner Portal Live Apps App (appId: 1742) 'Created' state
*
*     <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14">
*        <path fill="<DYNAMICFILL>" class="svg-content" fill-rule="evenodd" d="M7 14A7 7 0 1 1 7 0a7 7 0 0 1 0 14zm3.474-6.472a.527.527 0 0 0 0-1.053H7.526V3.527a.525.525 0 1 0-1.052 0v2.948H3.526a.527.527 0 0 0 0 1.053h2.948v2.948a.525.525 0 0 0 .898.373.525.525 0 0 0 .154-.373V7.528h2.948z"/>
*      </svg>
*
*
 */
import { Component, EventEmitter, Inject, Input, Output, QueryList, ViewChildren } from '@angular/core';
import { LiveAppsService } from '../../services/live-apps.service';
import { CaseTypeState, IconMap } from '../../models/liveappsdata';
import { map, take, takeUntil } from 'rxjs/operators';
import { HttpClient } from '@angular/common/http';
import { DomSanitizer } from '@angular/platform-browser';
import { LiveAppsCaseSummaryComponent } from '../live-apps-case-summary/live-apps-case-summary.component';
import { MAT_DIALOG_DATA, MatDialog, MatDialogRef } from '@angular/material';
import { Location } from '@angular/common';
import { LiveAppsComponent } from '../live-apps-component/live-apps-component.component';
import { DEFAULT_COLORS, DEFAULT_STATE_COLOR, DEFAULT_TYPE_COLOR, TcCaseCardConfigService } from '../../services/tc-case-card-config.service';
import { TcDocumentService } from '../../services/tc-document.service';
/**
 * Manages summary card configuration
 *
 * \@example <tcla-live-apps-application-configuration></tcla-live-apps-application-configuration>
 */
var LiveAppsApplicationConfigurationComponent = /** @class */ (function (_super) {
    tslib_1.__extends(LiveAppsApplicationConfigurationComponent, _super);
    function LiveAppsApplicationConfigurationComponent(http, sanitizer, liveapps, caseCardConfigService, documentsService, dialog, location) {
        var _this = _super.call(this) || this;
        _this.http = http;
        _this.sanitizer = sanitizer;
        _this.liveapps = liveapps;
        _this.caseCardConfigService = caseCardConfigService;
        _this.documentsService = documentsService;
        _this.dialog = dialog;
        _this.location = location;
        /**
         * ~event configChanged : Configuration values changed
         * ~payload CaseCardConfig : CaseCardConfig object when configuration is changed (so called can do a save with data)
         */
        _this.configChanged = new EventEmitter();
        // prepareExternalUrl will add the base href
        _this.DEFAULT_CASE_TYPE_ICON = 'assets/icons/ic-generic-casetype.svg';
        _this.DEFAULT_CASE_TYPE_COLOR = DEFAULT_TYPE_COLOR;
        _this.DEFAULT_CASE_STATE_ICON = 'assets/icons/ic-generic-state.svg';
        _this.DEFAULT_CASE_STATE_COLOR = DEFAULT_STATE_COLOR;
        _this.DEFAULT_COLOR_PALETTE = DEFAULT_COLORS;
        _this.getConfigForState = (/**
         * @param {?} state
         * @return {?}
         */
        function (state) {
            /** @type {?} */
            var reqIconMap;
            if (_this.caseCardConfig.cardConfig && _this.caseCardConfig.cardConfig.stateMap) {
                _this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    if (stateMap.state === state.value) {
                        reqIconMap = stateMap;
                    }
                }));
            }
            return reqIconMap ? reqIconMap : new IconMap(false, state.value, _this.DEFAULT_CASE_STATE_COLOR, _this.DEFAULT_CASE_STATE_ICON);
        });
        _this.getConfigForCaseType = (/**
         * @param {?} caseTypeId
         * @return {?}
         */
        function (caseTypeId) {
            /** @type {?} */
            var reqIconMap;
            if (_this.caseCardConfig.cardConfig && _this.caseCardConfig.cardConfig.stateMap) {
                _this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    if (stateMap.isCaseType) {
                        reqIconMap = stateMap;
                    }
                }));
            }
            return reqIconMap ? reqIconMap : new IconMap(true, caseTypeId, _this.DEFAULT_CASE_TYPE_COLOR, _this.DEFAULT_CASE_TYPE_ICON);
        });
        _this.updateIconMap = (/**
         * @param {?} stateConfig
         * @return {?}
         */
        function (stateConfig) {
            /** @type {?} */
            var foundMap;
            /** @type {?} */
            var updatedMap;
            if (_this.caseCardConfig.cardConfig && _this.caseCardConfig.cardConfig.stateMap) {
                _this.caseCardConfig.cardConfig.stateMap.forEach((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    if (stateMap.state === stateConfig.state) {
                        foundMap = stateConfig;
                        stateMap.state = stateConfig.state;
                        stateMap.icon = stateConfig.icon;
                        stateMap.fill = stateConfig.fill;
                    }
                }));
                if (foundMap) {
                    foundMap = stateConfig;
                }
                else {
                    _this.caseCardConfig.cardConfig.stateMap.push(stateConfig);
                }
            }
            else {
                _this.caseCardConfig.cardConfig.stateMap = [];
                _this.caseCardConfig.cardConfig.stateMap.push(stateConfig);
            }
            _this.configChanged.emit(_this.caseCardConfig);
        });
        _this.handleCaseTypeColorToggleChange = (/**
         * @param {?} changes
         * @return {?}
         */
        function (changes) {
            _this.caseCardConfig.cardConfig.useCaseTypeColor = changes.checked ? changes.checked : false;
            if (changes.checked) {
                _this.caseSummaryComponent.forEach((/**
                 * @param {?} comp
                 * @return {?}
                 */
                function (comp) {
                    comp.restylePreview(_this.selectedStateConfig.icon, _this.caseTypeColor);
                }));
            }
            _this.configChanged.emit(_this.caseCardConfig);
        });
        _this.setFill = (/**
         * @param {?} fill
         * @param {?} stateConfig
         * @return {?}
         */
        function (fill, stateConfig) {
            _this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                comp.restylePreview(stateConfig.icon, fill);
            }));
            _this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return comp.id === stateConfig.state;
            })).refillSVG(fill);
            _this.configChanged.emit(_this.caseCardConfig);
        });
        _this.setCaseTypeFill = (/**
         * @param {?} fill
         * @param {?} stateConfig
         * @return {?}
         */
        function (fill, stateConfig) {
            _this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                comp.restylePreviewCaseType(stateConfig.icon, fill);
            }));
            _this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return (comp.id === stateConfig.state && stateConfig.isCaseType);
            })).refillSVG(fill);
            _this.configChanged.emit(_this.caseCardConfig);
        });
        _this.selectState = (/**
         * @param {?} state
         * @return {?}
         */
        function (state) {
            _this.selectedStateConfig = _this.getConfigForState(state);
            if (!_this.caseCardConfig.cardConfig.useCaseTypeColor) {
                _this.caseSummaryComponent.forEach((/**
                 * @param {?} comp
                 * @return {?}
                 */
                function (comp) {
                    comp.restylePreview(_this.selectedStateConfig.icon, _this.selectedStateConfig.fill);
                }));
            }
        });
        _this.setNewStateIcon = (/**
         * @param {?} url
         * @return {?}
         */
        function (url) {
            _this.selectedStateConfig.icon = url;
            _this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return (comp.id === _this.selectedStateConfig.state);
            })).refresh(_this.selectedStateConfig.icon, _this.selectedStateConfig.fill);
            _this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                comp.restylePreview(_this.selectedStateConfig.icon, _this.selectedStateConfig.fill);
            }));
            _this.updateIconMap(_this.selectedStateConfig);
        });
        _this.setNewCaseTypeIcon = (/**
         * @param {?} url
         * @return {?}
         */
        function (url) {
            _this.caseTypeIcon = url;
            _this.stateIconComponents.find((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                return (comp.id === _this.appTypeLabel);
            })).refresh(_this.caseTypeIcon, _this.caseTypeColor);
            _this.caseSummaryComponent.forEach((/**
             * @param {?} comp
             * @return {?}
             */
            function (comp) {
                comp.restylePreviewCaseType(_this.caseTypeIcon, _this.caseTypeColor);
            }));
            _this.updateIconMap(new IconMap(true, _this.appTypeLabel, _this.caseTypeColor, _this.caseTypeIcon));
        });
        _this.refresh = (/**
         * @return {?}
         */
        function () {
            // need states & cardConfig
            _this.selectedCaseTypeConfig = null;
            _this.caseCardConfigService.getCaseCardConfig(_this.sandboxId, _this.appId, _this.uiAppId, _this.appTypeLabel, _this.DEFAULT_CASE_TYPE_COLOR, _this.DEFAULT_CASE_TYPE_ICON, _this.DEFAULT_CASE_STATE_COLOR, _this.DEFAULT_CASE_STATE_ICON).pipe(take(1), takeUntil(_this._destroyed$), map((/**
             * @param {?} caseCardConfig
             * @return {?}
             */
            function (caseCardConfig) {
                _this.caseCardConfig = caseCardConfig;
                // set default selected to first state for this case type (0 is case type)
                _this.selectedStateConfig = _this.caseCardConfig.cardConfig.stateMap[1];
                /** @type {?} */
                var caseTypeRec = _this.caseCardConfig.cardConfig.stateMap.find((/**
                 * @param {?} stateMap
                 * @return {?}
                 */
                function (stateMap) {
                    return stateMap.isCaseType;
                }));
                _this.caseTypeIcon = caseTypeRec.icon;
                _this.caseTypeColor = caseTypeRec.fill;
                _this.selectedCaseTypeConfig = _this.getConfigForCaseType(_this.appTypeLabel);
            }))).subscribe(null, (/**
             * @param {?} error
             * @return {?}
             */
            function (error) { _this.errorMessage = 'Error retrieving case card config: ' + error.error.errorMsg; }));
        });
        return _this;
    }
    /*public saveConfig = () => {
      this.caseCardConfigService.updateCaseCardConfig(this.sandboxId, this.appId, this.uiAppId, this.caseCardConfig)
        .pipe(
          take(1),
          takeUntil(this._destroyed$),
          map(caseCardConfig => {
            this.caseCardConfig = caseCardConfig;
          })
        ).subscribe(null, error => { console.log('Unable to update case card config: ' + error.errorMsg); }
      );
    }*/
    /*public saveConfig = () => {
        this.caseCardConfigService.updateCaseCardConfig(this.sandboxId, this.appId, this.uiAppId, this.caseCardConfig)
          .pipe(
            take(1),
            takeUntil(this._destroyed$),
            map(caseCardConfig => {
              this.caseCardConfig = caseCardConfig;
            })
          ).subscribe(null, error => { console.log('Unable to update case card config: ' + error.errorMsg); }
        );
      }*/
    /**
     * @param {?} state
     * @param {?} isCaseType
     * @return {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.openDialog = /*public saveConfig = () => {
        this.caseCardConfigService.updateCaseCardConfig(this.sandboxId, this.appId, this.uiAppId, this.caseCardConfig)
          .pipe(
            take(1),
            takeUntil(this._destroyed$),
            map(caseCardConfig => {
              this.caseCardConfig = caseCardConfig;
            })
          ).subscribe(null, error => { console.log('Unable to update case card config: ' + error.errorMsg); }
        );
      }*/
    /**
     * @param {?} state
     * @param {?} isCaseType
     * @return {?}
     */
    function (state, isCaseType) {
        var _this = this;
        if (!isCaseType) {
            this.selectState(state);
        }
        else {
            state = new CaseTypeState().deserialize({ value: this.appTypeLabel });
        }
        /** @type {?} */
        var dialogRef = this.dialog.open(LiveAppsStateIconUploadDialogComponent, {
            width: '500px',
            data: { state: state, isCaseType: isCaseType }
        });
        dialogRef.componentInstance.fileevent.subscribe((/**
         * @param {?} $e
         * @return {?}
         */
        function ($e) {
            _this.uploadFile($e.file, $e.state, $e.isCaseType);
        }));
        dialogRef.afterClosed().subscribe((/**
         * @param {?} result
         * @return {?}
         */
        function (result) {
        }));
    };
    /**
     * @param {?} file
     * @param {?} state
     * @param {?} isStateIcon
     * @return {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.uploadFile = /**
     * @param {?} file
     * @param {?} state
     * @param {?} isStateIcon
     * @return {?}
     */
    function (file, state, isStateIcon) {
        var _this = this;
        if (file) {
            /** @type {?} */
            var url = 'webresource/v1/orgFolders/' + this.folderId + '/' + this.appId + '.' + file.name;
            /** @type {?} */
            var dlUrl_1 = 'webresource/orgFolders/' + this.folderId + '/' + this.appId + '.' + file.name;
            this.liveapps.clearFromIconSVGTextCache(url);
            this.documentsService.uploadDocument('orgFolders', this.folderId, this.sandboxId, file, (this.appId + '.' + file.name), '')
                .pipe(map((/**
             * @param {?} val
             * @return {?}
             */
            function (val) {
                if (!isStateIcon) {
                    _this.setNewStateIcon(dlUrl_1);
                }
                else {
                    _this.setNewCaseTypeIcon(dlUrl_1);
                }
            })))
                .subscribe((/**
             * @param {?} result
             * @return {?}
             */
            function (result) { return null; }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) { console.log('error'); _this.errorMessage = 'Error uploading state icon: ' + error.errorMsg; }));
        }
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.appId && (changes.appId.currentValue !== changes.appId.previousValue)) {
            this.refresh();
        }
    };
    LiveAppsApplicationConfigurationComponent.decorators = [
        { type: Component, args: [{
                    selector: 'tcla-live-apps-application-configuration',
                    template: "<div *ngIf=\"appId\" class=\"tcs-case-card-customization\" fxLayout=\"column\">\n    <div fxLayout=\"row\" fxLayoutAlign=\"space-around stretch\" fxFlex>\n      <div fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n        <div fxLayout=\"column\" fxLayoutAlign=\"start center\">\n          <div class=\"tcs-case-card-customization-section-text\">Preview</div>\n        </div>\n        <div class=\"tcs-case-card-customization-preview\" fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n          <div *ngIf=\"selectedStateConfig && caseTypeColor && caseTypeIcon\" style=\"border-radius: 3px; margin: 5px;\" fxLayout=\"column\" fxLayoutAlign=\"space-around center\">\n            <tcla-live-apps-case-summary style=\"margin: 5px;\" [displayType]=\"'card'\" [typeBar]=\"true\" [configMode]=\"true\" [configModeColor]=\"caseCardConfig.cardConfig.useCaseTypeColor ? caseTypeColor : selectedStateConfig.fill\" [configModeIcon]=\"selectedStateConfig.icon\" [configModeCaseTypeColor]=\"caseTypeColor\" [configModeCaseTypeIcon]=\"caseTypeIcon\" [configModeAppTypeLabel]=\"appTypeLabel\"></tcla-live-apps-case-summary>\n            <tcla-live-apps-case-summary style=\"margin: 5px;\" [displayType]=\"'miniCard'\" [typeBar]=\"true\" [configMode]=\"true\" [configModeColor]=\"caseCardConfig.cardConfig.useCaseTypeColor ? caseTypeColor : selectedStateConfig.fill\" [configModeIcon]=\"selectedStateConfig.icon\" [configModeCaseTypeColor]=\"caseTypeColor\" [configModeCaseTypeIcon]=\"caseTypeIcon\" [configModeAppTypeLabel]=\"appTypeLabel\"></tcla-live-apps-case-summary>\n          </div>\n        </div>\n      </div>\n      <div class=\"tcs-case-card-customization-divider\"></div>\n      <div fxLayout=\"column\" fxLayoutAlign=\"start center\" fxFlex>\n        <div fxLayout=\"column\" fxLayoutAlign=\"start center\">\n          <div class=\"tcs-case-card-customization-section-text\">Configure Icons</div>\n        </div>\n        <div fxFlex>\n          <div fxFlex class=\"tcs-case-states-list\" *ngIf=\"caseCardConfig && caseCardConfig.cardConfig && caseCardConfig.states\" fxLayout=\"column\" fxLayoutAlign=\"start center\">\n            <div class=\"tcs-case-states-list-inner\">\n              <div class=\"case-type-color-toggle\">\n                <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                  <mat-slide-toggle\n                  class=\"use-case-type-color\"\n                  [labelPosition]=\"'before'\"\n                  [checked]=\"caseCardConfig.cardConfig.useCaseTypeColor\"\n                  (change)=\"handleCaseTypeColorToggleChange($event)\">\n                  Use Case Type Color for color bar\n                  </mat-slide-toggle>\n                </div>\n              </div>\n              <div class=\"tcs-case-states-list-row\">\n                  <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <div fxLayoutAlign=\"start center\" style=\"min-width: 170px;\">Case Type Icon</div>\n                    <tcla-live-apps-state-icon style=\"margin-left: 10px; margin-right: 10px; min-width: 14px;\" #iconcomp [id]=\"appTypeLabel\" [iconPath]=\"selectedCaseTypeConfig.icon\" [color]=\"selectedCaseTypeConfig.fill\"\n                                               [appId]=\"appId\" [(colorPicker)]=\"selectedCaseTypeConfig.fill\" (colorPickerChange)=\"setCaseTypeFill($event, selectedCaseTypeConfig)\" [cpPresetColors]=\"DEFAULT_COLOR_PALETTE\" [cpPositionOffset]=\"'-40%'\"\n                                              matTooltip=\"Click to change color\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </tcla-live-apps-state-icon>\n                    <mat-icon (click)=\"openDialog(null, true)\" class=\"tcs-icon tcs-icon-active tcs-config-button tcs-document-upload-button\" svgIcon=\"tcs-document-upload\"\n                              matTooltip=\"Click to upload new icon\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </mat-icon>\n                    <mat-icon class=\"tcs-icon tcs-icon-active tcs-config-button-placeholder\"></mat-icon>\n                  </div>\n              </div>\n              <div class=\"tcs-case-states-icon-divider\"></div>\n              <!-- case state icons -->\n              <div *ngFor=\"let state of caseCardConfig.states\" class=\"tcs-case-states-list-row\" (click)=\"selectState(state)\">\n                <div *ngIf=\"getConfigForState(state); let stateConfig;\">\n                  <div fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n                    <div fxLayoutAlign=\"start center\" style=\"min-width: 170px;\">{{state.label | ellipsis: 25}}</div>\n                    <tcla-live-apps-state-icon style=\"margin-left: 10px; margin-right: 10px; min-width: 14px;\" #iconcomp [id]=\"state.value\" [iconPath]=\"stateConfig.icon\" [color]=\"stateConfig.fill\"\n                                               [appId]=\"appId\" [(colorPicker)]=\"stateConfig.fill\" (colorPickerChange)=\"setFill($event, stateConfig)\" [cpPresetColors]=\"DEFAULT_COLOR_PALETTE\" [cpPositionOffset]=\"'-40%'\"\n                                              matTooltip=\"Click to change color\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </tcla-live-apps-state-icon>\n                    <mat-icon (click)=\"openDialog(state, false)\" class=\"tcs-icon tcs-icon-active tcs-config-button tcs-document-upload-button\" svgIcon=\"tcs-document-upload\"\n                              matTooltip=\"Click to upload new icon\" matTooltipShowDelay=\"1000\" matTooltipPosition=\"below\">\n                    </mat-icon>\n                    <mat-icon class=\"tcs-icon tcs-icon-active tcs-config-button-placeholder\"></mat-icon>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  <!--div class=\"tcs-case-card-customization-footer\" fxLayout=\"column\" fxLayoutAlign=\"end stretch\">\n    <div class=\"tcs-case-card-customization-action-buttons\" fxLayout=\"row\" fxLayoutAlign=\"center center\">\n      <button class=\"tcs-save-app-config-button\" mat-button (click)=\"saveConfig()\" type=\"submit\">Save Configuration</button>\n    </div>\n  </div-->\n</div>\n",
                    styles: [".tcs-case-card-customization{min-width:775px;min-height:370px;background-color:#fff}.tcs-case-card-customization *{font-family:Source Sans Pro;font-size:12px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;text-align:center;color:#000}.case-type-color-toggle{margin-bottom:10px;margin-top:10px}.tcs-case-card-customization-header{height:40px;border-radius:3px 3px 0 0;box-shadow:0 1px 2px 0 #dedede;padding-left:20px;padding-right:20px}.tcs-case-card-customization .tcs-case-card-customization-header-text{font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:1.5;letter-spacing:.3px;text-align:left;color:#000;margin-left:10px}.tcs-case-card-customization-action-buttons{margin-top:10px;margin-bottom:10px}.tcs-case-card-customization-divider{padding:0;margin:4px 5px 0;border-left:1.1px solid #f4f4f4}.tcs-case-card-customization .tcs-case-card-customization-section-text{font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;color:#000}.tcs-case-states-list{margin:5px}.tcs-case-card-customization-preview app-live-apps-case-summary,.tcs-case-states-list-inner{overflow-y:auto}.tcs-case-states-list-row{border-radius:3px;padding:3px;margin-left:15px;margin-right:15px}.tcs-case-states-list-row:hover{-webkit-transition:background-color .5s;transition:background-color .5s;background-color:#eef0f7}.tcs-icon-active.tcs-config-button{display:none}.tcs-icon-active.tcs-config-button-placeholder{display:inline-block;width:24px}.tcs-case-states-list-row:hover .tcs-icon-active.tcs-config-button{display:inline-block}.tcs-case-states-list-row:hover .tcs-icon-active.tcs-config-button-placeholder{display:none}.tcs-case-states-icon-divider{padding:0;margin:2px 15px 4px 10px;border-bottom:1.1px solid #f4f4f4}.tcs-save-app-config-button{height:35px}"]
                }] }
    ];
    /** @nocollapse */
    LiveAppsApplicationConfigurationComponent.ctorParameters = function () { return [
        { type: HttpClient },
        { type: DomSanitizer },
        { type: LiveAppsService },
        { type: TcCaseCardConfigService },
        { type: TcDocumentService },
        { type: MatDialog },
        { type: Location }
    ]; };
    LiveAppsApplicationConfigurationComponent.propDecorators = {
        stateIconComponents: [{ type: ViewChildren, args: ['iconcomp',] }],
        caseSummaryComponent: [{ type: ViewChildren, args: [LiveAppsCaseSummaryComponent,] }],
        appId: [{ type: Input }],
        appTypeLabel: [{ type: Input }],
        sandboxId: [{ type: Input }],
        uiAppId: [{ type: Input }],
        folderId: [{ type: Input }],
        configChanged: [{ type: Output }]
    };
    return LiveAppsApplicationConfigurationComponent;
}(LiveAppsComponent));
export { LiveAppsApplicationConfigurationComponent };
if (false) {
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.stateIconComponents;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseSummaryComponent;
    /**
     * The LA Application Id
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.appId;
    /**
     * The label shown above the case type in the configuration widget
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.appTypeLabel;
    /**
     * sandboxId - this comes from claims resolver
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.sandboxId;
    /**
     * The Application ID of the UI (should ideally be unique as it is shared state key)
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.uiAppId;
    /**
     * The organisation folder to store/retrieve documents
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.folderId;
    /**
     * ~event configChanged : Configuration values changed
     * ~payload CaseCardConfig : CaseCardConfig object when configuration is changed (so called can do a save with data)
     * @type {?}
     */
    LiveAppsApplicationConfigurationComponent.prototype.configChanged;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.errorMessage;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseCardConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectedStateConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectedCaseTypeConfig;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseTypeIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseTypeColor;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_TYPE_ICON;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_TYPE_COLOR;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_STATE_ICON;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_CASE_STATE_COLOR;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.DEFAULT_COLOR_PALETTE;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.getConfigForState;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.getConfigForCaseType;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.updateIconMap;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.handleCaseTypeColorToggleChange;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setFill;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setCaseTypeFill;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.selectState;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setNewStateIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.setNewCaseTypeIcon;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.refresh;
    /**
     * @type {?}
     * @private
     */
    LiveAppsApplicationConfigurationComponent.prototype.http;
    /**
     * @type {?}
     * @private
     */
    LiveAppsApplicationConfigurationComponent.prototype.sanitizer;
    /**
     * @type {?}
     * @private
     */
    LiveAppsApplicationConfigurationComponent.prototype.liveapps;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.caseCardConfigService;
    /**
     * @type {?}
     * @private
     */
    LiveAppsApplicationConfigurationComponent.prototype.documentsService;
    /** @type {?} */
    LiveAppsApplicationConfigurationComponent.prototype.dialog;
    /**
     * @type {?}
     * @private
     */
    LiveAppsApplicationConfigurationComponent.prototype.location;
}
var LiveAppsStateIconUploadDialogComponent = /** @class */ (function () {
    function LiveAppsStateIconUploadDialogComponent(dialogRef, data) {
        var _this = this;
        this.dialogRef = dialogRef;
        this.data = data;
        this.fileevent = new EventEmitter();
        this.fileToUpload = undefined;
        this.description = undefined;
        this.uploadFile = (/**
         * @return {?}
         */
        function () {
            if (_this.fileToUpload) {
                _this.fileevent.emit({ file: _this.fileToUpload, state: _this.data.state, isCaseType: _this.data.isCaseType });
                _this.dialogRef.close();
            }
        });
    }
    /**
     * @param {?} description
     * @return {?}
     */
    LiveAppsStateIconUploadDialogComponent.prototype.setFileDescription = /**
     * @param {?} description
     * @return {?}
     */
    function (description) {
        this.description = description;
    };
    /**
     * @param {?} files
     * @return {?}
     */
    LiveAppsStateIconUploadDialogComponent.prototype.attachFile = /**
     * @param {?} files
     * @return {?}
     */
    function (files) {
        this.fileToUpload = files.item(0);
        /*const myReader: FileReader = new FileReader();
        myReader.readAsText(this.fileToUpload);
        this.fileText = myReader.result.toString();*/
    };
    /**
     * @return {?}
     */
    LiveAppsStateIconUploadDialogComponent.prototype.onNoClick = /**
     * @return {?}
     */
    function () {
        this.dialogRef.close();
    };
    LiveAppsStateIconUploadDialogComponent.decorators = [
        { type: Component, args: [{
                    selector: 'tcla-live-apps-state-icon-upload-dialog',
                    template: "  <h1 mat-dialog-title>Upload New Icon (svg) for '{{data.state.value}}'</h1>\n  <div mat-dialog-content class=\"tcs-state-icon-upload-dialog\">\n    <form #fileUploadForm=\"ngForm\" fxFlex fxLayout=\"column\">\n      <div fxLayout=\"row\" fxLayoutAlign=\"start space-between\">\n        <button type=\"button\" mat-raised-button (click)=\"fileInput.click()\">Choose File To Upload</button>\n        <div *ngIf=\"fileToUpload\">{{fileToUpload.name}}</div>\n        <!-- below input is hidden and enabled by above button -->\n        <input class=\"tcs-hidden-input\" (change)=\"attachFile($event.target.files)\" accept=\"image/svg+xml\" #fileInput type=\"file\" id=\"file\">\n      </div>\n    </form>\n  </div>\n  <div mat-dialog-actions>\n    <button mat-button (click)=\"uploadFile()\" type=\"submit\" [disabled]=\"!fileToUpload\">Upload</button>\n    <button mat-button (click)=\"onNoClick()\">Cancel</button>\n  </div>\n",
                    styles: [".tcs-hidden-input{display:none}"]
                }] }
    ];
    /** @nocollapse */
    LiveAppsStateIconUploadDialogComponent.ctorParameters = function () { return [
        { type: MatDialogRef },
        { type: undefined, decorators: [{ type: Inject, args: [MAT_DIALOG_DATA,] }] }
    ]; };
    LiveAppsStateIconUploadDialogComponent.propDecorators = {
        fileevent: [{ type: Output }]
    };
    return LiveAppsStateIconUploadDialogComponent;
}());
export { LiveAppsStateIconUploadDialogComponent };
if (false) {
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileevent;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileToUpload;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.description;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.fileText;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.uploadFile;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.dialogRef;
    /** @type {?} */
    LiveAppsStateIconUploadDialogComponent.prototype.data;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24uY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHRpYmNvLXRjc3RrL3RjLWxpdmVhcHBzLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2xpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uL2xpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFjQSxPQUFPLEVBQ0wsU0FBUyxFQUNULFlBQVksRUFDWixNQUFNLEVBQ04sS0FBSyxFQUlMLE1BQU0sRUFDTixTQUFTLEVBRVQsWUFBWSxFQUNiLE1BQU0sZUFBZSxDQUFDO0FBRXZCLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxrQ0FBa0MsQ0FBQztBQUNqRSxPQUFPLEVBQWEsYUFBYSxFQUFFLE9BQU8sRUFBQyxNQUFNLDJCQUEyQixDQUFDO0FBQzdFLE9BQU8sRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBQ3BELE9BQU8sRUFBQyxVQUFVLEVBQWMsTUFBTSxzQkFBc0IsQ0FBQztBQUM3RCxPQUFPLEVBQUMsWUFBWSxFQUFXLE1BQU0sMkJBQTJCLENBQUM7QUFHakUsT0FBTyxFQUFDLDRCQUE0QixFQUFDLE1BQU0sNERBQTRELENBQUM7QUFDeEcsT0FBTyxFQUFDLGVBQWUsRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFDLE1BQU0sbUJBQW1CLENBQUM7QUFFM0UsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzNDLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLHNEQUFzRCxDQUFDO0FBRXZGLE9BQU8sRUFBQyxjQUFjLEVBQUUsbUJBQW1CLEVBQUUsa0JBQWtCLEVBQUUsdUJBQXVCLEVBQUMsTUFBTSw0Q0FBNEMsQ0FBQztBQUM1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UyxDQUFDLEtBQUssRUFBRSxDQUFDO2FBQ3hCO1FBQ0gsQ0FBQyxFQUFBO0lBUHFILENBQUM7Ozs7O0lBU3ZILG1FQUFrQjs7OztJQUFsQixVQUFtQixXQUFtQjtRQUNwQyxJQUFJLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQztJQUNqQyxDQUFDOzs7OztJQUVELDJEQUFVOzs7O0lBQVYsVUFBVyxLQUFlO1FBQ3hCLElBQUksQ0FBQyxZQUFZLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsQzs7cURBRTZDO0lBQy9DLENBQUM7Ozs7SUFFRCwwREFBUzs7O0lBQVQ7UUFDRSxJQUFJLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxDQUFDO0lBQ3pCLENBQUM7O2dCQWxDRixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLHlDQUF5QztvQkFDbkQsdzZCQUE2RTs7aUJBRTlFOzs7O2dCQWxSbUMsWUFBWTtnREEwUjZCLE1BQU0sU0FBQyxlQUFlOzs7NEJBTmhHLE1BQU07O0lBOEJULDZDQUFDO0NBQUEsQUFwQ0QsSUFvQ0M7U0EvQlksc0NBQXNDOzs7SUFDakQsMkRBQThDOztJQUM5Qyw4REFBc0M7O0lBQ3RDLDZEQUF1Qzs7SUFDdkMsMERBQXdCOztJQUt4Qiw0REFLQzs7SUFQQywyREFBc0U7O0lBQUUsc0RBQXlDIiwic291cmNlc0NvbnRlbnQiOlsiXG4vKlxuKiAgICAgQ2FzZSBUeXBlIGljb25zIGFyZSBzdG9yZWQgaW4gYW4gb3JnRm9sZGVyIHNwZWNpZmllZCBpbiBsaXZlQXBwc0NvbmZpZy5qc29uIChwdXNoZWQgdG8gc2hhcmVkIHN0YXRlKVxuKiAgICAgSWNvbiBOYW1lIHdpbGwgYmUgYXBwSWQuZmlsZW5hbWUuc3ZnXG4qICAgICBJY29uIHN2ZyBzaG91bGQgY29udGFpbiA8RFlOQU1JQ0ZJTEw+IHRoaXMgd2lsbCBiZSBzZXQgYWNjb3JkaW5nIHRvIHRoZSBjb2xvciBzZWxlY3RlZCBpbiB0aGlzIGNvbXBvbmVudFxuKlxuKiAgICAgZWc6IDE3NDIuaWMtY3JlYXRlZC5zdmcgZm9yIFBhcnRuZXIgUG9ydGFsIExpdmUgQXBwcyBBcHAgKGFwcElkOiAxNzQyKSAnQ3JlYXRlZCcgc3RhdGVcbipcbiogICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTRcIiBoZWlnaHQ9XCIxNFwiIHZpZXdCb3g9XCIwIDAgMTQgMTRcIj5cbiogICAgICAgIDxwYXRoIGZpbGw9XCI8RFlOQU1JQ0ZJTEw+XCIgY2xhc3M9XCJzdmctY29udGVudFwiIGZpbGwtcnVsZT1cImV2ZW5vZGRcIiBkPVwiTTcgMTRBNyA3IDAgMSAxIDcgMGE3IDcgMCAwIDEgMCAxNHptMy40NzQtNi40NzJhLjUyNy41MjcgMCAwIDAgMC0xLjA1M0g3LjUyNlYzLjUyN2EuNTI1LjUyNSAwIDEgMC0xLjA1MiAwdjIuOTQ4SDMuNTI2YS41MjcuNTI3IDAgMCAwIDAgMS4wNTNoMi45NDh2Mi45NDhhLjUyNS41MjUgMCAwIDAgLjg5OC4zNzMuNTI1LjUyNSAwIDAgMCAuMTU0LS4zNzNWNy41MjhoMi45NDh6XCIvPlxuKiAgICAgIDwvc3ZnPlxuKlxuKlxuICovXG5pbXBvcnQge1xuICBDb21wb25lbnQsXG4gIEV2ZW50RW1pdHRlcixcbiAgSW5qZWN0LFxuICBJbnB1dCxcbiAgT25DaGFuZ2VzLFxuICBPbkRlc3Ryb3ksXG4gIE9uSW5pdCxcbiAgT3V0cHV0LFxuICBRdWVyeUxpc3QsIFNpbXBsZUNoYW5nZXMsXG4gIFZpZXdDaGlsZCxcbiAgVmlld0NoaWxkcmVuXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtPYnNlcnZhYmxlLCBvZiwgU3ViamVjdH0gZnJvbSAncnhqcyc7XG5pbXBvcnQge0xpdmVBcHBzU2VydmljZX0gZnJvbSAnLi4vLi4vc2VydmljZXMvbGl2ZS1hcHBzLnNlcnZpY2UnO1xuaW1wb3J0IHtDYXJkQ29uZmlnLCBDYXNlVHlwZVN0YXRlLCBJY29uTWFwfSBmcm9tICcuLi8uLi9tb2RlbHMvbGl2ZWFwcHNkYXRhJztcbmltcG9ydCB7bWFwLCB0YWtlLCB0YWtlVW50aWx9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7SHR0cENsaWVudCwgSHR0cEhlYWRlcnN9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7RG9tU2FuaXRpemVyLCBTYWZlSHRtbH0gZnJvbSAnQGFuZ3VsYXIvcGxhdGZvcm0tYnJvd3Nlcic7XG5pbXBvcnQge0xpdmVBcHBzQ2FzZURhdGFDb21wb25lbnR9IGZyb20gJy4uL2xpdmUtYXBwcy1jYXNlLWRhdGEvbGl2ZS1hcHBzLWNhc2UtZGF0YS5jb21wb25lbnQnO1xuaW1wb3J0IHtMaXZlQXBwc1N0YXRlSWNvbkNvbXBvbmVudH0gZnJvbSAnLi4vbGl2ZS1hcHBzLXN0YXRlLWljb24vbGl2ZS1hcHBzLXN0YXRlLWljb24uY29tcG9uZW50JztcbmltcG9ydCB7TGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudH0gZnJvbSAnLi4vbGl2ZS1hcHBzLWNhc2Utc3VtbWFyeS9saXZlLWFwcHMtY2FzZS1zdW1tYXJ5LmNvbXBvbmVudCc7XG5pbXBvcnQge01BVF9ESUFMT0dfREFUQSwgTWF0RGlhbG9nLCBNYXREaWFsb2dSZWZ9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsJztcbmltcG9ydCB7TGl2ZUFwcHNEb2N1bWVudFVwbG9hZERpYWxvZ0NvbXBvbmVudH0gZnJvbSAnLi4vbGl2ZS1hcHBzLWRvY3VtZW50cy9saXZlLWFwcHMtZG9jdW1lbnRzLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBMb2NhdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5pbXBvcnQge0xpdmVBcHBzQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtY29tcG9uZW50L2xpdmUtYXBwcy1jb21wb25lbnQuY29tcG9uZW50JztcbmltcG9ydCB7Q2FzZUNhcmRDb25maWd9IGZyb20gJy4uLy4uL21vZGVscy90Yy1jYXNlLWNhcmQtY29uZmlnJztcbmltcG9ydCB7REVGQVVMVF9DT0xPUlMsIERFRkFVTFRfU1RBVEVfQ09MT1IsIERFRkFVTFRfVFlQRV9DT0xPUiwgVGNDYXNlQ2FyZENvbmZpZ1NlcnZpY2V9IGZyb20gJy4uLy4uL3NlcnZpY2VzL3RjLWNhc2UtY2FyZC1jb25maWcuc2VydmljZSc7XG5pbXBvcnQge1RjRG9jdW1lbnRTZXJ2aWNlfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy90Yy1kb2N1bWVudC5zZXJ2aWNlJztcblxuXG5cbi8qKlxuICogTWFuYWdlcyBzdW1tYXJ5IGNhcmQgY29uZmlndXJhdGlvblxuICpcbiAqQGV4YW1wbGUgPHRjbGEtbGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24+PC90Y2xhLWxpdmUtYXBwcy1hcHBsaWNhdGlvbi1jb25maWd1cmF0aW9uPlxuICovXG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3RjbGEtbGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24nLFxuICB0ZW1wbGF0ZVVybDogJy4vbGl2ZS1hcHBzLWFwcGxpY2F0aW9uLWNvbmZpZ3VyYXRpb24uY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9saXZlLWFwcHMtYXBwbGljYXRpb24tY29uZmlndXJhdGlvbi5jb21wb25lbnQuY3NzJ11cbn0pXG5leHBvcnQgY2xhc3MgTGl2ZUFwcHNBcHBsaWNhdGlvbkNvbmZpZ3VyYXRpb25Db21wb25lbnQgZXh0ZW5kcyBMaXZlQXBwc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XG4gIC8vIFRoZSBWaWV3Q2hpbGQgZGVjbGFyYXRpb25zIGdpdmUgYWNjZXNzIHRvIGNvbXBvbmVudHMgbWFya2VkIG9uIHRoZSB0ZW1wbGF0ZSBzbyB0aGF0IEkgY2FuIGNhbGwgcHVibGljIGZ1bmN0aW9ucyBsaWtlIHJlZnJlc2hcbiAgQFZpZXdDaGlsZHJlbignaWNvbmNvbXAnKSBzdGF0ZUljb25Db21wb25lbnRzOiBRdWVyeUxpc3Q8TGl2ZUFwcHNTdGF0ZUljb25Db21wb25lbnQ+O1xuICBAVmlld0NoaWxkcmVuKExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQpIGNhc2VTdW1tYXJ5Q29tcG9uZW50OiBRdWVyeUxpc3Q8TGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudD47XG5cbiAgLyoqXG4gICAqIFRoZSBMQSBBcHBsaWNhdGlvbiBJZFxuICAgKi9cbiAgQElucHV0KCkgYXBwSWQ6IHN0cmluZztcblxuICAvKipcbiAgICogVGhlIGxhYmVsIHNob3duIGFib3ZlIHRoZSBjYXNlIHR5cGUgaW4gdGhlIGNvbmZpZ3VyYXRpb24gd2lkZ2V0XG4gICAqL1xuICBASW5wdXQoKSBhcHBUeXBlTGFiZWw6IHN0cmluZztcblxuICAvKipcbiAgICogc2FuZGJveElkIC0gdGhpcyBjb21lcyBmcm9tIGNsYWltcyByZXNvbHZlclxuICAgKi9cbiAgQElucHV0KCkgc2FuZGJveElkOiBudW1iZXI7XG5cbiAgLyoqXG4gICAqIFRoZSBBcHBsaWNhdGlvbiBJRCBvZiB0aGUgVUkgKHNob3VsZCBpZGVhbGx5IGJlIHVuaXF1ZSBhcyBpdCBpcyBzaGFyZWQgc3RhdGUga2V5KVxuICAgKi9cbiAgQElucHV0KCkgdWlBcHBJZDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUaGUgb3JnYW5pc2F0aW9uIGZvbGRlciB0byBzdG9yZS9yZXRyaWV2ZSBkb2N1bWVudHNcbiAgICovXG4gIEBJbnB1dCgpIGZvbGRlcklkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIH5ldmVudCBjb25maWdDaGFuZ2VkIDogQ29uZmlndXJhdGlvbiB2YWx1ZXMgY2hhbmdlZFxuICAgKiB+cGF5bG9hZCBDYXNlQ2FyZENvbmZpZyA6IENhc2VDYXJkQ29uZmlnIG9iamVjdCB3aGVuIGNvbmZpZ3VyYXRpb24gaXMgY2hhbmdlZCAoc28gY2FsbGVkIGNhbiBkbyBhIHNhdmUgd2l0aCBkYXRhKVxuICAgKi9cbiAgQE91dHB1dCgpIGNvbmZpZ0NoYW5nZWQ6IEV2ZW50RW1pdHRlcjxDYXNlQ2FyZENvbmZpZz4gPSBuZXcgRXZlbnRFbWl0dGVyPENhc2VDYXJkQ29uZmlnPigpO1xuXG4gIHB1YmxpYyBlcnJvck1lc3NhZ2U6IHN0cmluZztcbiAgcHVibGljIGNhc2VDYXJkQ29uZmlnOiBDYXNlQ2FyZENvbmZpZztcbiAgcHVibGljIHNlbGVjdGVkU3RhdGVDb25maWc6IEljb25NYXA7XG4gIHB1YmxpYyBzZWxlY3RlZENhc2VUeXBlQ29uZmlnOiBJY29uTWFwO1xuICBwdWJsaWMgY2FzZVR5cGVJY29uOiBzdHJpbmc7XG4gIHB1YmxpYyBjYXNlVHlwZUNvbG9yOiBzdHJpbmc7XG5cbiAgLy8gcHJlcGFyZUV4dGVybmFsVXJsIHdpbGwgYWRkIHRoZSBiYXNlIGhyZWZcbiAgcHVibGljIERFRkFVTFRfQ0FTRV9UWVBFX0lDT04gPSAnYXNzZXRzL2ljb25zL2ljLWdlbmVyaWMtY2FzZXR5cGUuc3ZnJztcbiAgcHVibGljIERFRkFVTFRfQ0FTRV9UWVBFX0NPTE9SID0gREVGQVVMVF9UWVBFX0NPTE9SO1xuICBwdWJsaWMgREVGQVVMVF9DQVNFX1NUQVRFX0lDT04gPSAnYXNzZXRzL2ljb25zL2ljLWdlbmVyaWMtc3RhdGUuc3ZnJztcbiAgcHVibGljIERFRkFVTFRfQ0FTRV9TVEFURV9DT0xPUiA9IERFRkFVTFRfU1RBVEVfQ09MT1I7XG4gIHB1YmxpYyBERUZBVUxUX0NPTE9SX1BBTEVUVEUgPSBERUZBVUxUX0NPTE9SUztcblxuICBwdWJsaWMgZ2V0Q29uZmlnRm9yU3RhdGUgPSAoc3RhdGU6IENhc2VUeXBlU3RhdGUpOiBJY29uTWFwID0+IHtcbiAgICBsZXQgcmVxSWNvbk1hcDogSWNvbk1hcDtcbiAgICBpZiAodGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnICYmIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcCkge1xuICAgICAgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwLmZvckVhY2goKHN0YXRlTWFwKSA9PiB7XG4gICAgICAgIGlmIChzdGF0ZU1hcC5zdGF0ZSA9PT0gc3RhdGUudmFsdWUpIHtcbiAgICAgICAgICByZXFJY29uTWFwID0gc3RhdGVNYXA7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcmVxSWNvbk1hcCA/IHJlcUljb25NYXAgOiBuZXcgSWNvbk1hcChmYWxzZSwgc3RhdGUudmFsdWUsIHRoaXMuREVGQVVMVF9DQVNFX1NUQVRFX0NPTE9SLCB0aGlzLkRFRkFVTFRfQ0FTRV9TVEFURV9JQ09OKTtcbiAgfVxuXG4gIHB1YmxpYyBnZXRDb25maWdGb3JDYXNlVHlwZSA9IChjYXNlVHlwZUlkOiBzdHJpbmcpOiBJY29uTWFwID0+IHtcbiAgICBsZXQgcmVxSWNvbk1hcDogSWNvbk1hcDtcbiAgICBpZiAodGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnICYmIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcCkge1xuICAgICAgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwLmZvckVhY2goKHN0YXRlTWFwKSA9PiB7XG4gICAgICAgIGlmIChzdGF0ZU1hcC5pc0Nhc2VUeXBlKSB7XG4gICAgICAgICAgcmVxSWNvbk1hcCA9IHN0YXRlTWFwO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlcUljb25NYXAgPyByZXFJY29uTWFwIDogbmV3IEljb25NYXAodHJ1ZSwgY2FzZVR5cGVJZCwgdGhpcy5ERUZBVUxUX0NBU0VfVFlQRV9DT0xPUiwgdGhpcy5ERUZBVUxUX0NBU0VfVFlQRV9JQ09OKTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVJY29uTWFwID0gKHN0YXRlQ29uZmlnOiBJY29uTWFwKSA9PiB7XG4gICAgbGV0IGZvdW5kTWFwOiBJY29uTWFwO1xuICAgIGxldCB1cGRhdGVkTWFwOiBJY29uTWFwO1xuICAgIGlmICh0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcgJiYgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwKSB7XG4gICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXAuZm9yRWFjaChmdW5jdGlvbihzdGF0ZU1hcCkge1xuICAgICAgICBpZiAoc3RhdGVNYXAuc3RhdGUgPT09IHN0YXRlQ29uZmlnLnN0YXRlKSB7XG4gICAgICAgICAgZm91bmRNYXAgPSBzdGF0ZUNvbmZpZztcbiAgICAgICAgICBzdGF0ZU1hcC5zdGF0ZSA9IHN0YXRlQ29uZmlnLnN0YXRlO1xuICAgICAgICAgIHN0YXRlTWFwLmljb24gPSBzdGF0ZUNvbmZpZy5pY29uO1xuICAgICAgICAgIHN0YXRlTWFwLmZpbGwgPSBzdGF0ZUNvbmZpZy5maWxsO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChmb3VuZE1hcCkge1xuICAgICAgICBmb3VuZE1hcCA9IHN0YXRlQ29uZmlnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnN0YXRlTWFwLnB1c2goc3RhdGVDb25maWcpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXAgPSBbXTtcbiAgICAgIHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcC5wdXNoKHN0YXRlQ29uZmlnKTtcbiAgICB9XG4gICAgdGhpcy5jb25maWdDaGFuZ2VkLmVtaXQodGhpcy5jYXNlQ2FyZENvbmZpZyk7XG4gIH1cblxuICBwdWJsaWMgaGFuZGxlQ2FzZVR5cGVDb2xvclRvZ2dsZUNoYW5nZSA9IChjaGFuZ2VzKSA9PiB7XG4gICAgdGhpcy5jYXNlQ2FyZENvbmZpZy5jYXJkQ29uZmlnLnVzZUNhc2VUeXBlQ29sb3IgPSBjaGFuZ2VzLmNoZWNrZWQgPyBjaGFuZ2VzLmNoZWNrZWQgOiBmYWxzZTtcbiAgICBpZiAoY2hhbmdlcy5jaGVja2VkKSB7XG4gICAgICB0aGlzLmNhc2VTdW1tYXJ5Q29tcG9uZW50LmZvckVhY2goKGNvbXA6IExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQpID0+IHtcbiAgICAgICAgY29tcC5yZXN0eWxlUHJldmlldyh0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuaWNvbiwgdGhpcy5jYXNlVHlwZUNvbG9yKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLmNvbmZpZ0NoYW5nZWQuZW1pdCh0aGlzLmNhc2VDYXJkQ29uZmlnKTtcbiAgfVxuXG4gIHB1YmxpYyBzZXRGaWxsID0gKGZpbGwsIHN0YXRlQ29uZmlnOiBJY29uTWFwKSA9PiB7XG4gICAgdGhpcy5jYXNlU3VtbWFyeUNvbXBvbmVudC5mb3JFYWNoKChjb21wOiBMaXZlQXBwc0Nhc2VTdW1tYXJ5Q29tcG9uZW50KSA9PiB7XG4gICAgICBjb21wLnJlc3R5bGVQcmV2aWV3KHN0YXRlQ29uZmlnLmljb24sIGZpbGwpO1xuICAgIH0pO1xuICAgIHRoaXMuc3RhdGVJY29uQ29tcG9uZW50cy5maW5kKGZ1bmN0aW9uKGNvbXApIHtcbiAgICAgIHJldHVybiBjb21wLmlkID09PSBzdGF0ZUNvbmZpZy5zdGF0ZTtcbiAgICB9KS5yZWZpbGxTVkcoZmlsbCk7XG4gICAgdGhpcy5jb25maWdDaGFuZ2VkLmVtaXQodGhpcy5jYXNlQ2FyZENvbmZpZyk7XG4gIH1cblxuICBwdWJsaWMgc2V0Q2FzZVR5cGVGaWxsID0gKGZpbGwsIHN0YXRlQ29uZmlnOiBJY29uTWFwKSA9PiB7XG4gICAgdGhpcy5jYXNlU3VtbWFyeUNvbXBvbmVudC5mb3JFYWNoKChjb21wOiBMaXZlQXBwc0Nhc2VTdW1tYXJ5Q29tcG9uZW50KSA9PiB7XG4gICAgICBjb21wLnJlc3R5bGVQcmV2aWV3Q2FzZVR5cGUoc3RhdGVDb25maWcuaWNvbiwgZmlsbCk7XG4gICAgfSk7XG4gICAgdGhpcy5zdGF0ZUljb25Db21wb25lbnRzLmZpbmQoZnVuY3Rpb24oY29tcCkge1xuICAgICAgcmV0dXJuIChjb21wLmlkID09PSBzdGF0ZUNvbmZpZy5zdGF0ZSAmJiBzdGF0ZUNvbmZpZy5pc0Nhc2VUeXBlKTtcbiAgICB9KS5yZWZpbGxTVkcoZmlsbCk7XG4gICAgdGhpcy5jb25maWdDaGFuZ2VkLmVtaXQodGhpcy5jYXNlQ2FyZENvbmZpZyk7XG4gIH1cblxuICBwdWJsaWMgc2VsZWN0U3RhdGUgPSAoc3RhdGU6IENhc2VUeXBlU3RhdGUpID0+IHtcbiAgICB0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcgPSB0aGlzLmdldENvbmZpZ0ZvclN0YXRlKHN0YXRlKTtcbiAgICBpZiAoIXRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy51c2VDYXNlVHlwZUNvbG9yKSB7XG4gICAgICB0aGlzLmNhc2VTdW1tYXJ5Q29tcG9uZW50LmZvckVhY2goKGNvbXA6IExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQpID0+IHtcbiAgICAgICAgY29tcC5yZXN0eWxlUHJldmlldyh0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuaWNvbiwgdGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLmZpbGwpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLypwdWJsaWMgc2F2ZUNvbmZpZyA9ICgpID0+IHtcbiAgICB0aGlzLmNhc2VDYXJkQ29uZmlnU2VydmljZS51cGRhdGVDYXNlQ2FyZENvbmZpZyh0aGlzLnNhbmRib3hJZCwgdGhpcy5hcHBJZCwgdGhpcy51aUFwcElkLCB0aGlzLmNhc2VDYXJkQ29uZmlnKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRha2UoMSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQkKSxcbiAgICAgICAgbWFwKGNhc2VDYXJkQ29uZmlnID0+IHtcbiAgICAgICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnID0gY2FzZUNhcmRDb25maWc7XG4gICAgICAgIH0pXG4gICAgICApLnN1YnNjcmliZShudWxsLCBlcnJvciA9PiB7IGNvbnNvbGUubG9nKCdVbmFibGUgdG8gdXBkYXRlIGNhc2UgY2FyZCBjb25maWc6ICcgKyBlcnJvci5lcnJvck1zZyk7IH1cbiAgICApO1xuICB9Ki9cblxuICBwdWJsaWMgb3BlbkRpYWxvZyhzdGF0ZTogQ2FzZVR5cGVTdGF0ZSwgaXNDYXNlVHlwZTogYm9vbGVhbik6IHZvaWQge1xuXG4gICAgaWYgKCFpc0Nhc2VUeXBlKSB7XG4gICAgICB0aGlzLnNlbGVjdFN0YXRlKHN0YXRlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc3RhdGUgPSBuZXcgQ2FzZVR5cGVTdGF0ZSgpLmRlc2VyaWFsaXplKHsgdmFsdWU6IHRoaXMuYXBwVHlwZUxhYmVsIH0pO1xuICAgIH1cbiAgICBjb25zdCBkaWFsb2dSZWYgPSB0aGlzLmRpYWxvZy5vcGVuKExpdmVBcHBzU3RhdGVJY29uVXBsb2FkRGlhbG9nQ29tcG9uZW50LCB7XG4gICAgICB3aWR0aDogJzUwMHB4JyxcbiAgICAgIGRhdGE6IHsgc3RhdGU6IHN0YXRlLCBpc0Nhc2VUeXBlOiBpc0Nhc2VUeXBlIH1cbiAgICB9KTtcblxuICAgIGRpYWxvZ1JlZi5jb21wb25lbnRJbnN0YW5jZS5maWxlZXZlbnQuc3Vic2NyaWJlKCgkZSkgPT4ge1xuICAgICAgdGhpcy51cGxvYWRGaWxlKCRlLmZpbGUsICRlLnN0YXRlLCAkZS5pc0Nhc2VUeXBlKTtcbiAgICB9KVxuXG4gICAgZGlhbG9nUmVmLmFmdGVyQ2xvc2VkKCkuc3Vic2NyaWJlKHJlc3VsdCA9PiB7XG4gICAgfSk7XG4gIH1cblxuICBwdWJsaWMgc2V0TmV3U3RhdGVJY29uID0gKHVybCkgPT4ge1xuICAgIHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5pY29uID0gdXJsO1xuICAgIHRoaXMuc3RhdGVJY29uQ29tcG9uZW50cy5maW5kKChjb21wOiBMaXZlQXBwc1N0YXRlSWNvbkNvbXBvbmVudCkgPT4ge1xuICAgICAgcmV0dXJuIChjb21wLmlkID09PSB0aGlzLnNlbGVjdGVkU3RhdGVDb25maWcuc3RhdGUpO1xuICAgIH0pLnJlZnJlc2godGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLmljb24sIHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5maWxsKTtcbiAgICB0aGlzLmNhc2VTdW1tYXJ5Q29tcG9uZW50LmZvckVhY2goKGNvbXA6IExpdmVBcHBzQ2FzZVN1bW1hcnlDb21wb25lbnQpID0+IHtcbiAgICAgIGNvbXAucmVzdHlsZVByZXZpZXcodGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnLmljb24sIHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZy5maWxsKTtcbiAgICB9KTtcbiAgICB0aGlzLnVwZGF0ZUljb25NYXAodGhpcy5zZWxlY3RlZFN0YXRlQ29uZmlnKTtcbiAgfVxuXG4gIHB1YmxpYyBzZXROZXdDYXNlVHlwZUljb24gPSAodXJsKSA9PiB7XG4gICAgdGhpcy5jYXNlVHlwZUljb24gPSB1cmw7XG4gICAgdGhpcy5zdGF0ZUljb25Db21wb25lbnRzLmZpbmQoKGNvbXA6IExpdmVBcHBzU3RhdGVJY29uQ29tcG9uZW50KSA9PiB7XG4gICAgICByZXR1cm4gKGNvbXAuaWQgPT09IHRoaXMuYXBwVHlwZUxhYmVsKTtcbiAgICB9KS5yZWZyZXNoKHRoaXMuY2FzZVR5cGVJY29uLCB0aGlzLmNhc2VUeXBlQ29sb3IpO1xuICAgIHRoaXMuY2FzZVN1bW1hcnlDb21wb25lbnQuZm9yRWFjaCgoY29tcDogTGl2ZUFwcHNDYXNlU3VtbWFyeUNvbXBvbmVudCkgPT4ge1xuICAgICAgY29tcC5yZXN0eWxlUHJldmlld0Nhc2VUeXBlKHRoaXMuY2FzZVR5cGVJY29uLCB0aGlzLmNhc2VUeXBlQ29sb3IpO1xuICAgIH0pO1xuICAgIHRoaXMudXBkYXRlSWNvbk1hcChuZXcgSWNvbk1hcCh0cnVlLCB0aGlzLmFwcFR5cGVMYWJlbCwgdGhpcy5jYXNlVHlwZUNvbG9yLCB0aGlzLmNhc2VUeXBlSWNvbikpO1xuICB9XG5cbiAgcHVibGljIHVwbG9hZEZpbGUoZmlsZTogRmlsZSwgc3RhdGU6IENhc2VUeXBlU3RhdGUsIGlzU3RhdGVJY29uOiBib29sZWFuKSB7XG4gICAgaWYgKGZpbGUpIHtcbiAgICAgIGNvbnN0IHVybCA9ICd3ZWJyZXNvdXJjZS92MS9vcmdGb2xkZXJzLycgKyB0aGlzLmZvbGRlcklkICsgJy8nICsgdGhpcy5hcHBJZCArICcuJyArIGZpbGUubmFtZTtcbiAgICAgIGNvbnN0IGRsVXJsID0gJ3dlYnJlc291cmNlL29yZ0ZvbGRlcnMvJyArIHRoaXMuZm9sZGVySWQgKyAnLycgKyB0aGlzLmFwcElkICsgJy4nICsgZmlsZS5uYW1lO1xuICAgICAgdGhpcy5saXZlYXBwcy5jbGVhckZyb21JY29uU1ZHVGV4dENhY2hlKHVybCk7XG4gICAgICB0aGlzLmRvY3VtZW50c1NlcnZpY2UudXBsb2FkRG9jdW1lbnQoJ29yZ0ZvbGRlcnMnLCB0aGlzLmZvbGRlcklkLCB0aGlzLnNhbmRib3hJZCxcbiAgICAgICAgZmlsZSwgKHRoaXMuYXBwSWQgKyAnLicgKyBmaWxlLm5hbWUpLCAnJylcbiAgICAgICAgLnBpcGUoXG4gICAgICAgICAgbWFwKHZhbCA9PiB7XG4gICAgICAgICAgICBpZiAoIWlzU3RhdGVJY29uKSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0TmV3U3RhdGVJY29uKGRsVXJsKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHRoaXMuc2V0TmV3Q2FzZVR5cGVJY29uKGRsVXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgcmVzdWx0ID0+IG51bGwsXG4gICAgICAgICAgZXJyb3IgPT4geyBjb25zb2xlLmxvZygnZXJyb3InKTsgdGhpcy5lcnJvck1lc3NhZ2UgPSAnRXJyb3IgdXBsb2FkaW5nIHN0YXRlIGljb246ICcgKyBlcnJvci5lcnJvck1zZzsgfSk7XG4gICAgfVxuICB9XG5cbiAgcHVibGljIHJlZnJlc2ggPSAoKSA9PiB7XG4gICAgLy8gbmVlZCBzdGF0ZXMgJiBjYXJkQ29uZmlnXG4gICAgdGhpcy5zZWxlY3RlZENhc2VUeXBlQ29uZmlnID0gbnVsbDtcbiAgICB0aGlzLmNhc2VDYXJkQ29uZmlnU2VydmljZS5nZXRDYXNlQ2FyZENvbmZpZyh0aGlzLnNhbmRib3hJZCwgdGhpcy5hcHBJZCwgdGhpcy51aUFwcElkLCB0aGlzLmFwcFR5cGVMYWJlbCwgdGhpcy5ERUZBVUxUX0NBU0VfVFlQRV9DT0xPUiwgdGhpcy5ERUZBVUxUX0NBU0VfVFlQRV9JQ09OLCB0aGlzLkRFRkFVTFRfQ0FTRV9TVEFURV9DT0xPUiwgdGhpcy5ERUZBVUxUX0NBU0VfU1RBVEVfSUNPTikucGlwZShcbiAgICAgIHRha2UoMSksXG4gICAgICB0YWtlVW50aWwodGhpcy5fZGVzdHJveWVkJCksXG4gICAgICBtYXAoY2FzZUNhcmRDb25maWcgPT4ge1xuICAgICAgICB0aGlzLmNhc2VDYXJkQ29uZmlnID0gY2FzZUNhcmRDb25maWc7XG4gICAgICAgIC8vIHNldCBkZWZhdWx0IHNlbGVjdGVkIHRvIGZpcnN0IHN0YXRlIGZvciB0aGlzIGNhc2UgdHlwZSAoMCBpcyBjYXNlIHR5cGUpXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRTdGF0ZUNvbmZpZyA9IHRoaXMuY2FzZUNhcmRDb25maWcuY2FyZENvbmZpZy5zdGF0ZU1hcFsxXTtcbiAgICAgICAgY29uc3QgY2FzZVR5cGVSZWMgPSB0aGlzLmNhc2VDYXJkQ29uZmlnLmNhcmRDb25maWcuc3RhdGVNYXAuZmluZChmdW5jdGlvbihzdGF0ZU1hcCkge1xuICAgICAgICAgIHJldHVybiBzdGF0ZU1hcC5pc0Nhc2VUeXBlO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmNhc2VUeXBlSWNvbiA9IGNhc2VUeXBlUmVjLmljb247XG4gICAgICAgIHRoaXMuY2FzZVR5cGVDb2xvciA9IGNhc2VUeXBlUmVjLmZpbGw7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWRDYXNlVHlwZUNvbmZpZyA9IHRoaXMuZ2V0Q29uZmlnRm9yQ2FzZVR5cGUodGhpcy5hcHBUeXBlTGFiZWwpO1xuICAgICAgfSlcbiAgICApLnN1YnNjcmliZShcbiAgICAgIG51bGwsIGVycm9yID0+IHsgdGhpcy5lcnJvck1lc3NhZ2UgPSAnRXJyb3IgcmV0cmlldmluZyBjYXNlIGNhcmQgY29uZmlnOiAnICsgZXJyb3IuZXJyb3IuZXJyb3JNc2c7IH0pO1xuICB9XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBodHRwOiBIdHRwQ2xpZW50LCBwcml2YXRlIHNhbml0aXplcjogRG9tU2FuaXRpemVyLFxuICAgICAgICAgICAgICBwcml2YXRlIGxpdmVhcHBzOiBMaXZlQXBwc1NlcnZpY2UsIHB1YmxpYyBjYXNlQ2FyZENvbmZpZ1NlcnZpY2U6IFRjQ2FzZUNhcmRDb25maWdTZXJ2aWNlLCBwcml2YXRlIGRvY3VtZW50c1NlcnZpY2U6IFRjRG9jdW1lbnRTZXJ2aWNlLCBwdWJsaWMgZGlhbG9nOiBNYXREaWFsb2csIHByaXZhdGUgbG9jYXRpb246IExvY2F0aW9uKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG4gIG5nT25DaGFuZ2VzKGNoYW5nZXM6IFNpbXBsZUNoYW5nZXMpIHtcbiAgICBpZiAoY2hhbmdlcy5hcHBJZCAmJiAoY2hhbmdlcy5hcHBJZC5jdXJyZW50VmFsdWUgIT09IGNoYW5nZXMuYXBwSWQucHJldmlvdXNWYWx1ZSkpIHtcbiAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgIH1cbiAgfVxuXG5cbn1cblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGNsYS1saXZlLWFwcHMtc3RhdGUtaWNvbi11cGxvYWQtZGlhbG9nJyxcbiAgdGVtcGxhdGVVcmw6ICd1cGxvYWQtZmlsZS1kaWFsb2cvYXBwLWxpdmUtYXBwcy1zdGF0ZS1pY29uLXVwbG9hZC1kaWFsb2cuaHRtbCcsXG4gIHN0eWxlVXJsczogWyAndXBsb2FkLWZpbGUtZGlhbG9nL2FwcC1saXZlLWFwcHMtc3RhdGUtaWNvbi11cGxvYWQtZGlhbG9nLmNzcyddXG59KVxuZXhwb3J0IGNsYXNzIExpdmVBcHBzU3RhdGVJY29uVXBsb2FkRGlhbG9nQ29tcG9uZW50IHtcbiAgQE91dHB1dCgpIGZpbGVldmVudCA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICBwdWJsaWMgZmlsZVRvVXBsb2FkOiBGaWxlID0gdW5kZWZpbmVkO1xuICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyA9IHVuZGVmaW5lZDtcbiAgcHVibGljIGZpbGVUZXh0OiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIGRpYWxvZ1JlZjogTWF0RGlhbG9nUmVmPExpdmVBcHBzU3RhdGVJY29uVXBsb2FkRGlhbG9nQ29tcG9uZW50PiwgQEluamVjdChNQVRfRElBTE9HX0RBVEEpIHB1YmxpYyBkYXRhOiBhbnkpIHt9XG5cbiAgcHVibGljIHVwbG9hZEZpbGUgPSAoKSA9PiB7XG4gICAgaWYgKHRoaXMuZmlsZVRvVXBsb2FkKSB7XG4gICAgICB0aGlzLmZpbGVldmVudC5lbWl0KHsgZmlsZTogdGhpcy5maWxlVG9VcGxvYWQsIHN0YXRlOiB0aGlzLmRhdGEuc3RhdGUsIGlzQ2FzZVR5cGU6IHRoaXMuZGF0YS5pc0Nhc2VUeXBlIH0gKTtcbiAgICAgIHRoaXMuZGlhbG9nUmVmLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgc2V0RmlsZURlc2NyaXB0aW9uKGRlc2NyaXB0aW9uOiBzdHJpbmcpIHtcbiAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gIH1cblxuICBhdHRhY2hGaWxlKGZpbGVzOiBGaWxlTGlzdCkge1xuICAgIHRoaXMuZmlsZVRvVXBsb2FkID0gZmlsZXMuaXRlbSgwKTtcbiAgICAvKmNvbnN0IG15UmVhZGVyOiBGaWxlUmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICBteVJlYWRlci5yZWFkQXNUZXh0KHRoaXMuZmlsZVRvVXBsb2FkKTtcbiAgICB0aGlzLmZpbGVUZXh0ID0gbXlSZWFkZXIucmVzdWx0LnRvU3RyaW5nKCk7Ki9cbiAgfVxuXG4gIG9uTm9DbGljaygpOiB2b2lkIHtcbiAgICB0aGlzLmRpYWxvZ1JlZi5jbG9zZSgpO1xuICB9XG5cbn1cblxuIl19