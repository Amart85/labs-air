/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, ElementRef, EventEmitter, Input, Output, ViewChild } from '@angular/core';
import { LiveAppsService } from '../../services/live-apps.service';
import { take, takeUntil } from 'rxjs/operators';
import { LiveAppsComponent } from '../live-apps-component/live-apps-component.component';
import { TcCoreCommonFunctions } from '@tibco-tcstk/tc-core-lib';
/**
 * Recent cases widget, this Component list recent visited Cases.
 *
 * ![alt-text](../live-apps-recent-cases.png "")
 *
 * \@example <tcla-live-apps-recent-cases></tcla-live-apps-recent-cases>
 */
var LiveAppsRecentCasesComponent = /** @class */ (function (_super) {
    tslib_1.__extends(LiveAppsRecentCasesComponent, _super);
    function LiveAppsRecentCasesComponent(liveapps) {
        var _this = _super.call(this) || this;
        _this.liveapps = liveapps;
        /**
         * case card format - list, card, miniCard, staticList (no click event)
         */
        _this.displayType = _this.displayType ? _this.displayType : 'miniCard'; // miniCard, card, list
        // miniCard, card, list
        /**
         * Whether to show the header bar in the widget - eg. favorites on home page (contains icon etc) - if off icons still appear without bar
         */
        _this.showHeader = _this.showHeader ? _this.showHeader : true;
        /**
         * ~event clickCase : Case clicked
         * ~payload CaseRoute : CaseRoute object output when case is clicked so calling component can route accordingly - ie. route to case
         */
        _this.clickCase = new EventEmitter();
        _this.clickCaseAction = (/**
         * @param {?} caseRoute
         * @return {?}
         */
        function (caseRoute) {
            _this.clickCase.emit(caseRoute);
        });
        _this.refresh = (/**
         * @return {?}
         */
        function () {
            _this.recentCases = [];
            _this.liveapps.getRecentCases(_this.uiAppId, _this.sandboxId)
                .pipe(take(1), takeUntil(_this._destroyed$)).subscribe((/**
             * @param {?} next
             * @return {?}
             */
            function (next) {
                _this.recentCases = next.caseRefs || [];
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) { _this.errorMessage = 'Error retrieving recent cases: ' + error.error.errorMsg; }));
        });
        _this.clearRecentCases = (/**
         * @return {?}
         */
        function () {
            // -1 will clear recent cases
            _this.liveapps.setRecentCase('-1', _this.uiAppId, _this.sandboxId);
            _this.recentCases = [];
        });
        _this.handleDeleted = (/**
         * @param {?} caseRef
         * @return {?}
         */
        function (caseRef) {
            _this.recentCases.splice(_this.recentCases.indexOf(caseRef), 1);
            _this.liveapps.unsetRecentCase(caseRef, _this.uiAppId, _this.sandboxId);
        });
        return _this;
    }
    /**
     * @return {?}
     */
    LiveAppsRecentCasesComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        _super.prototype.ngAfterViewInit.call(this);
        this.cardWidthPct = TcCoreCommonFunctions.calcSummaryCardPct(this.widget);
        this.containerChanges$.subscribe((/**
         * @param {?} widget
         * @return {?}
         */
        function (widget) {
            _this.cardWidthPct = TcCoreCommonFunctions.calcSummaryCardPct(widget);
        }));
    };
    /**
     * @return {?}
     */
    LiveAppsRecentCasesComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        _super.prototype.ngOnInit.call(this);
        this.refresh();
    };
    LiveAppsRecentCasesComponent.decorators = [
        { type: Component, args: [{
                    selector: 'tcla-live-apps-recent-cases',
                    template: "<div #componentDiv class=\"tcs-case-recent-box\" fxLayout=\"column\" fxFill>\n  <div *ngIf=\"showHeader\" class=\"tcs-case-recent-header\" fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n    <div fxLayoutAlign=\"start center\">\n      <mat-icon class=\"tcs-icon tcs-recent-icon\" svgIcon=\"tcs-recent-icon\"></mat-icon>\n      <div class=\"tcs-case-recent-header-text\">Recent</div>\n    </div>\n    <mat-icon (click)=\"clearRecentCases()\" class=\"tcs-icon tcs-icon-active tcs-clear-recent-icon\" svgIcon=\"tcs-clear-icon\" matTooltip=\"Clear Recent Cases\" matTooltipPosition=\"left\" matTooltipShowDelay=\"1000\"></mat-icon>\n  </div>\n  <div *ngIf=\"!showHeader\" fxLayout=\"row\" fxLayoutAlign=\"end center\">\n    <mat-icon style=\"margin: 5px\" (click)=\"clearRecentCases()\" class=\"tcs-icon tcs-icon-active tcs-clear-recent-icon\" svgIcon=\"tcs-clear-icon\" matTooltip=\"Clear Recent Cases\" matTooltipPosition=\"left\" matTooltipShowDelay=\"1000\"></mat-icon>\n  </div>\n  <div *ngIf=\"recentCases.length > 0\"class=\"tcs-case-recent-flow-list\" fxLayout=\"column\" fxLayout=\"row wrap\">\n    <div class=\"tcs-case-recent-item-box\" *ngFor=\"let case of recentCases\" [fxFlex]=\"cardWidthPct\">\n      <tcla-live-apps-case-summary [uiAppId]=\"uiAppId\" [typeBar]=\"true\" [borderCard]=\"false\" [displayType]=\"displayType\" [sandboxId]=\"sandboxId\" [caseRef]=\"case\" (clickCase)=\"clickCaseAction($event)\" (deleted)=\"handleDeleted($event)\"></tcla-live-apps-case-summary>\n      <div class=\"tcs-case-recent-line\"></div>\n    </div>\n  </div>\n  <div *ngIf=\"!(recentCases.length > 0)\" fxLayout=\"row\" fxLayoutAlign=\"center start\" fxLayoutGap=\"10px\" style=\"margin: 20px;\">\n    <mat-icon [svgIcon]=\"'ic-no-cases-icon'\" style=\"height: 48px; width: 48px;\"></mat-icon>\n    <div style=\"height: 100%\" fxLayoutAlign=\"start center\">\n      <span class=\"tcs-no-item-text\">No cases found</span>\n    </div>\n  </div>\n</div>\n",
                    styles: [".tcs-case-recent-box{border-radius:3px;box-shadow:0 2px 8px 0 #dedede;background-color:#fff}.tcs-case-recent-header{min-height:40px;border-radius:3px 3px 0 0;box-shadow:0 1px 2px 0 #dedede;padding-left:20px;padding-right:20px}.tcs-case-recent-header-text{font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:1.5;letter-spacing:.3px;text-align:left;color:#000;margin-left:10px}.tcs-case-recent-flow-list{margin:10px;overflow-y:auto;padding:4px}.tcs-case-recent-item-box{padding:5px}.tcs-icon.tcs-icon-active:hover{cursor:pointer}:host ::ng-deep .tcs-icon.tcs-icon-active:hover .svg-content{fill:#0081cb}.tcs-case-recent-line{padding:0;margin:4px 5px 0;border-bottom:1.1px solid #f4f4f4}.tcs-no-item-text{font-family:Source Sans Pro;font-size:16px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;color:#b6b6b6}"]
                }] }
    ];
    /** @nocollapse */
    LiveAppsRecentCasesComponent.ctorParameters = function () { return [
        { type: LiveAppsService }
    ]; };
    LiveAppsRecentCasesComponent.propDecorators = {
        sandboxId: [{ type: Input }],
        uiAppId: [{ type: Input }],
        displayType: [{ type: Input }],
        showHeader: [{ type: Input }],
        clickCase: [{ type: Output }],
        componentDiv: [{ type: ViewChild, args: ['componentDiv', { static: false },] }]
    };
    return LiveAppsRecentCasesComponent;
}(LiveAppsComponent));
export { LiveAppsRecentCasesComponent };
if (false) {
    /**
     * sandboxId - this comes from claims resolver
     * @type {?}
     */
    LiveAppsRecentCasesComponent.prototype.sandboxId;
    /**
     * The Application ID of the UI (should ideally be unique as it is shared state key)
     * @type {?}
     */
    LiveAppsRecentCasesComponent.prototype.uiAppId;
    /**
     * case card format - list, card, miniCard, staticList (no click event)
     * @type {?}
     */
    LiveAppsRecentCasesComponent.prototype.displayType;
    /**
     * Whether to show the header bar in the widget - eg. favorites on home page (contains icon etc) - if off icons still appear without bar
     * @type {?}
     */
    LiveAppsRecentCasesComponent.prototype.showHeader;
    /**
     * ~event clickCase : Case clicked
     * ~payload CaseRoute : CaseRoute object output when case is clicked so calling component can route accordingly - ie. route to case
     * @type {?}
     */
    LiveAppsRecentCasesComponent.prototype.clickCase;
    /** @type {?} */
    LiveAppsRecentCasesComponent.prototype.componentDiv;
    /** @type {?} */
    LiveAppsRecentCasesComponent.prototype.recentCases;
    /** @type {?} */
    LiveAppsRecentCasesComponent.prototype.errorMessage;
    /** @type {?} */
    LiveAppsRecentCasesComponent.prototype.widget;
    /** @type {?} */
    LiveAppsRecentCasesComponent.prototype.cardWidthPct;
    /** @type {?} */
    LiveAppsRecentCasesComponent.prototype.clickCaseAction;
    /** @type {?} */
    LiveAppsRecentCasesComponent.prototype.refresh;
    /** @type {?} */
    LiveAppsRecentCasesComponent.prototype.clearRecentCases;
    /** @type {?} */
    LiveAppsRecentCasesComponent.prototype.handleDeleted;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsRecentCasesComponent.prototype.liveapps;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLXJlY2VudC1jYXNlcy5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AdGliY28tdGNzdGsvdGMtbGl2ZWFwcHMtbGliLyIsInNvdXJjZXMiOlsibGliL2NvbXBvbmVudHMvbGl2ZS1hcHBzLXJlY2VudC1jYXNlcy9saXZlLWFwcHMtcmVjZW50LWNhc2VzLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFHTCxTQUFTLEVBQ1QsVUFBVSxFQUNWLFlBQVksRUFDWixLQUFLLEVBSUwsTUFBTSxFQUNOLFNBQVMsRUFDVixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0sa0NBQWtDLENBQUM7QUFFakUsT0FBTyxFQUFNLElBQUksRUFBRSxTQUFTLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUVwRCxPQUFPLEVBQUMsaUJBQWlCLEVBQUMsTUFBTSxzREFBc0QsQ0FBQztBQUN2RixPQUFPLEVBQWMscUJBQXFCLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQzs7Ozs7Ozs7QUFTNUU7SUFLa0Qsd0RBQWlCO0lBNERqRSxzQ0FBc0IsUUFBeUI7UUFBL0MsWUFDRSxpQkFBTyxTQUNSO1FBRnFCLGNBQVEsR0FBUixRQUFRLENBQWlCOzs7O1FBOUN0QyxpQkFBVyxHQUFXLEtBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLEtBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLHVCQUF1Qjs7Ozs7UUFJL0YsZ0JBQVUsR0FBWSxLQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxLQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7Ozs7O1FBTTlELGVBQVMsR0FBNEIsSUFBSSxZQUFZLEVBQWEsQ0FBQztRQVN0RSxxQkFBZTs7OztRQUFHLFVBQUMsU0FBb0I7WUFDNUMsS0FBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDakMsQ0FBQyxFQUFBO1FBRU0sYUFBTzs7O1FBQUc7WUFDZixLQUFJLENBQUMsV0FBVyxHQUFHLEVBQUUsQ0FBQztZQUN0QixLQUFJLENBQUMsUUFBUSxDQUFDLGNBQWMsQ0FBQyxLQUFJLENBQUMsT0FBTyxFQUFFLEtBQUksQ0FBQyxTQUFTLENBQUM7aUJBQ3ZELElBQUksQ0FDSCxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQ1AsU0FBUyxDQUFDLEtBQUksQ0FBQyxXQUFXLENBQUMsQ0FDNUIsQ0FBQyxTQUFTOzs7O1lBQ1gsVUFBQSxJQUFJO2dCQUNGLEtBQUksQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFFBQVEsSUFBSSxFQUFFLENBQUM7WUFDekMsQ0FBQzs7OztZQUFFLFVBQUEsS0FBSyxJQUFNLEtBQUksQ0FBQyxZQUFZLEdBQUcsaUNBQWlDLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQztRQUNuRyxDQUFDLEVBQUE7UUFFTSxzQkFBZ0I7OztRQUFHO1lBQ3hCLDZCQUE2QjtZQUM3QixLQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxJQUFJLEVBQUUsS0FBSSxDQUFDLE9BQU8sRUFBRSxLQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDaEUsS0FBSSxDQUFDLFdBQVcsR0FBRyxFQUFFLENBQUM7UUFDeEIsQ0FBQyxFQUFBO1FBRU0sbUJBQWE7Ozs7UUFBRyxVQUFDLE9BQWU7WUFDckMsS0FBSSxDQUFDLFdBQVcsQ0FBQyxNQUFNLENBQUMsS0FBSSxDQUFDLFdBQVcsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDOUQsS0FBSSxDQUFDLFFBQVEsQ0FBQyxlQUFlLENBQUMsT0FBTyxFQUFFLEtBQUksQ0FBQyxPQUFPLEVBQUUsS0FBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ3ZFLENBQUMsRUFBQTs7SUFJRCxDQUFDOzs7O0lBR0Qsc0RBQWU7OztJQUFmO1FBQUEsaUJBTUM7UUFMQyxpQkFBTSxlQUFlLFdBQUUsQ0FBQztRQUN4QixJQUFJLENBQUMsWUFBWSxHQUFHLHFCQUFxQixDQUFDLGtCQUFrQixDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUMxRSxJQUFJLENBQUMsaUJBQWlCLENBQUMsU0FBUzs7OztRQUFDLFVBQUEsTUFBTTtZQUNyQyxLQUFJLENBQUMsWUFBWSxHQUFHLHFCQUFxQixDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ3ZFLENBQUMsRUFBQyxDQUFDO0lBQ0wsQ0FBQzs7OztJQUVELCtDQUFROzs7SUFBUjtRQUNFLGlCQUFNLFFBQVEsV0FBRSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztJQUNqQixDQUFDOztnQkFqRkYsU0FBUyxTQUFDO29CQUNULFFBQVEsRUFBRSw2QkFBNkI7b0JBQ3ZDLHU3REFBc0Q7O2lCQUV2RDs7OztnQkFsQk8sZUFBZTs7OzRCQXVCcEIsS0FBSzswQkFLTCxLQUFLOzhCQUtMLEtBQUs7NkJBSUwsS0FBSzs0QkFNTCxNQUFNOytCQUVOLFNBQVMsU0FBQyxjQUFjLEVBQUUsRUFBQyxNQUFNLEVBQUUsS0FBSyxFQUFDOztJQW9ENUMsbUNBQUM7Q0FBQSxBQW5GRCxDQUtrRCxpQkFBaUIsR0E4RWxFO1NBOUVZLDRCQUE0Qjs7Ozs7O0lBSXZDLGlEQUEyQjs7Ozs7SUFLM0IsK0NBQXlCOzs7OztJQUt6QixtREFBZ0Y7Ozs7O0lBSWhGLGtEQUF3RTs7Ozs7O0lBTXhFLGlEQUE2RTs7SUFFN0Usb0RBQXFFOztJQUVyRSxtREFBNkI7O0lBQzdCLG9EQUE0Qjs7SUFDNUIsOENBQTJCOztJQUMzQixvREFBNEI7O0lBRTVCLHVEQUVDOztJQUVELCtDQVVDOztJQUVELHdEQUlDOztJQUVELHFEQUdDOzs7OztJQUVXLGdEQUFtQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFmdGVyVmlld0NoZWNrZWQsXG4gIEFmdGVyVmlld0luaXQsXG4gIENvbXBvbmVudCxcbiAgRWxlbWVudFJlZixcbiAgRXZlbnRFbWl0dGVyLFxuICBJbnB1dCxcbiAgT25DaGFuZ2VzLFxuICBPbkRlc3Ryb3ksXG4gIE9uSW5pdCxcbiAgT3V0cHV0LFxuICBWaWV3Q2hpbGRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0xpdmVBcHBzU2VydmljZX0gZnJvbSAnLi4vLi4vc2VydmljZXMvbGl2ZS1hcHBzLnNlcnZpY2UnO1xuaW1wb3J0IHtTdWJqZWN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7bWFwLCB0YWtlLCB0YWtlVW50aWx9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7Q2FzZUxpc3QsIENhc2VSb3V0ZX0gZnJvbSAnLi4vLi4vbW9kZWxzL2xpdmVhcHBzZGF0YSc7XG5pbXBvcnQge0xpdmVBcHBzQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtY29tcG9uZW50L2xpdmUtYXBwcy1jb21wb25lbnQuY29tcG9uZW50JztcbmltcG9ydCB7VGNDb21wb25lbnQsIFRjQ29yZUNvbW1vbkZ1bmN0aW9uc30gZnJvbSAnQHRpYmNvLXRjc3RrL3RjLWNvcmUtbGliJztcblxuLyoqXG4gKiBSZWNlbnQgY2FzZXMgd2lkZ2V0LCB0aGlzIENvbXBvbmVudCBsaXN0IHJlY2VudCB2aXNpdGVkIENhc2VzLlxuICpcbiAqICFbYWx0LXRleHRdKC4uL2xpdmUtYXBwcy1yZWNlbnQtY2FzZXMucG5nIFwiXCIpXG4gKlxuICpAZXhhbXBsZSA8dGNsYS1saXZlLWFwcHMtcmVjZW50LWNhc2VzPjwvdGNsYS1saXZlLWFwcHMtcmVjZW50LWNhc2VzPlxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd0Y2xhLWxpdmUtYXBwcy1yZWNlbnQtY2FzZXMnLFxuICB0ZW1wbGF0ZVVybDogJy4vbGl2ZS1hcHBzLXJlY2VudC1jYXNlcy5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2xpdmUtYXBwcy1yZWNlbnQtY2FzZXMuY29tcG9uZW50LmNzcyddXG59KVxuZXhwb3J0IGNsYXNzIExpdmVBcHBzUmVjZW50Q2FzZXNDb21wb25lbnQgZXh0ZW5kcyBMaXZlQXBwc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCB7XG4gIC8qKlxuICAgKiBzYW5kYm94SWQgLSB0aGlzIGNvbWVzIGZyb20gY2xhaW1zIHJlc29sdmVyXG4gICAqL1xuICBASW5wdXQoKSBzYW5kYm94SWQ6IG51bWJlcjtcblxuICAvKipcbiAgICogVGhlIEFwcGxpY2F0aW9uIElEIG9mIHRoZSBVSSAoc2hvdWxkIGlkZWFsbHkgYmUgdW5pcXVlIGFzIGl0IGlzIHNoYXJlZCBzdGF0ZSBrZXkpXG4gICAqL1xuICBASW5wdXQoKSB1aUFwcElkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIGNhc2UgY2FyZCBmb3JtYXQgLSBsaXN0LCBjYXJkLCBtaW5pQ2FyZCwgc3RhdGljTGlzdCAobm8gY2xpY2sgZXZlbnQpXG4gICAqL1xuICBASW5wdXQoKSBkaXNwbGF5VHlwZTogc3RyaW5nID0gdGhpcy5kaXNwbGF5VHlwZSA/IHRoaXMuZGlzcGxheVR5cGUgOiAnbWluaUNhcmQnOyAvLyBtaW5pQ2FyZCwgY2FyZCwgbGlzdFxuICAvKipcbiAgICogV2hldGhlciB0byBzaG93IHRoZSBoZWFkZXIgYmFyIGluIHRoZSB3aWRnZXQgLSBlZy4gZmF2b3JpdGVzIG9uIGhvbWUgcGFnZSAoY29udGFpbnMgaWNvbiBldGMpIC0gaWYgb2ZmIGljb25zIHN0aWxsIGFwcGVhciB3aXRob3V0IGJhclxuICAgKi9cbiAgQElucHV0KCkgc2hvd0hlYWRlcjogYm9vbGVhbiA9IHRoaXMuc2hvd0hlYWRlciA/IHRoaXMuc2hvd0hlYWRlciA6IHRydWU7XG5cbiAgLyoqXG4gICAqIH5ldmVudCBjbGlja0Nhc2UgOiBDYXNlIGNsaWNrZWRcbiAgICogfnBheWxvYWQgQ2FzZVJvdXRlIDogQ2FzZVJvdXRlIG9iamVjdCBvdXRwdXQgd2hlbiBjYXNlIGlzIGNsaWNrZWQgc28gY2FsbGluZyBjb21wb25lbnQgY2FuIHJvdXRlIGFjY29yZGluZ2x5IC0gaWUuIHJvdXRlIHRvIGNhc2VcbiAgICovXG4gIEBPdXRwdXQoKSBjbGlja0Nhc2U6IEV2ZW50RW1pdHRlcjxDYXNlUm91dGU+ID0gbmV3IEV2ZW50RW1pdHRlcjxDYXNlUm91dGU+KCk7XG5cbiAgQFZpZXdDaGlsZCgnY29tcG9uZW50RGl2Jywge3N0YXRpYzogZmFsc2V9KSBjb21wb25lbnREaXY6IEVsZW1lbnRSZWY7XG5cbiAgcHVibGljIHJlY2VudENhc2VzOiBzdHJpbmdbXTtcbiAgcHVibGljIGVycm9yTWVzc2FnZTogc3RyaW5nO1xuICBwdWJsaWMgd2lkZ2V0OiBUY0NvbXBvbmVudDtcbiAgcHVibGljIGNhcmRXaWR0aFBjdDogTnVtYmVyO1xuXG4gIHB1YmxpYyBjbGlja0Nhc2VBY3Rpb24gPSAoY2FzZVJvdXRlOiBDYXNlUm91dGUpID0+IHtcbiAgICB0aGlzLmNsaWNrQ2FzZS5lbWl0KGNhc2VSb3V0ZSk7XG4gIH1cblxuICBwdWJsaWMgcmVmcmVzaCA9ICgpID0+IHtcbiAgICB0aGlzLnJlY2VudENhc2VzID0gW107XG4gICAgdGhpcy5saXZlYXBwcy5nZXRSZWNlbnRDYXNlcyh0aGlzLnVpQXBwSWQsIHRoaXMuc2FuZGJveElkKVxuICAgICAgLnBpcGUoXG4gICAgICAgIHRha2UoMSksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLl9kZXN0cm95ZWQkKVxuICAgICAgKS5zdWJzY3JpYmUoXG4gICAgICBuZXh0ID0+IHtcbiAgICAgICAgdGhpcy5yZWNlbnRDYXNlcyA9IG5leHQuY2FzZVJlZnMgfHwgW107XG4gICAgICB9LCBlcnJvciA9PiB7IHRoaXMuZXJyb3JNZXNzYWdlID0gJ0Vycm9yIHJldHJpZXZpbmcgcmVjZW50IGNhc2VzOiAnICsgZXJyb3IuZXJyb3IuZXJyb3JNc2c7IH0pO1xuICB9XG5cbiAgcHVibGljIGNsZWFyUmVjZW50Q2FzZXMgPSAoKSA9PiB7XG4gICAgLy8gLTEgd2lsbCBjbGVhciByZWNlbnQgY2FzZXNcbiAgICB0aGlzLmxpdmVhcHBzLnNldFJlY2VudENhc2UoJy0xJywgdGhpcy51aUFwcElkLCB0aGlzLnNhbmRib3hJZCk7XG4gICAgdGhpcy5yZWNlbnRDYXNlcyA9IFtdO1xuICB9XG5cbiAgcHVibGljIGhhbmRsZURlbGV0ZWQgPSAoY2FzZVJlZjogc3RyaW5nKSA9PiB7XG4gICAgdGhpcy5yZWNlbnRDYXNlcy5zcGxpY2UodGhpcy5yZWNlbnRDYXNlcy5pbmRleE9mKGNhc2VSZWYpLCAxKTtcbiAgICB0aGlzLmxpdmVhcHBzLnVuc2V0UmVjZW50Q2FzZShjYXNlUmVmLCB0aGlzLnVpQXBwSWQsIHRoaXMuc2FuZGJveElkKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByb3RlY3RlZCBsaXZlYXBwczogTGl2ZUFwcHNTZXJ2aWNlKSB7XG4gICAgc3VwZXIoKTtcbiAgfVxuXG5cbiAgbmdBZnRlclZpZXdJbml0KCkge1xuICAgIHN1cGVyLm5nQWZ0ZXJWaWV3SW5pdCgpO1xuICAgIHRoaXMuY2FyZFdpZHRoUGN0ID0gVGNDb3JlQ29tbW9uRnVuY3Rpb25zLmNhbGNTdW1tYXJ5Q2FyZFBjdCh0aGlzLndpZGdldCk7XG4gICAgdGhpcy5jb250YWluZXJDaGFuZ2VzJC5zdWJzY3JpYmUod2lkZ2V0ID0+IHtcbiAgICAgIHRoaXMuY2FyZFdpZHRoUGN0ID0gVGNDb3JlQ29tbW9uRnVuY3Rpb25zLmNhbGNTdW1tYXJ5Q2FyZFBjdCh3aWRnZXQpO1xuICAgIH0pO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgc3VwZXIubmdPbkluaXQoKTtcbiAgICB0aGlzLnJlZnJlc2goKTtcbiAgfVxuXG59XG4iXX0=