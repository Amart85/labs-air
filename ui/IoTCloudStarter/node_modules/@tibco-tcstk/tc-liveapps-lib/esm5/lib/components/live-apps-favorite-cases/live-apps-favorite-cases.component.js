/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { take, takeUntil } from 'rxjs/operators';
import { LiveAppsService } from '../../services/live-apps.service';
import { LiveAppsComponent } from '../live-apps-component/live-apps-component.component';
import { TcCoreCommonFunctions } from '@tibco-tcstk/tc-core-lib';
/**
 * This Component allows to list your Favorite Cases.
 *
 * ![alt-text](../live-apps-favorite-cases.png "Documents Component Image")
 *
 * \@example <tcla-live-apps-favorite-cases></tcla-live-apps-favorite-cases>
 */
var LiveAppsFavoriteCasesComponent = /** @class */ (function (_super) {
    tslib_1.__extends(LiveAppsFavoriteCasesComponent, _super);
    function LiveAppsFavoriteCasesComponent(liveapps) {
        var _this = _super.call(this) || this;
        _this.liveapps = liveapps;
        /**
         * case card format - list, card, miniCard, staticList (no click event)
         */
        _this.displayType = _this.displayType ? _this.displayType : 'miniCard'; // miniCard, card, list
        // miniCard, card, list
        /**
         * Whether to show the header bar in the widget - eg. favorites on home page (contains icon etc) - if off icons still appear without bar
         */
        _this.showHeader = _this.showHeader ? _this.showHeader : true;
        /**
         * ~event clickCase : Case clicked
         * ~payload CaseRoute : CaseRoute object output when case is clicked so calling component can route accordingly - ie. route to case
         */
        _this.clickCase = new EventEmitter();
        _this.clickCaseAction = (/**
         * @param {?} caseRoute
         * @return {?}
         */
        function (caseRoute) {
            _this.clickCase.emit(caseRoute);
        });
        _this.refresh = (/**
         * @return {?}
         */
        function () {
            _this.favoriteCases = [];
            _this.liveapps.getFavoriteCases(_this.uiAppId, _this.sandboxId)
                .pipe(take(1), takeUntil(_this._destroyed$)).subscribe((/**
             * @param {?} favoriteCases
             * @return {?}
             */
            function (favoriteCases) {
                _this.favoriteCases = favoriteCases.caseRefs || [];
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) { _this.errorMessage = 'Error retrieving favorite cases: ' + error.error.errorMsg; }));
        });
        _this.clearFavoriteCases = (/**
         * @return {?}
         */
        function () {
            _this.liveapps.setFavoriteCase('-1', _this.uiAppId, _this.sandboxId);
            _this.favoriteCases = [];
        });
        _this.handleDeleted = (/**
         * @param {?} caseRef
         * @return {?}
         */
        function (caseRef) {
            _this.favoriteCases.splice(_this.favoriteCases.indexOf(caseRef), 1);
            _this.liveapps.setFavoriteCase(caseRef, _this.uiAppId, _this.sandboxId);
        });
        return _this;
    }
    /**
     * @return {?}
     */
    LiveAppsFavoriteCasesComponent.prototype.ngAfterViewInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        _super.prototype.ngAfterViewInit.call(this);
        this.containerChanges$.subscribe((/**
         * @param {?} widget
         * @return {?}
         */
        function (widget) {
            _this.cardWidthPct = TcCoreCommonFunctions.calcSummaryCardPct(widget);
        }));
    };
    /**
     * @return {?}
     */
    LiveAppsFavoriteCasesComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        _super.prototype.ngOnInit.call(this);
        this.refresh();
    };
    LiveAppsFavoriteCasesComponent.decorators = [
        { type: Component, args: [{
                    selector: 'tcla-live-apps-favorite-cases',
                    template: "<div #componentDiv class=\"tcs-case-favorites-box\" fxLayout=\"column\" fxFill>\n  <div *ngIf=\"showHeader\" class=\"tcs-case-favorites-header\" fxLayout=\"row\" fxLayoutAlign=\"space-between center\">\n    <div fxLayoutAlign=\"start center\">\n      <mat-icon class=\"tcs-icon tcs-favorites-icon\" svgIcon=\"tcs-favorites-icon\"></mat-icon>\n      <div class=\"tcs-case-favorites-header-text\">Favorites</div>\n    </div>\n    <mat-icon (click)=\"clearFavoriteCases()\" class=\"tcs-icon tcs-icon-active tcs-clear-favorite-icon\" svgIcon=\"tcs-clear-icon\" matTooltip=\"Clear Favorites\" matTooltipPosition=\"left\" matTooltipShowDelay=\"1000\"></mat-icon>\n  </div>\n  <div *ngIf=\"!showHeader\" fxLayout=\"row\" fxLayoutAlign=\"end center\">\n    <mat-icon style=\"margin: 5px\" (click)=\"clearFavoriteCases()\" class=\"tcs-icon tcs-icon-active tcs-clear-favorite-icon\" svgIcon=\"tcs-clear-icon\" matTooltip=\"Clear Favorites\" matTooltipPosition=\"left\" matTooltipShowDelay=\"1000\"></mat-icon>\n  </div>\n  <div *ngIf=\"favoriteCases.length > 0\" class=\"tcs-case-favorites-flow-list\" fxLayout=\"column\" fxLayout=\"row wrap\">\n    <div class=\"tcs-case-favorite-item-box\" *ngFor=\"let case of favoriteCases\" [fxFlex]=\"cardWidthPct\">\n      <tcla-live-apps-case-summary [uiAppId]=\"uiAppId\" [typeBar]=\"true\" [borderCard]=\"false\" [displayType]=\"displayType\" [sandboxId]=\"sandboxId\" [caseRef]=\"case\" (clickCase)=\"clickCaseAction($event)\" (deleted)=\"handleDeleted($event)\"></tcla-live-apps-case-summary>\n      <div class=\"tcs-case-summary-line\"></div>\n    </div>\n  </div>\n  <div *ngIf=\"!(favoriteCases.length > 0)\" fxLayout=\"row\" fxLayoutAlign=\"center start\" fxLayoutGap=\"10px\" style=\"margin: 20px;\">\n    <mat-icon [svgIcon]=\"'ic-no-cases-icon'\" style=\"height: 48px; width: 48px;\"></mat-icon>\n    <div style=\"height: 100%; margin: 5px\" fxLayoutAlign=\"start center\">\n      <span class=\"tcs-no-item-text\">No cases found</span>\n    </div>\n  </div>\n</div>\n",
                    styles: [".tcs-case-favorites-box{border-radius:3px;box-shadow:0 2px 8px 0 #dedede;background-color:#fff}.tcs-case-favorites-header{min-height:40px;border-radius:3px 3px 0 0;box-shadow:0 1px 2px 0 #dedede;padding-left:20px;padding-right:20px}.tcs-case-favorites-header-text{font-family:Source Sans Pro;font-size:18px;font-weight:600;font-style:normal;font-stretch:normal;line-height:1.5;letter-spacing:.3px;text-align:left;color:#000;margin-left:10px}.tcs-case-favorites-flow-list{margin:10px;overflow-y:auto;padding:4px}.tcs-case-favorite-item-box{padding:5px}.tcs-icon.tcs-icon-active:hover{cursor:pointer}:host ::ng-deep .tcs-icon.tcs-icon-active:hover .svg-content{fill:#0081cb}.tcs-case-summary-line{padding:0;margin:4px 5px 0;border-bottom:1.1px solid #f4f4f4}.tcs-no-item-text{font-family:Source Sans Pro;font-size:16px;font-weight:400;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;color:#b6b6b6}"]
                }] }
    ];
    /** @nocollapse */
    LiveAppsFavoriteCasesComponent.ctorParameters = function () { return [
        { type: LiveAppsService }
    ]; };
    LiveAppsFavoriteCasesComponent.propDecorators = {
        sandboxId: [{ type: Input }],
        uiAppId: [{ type: Input }],
        displayType: [{ type: Input }],
        showHeader: [{ type: Input }],
        clickCase: [{ type: Output }]
    };
    return LiveAppsFavoriteCasesComponent;
}(LiveAppsComponent));
export { LiveAppsFavoriteCasesComponent };
if (false) {
    /**
     * sandboxId - this comes from claims resolver
     * @type {?}
     */
    LiveAppsFavoriteCasesComponent.prototype.sandboxId;
    /**
     * The Application ID of the UI (should ideally be unique as it is shared state key)
     * @type {?}
     */
    LiveAppsFavoriteCasesComponent.prototype.uiAppId;
    /**
     * case card format - list, card, miniCard, staticList (no click event)
     * @type {?}
     */
    LiveAppsFavoriteCasesComponent.prototype.displayType;
    /**
     * Whether to show the header bar in the widget - eg. favorites on home page (contains icon etc) - if off icons still appear without bar
     * @type {?}
     */
    LiveAppsFavoriteCasesComponent.prototype.showHeader;
    /**
     * ~event clickCase : Case clicked
     * ~payload CaseRoute : CaseRoute object output when case is clicked so calling component can route accordingly - ie. route to case
     * @type {?}
     */
    LiveAppsFavoriteCasesComponent.prototype.clickCase;
    /** @type {?} */
    LiveAppsFavoriteCasesComponent.prototype.favoriteCases;
    /** @type {?} */
    LiveAppsFavoriteCasesComponent.prototype.errorMessage;
    /** @type {?} */
    LiveAppsFavoriteCasesComponent.prototype.cardWidthPct;
    /** @type {?} */
    LiveAppsFavoriteCasesComponent.prototype.clickCaseAction;
    /** @type {?} */
    LiveAppsFavoriteCasesComponent.prototype.refresh;
    /** @type {?} */
    LiveAppsFavoriteCasesComponent.prototype.clearFavoriteCases;
    /** @type {?} */
    LiveAppsFavoriteCasesComponent.prototype.handleDeleted;
    /**
     * @type {?}
     * @protected
     */
    LiveAppsFavoriteCasesComponent.prototype.liveapps;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLWZhdm9yaXRlLWNhc2VzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B0aWJjby10Y3N0ay90Yy1saXZlYXBwcy1saWIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9saXZlLWFwcHMtZmF2b3JpdGUtY2FzZXMvbGl2ZS1hcHBzLWZhdm9yaXRlLWNhc2VzLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFHTCxTQUFTLEVBRVQsWUFBWSxFQUNaLEtBQUssRUFHTCxNQUFNLEVBRVAsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFNLElBQUksRUFBRSxTQUFTLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUNwRCxPQUFPLEVBQUMsZUFBZSxFQUFDLE1BQU0sa0NBQWtDLENBQUM7QUFDakUsT0FBTyxFQUFDLGlCQUFpQixFQUFDLE1BQU0sc0RBQXNELENBQUM7QUFFdkYsT0FBTyxFQUFjLHFCQUFxQixFQUFDLE1BQU0sMEJBQTBCLENBQUM7Ozs7Ozs7O0FBVTVFO0lBS29ELDBEQUFpQjtJQTJEbkUsd0NBQXNCLFFBQXlCO1FBQS9DLFlBQ0UsaUJBQU8sU0FDUjtRQUZxQixjQUFRLEdBQVIsUUFBUSxDQUFpQjs7OztRQTdDdEMsaUJBQVcsR0FBVyxLQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxLQUFJLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsQ0FBQyx1QkFBdUI7Ozs7O1FBSy9GLGdCQUFVLEdBQVksS0FBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsS0FBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDOzs7OztRQU85RCxlQUFTLEdBQTRCLElBQUksWUFBWSxFQUFhLENBQUM7UUFNdEUscUJBQWU7Ozs7UUFBRyxVQUFDLFNBQW9CO1lBQzVDLEtBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ2pDLENBQUMsRUFBQTtRQUVNLGFBQU87OztRQUFHO1lBQ2YsS0FBSSxDQUFDLGFBQWEsR0FBRyxFQUFFLENBQUM7WUFDeEIsS0FBSSxDQUFDLFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFJLENBQUMsT0FBTyxFQUFFLEtBQUksQ0FBQyxTQUFTLENBQUM7aUJBQ3pELElBQUksQ0FDSCxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQ1AsU0FBUyxDQUFDLEtBQUksQ0FBQyxXQUFXLENBQUMsQ0FDNUIsQ0FBQyxTQUFTOzs7O1lBQ1gsVUFBQSxhQUFhO2dCQUNYLEtBQUksQ0FBQyxhQUFhLEdBQUcsYUFBYSxDQUFDLFFBQVEsSUFBSSxFQUFFLENBQUM7WUFDcEQsQ0FBQzs7OztZQUFFLFVBQUEsS0FBSyxJQUFNLEtBQUksQ0FBQyxZQUFZLEdBQUcsbUNBQW1DLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQztRQUNyRyxDQUFDLEVBQUE7UUFFTSx3QkFBa0I7OztRQUFHO1lBQzFCLEtBQUksQ0FBQyxRQUFRLENBQUMsZUFBZSxDQUFDLElBQUksRUFBRSxLQUFJLENBQUMsT0FBTyxFQUFFLEtBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztZQUNsRSxLQUFJLENBQUMsYUFBYSxHQUFHLEVBQUUsQ0FBQztRQUMxQixDQUFDLEVBQUE7UUFFTSxtQkFBYTs7OztRQUFHLFVBQUMsT0FBZTtZQUNyQyxLQUFJLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxLQUFJLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUNsRSxLQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxPQUFPLEVBQUUsS0FBSSxDQUFDLE9BQU8sRUFBRSxLQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDdkUsQ0FBQyxFQUFBOztJQUtELENBQUM7Ozs7SUFFRCx3REFBZTs7O0lBQWY7UUFBQSxpQkFLQztRQUpDLGlCQUFNLGVBQWUsV0FBRSxDQUFDO1FBQ3hCLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTOzs7O1FBQUMsVUFBQSxNQUFNO1lBQ3JDLEtBQUksQ0FBQyxZQUFZLEdBQUcscUJBQXFCLENBQUMsa0JBQWtCLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDdkUsQ0FBQyxFQUFDLENBQUM7SUFDTCxDQUFDOzs7O0lBRUQsaURBQVE7OztJQUFSO1FBQ0UsaUJBQU0sUUFBUSxXQUFFLENBQUM7UUFDakIsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO0lBQ2pCLENBQUM7O2dCQTlFRixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLCtCQUErQjtvQkFDekMscStEQUF3RDs7aUJBRXpEOzs7O2dCQWpCTyxlQUFlOzs7NEJBc0JwQixLQUFLOzBCQUtMLEtBQUs7OEJBS0wsS0FBSzs2QkFLTCxLQUFLOzRCQU9MLE1BQU07O0lBaURULHFDQUFDO0NBQUEsQUFoRkQsQ0FLb0QsaUJBQWlCLEdBMkVwRTtTQTNFWSw4QkFBOEI7Ozs7OztJQUl6QyxtREFBMkI7Ozs7O0lBSzNCLGlEQUF5Qjs7Ozs7SUFLekIscURBQWdGOzs7OztJQUtoRixvREFBd0U7Ozs7OztJQU94RSxtREFBNkU7O0lBRTdFLHVEQUErQjs7SUFDL0Isc0RBQTRCOztJQUM1QixzREFBNEI7O0lBRTVCLHlEQUVDOztJQUVELGlEQVVDOztJQUVELDREQUdDOztJQUVELHVEQUdDOzs7OztJQUdXLGtEQUFtQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFmdGVyVmlld0NoZWNrZWQsXG4gIEFmdGVyVmlld0luaXQsXG4gIENvbXBvbmVudCxcbiAgRWxlbWVudFJlZixcbiAgRXZlbnRFbWl0dGVyLFxuICBJbnB1dCxcbiAgT25EZXN0cm95LFxuICBPbkluaXQsXG4gIE91dHB1dCxcbiAgVmlld0NoaWxkXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtTdWJqZWN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7bWFwLCB0YWtlLCB0YWtlVW50aWx9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7TGl2ZUFwcHNTZXJ2aWNlfSBmcm9tICcuLi8uLi9zZXJ2aWNlcy9saXZlLWFwcHMuc2VydmljZSc7XG5pbXBvcnQge0xpdmVBcHBzQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtY29tcG9uZW50L2xpdmUtYXBwcy1jb21wb25lbnQuY29tcG9uZW50JztcbmltcG9ydCB7Q2FzZVJvdXRlfSBmcm9tICcuLi8uLi9tb2RlbHMvbGl2ZWFwcHNkYXRhJztcbmltcG9ydCB7VGNDb21wb25lbnQsIFRjQ29yZUNvbW1vbkZ1bmN0aW9uc30gZnJvbSAnQHRpYmNvLXRjc3RrL3RjLWNvcmUtbGliJztcblxuXG4vKipcbiAqIFRoaXMgQ29tcG9uZW50IGFsbG93cyB0byBsaXN0IHlvdXIgRmF2b3JpdGUgQ2FzZXMuXG4gKlxuICogIVthbHQtdGV4dF0oLi4vbGl2ZS1hcHBzLWZhdm9yaXRlLWNhc2VzLnBuZyBcIkRvY3VtZW50cyBDb21wb25lbnQgSW1hZ2VcIilcbiAqXG4gKkBleGFtcGxlIDx0Y2xhLWxpdmUtYXBwcy1mYXZvcml0ZS1jYXNlcz48L3RjbGEtbGl2ZS1hcHBzLWZhdm9yaXRlLWNhc2VzPlxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd0Y2xhLWxpdmUtYXBwcy1mYXZvcml0ZS1jYXNlcycsXG4gIHRlbXBsYXRlVXJsOiAnLi9saXZlLWFwcHMtZmF2b3JpdGUtY2FzZXMuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9saXZlLWFwcHMtZmF2b3JpdGUtY2FzZXMuY29tcG9uZW50LmNzcyddXG59KVxuZXhwb3J0IGNsYXNzIExpdmVBcHBzRmF2b3JpdGVDYXNlc0NvbXBvbmVudCBleHRlbmRzIExpdmVBcHBzQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0LCBBZnRlclZpZXdJbml0IHtcbiAgLyoqXG4gICAqIHNhbmRib3hJZCAtIHRoaXMgY29tZXMgZnJvbSBjbGFpbXMgcmVzb2x2ZXJcbiAgICovXG4gIEBJbnB1dCgpIHNhbmRib3hJZDogbnVtYmVyO1xuXG4gIC8qKlxuICAgKiBUaGUgQXBwbGljYXRpb24gSUQgb2YgdGhlIFVJIChzaG91bGQgaWRlYWxseSBiZSB1bmlxdWUgYXMgaXQgaXMgc2hhcmVkIHN0YXRlIGtleSlcbiAgICovXG4gIEBJbnB1dCgpIHVpQXBwSWQ6IHN0cmluZztcblxuICAvKipcbiAgICogY2FzZSBjYXJkIGZvcm1hdCAtIGxpc3QsIGNhcmQsIG1pbmlDYXJkLCBzdGF0aWNMaXN0IChubyBjbGljayBldmVudClcbiAgICovXG4gIEBJbnB1dCgpIGRpc3BsYXlUeXBlOiBzdHJpbmcgPSB0aGlzLmRpc3BsYXlUeXBlID8gdGhpcy5kaXNwbGF5VHlwZSA6ICdtaW5pQ2FyZCc7IC8vIG1pbmlDYXJkLCBjYXJkLCBsaXN0XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdG8gc2hvdyB0aGUgaGVhZGVyIGJhciBpbiB0aGUgd2lkZ2V0IC0gZWcuIGZhdm9yaXRlcyBvbiBob21lIHBhZ2UgKGNvbnRhaW5zIGljb24gZXRjKSAtIGlmIG9mZiBpY29ucyBzdGlsbCBhcHBlYXIgd2l0aG91dCBiYXJcbiAgICovXG4gIEBJbnB1dCgpIHNob3dIZWFkZXI6IGJvb2xlYW4gPSB0aGlzLnNob3dIZWFkZXIgPyB0aGlzLnNob3dIZWFkZXIgOiB0cnVlO1xuXG5cbiAgLyoqXG4gICAqIH5ldmVudCBjbGlja0Nhc2UgOiBDYXNlIGNsaWNrZWRcbiAgICogfnBheWxvYWQgQ2FzZVJvdXRlIDogQ2FzZVJvdXRlIG9iamVjdCBvdXRwdXQgd2hlbiBjYXNlIGlzIGNsaWNrZWQgc28gY2FsbGluZyBjb21wb25lbnQgY2FuIHJvdXRlIGFjY29yZGluZ2x5IC0gaWUuIHJvdXRlIHRvIGNhc2VcbiAgICovXG4gIEBPdXRwdXQoKSBjbGlja0Nhc2U6IEV2ZW50RW1pdHRlcjxDYXNlUm91dGU+ID0gbmV3IEV2ZW50RW1pdHRlcjxDYXNlUm91dGU+KCk7XG5cbiAgcHVibGljIGZhdm9yaXRlQ2FzZXM6IHN0cmluZ1tdO1xuICBwdWJsaWMgZXJyb3JNZXNzYWdlOiBzdHJpbmc7XG4gIHB1YmxpYyBjYXJkV2lkdGhQY3Q6IE51bWJlcjtcblxuICBwdWJsaWMgY2xpY2tDYXNlQWN0aW9uID0gKGNhc2VSb3V0ZTogQ2FzZVJvdXRlKSA9PiB7XG4gICAgdGhpcy5jbGlja0Nhc2UuZW1pdChjYXNlUm91dGUpO1xuICB9XG5cbiAgcHVibGljIHJlZnJlc2ggPSAoKSA9PiB7XG4gICAgdGhpcy5mYXZvcml0ZUNhc2VzID0gW107XG4gICAgdGhpcy5saXZlYXBwcy5nZXRGYXZvcml0ZUNhc2VzKHRoaXMudWlBcHBJZCwgdGhpcy5zYW5kYm94SWQpXG4gICAgICAucGlwZShcbiAgICAgICAgdGFrZSgxKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuX2Rlc3Ryb3llZCQpXG4gICAgICApLnN1YnNjcmliZShcbiAgICAgIGZhdm9yaXRlQ2FzZXMgPT4ge1xuICAgICAgICB0aGlzLmZhdm9yaXRlQ2FzZXMgPSBmYXZvcml0ZUNhc2VzLmNhc2VSZWZzIHx8IFtdO1xuICAgICAgfSwgZXJyb3IgPT4geyB0aGlzLmVycm9yTWVzc2FnZSA9ICdFcnJvciByZXRyaWV2aW5nIGZhdm9yaXRlIGNhc2VzOiAnICsgZXJyb3IuZXJyb3IuZXJyb3JNc2c7IH0pO1xuICB9XG5cbiAgcHVibGljIGNsZWFyRmF2b3JpdGVDYXNlcyA9ICgpID0+IHtcbiAgICB0aGlzLmxpdmVhcHBzLnNldEZhdm9yaXRlQ2FzZSgnLTEnLCB0aGlzLnVpQXBwSWQsIHRoaXMuc2FuZGJveElkKTtcbiAgICB0aGlzLmZhdm9yaXRlQ2FzZXMgPSBbXTtcbiAgfVxuXG4gIHB1YmxpYyBoYW5kbGVEZWxldGVkID0gKGNhc2VSZWY6IHN0cmluZykgPT4ge1xuICAgIHRoaXMuZmF2b3JpdGVDYXNlcy5zcGxpY2UodGhpcy5mYXZvcml0ZUNhc2VzLmluZGV4T2YoY2FzZVJlZiksIDEpO1xuICAgIHRoaXMubGl2ZWFwcHMuc2V0RmF2b3JpdGVDYXNlKGNhc2VSZWYsIHRoaXMudWlBcHBJZCwgdGhpcy5zYW5kYm94SWQpO1xuICB9XG5cblxuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgbGl2ZWFwcHM6IExpdmVBcHBzU2VydmljZSkge1xuICAgIHN1cGVyKCk7XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgc3VwZXIubmdBZnRlclZpZXdJbml0KCk7XG4gICAgdGhpcy5jb250YWluZXJDaGFuZ2VzJC5zdWJzY3JpYmUod2lkZ2V0ID0+IHtcbiAgICAgIHRoaXMuY2FyZFdpZHRoUGN0ID0gVGNDb3JlQ29tbW9uRnVuY3Rpb25zLmNhbGNTdW1tYXJ5Q2FyZFBjdCh3aWRnZXQpO1xuICAgIH0pO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgc3VwZXIubmdPbkluaXQoKTtcbiAgICB0aGlzLnJlZnJlc2goKTtcbiAgfVxuXG59XG4iXX0=