/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
// todo: JS deprecate this since now using private API to allow only listing of enabled creators
import { Component, EventEmitter, Input, Output, ViewChild } from '@angular/core';
import { LaProcessSelection } from '../../models/tc-case-processes';
import { LiveAppsComponent } from '../live-apps-component/live-apps-component.component';
import { LiveAppsService } from '../../services/live-apps.service';
import { map } from 'rxjs/operators';
import { MatSelect } from '@angular/material';
var LiveAppsCreatorSelectorComponent = /** @class */ (function (_super) {
    tslib_1.__extends(LiveAppsCreatorSelectorComponent, _super);
    function LiveAppsCreatorSelectorComponent(liveapps) {
        var _this = _super.call(this) || this;
        _this.liveapps = liveapps;
        /**
         * ~event creatorSelection : Case Creator selected
         * ~payload LaProcessSelection : LaProcessSelection object output when a creator is selected from a drop down
         */
        _this.creatorSelection = new EventEmitter();
        // run when the user clicks on a case creator
        _this.selectProcess = (/**
         * @param {?} process
         * @return {?}
         */
        function (process) {
            _this.creatorSelection.emit(new LaProcessSelection('creator', _this.appSchema, _this.getCaseIDAttributeName(), process, 
            // Format of ref is <applicationName>.<applicationInternalName>.<processType>.<processName>
            (_this.caseType.applicationName + '.' + _this.caseType.applicationInternalName + '.' + 'creator' + '.' + process.name), undefined));
        });
        _this.reset = (/**
         * @return {?}
         */
        function () {
            _this.creatorSelector.value = undefined;
        });
        _this.getCaseIDAttributeName = (/**
         * @return {?}
         */
        function () {
            /** @type {?} */
            var caseIdAttrib;
            _this.caseType.attributes.forEach((/**
             * @param {?} attribute
             * @return {?}
             */
            function (attribute) {
                if (attribute.isIdentifier) {
                    caseIdAttrib = attribute;
                }
            }));
            return caseIdAttrib;
        });
        _this.refresh = (/**
         * @return {?}
         */
        function () {
            // retrieve the schema for this case type so we can display case creators and case actions for this case type
            _this.liveapps.getCaseTypeSchema(_this.sandboxId, _this.appId, 100).pipe(map((/**
             * @param {?} schema
             * @return {?}
             */
            function (schema) {
                _this.appSchema = schema;
                schema.casetypes.forEach((/**
                 * @param {?} casetype
                 * @return {?}
                 */
                function (casetype) {
                    // the schema will contain definitions for both the 'case' and any defined types in that case.
                    // We want the schema for this 'case'.
                    if (casetype.applicationId === _this.appId && casetype.id === _this.typeId) {
                        if (casetype.jsonSchema !== undefined) {
                            _this.caseType = casetype;
                            _this.caseCreatorList = casetype.creators ? casetype.creators : [];
                            if (_this.caseCreatorList.length === 1) {
                                _this.selectProcess(_this.caseCreatorList[0]);
                            }
                        }
                        else {
                            console.error('No schema returned for this case type: You may need to update/re-deploy the live apps application');
                        }
                    }
                }));
            }))).subscribe();
        });
        return _this;
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    LiveAppsCreatorSelectorComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes.appId && (changes.appId.currentValue !== changes.appId.previousValue)) {
            this.caseCreatorList = [];
            this.refresh();
        }
    };
    LiveAppsCreatorSelectorComponent.decorators = [
        { type: Component, args: [{
                    selector: 'tcla-live-apps-creator-selector',
                    template: "<div *ngIf=\"caseCreatorList && caseCreatorList.length > 1\" fxFlex style=\"margin-left: 10px;\">\n    <span class=\"tcs-case-creation-dialog-instruction\">Select a case creator</span>\n    <mat-select #creatorSelector class=\"tcs-creator-selector-option\" [disableOptionCentering]=\"true\"\n                placeholder=\"Case Creators\" (selectionChange)=\"selectProcess($event.value)\">\n      <mat-option *ngFor=\"let creator of caseCreatorList\" [value]=\"creator\">\n        <span>{{creator.name}}</span>\n      </mat-option>\n    </mat-select>\n</div>\n",
                    styles: [":host ::ng-deep .tcs-creator-selector-option .mat-select-value span{font-family:Source Sans Pro;font-size:16px;font-weight:400;font-style:normal;font-stretch:normal;line-height:1.5;letter-spacing:.3px;color:#0081cb}:host ::ng-deep .tcs-creator-selector-option .mat-select-arrow-wrapper div{color:#0081cb}:host ::ng-deep .mat-select-value{min-width:100px;max-width:100%;width:auto}.tcs-creators-box{width:200px;height:44px;box-shadow:inset 0 1px 3px 0 rgba(0,0,0,.5);background-color:#fff}tcs-creator-selector-option{width:170px;margin-left:5px;margin-right:5px;background-color:#eee;padding-left:20px;padding-right:20px;height:35px}.tcs-case-creation-dialog-instruction{font-family:Source Sans Pro;font-size:16px;font-weight:600;font-style:normal;font-stretch:normal;line-height:normal;letter-spacing:normal;color:#727272}"]
                }] }
    ];
    /** @nocollapse */
    LiveAppsCreatorSelectorComponent.ctorParameters = function () { return [
        { type: LiveAppsService }
    ]; };
    LiveAppsCreatorSelectorComponent.propDecorators = {
        creatorSelector: [{ type: ViewChild, args: ['creatorSelector', { static: false },] }],
        sandboxId: [{ type: Input }],
        appId: [{ type: Input }],
        typeId: [{ type: Input }],
        creatorSelection: [{ type: Output }]
    };
    return LiveAppsCreatorSelectorComponent;
}(LiveAppsComponent));
export { LiveAppsCreatorSelectorComponent };
if (false) {
    /** @type {?} */
    LiveAppsCreatorSelectorComponent.prototype.creatorSelector;
    /** @type {?} */
    LiveAppsCreatorSelectorComponent.prototype.sandboxId;
    /** @type {?} */
    LiveAppsCreatorSelectorComponent.prototype.appId;
    /** @type {?} */
    LiveAppsCreatorSelectorComponent.prototype.typeId;
    /**
     * ~event creatorSelection : Case Creator selected
     * ~payload LaProcessSelection : LaProcessSelection object output when a creator is selected from a drop down
     * @type {?}
     */
    LiveAppsCreatorSelectorComponent.prototype.creatorSelection;
    /** @type {?} */
    LiveAppsCreatorSelectorComponent.prototype.appSchema;
    /** @type {?} */
    LiveAppsCreatorSelectorComponent.prototype.caseType;
    /** @type {?} */
    LiveAppsCreatorSelectorComponent.prototype.caseCreatorList;
    /** @type {?} */
    LiveAppsCreatorSelectorComponent.prototype.selectProcess;
    /** @type {?} */
    LiveAppsCreatorSelectorComponent.prototype.reset;
    /**
     * @type {?}
     * @private
     */
    LiveAppsCreatorSelectorComponent.prototype.getCaseIDAttributeName;
    /** @type {?} */
    LiveAppsCreatorSelectorComponent.prototype.refresh;
    /**
     * @type {?}
     * @private
     */
    LiveAppsCreatorSelectorComponent.prototype.liveapps;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGl2ZS1hcHBzLWNyZWF0b3Itc2VsZWN0b3IuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHRpYmNvLXRjc3RrL3RjLWxpdmVhcHBzLWxpYi8iLCJzb3VyY2VzIjpbImxpYi9jb21wb25lbnRzL2xpdmUtYXBwcy1jcmVhdG9yLXNlbGVjdG9yL2xpdmUtYXBwcy1jcmVhdG9yLXNlbGVjdG9yLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFFQSxPQUFPLEVBQUMsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQXFCLE1BQU0sRUFBaUIsU0FBUyxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBRWxILE9BQU8sRUFBQyxrQkFBa0IsRUFBQyxNQUFNLGdDQUFnQyxDQUFDO0FBQ2xFLE9BQU8sRUFBQyxpQkFBaUIsRUFBQyxNQUFNLHNEQUFzRCxDQUFDO0FBQ3ZGLE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxrQ0FBa0MsQ0FBQztBQUNqRSxPQUFPLEVBQUMsR0FBRyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFFbkMsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLG1CQUFtQixDQUFDO0FBRTVDO0lBS3NELDREQUFpQjtJQWtFckUsMENBQW9CLFFBQXlCO1FBQTdDLFlBQ0UsaUJBQU8sU0FDUjtRQUZtQixjQUFRLEdBQVIsUUFBUSxDQUFpQjs7Ozs7UUF4RG5DLHNCQUFnQixHQUFHLElBQUksWUFBWSxFQUFzQixDQUFDOztRQU83RCxtQkFBYTs7OztRQUFHLFVBQUMsT0FBTztZQUM3QixLQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLElBQUksa0JBQWtCLENBQUMsU0FBUyxFQUFFLEtBQUksQ0FBQyxTQUFTLEVBQUUsS0FBSSxDQUFDLHNCQUFzQixFQUFFLEVBQUUsT0FBTztZQUNqSCwyRkFBMkY7WUFDM0YsQ0FBQyxLQUFJLENBQUMsUUFBUSxDQUFDLGVBQWUsR0FBRyxHQUFHLEdBQUcsS0FBSSxDQUFDLFFBQVEsQ0FB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Qzs7SUFFRCxpREFFQzs7Ozs7SUFFRCxrRUFRQzs7SUFFRCxtREF3QkM7Ozs7O0lBR1csb0RBQWlDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gdG9kbzogSlMgZGVwcmVjYXRlIHRoaXMgc2luY2Ugbm93IHVzaW5nIHByaXZhdGUgQVBJIHRvIGFsbG93IG9ubHkgbGlzdGluZyBvZiBlbmFibGVkIGNyZWF0b3JzXG5cbmltcG9ydCB7Q29tcG9uZW50LCBFdmVudEVtaXR0ZXIsIElucHV0LCBPbkNoYW5nZXMsIE9uSW5pdCwgT3V0cHV0LCBTaW1wbGVDaGFuZ2VzLCBWaWV3Q2hpbGR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtDYXNlVHlwZSwgQ2FzZVR5cGVzTGlzdCwgUHJvY2Vzc30gZnJvbSAnLi4vLi4vbW9kZWxzL2xpdmVhcHBzZGF0YSc7XG5pbXBvcnQge0xhUHJvY2Vzc1NlbGVjdGlvbn0gZnJvbSAnLi4vLi4vbW9kZWxzL3RjLWNhc2UtcHJvY2Vzc2VzJztcbmltcG9ydCB7TGl2ZUFwcHNDb21wb25lbnR9IGZyb20gJy4uL2xpdmUtYXBwcy1jb21wb25lbnQvbGl2ZS1hcHBzLWNvbXBvbmVudC5jb21wb25lbnQnO1xuaW1wb3J0IHtMaXZlQXBwc1NlcnZpY2V9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2xpdmUtYXBwcy5zZXJ2aWNlJztcbmltcG9ydCB7bWFwfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQge0xpdmVBcHBzU3RhdGVJY29uQ29tcG9uZW50fSBmcm9tICcuLi9saXZlLWFwcHMtc3RhdGUtaWNvbi9saXZlLWFwcHMtc3RhdGUtaWNvbi5jb21wb25lbnQnO1xuaW1wb3J0IHtNYXRTZWxlY3R9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAndGNsYS1saXZlLWFwcHMtY3JlYXRvci1zZWxlY3RvcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9saXZlLWFwcHMtY3JlYXRvci1zZWxlY3Rvci5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2xpdmUtYXBwcy1jcmVhdG9yLXNlbGVjdG9yLmNvbXBvbmVudC5jc3MnXVxufSlcbmV4cG9ydCBjbGFzcyBMaXZlQXBwc0NyZWF0b3JTZWxlY3RvckNvbXBvbmVudCBleHRlbmRzIExpdmVBcHBzQ29tcG9uZW50IGltcGxlbWVudHMgT25DaGFuZ2VzIHtcbiAgQFZpZXdDaGlsZCgnY3JlYXRvclNlbGVjdG9yJywge3N0YXRpYzogZmFsc2V9KSBjcmVhdG9yU2VsZWN0b3I6IE1hdFNlbGVjdDtcbiAgQElucHV0KCkgc2FuZGJveElkOiBudW1iZXI7XG4gIEBJbnB1dCgpIGFwcElkOiBzdHJpbmc7XG4gIEBJbnB1dCgpIHR5cGVJZDogc3RyaW5nO1xuICAvKipcbiAgICogfmV2ZW50IGNyZWF0b3JTZWxlY3Rpb24gOiBDYXNlIENyZWF0b3Igc2VsZWN0ZWRcbiAgICogfnBheWxvYWQgTGFQcm9jZXNzU2VsZWN0aW9uIDogTGFQcm9jZXNzU2VsZWN0aW9uIG9iamVjdCBvdXRwdXQgd2hlbiBhIGNyZWF0b3IgaXMgc2VsZWN0ZWQgZnJvbSBhIGRyb3AgZG93blxuICAgKi9cblxuICBAT3V0cHV0KCkgY3JlYXRvclNlbGVjdGlvbiA9IG5ldyBFdmVudEVtaXR0ZXI8TGFQcm9jZXNzU2VsZWN0aW9uPigpO1xuXG4gIGFwcFNjaGVtYTogQ2FzZVR5cGVzTGlzdDtcbiAgY2FzZVR5cGU6IENhc2VUeXBlO1xuICBjYXNlQ3JlYXRvckxpc3Q6IFByb2Nlc3NbXTtcblxuICAvLyBydW4gd2hlbiB0aGUgdXNlciBjbGlja3Mgb24gYSBjYXNlIGNyZWF0b3JcbiAgcHVibGljIHNlbGVjdFByb2Nlc3MgPSAocHJvY2VzcykgPT4ge1xuICAgIHRoaXMuY3JlYXRvclNlbGVjdGlvbi5lbWl0KG5ldyBMYVByb2Nlc3NTZWxlY3Rpb24oJ2NyZWF0b3InLCB0aGlzLmFwcFNjaGVtYSwgdGhpcy5nZXRDYXNlSURBdHRyaWJ1dGVOYW1lKCksIHByb2Nlc3MsXG4gICAgICAvLyBGb3JtYXQgb2YgcmVmIGlzIDxhcHBsaWNhdGlvbk5hbWU+LjxhcHBsaWNhdGlvbkludGVybmFsTmFtZT4uPHByb2Nlc3NUeXBlPi48cHJvY2Vzc05hbWU+XG4gICAgICAodGhpcy5jYXNlVHlwZS5hcHBsaWNhdGlvbk5hbWUgKyAnLicgKyB0aGlzLmNhc2VUeXBlLmFwcGxpY2F0aW9uSW50ZXJuYWxOYW1lICsgJy4nICsgJ2NyZWF0b3InICsgJy4nICsgcHJvY2Vzcy5uYW1lKSxcbiAgICAgIHVuZGVmaW5lZFxuICAgICkpO1xuICB9XG5cbiAgcHVibGljIHJlc2V0ID0gKCkgPT4ge1xuICAgIHRoaXMuY3JlYXRvclNlbGVjdG9yLnZhbHVlID0gdW5kZWZpbmVkO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRDYXNlSURBdHRyaWJ1dGVOYW1lID0gKCkgPT4ge1xuICAgIGxldCBjYXNlSWRBdHRyaWI6IGFueTtcbiAgICB0aGlzLmNhc2VUeXBlLmF0dHJpYnV0ZXMuZm9yRWFjaCgoYXR0cmlidXRlKSA9PiB7XG4gICAgICBpZiAoYXR0cmlidXRlLmlzSWRlbnRpZmllcikge1xuICAgICAgICBjYXNlSWRBdHRyaWIgPSBhdHRyaWJ1dGU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIGNhc2VJZEF0dHJpYjtcbiAgfVxuXG4gIHB1YmxpYyByZWZyZXNoID0gKCkgPT4ge1xuICAgIC8vIHJldHJpZXZlIHRoZSBzY2hlbWEgZm9yIHRoaXMgY2FzZSB0eXBlIHNvIHdlIGNhbiBkaXNwbGF5IGNhc2UgY3JlYXRvcnMgYW5kIGNhc2UgYWN0aW9ucyBmb3IgdGhpcyBjYXNlIHR5cGVcbiAgICB0aGlzLmxpdmVhcHBzLmdldENhc2VUeXBlU2NoZW1hKHRoaXMuc2FuZGJveElkLCB0aGlzLmFwcElkLCAxMDApLnBpcGUoXG4gICAgICBtYXAoc2NoZW1hID0+IHtcbiAgICAgICAgICB0aGlzLmFwcFNjaGVtYSA9IHNjaGVtYTtcbiAgICAgICAgICBzY2hlbWEuY2FzZXR5cGVzLmZvckVhY2goKGNhc2V0eXBlKSA9PiB7XG4gICAgICAgICAgICAgIC8vIHRoZSBzY2hlbWEgd2lsbCBjb250YWluIGRlZmluaXRpb25zIGZvciBib3RoIHRoZSAnY2FzZScgYW5kIGFueSBkZWZpbmVkIHR5cGVzIGluIHRoYXQgY2FzZS5cbiAgICAgICAgICAgICAgLy8gV2Ugd2FudCB0aGUgc2NoZW1hIGZvciB0aGlzICdjYXNlJy5cbiAgICAgICAgICAgICAgaWYgKGNhc2V0eXBlLmFwcGxpY2F0aW9uSWQgPT09IHRoaXMuYXBwSWQgJiYgY2FzZXR5cGUuaWQgPT09IHRoaXMudHlwZUlkKSB7XG4gICAgICAgICAgICAgICAgaWYgKGNhc2V0eXBlLmpzb25TY2hlbWEgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgdGhpcy5jYXNlVHlwZSA9IGNhc2V0eXBlO1xuICAgICAgICAgICAgICAgICAgdGhpcy5jYXNlQ3JlYXRvckxpc3QgPSBjYXNldHlwZS5jcmVhdG9ycyA/IGNhc2V0eXBlLmNyZWF0b3JzIDogW107XG4gICAgICAgICAgICAgICAgICBpZiAodGhpcy5jYXNlQ3JlYXRvckxpc3QubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RQcm9jZXNzKHRoaXMuY2FzZUNyZWF0b3JMaXN0WzBdKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignTm8gc2NoZW1hIHJldHVybmVkIGZvciB0aGlzIGNhc2UgdHlwZTogWW91IG1heSBuZWVkIHRvIHVwZGF0ZS9yZS1kZXBsb3kgdGhlIGxpdmUgYXBwcyBhcHBsaWNhdGlvbicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIClcbiAgICApLnN1YnNjcmliZSgpO1xuICB9XG5cblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGxpdmVhcHBzOiBMaXZlQXBwc1NlcnZpY2UpIHtcbiAgICBzdXBlcigpO1xuICB9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgIGlmIChjaGFuZ2VzLmFwcElkICYmIChjaGFuZ2VzLmFwcElkLmN1cnJlbnRWYWx1ZSAhPT0gY2hhbmdlcy5hcHBJZC5wcmV2aW91c1ZhbHVlKSkge1xuICAgICAgICB0aGlzLmNhc2VDcmVhdG9yTGlzdCA9IFtdO1xuICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgfVxuICB9XG59XG4iXX0=